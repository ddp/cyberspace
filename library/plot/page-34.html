<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>PLOT: Iteration Statements</title></head><body><banner><center><h1>Programming Language for Old Timers</h1><br>by David A. Moon<br>February 2006 .. September 2008<br></center><br>Comments and criticisms to dave underscore moon atsign alum dot mit dot edu.<br><hr><br><P align=center><A HREF="page-33.html">Previous page</A>&nbsp;&nbsp;&nbsp;<A HREF="index.html">Table of Contents</A>&nbsp;&nbsp;&nbsp;<A HREF="page-35.html">Next page</A></P><BR><h2>Iteration Statements</h2><P>The language semantics require tail recursion removal, so iteration can beaccomplished simply by writing a recursive function.  However, for readabilityseveral iteration statements are defined by macros.  These do not have to be part of thePLOT language per se, they are a library that could have been written by auser.  However it is likely that most programs use that library.<P><PRE>defmacro while ?test ?:loop-body =&gt; ...defmacro until ?test ?:loop-body =&gt; ...</PRE><P>These repeatedly execute the body zero or more times until the test is falseor true, respectively.  The scope of any definition in the test includes the body.The entire statement is enclosed in a block.The result is always false unless <TT>result:</TT> appears in the body.<P><PRE>defmacro for { ?:for-clause &amp; ~^ , }+ ?:loop-body =&gt; ...</PRE><P>A for statement begins with one or more clauses, separated by commas.  Theremainder of the statement is the body.  The entire statement is enclosed in a block.(There is not actually a syntactic type named for-clause.)<P>Each clause can be an iteration clause or an endtest clause.  An endtest clausespecifies a test that controls whether the iteration repeats.  An iterationclause specifies a variable and a set of values that it will assume insuccessive iterations.  All iteration variables take on their values inparallel.  An iteration clause can also imply an endtest.<P>The body is in the scope of additional "result" statements, defined bylocal macro definitions, that allow control over the value(s) of the for statement.The default value is false if these are not used and <TT>result:</TT> doesnot appear in the body.<P>The full details of the for statement are in the next section.<P>Example:<P><PRE>  for x in sequence, i from 0, while test?(x)    if test2?(i) collect x</PRE><P>The syntactic type loop-body used in iteration statements is defined as follows:<PRE>defclass loop-body  body is expression                    ; the main part of the body  result is expression or false         ; result expression if any  cleanup is expression or false        ; cleanup body if any  exit is name or false                 ; exit function if anydefparser loop-body [ exit: ?exit-function is name ]                    { ^ ?expr }+                    [ result: ?result ]                    [ cleanup: ?cleanup is block ] =&gt;  loop-body(if length(expr) = 1 then expr[0] else collation(expr...),            result, cleanup, exit-function)</PRE><P>The syntax and semantics of a loop-body are similar but not identical tothose of an ordinary body.<P>The expr expressions are the main part of the body.  They are executedand their values are ignored by each iteration of the iteration statement.They are enclosed in a block.<P>If an exit-function is specified, calling that function immediatelyreturns the arguments as the values of the whole iteration statement.<P>If a result expression is specified, it is evaluated when iterationterminates normally and its values arereturned as the values of the whole iteration statement.<P>If a cleanup block is specified, it is executed and its values are ignoredwhen control leaves the iteration statement, whether normally or abnormally.<P><P><BR><P align=center><A HREF="page-33.html">Previous page</A>&nbsp;&nbsp;&nbsp;<A HREF="index.html">Table of Contents</A>&nbsp;&nbsp;&nbsp;<A HREF="page-35.html">Next page</A></P><BR><br></body></html>