<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="4.6. Pairs" href="pairs.html" /><link rel="prev" title="4.4. Numbers and Time" href="numbers.html" />

    <!-- Generated with Sphinx 8.0.2 and Furo 2024.08.06 -->
        <title>4.5. Collections - Self Handbook 2024.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments%EF%B9%96v=a746c00c.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo%EF%B9%96v=354aac6f.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions%EF%B9%96v=302659d7.css" />
    
    


<style>body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Self Handbook 2024.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">Self Handbook 2024.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">2. Building the Self system</a></li>
<li class="toctree-l1"><a class="reference internal" href="langref.html">3. Language Reference</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="selfwrld.html">4. The Self World</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of 4. The Self World</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="worldorg.html">4.1. World Organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="roots.html">4.2. The Roots of Behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="blocks.html">4.3. Blocks, Booleans, and Control Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="numbers.html">4.4. Numbers and Time</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">4.5. Collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="pairs.html">4.6. Pairs</a></li>
<li class="toctree-l2"><a class="reference internal" href="mirrors.html">4.7. Mirrors</a></li>
<li class="toctree-l2"><a class="reference internal" href="messages.html">4.8. Messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="processes.html">4.9. Processes and Concurrency</a></li>
<li class="toctree-l2"><a class="reference internal" href="foreign.html">4.10. Foreign Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="unix.html">4.11. I/O and Unix</a></li>
<li class="toctree-l2"><a class="reference internal" href="oddball.html">4.12. Other Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="lowlevel.html">4.13. How to use the low-level interrupt facilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="textdebug.html">4.14. Using the textual debugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">4.15. Logging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="progguid.html">5. A Guide to Programming Style</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtoprg.html">6. How to Program in Self</a></li>
<li class="toctree-l1"><a class="reference internal" href="morphic.html">7. Morphic: The Self User Interface Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="vmref.html">8. Virtual Machine Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="ref.html">9. References</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="appendices.html">10. Appendices</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of 10. Appendices</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="glossary.html">10.1. Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="lexicaloverview.html">10.2. Lexical overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="syntaxoverview.html">10.3. Syntax overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="builtintypes.html">10.4. Built-in types</a></li>
<li class="toctree-l2"><a class="reference internal" href="usefulselectors.html">10.5. Useful Selectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="menus.html">10.6. Every Menu Item in the Programming Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="monitor.html">10.7. The system monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="primitives.html">10.8. Primitives</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="extras.html">11. Extras</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of 11. Extras</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="ui1.html">11.1. The Original Self UI</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/collections.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="collections">
<h1><span class="section-number">4.5. </span>Collections<a class="headerlink" href="#collections" title="Link to this heading">¶</a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clonable</span>
    <span class="n">collection</span>
        <span class="o">...</span> <span class="n">collection</span> <span class="n">hierarchy</span> <span class="o">...</span>
</pre></div>
</div>
<p>Collections are containers that hold zero or more other objects. In Self, collections behave as if
they have a key associated with each value in the collection. Collections without an obvious key,
such as lists, use each element as both key and value. Iterations over collections always pass both
the value and the key of each element (in that order) to the iteration block. Since Self blocks ignore
extra arguments, this allows applications that don’t care about keys to simply provide a block
that takes only one argument.</p>
<p>Collections have a rich protocol. Additions are made with <code class="docutils literal notranslate"><span class="pre">at:Put:</span></code>, or with <code class="docutils literal notranslate"><span class="pre">add:</span></code> or <code class="docutils literal notranslate"><span class="pre">addAll:</span></code> for
implicitly keyed collections. Iteration can be done with <code class="docutils literal notranslate"><span class="pre">do:</span></code> or with variations that allow the programmer
to specify special handling of the first and/or last element. <code class="docutils literal notranslate"><span class="pre">with:Do:</span></code> allows pairwise iteration
through two collections. The <code class="docutils literal notranslate"><span class="pre">includes:</span></code>, <code class="docutils literal notranslate"><span class="pre">occurrencesOf:</span></code>, and <code class="docutils literal notranslate"><span class="pre">findFirst:</span></code>
<code class="docutils literal notranslate"><span class="pre">IfPresent:IfAbsent:</span></code> messages test for the presence of particular values in the collection.
<code class="docutils literal notranslate"><span class="pre">filterBy:Into:</span></code> creates a new collection including only those elements that satisfy a predicate
block, while <code class="docutils literal notranslate"><span class="pre">mapBy:Into:</span></code> creates a new collection whose elements are the result of applying the
argument block to each element of the original collection.</p>
<p>Abstract collection behavior is defined in <code class="docutils literal notranslate"><span class="pre">traits</span> <span class="pre">collection</span></code>. Only a small handful of operations need
be implemented to create a new type of collection; the rest can be inherited from <code class="docutils literal notranslate"><span class="pre">traits</span> <span class="pre">collection</span></code>.
(See the <code class="docutils literal notranslate"><span class="pre">descendantResponsibility</span></code> slot of <code class="docutils literal notranslate"><span class="pre">traits</span> <span class="pre">collection</span></code>.) The following
sections discuss various kinds of collection in more detail.</p>
<p>Modules: collection (abstract collection behavior)</p>
<section id="indexable-collections">
<h2><span class="section-number">4.5.1. </span>Indexable Collections<a class="headerlink" href="#indexable-collections" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span>
    <span class="n">indexable</span>
        <span class="n">mutableIndexable</span>
            <span class="n">byteVector</span>
                <span class="o">...</span><span class="n">the</span> <span class="n">string</span> <span class="n">hierarchy</span>
            <span class="n">sequence</span>
                <span class="n">sortedSequence</span>
            <span class="n">vector</span>
</pre></div>
</div>
<p>Indexable collections allow random access to their elements via keys that are integers. All sequences
and vectors are indexable. The message <code class="docutils literal notranslate"><span class="pre">at:</span></code> is used to retrieve an element of an indexable collection
while <code class="docutils literal notranslate"><span class="pre">at:Put:</span></code> is used to update an element of a <code class="docutils literal notranslate"><span class="pre">mutableIndexable</span></code> collection (other
than a <code class="docutils literal notranslate"><span class="pre">sortedSequence</span></code>).</p>
<p>Modules: indexable, abstractString, vector, sequence, sortedSequence</p>
</section>
<section id="strings-characters-and-paragraphs">
<h2><span class="section-number">4.5.2. </span>Strings, Characters, and Paragraphs<a class="headerlink" href="#strings-characters-and-paragraphs" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span>
    <span class="o">...</span>
    <span class="n">byteVector</span>
        <span class="n">string</span>
            <span class="n">mutableString</span>
            <span class="n">immutableString</span>
                <span class="n">canonicalString</span>
</pre></div>
</div>
<p>A string is a vector whose elements are character objects. There are three kinds of concrete string:
immutable strings, mutable strings and canonical strings. <code class="docutils literal notranslate"><span class="pre">traits</span> <span class="pre">string</span></code> defines the behavior
shared by all strings. A character is a string of length one that references itself in its sole indexable
slot.</p>
<p>Mutable strings can be changed using the message <code class="docutils literal notranslate"><span class="pre">at:Put:</span></code>, which takes a character argument, or
<code class="docutils literal notranslate"><span class="pre">at:PutByte:</span></code>, which takes an integer argument. An immutable string cannot be modified, but
sending it the <code class="docutils literal notranslate"><span class="pre">copyMutable</span></code> message returns a mutable string containing the same characters.</p>
<p>Canonical strings are registered in an table inside the virtual machine, like Symbol objects in
Smalltalk or atoms in LISP. The VM guarantees that there is at most one canonical string for any
given sequence of bytes, so two canonical strings are equal (have the same contents) if and only if
they are identical (are the same object). This allows efficient equality checks between canonical
strings. All message selectors and string literals are canonical strings, and some primitives require
canonical strings as arguments. Sending <code class="docutils literal notranslate"><span class="pre">canonicalize</span></code> to any string returns the corresponding
canonical string.</p>
<p>Character objects behave like immutable strings of length one. There are 256 well-known character
objects in the Self universe. They are stored in a 256-element vector named <code class="docutils literal notranslate"><span class="pre">ascii</span></code>, with each
character stored at the location corresponding to its ASCII value. Characters respond to the message
<code class="docutils literal notranslate"><span class="pre">asByte</span></code> by returning their ASCII value (that is, their index in <code class="docutils literal notranslate"><span class="pre">ascii</span></code>). The inverse of <code class="docutils literal notranslate"><span class="pre">asByte</span></code>,
<code class="docutils literal notranslate"><span class="pre">asCharacter</span></code>, can be sent to an integer between 0 and 255 to obtain the corresponding
character object.</p>
<p>Module: string</p>
</section>
<section id="unordered-sets-and-dictionaries">
<h2><span class="section-number">4.5.3. </span>Unordered Sets and Dictionaries<a class="headerlink" href="#unordered-sets-and-dictionaries" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span>
    <span class="n">setOrDictionary</span>
        <span class="nb">set</span>
            <span class="n">sharedSet</span>
        <span class="n">dictionary</span>
            <span class="n">sharedDictionary</span>
</pre></div>
</div>
<p>There are two implementations of sets and dictionaries in the system. The one described in this
section is based on hash tables. The one discussed in the following section is based on sorted binary
trees. The hash table implementation has better performance over a wide range of conditions.
(An unfortunate ordering of element addtions can cause the unbalanced trees used in the tree version
to degenerate into an ordered lists, resulting in linear access times.)</p>
<p>A set behaves like a mathematical set. It contains elements without duplication in no particular order.
A dictionary implements a mapping from keys to values, where both keys and values are arbitrary
objects. Dictionaries implement the usual collection behavior plus keyed access using <code class="docutils literal notranslate"><span class="pre">at:</span></code>
and <code class="docutils literal notranslate"><span class="pre">at:Put:</span></code> and the dictionary-specific operations <code class="docutils literal notranslate"><span class="pre">includesKey:</span></code> and <code class="docutils literal notranslate"><span class="pre">removeKey:</span></code>. In order
to store an object in a set or use it as a dictionary key, the object must understand the messages
<code class="docutils literal notranslate"><span class="pre">hash</span></code> and <code class="docutils literal notranslate"><span class="pre">=</span></code>, the latter applying to any pair of items in the collection. This is because sets and dictionaries
are implemented as hash tables.</p>
<p>Derived from set and dictionary are <code class="docutils literal notranslate"><span class="pre">sharedSet</span></code> and <code class="docutils literal notranslate"><span class="pre">sharedDictionary</span></code>. These provide locking
to maintain internal consistency in the presence of concurrency.</p>
<p>Modules: setAndDictionary, sharedSetAndDictionary</p>
</section>
<section id="tree-based-sets-and-dictionaries">
<h2><span class="section-number">4.5.4. </span>Tree-Based Sets and Dictionaries<a class="headerlink" href="#tree-based-sets-and-dictionaries" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span>
    <span class="n">tree</span>
        <span class="n">treeNodes</span> <span class="n">abstract</span>
            <span class="n">treeNodes</span> <span class="n">bag</span>
            <span class="n">treeNodes</span> <span class="nb">set</span>
        <span class="n">emptyTrees</span> <span class="n">abstract</span>
            <span class="n">emptyTrees</span> <span class="n">bag</span>
            <span class="n">emptyTrees</span> <span class="nb">set</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">treeSet</span></code> and <code class="docutils literal notranslate"><span class="pre">treeBag</span></code> implement sorted collections using binary trees. The set variant ignores
duplicates, while the bag variant does not. Tree sets and bags allow both explicit and implicit keys
(that is, adding elements can be done with either <code class="docutils literal notranslate"><span class="pre">at:Put:</span></code> or <code class="docutils literal notranslate"><span class="pre">add:</span></code>), where a tree set that uses
explicit keys behaves like a dictionary. Sorting is done on explicit keys if present, values otherwise,
and the objects sorted must be mutually comparable. Comparisons between keys are made using
<code class="docutils literal notranslate"><span class="pre">compare:IfLess:Equal:Greater:</span></code>.</p>
<p>The implementation of trees uses dynamic inheritance to distinguish the differing behavior of empty
and non-empty subtrees. The prototype <code class="docutils literal notranslate"><span class="pre">treeSet</span></code> represents an empty (sub)tree; when an element
is added to it, its parent is switched from <code class="docutils literal notranslate"><span class="pre">traits</span> <span class="pre">emptyTrees</span> <span class="pre">set</span></code>, which holds behavior
for empty (sub)trees, to a new copy of <code class="docutils literal notranslate"><span class="pre">treeSetNode</span></code>, which represents a tree node holding an element.
Thus, the <code class="docutils literal notranslate"><span class="pre">treeSet</span></code> object now behaves as a <code class="docutils literal notranslate"><span class="pre">treeSetNode</span></code> object, with right and left subtrees
(initially copies of the empty subtree <code class="docutils literal notranslate"><span class="pre">treeSet</span></code>). Dynamic inheritance allows one object to
behave modally without using clumsy if-tests throughout every method.</p>
<p>One caveat: since these trees are not balanced, they can degenerate into lists if their elements are
added in sorted order. However, a more complex tree data structure might obscure the main point
of this implementation: to provide a canonical example of the use of dynamic inheritance.</p>
<p>Modules: tree</p>
</section>
<section id="lists-and-priorityqueues">
<h2><span class="section-number">4.5.5. </span>Lists and PriorityQueues<a class="headerlink" href="#lists-and-priorityqueues" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">collection</span>
    <span class="nb">list</span>
    <span class="n">priorityQueue</span>
</pre></div>
</div>
<p>A list is an unkeyed, circular, doubly-linked list of objects. Additions and removals at either end
are efficient, but removing an object in the middle is less so, as a linear search is involved.</p>
<p>A priorityQueue is an unkeyed, unordered collection with the property that the element with the
highest priority is always at the front of the queue. Priority queues are useful for sorting (heapsort)
and scheduling. The default comparison uses &lt;, but this can be changed.</p>
<p>Modules: list. priorityQueue</p>
</section>
<section id="constructing-and-concatenating-collections">
<h2><span class="section-number">4.5.6. </span>Constructing and Concatenating Collections<a class="headerlink" href="#constructing-and-concatenating-collections" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clonable</span>
    <span class="n">collector</span>
</pre></div>
</div>
<p>Two kinds of objects play supporting roles for collections. A <code class="docutils literal notranslate"><span class="pre">collector</span></code> object is created using
the &amp; operator (inherited from <code class="docutils literal notranslate"><span class="pre">defaultBehavior</span></code>), and represents a collection under construction.
The &amp; operator provides a concise syntax for constructing small collections. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(1 &amp; ’abc’ &amp; x) asList
</pre></div>
</div>
<p>constructs a list containing an integer, a string, and the object x. A <code class="docutils literal notranslate"><span class="pre">collector</span></code> object is not itself
a collection; it is converted into one using a conversion message such as <code class="docutils literal notranslate"><span class="pre">asList</span></code>, <code class="docutils literal notranslate"><span class="pre">asVector</span></code>, or
<code class="docutils literal notranslate"><span class="pre">asString</span></code>.</p>
<p>Modules: collector</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="pairs.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">4.6. </span>Pairs</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="numbers.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">4.4. </span>Numbers and Time</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Russell Allen (Ed.)
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">4.5. Collections</a><ul>
<li><a class="reference internal" href="#indexable-collections">4.5.1. Indexable Collections</a></li>
<li><a class="reference internal" href="#strings-characters-and-paragraphs">4.5.2. Strings, Characters, and Paragraphs</a></li>
<li><a class="reference internal" href="#unordered-sets-and-dictionaries">4.5.3. Unordered Sets and Dictionaries</a></li>
<li><a class="reference internal" href="#tree-based-sets-and-dictionaries">4.5.4. Tree-Based Sets and Dictionaries</a></li>
<li><a class="reference internal" href="#lists-and-priorityqueues">4.5.5. Lists and PriorityQueues</a></li>
<li><a class="reference internal" href="#constructing-and-concatenating-collections">4.5.6. Constructing and Concatenating Collections</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options%EF%B9%96v=db884f6e.js"></script>
    <script src="_static/doctools%EF%B9%96v=9a2dae69.js"></script>
    <script src="_static/sphinx_highlight%EF%B9%96v=dc90522c.js"></script>
    <script src="_static/scripts/furo%EF%B9%96v=5fa4622c.js"></script>
    </body>
</html>