%!PS-Adobe-3.0
%%Title: memo-0036-audit-protection
%%Creator: Library of Cyberspace Memo Pipeline
%%Pages: (atend)
%%EndComments

/Courier findfont 10 scalefont setfont
/margin 72 def
/pagewidth 612 def
/pageheight 792 def
/leading 12 def
/topmargin pageheight margin sub def
/bottommargin margin def
/linewidth pagewidth margin 2 mul sub def
/ypos topmargin def
/pagenum 1 def

/newline {
  /ypos ypos leading sub def
  ypos bottommargin lt {
    showpage
    /pagenum pagenum 1 add def
    /ypos topmargin def
  } if
  margin ypos moveto
} def

margin topmargin moveto
(Memo 0036: Audit Log Protection) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
() show newline
(------------------------------------------------------------------------) show newline
(ABSTRACT) show newline
(------------------------------------------------------------------------) show newline
() show newline
(This Memo specifies protection mechanisms for the Library of Cyberspace) show newline
(audit log: how the system prevents resource exhaustion, log flooding,) show newline
(and denial of service attacks against the audit trail while maintaining) show newline
(its integrity as the authoritative record of all vault operations.) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(MOTIVATION) show newline
(------------------------------------------------------------------------) show newline
() show newline
(The audit log is sacred:) show newline
() show newline
(  * Evidence) show newline
(  * Legal and forensic record) show newline
(  * Accountability) show newline
(  * Who did what when) show newline
(  * Recovery) show newline
(  * Reconstruct state after failure) show newline
(  * Trust) show newline
(  * Foundation of the security model) show newline
() show newline
(But the audit log is also a target:) show newline
() show newline
(  * Flooding) show newline
(  * Generate noise to hide malicious activity) show newline
(  * Exhaustion) show newline
(  * Fill storage to halt operations) show newline
(  * Evasion) show newline
(  * Overwhelm to prevent logging of real attacks) show newline
(  * Amplification) show newline
(  * Small action triggers large log entries) show newline
() show newline
(The audit log must protect itself while never failing to record.) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(THREAT MODEL) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Attack Vectors) show newline
(--------------) show newline
() show newline
() show newline
(    \(define audit-threats) show newline
(      '\(\(flooding) show newline
(         \(description "Generate massive log volume"\)) show newline
(         \(goal "Hide malicious activity in noise"\)) show newline
(         \(method "Rapid legitimate-looking operations"\)\)) show newline
(        \(exhaustion) show newline
(         \(description "Fill audit storage"\)) show newline
(         \(goal "Halt vault operations"\)) show newline
(         \(method "Sustained high-volume logging"\)\)) show newline
(        \(amplification) show newline
(         \(description "Small input, large log output"\)) show newline
(         \(goal "Asymmetric resource consumption"\)) show newline
(         \(method "Operations that log disproportionately"\)\)) show newline
(        \(corruption) show newline
(         \(description "Tamper with log entries"\)) show newline
(         \(goal "Alter historical record"\)) show newline
(         \(method "Exploit write access to log storage"\)\)) show newline
(        \(truncation) show newline
(         \(description "Force log rotation/deletion"\)) show newline
(         \(goal "Remove evidence"\)) show newline
(         \(method "Fill logs to trigger cleanup"\)\)\)\)) show newline
() show newline
() show newline
(Attacker Capabilities) show newline
(---------------------) show newline
() show newline
() show newline
(    ;; Assume attacker can:) show newline
(    ;; - Authenticate as a valid principal) show newline
(    ;; - Perform many legitimate operations) show newline
(    ;; - Control timing of operations) show newline
(    ;; - Observe system behavior) show newline
(    ;; Assume attacker cannot:) show newline
(    ;; - Directly write to audit storage) show newline
(    ;; - Forge signatures on log entries) show newline
(    ;; - Break cryptographic primitives) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(RATE LIMITING) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Per-Principal Audit Limits) show newline
(--------------------------) show newline
() show newline
() show newline
(    \(define audit-rate-limits) show newline
(      `\(\(entries-per-second . 100\)) show newline
(        \(bytes-per-second . 102400\)      ; 100KB/s) show newline
(        \(entries-per-minute . 1000\)) show newline
(        \(bytes-per-minute . 10485760\)\)\)  ; 10MB/min) show newline
(    \(define principal-audit-buckets \(make-hash-table\)\)) show newline
(    \(define \(get-audit-bucket principal\)) show newline
(      \(or \(hash-table-ref principal-audit-buckets principal #f\)) show newline
(          \(let \(\(bucket \(make-token-bucket) show newline
(                         \(assoc-ref audit-rate-limits 'entries-per-second\)) show newline
(                         \(assoc-ref audit-rate-limits 'entries-per-second\)\)\)\)) show newline
(            \(hash-table-set! principal-audit-buckets principal bucket\)) show newline
(            bucket\)\)\)) show newline
(    \(define \(audit-rate-check principal entry-size\)) show newline
(      "Check if principal can generate audit entry") show newline
(      \(let \(\(bucket \(get-audit-bucket principal\)\)\)) show newline
(        \(bucket 1\)\)\)  ; Consume one token) show newline
() show newline
() show newline
(Audit Entry Costing) show newline
(-------------------) show newline
() show newline
() show newline
(    ;; Different operations have different audit costs) show newline
(    \(define audit-costs) show newline
(      `\(\(read . 1\)) show newline
(        \(write . 2\)) show newline
(        \(delete . 5\)) show newline
(        \(query . 1\)) show newline
(        \(admin . 10\)) show newline
(        \(key-operation . 50\)) show newline
(        \(emergency . 0\)\)\)  ; Always allowed) show newline
(    \(define \(audit-cost action\)) show newline
(      \(or \(assoc-ref audit-costs action\) 1\)\)) show newline
(    \(define \(consume-audit-budget principal action\)) show newline
(      "Deduct from principal's audit budget") show newline
(      \(let \(\(cost \(audit-cost action\)\)) show newline
(            \(bucket \(get-audit-bucket principal\)\)\)) show newline
(        \(if \(bucket cost\)) show newline
(            #t) show newline
(            \(begin) show newline
(              ;; Log the rate limit event \(always succeeds\)) show newline
(              \(audit-append-privileged) show newline
(                action: 'audit-rate-limited) show newline
(                principal: principal) show newline
(                attempted-action: action\)) show newline
(              #f\)\)\)\)) show newline
() show newline
() show newline
(Burst Handling) show newline
(--------------) show newline
() show newline
() show newline
(    ;; Allow short bursts but limit sustained rate) show newline
(    \(define \(make-audit-limiter\)) show newline
(      \(let \(\(short-term \(make-token-bucket 200 100\)\)   ; 100/s, burst 200) show newline
(            \(long-term \(make-sliding-window 10000 60\)\)\) ; 10k/min) show newline
(        \(lambda \(cost\)) show newline
(          \(and \(short-term cost\)) show newline
(               \(long-term\)\)\)\)\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(STORAGE PROTECTION) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Reserved Audit Space) show newline
(--------------------) show newline
() show newline
() show newline
(    ;; Always reserve space for audit) show newline
(    \(define audit-reserved-space \( 1024 1024 1024\)\)  ; 1GB minimum) show newline
(    \(define \(audit-storage-available\)) show newline
(      \(let \(\(total \(storage-available\)\)) show newline
(            \(audit-used \(audit-storage-used\)\)\)) show newline
(        \(max 0 \(- total audit-reserved-space*\)\)\)\)) show newline
(    \(define \(check-audit-storage entry-size\)) show newline
(      "Ensure space for audit entry") show newline
(      \(let \(\(available \(audit-storage-available\)\)\)) show newline
(        \(when \(< available entry-size\)) show newline
(          ;; Emergency: halt non-audit operations) show newline
(          \(enter-audit-protection-mode\)) show newline
(          ;; But always log) show newline
(          #t\)\)\)) show newline
() show newline
() show newline
(Audit Protection Mode) show newline
(---------------------) show newline
() show newline
() show newline
(    \(define audit-protection-mode? \(make-parameter #f\)\)) show newline
(    \(define \(enter-audit-protection-mode\)) show newline
(      "Emergency mode: only allow audit writes") show newline
(      \(audit-protection-mode? #t\)) show newline
(      \(audit-append-privileged) show newline
(        action: 'audit-protection-enabled) show newline
(        reason: 'storage-exhaustion\)) show newline
(      ;; Reject all non-essential operations) show newline
(      \(set-vault-mode! 'audit-only\)\)) show newline
(    \(define \(exit-audit-protection-mode\)) show newline
(      "Resume normal operations") show newline
(      \(when \(> \(audit-storage-available\) \( 2 audit-reserved-space*\)\)) show newline
(        \(audit-protection-mode? #f\)) show newline
(        \(set-vault-mode! 'normal\)) show newline
(        \(audit-append-privileged) show newline
(          action: 'audit-protection-disabled\)\)\)) show newline
() show newline
() show newline
(Tiered Storage) show newline
(--------------) show newline
() show newline
() show newline
(    ;; Audit log tiers) show newline
(    \(define audit-tiers) show newline
(      '\(\(hot . \(\(retention . 86400\)      ; 1 day) show newline
(                \(storage . ssd\)) show newline
(                \(compression . none\)\)\)) show newline
(        \(warm . \(\(retention . 604800\)    ; 7 days) show newline
(                 \(storage . hdd\)) show newline
(                 \(compression . zstd-fast\)\)\)) show newline
(        \(cold . \(\(retention . 31536000\)  ; 1 year) show newline
(                 \(storage . archive\)) show newline
(                 \(compression . zstd-max\)\)\)) show newline
(        \(glacier . \(\(retention . #f\)     ; Forever) show newline
(                    \(storage . offsite\)) show newline
(                    \(compression . zstd-max\)\)\)\)\)) show newline
(    \(define \(tier-audit-entry entry age\)) show newline
(      "Move entry to appropriate storage tier") show newline
(      \(let \(\(tier \(find \(lambda \(t\)) show newline
(                          \(or \(not \(assoc-ref \(cdr t\) 'retention\)\)) show newline
(                              \(< age \(assoc-ref \(cdr t\) 'retention\)\)\)\)) show newline
(                        audit-tiers\)\)\)) show newline
(        \(migrate-to-tier entry \(car tier\)\)\)\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(ENTRY SIZE LIMITS) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Maximum Entry Size) show newline
(------------------) show newline
() show newline
() show newline
(    \(define max-audit-entry-size 65536\)  ; 64KB) show newline
(    \(define \(validate-audit-entry entry\)) show newline
(      "Validate entry before logging") show newline
(      \(let \(\(size \(serialized-size entry\)\)\)) show newline
(        \(when \(> size max-audit-entry-size\)) show newline
(          \(error 'audit-entry-too-large) show newline
(                 `\(\(size . ,size\)) show newline
(                   \(limit . ,max-audit-entry-size\)\)\)\)\)\)) show newline
() show newline
() show newline
(Entry Truncation) show newline
(----------------) show newline
() show newline
() show newline
(    \(define \(truncate-audit-entry entry max-size\)) show newline
(      "Truncate oversized entry while preserving critical fields") show newline
(      \(let \(\(critical '\(action principal timestamp hash signature\)\)\)) show newline
(        \(let loop \(\(entry entry\)) show newline
(                   \(fields \(entry-fields entry\)\)\)) show newline
(          \(if \(<= \(serialized-size entry\) max-size\)) show newline
(              entry) show newline
(              \(let \(\(removable \(find \(lambda \(f\)) show newline
(                                       \(not \(member f critical\)\)\)) show newline
(                                     fields\)\)\)) show newline
(                \(if removable) show newline
(                    \(loop \(assoc-remove entry removable\)) show newline
(                          \(delete removable fields\)\)) show newline
(                    ;; Can't truncate further, log warning) show newline
(                    \(begin) show newline
(                      \(audit-append-privileged) show newline
(                        action: 'audit-entry-truncation-failed) show newline
(                        original-size: \(serialized-size entry\)\)) show newline
(                      entry\)\)\)\)\)\)\)) show newline
() show newline
() show newline
(Payload Summarization) show newline
(---------------------) show newline
() show newline
() show newline
(    \(define \(summarize-large-payload payload\)) show newline
(      "Summarize large payloads for audit") show newline
(      \(if \(> \(bytevector-length payload\) 1024\)) show newline
(          `\(\(type . summarized\)) show newline
(            \(original-size . ,\(bytevector-length payload\)\)) show newline
(            \(hash . ,\(content-hash payload\)\)) show newline
(            \(preview . ,\(subbytevector payload 0 256\)\)\)) show newline
(          payload\)\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(AGGREGATION) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Event Aggregation) show newline
(-----------------) show newline
() show newline
() show newline
(    ;; Aggregate similar events to reduce volume) show newline
(    \(define aggregation-window 60\)  ; seconds) show newline
(    \(define pending-aggregations \(make-hash-table\)\)) show newline
(    \(define \(aggregate-audit-event action principal details\)) show newline
(      "Aggregate similar events within window") show newline
(      \(let* \(\(key \(list action principal\)\)) show newline
(             \(existing \(hash-table-ref pending-aggregations key #f\)\)\)) show newline
(        \(if existing) show newline
(            ;; Add to existing aggregation) show newline
(            \(begin) show newline
(              \(set-cdr! \(assoc 'count existing\)) show newline
(                        \(+ 1 \(assoc-ref existing 'count\)\)\)) show newline
(              \(set-cdr! \(assoc 'last-seen existing\)) show newline
(                        \(current-time\)\)\)) show newline
(            ;; Start new aggregation) show newline
(            \(hash-table-set! pending-aggregations key) show newline
(              `\(\(action . ,action\)) show newline
(                \(principal . ,principal\)) show newline
(                \(count . 1\)) show newline
(                \(first-seen . ,\(current-time\)\)) show newline
(                \(last-seen . ,\(current-time\)\)) show newline
(                \(sample . ,details\)\)\)\)\)\)) show newline
(    \(define \(flush-aggregations\)) show newline
(      "Flush aggregated events to audit log") show newline
(      \(hash-table-walk pending-aggregations) show newline
(        \(lambda \(key agg\)) show newline
(          \(when \(> \(- \(current-time\) \(assoc-ref agg 'first-seen\)\)) show newline
(                   aggregation-window\)) show newline
(            \(audit-append-direct) show newline
(              action: 'aggregated-events) show newline
(              original-action: \(assoc-ref agg 'action\)) show newline
(              principal: \(assoc-ref agg 'principal\)) show newline
(              count: \(assoc-ref agg 'count\)) show newline
(              window-start: \(assoc-ref agg 'first-seen\)) show newline
(              window-end: \(assoc-ref agg 'last-seen\)) show newline
(              sample: \(assoc-ref agg 'sample\)\)) show newline
(            \(hash-table-delete! pending-aggregations key\)\)\)\)\)) show newline
() show newline
() show newline
(Sampling) show newline
(--------) show newline
() show newline
() show newline
(    ;; Sample high-volume events) show newline
(    \(define \(should-sample? action principal\)) show newline
(      \(let \(\(rate \(current-rate action principal\)\)\)) show newline
(        \(cond) show newline
(          \(\(< rate 10\) #t\)              ; Always log low-rate) show newline
(          \(\(< rate 100\) \(< \(random 1.0\) 0.5\)\)  ; 50% sample) show newline
(          \(\(< rate 1000\) \(< \(random 1.0\) 0.1\)\) ; 10% sample) show newline
(          \(else \(< \(random 1.0\) 0.01\)\)\)\)\)      ; 1% sample) show newline
(    \(define \(audit-with-sampling action principal details\)) show newline
(      "Log with sampling for high-volume events") show newline
(      \(if \(should-sample? action principal\)) show newline
(          \(audit-append action: action) show newline
(                        principal: principal) show newline
(                        details: details) show newline
(                        sampled: #t\)) show newline
(          ;; Still count for rate tracking) show newline
(          \(increment-audit-counter action principal\)\)\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(ANOMALY DETECTION) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Baseline Establishment) show newline
(----------------------) show newline
() show newline
() show newline
(    \(define \(establish-audit-baseline principal duration\)) show newline
(      "Establish normal audit patterns for principal") show newline
(      \(let \(\(events \(soup-query type: 'audit-entry) show newline
(                                principal: principal) show newline
(                                timestamp: \(> \(- \(current-time\) duration\)\)\)\)\)) show newline
(        `\(\(events-per-hour . ,\(/ \(length events\) \(/ duration 3600\)\)\)) show newline
(          \(common-actions . ,\(top-n \(map audit-action events\) 10\)\)) show newline
(          \(typical-hours . ,\(typical-active-hours events\)\)) show newline
(          \(established-at . ,\(current-time\)\)\)\)\)) show newline
() show newline
() show newline
(Anomaly Detection) show newline
(-----------------) show newline
() show newline
() show newline
(    \(define \(detect-audit-anomaly principal current-rate baseline\)) show newline
(      "Detect anomalous audit patterns") show newline
(      \(let \(\(expected \(assoc-ref baseline 'events-per-hour\)\)) show newline
(            \(threshold 3.0\)\)  ; 3x normal is anomalous) show newline
(        \(when \(> current-rate \( threshold expected\)\)) show newline
(          \(audit-append-privileged) show newline
(            action: 'audit-anomaly-detected) show newline
(            principal: principal) show newline
(            current-rate: current-rate) show newline
(            expected-rate: expected) show newline
(            severity: \(if \(> current-rate \( 10 expected\)\)) show newline
(                          'critical) show newline
(                          'warning\)\)) show newline
(          ;; Potentially throttle) show newline
(          \(when \(> current-rate \(* 10 expected\)\)) show newline
(            \(throttle-principal principal\)\)\)\)\)) show newline
() show newline
() show newline
(Flood Detection) show newline
(---------------) show newline
() show newline
() show newline
(    \(define \(detect-audit-flood\)) show newline
(      "Detect system-wide audit flooding") show newline
(      \(let \(\(current-rate \(global-audit-rate\)\)) show newline
(            \(threshold \(* 10 \(baseline-global-rate\)\)\)\)) show newline
(        \(when \(> current-rate threshold\)) show newline
(          ;; Identify top contributors) show newline
(          \(let \(\(top-principals \(top-audit-principals 10\)\)\)) show newline
(            \(audit-append-privileged) show newline
(              action: 'audit-flood-detected) show newline
(              global-rate: current-rate) show newline
(              threshold: threshold) show newline
(              top-principals: top-principals\)) show newline
(            ;; Throttle top contributors) show newline
(            \(for-each throttle-principal) show newline
(                      \(map car top-principals\)\)\)\)\)\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(PRIVILEGED LOGGING) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(System Events) show newline
(-------------) show newline
() show newline
() show newline
(    ;; Some events bypass rate limits) show newline
(    \(define privileged-actions) show newline
(      '\(audit-rate-limited) show newline
(        audit-protection-enabled) show newline
(        audit-protection-disabled) show newline
(        audit-anomaly-detected) show newline
(        audit-flood-detected) show newline
(        key-ceremony) show newline
(        emergency-revoke) show newline
(        security-alert\)\)) show newline
(    \(define \(audit-append-privileged . args\)) show newline
(      "Log privileged event \(bypasses rate limits\)") show newline
(      \(let \(\(entry \(apply make-audit-entry args\)\)\)) show newline
(        ;; Always log, never rate limit) show newline
(        \(audit-write-direct entry\)) show newline
(        ;; Alert on privileged events) show newline
(        \(when \(member \(assoc-ref entry 'action\) '\(security-alert emergency-revoke\)\)) show newline
(          \(send-security-alert entry\)\)\)\)) show newline
() show newline
() show newline
(Guaranteed Delivery) show newline
(-------------------) show newline
() show newline
() show newline
(    \(define \(audit-write-guaranteed entry\)) show newline
(      "Write audit entry with guaranteed delivery") show newline
(      ;; Write to multiple locations) show newline
(      \(let \(\(locations \(list \(primary-audit-log\)) show newline
(                             \(secondary-audit-log\)) show newline
(                             \(remote-audit-log\)\)\)\)) show newline
(        \(let \(\(successes \(filter \(lambda \(loc\)) show newline
(                                   \(guard \(ex \(else #f\)\)) show newline
(                                     \(audit-write loc entry\)) show newline
(                                     #t\)\)) show newline
(                                 locations\)\)\)) show newline
(          \(when \(< \(length successes\) 2\)) show newline
(            ;; Failed to write to enough locations) show newline
(            \(emergency-audit-alert entry successes\)\)\)\)\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(INTEGRITY PROTECTION) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Append-Only Enforcement) show newline
(-----------------------) show newline
() show newline
() show newline
(    ;; Audit log is strictly append-only) show newline
(    \(define \(audit-write entry\)) show newline
(      "Append entry to audit log") show newline
(      \(let \(\(log \(current-audit-log\)\)\)) show newline
(        ;; Verify we're at the end) show newline
(        \(unless \(at-log-end? log\)) show newline
(          \(error 'audit-log-not-at-end\)\)) show newline
(        ;; Append with sequence number) show newline
(        \(let \(\(seq \(next-sequence-number log\)\)\)) show newline
(          \(write-entry log \(cons `\(sequence . ,seq\) entry\)\)) show newline
(          ;; Sign the entry) show newline
(          \(sign-entry log entry\)\)\)\)) show newline
() show newline
() show newline
(Chain Integrity) show newline
(---------------) show newline
() show newline
() show newline
(    ;; Each entry references previous \(blockchain-style\)) show newline
(    \(define \(chain-entry entry previous-hash\)) show newline
(      `\(\(previous-hash . ,previous-hash\)) show newline
(        \(sequence . ,\(+ 1 \(previous-sequence\)\)\)) show newline
(        \(timestamp . ,\(current-time\)\)) show newline
(        ,@entry) show newline
(        \(hash . ,\(compute-entry-hash entry previous-hash\)\)\)\)) show newline
(    \(define \(verify-audit-chain log\)) show newline
(      "Verify audit log chain integrity") show newline
(      \(let loop \(\(entries \(audit-entries log\)\)) show newline
(                 \(expected-prev #f\)\)) show newline
(        \(if \(null? entries\)) show newline
(            #t) show newline
(            \(let \(\(entry \(car entries\)\)\)) show newline
(              \(and \(or \(not expected-prev\)) show newline
(                       \(equal? \(assoc-ref entry 'previous-hash\) expected-prev\)\)) show newline
(                   \(loop \(cdr entries\)) show newline
(                         \(assoc-ref entry 'hash\)\)\)\)\)\)\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(RECOVERY) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Log Reconstruction) show newline
(------------------) show newline
() show newline
() show newline
(    \(define \(reconstruct-audit-log backups\)) show newline
(      "Reconstruct audit log from multiple backups") show newline
(      \(let \(\(entries \(merge-backup-entries backups\)\)\)) show newline
(        ;; Deduplicate by sequence number) show newline
(        \(let \(\(deduped \(deduplicate-by-sequence entries\)\)\)) show newline
(          ;; Verify chain) show newline
(          \(unless \(verify-audit-chain deduped\)) show newline
(            \(error 'audit-chain-broken\)\)) show newline
(          deduped\)\)\)) show newline
() show newline
() show newline
(Gap Detection) show newline
(-------------) show newline
() show newline
() show newline
(    \(define \(detect-audit-gaps log\)) show newline
(      "Find gaps in audit sequence") show newline
(      \(let loop \(\(entries \(audit-entries log\)\)) show newline
(                 \(expected-seq 1\)) show newline
(                 \(gaps '\(\)\)\)) show newline
(        \(if \(null? entries\)) show newline
(            gaps) show newline
(            \(let \(\(seq \(assoc-ref \(car entries\) 'sequence\)\)\)) show newline
(              \(if \(= seq expected-seq\)) show newline
(                  \(loop \(cdr entries\) \(+ seq 1\) gaps\)) show newline
(                  \(loop \(cdr entries\) \(+ seq 1\)) show newline
(                        \(cons \(list expected-seq \(- seq 1\)\) gaps\)\)\)\)\)\)\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(REFERENCES) show newline
(------------------------------------------------------------------------) show newline
() show newline
(1. [NIST SP 800-92: Guide to Computer Security Log) show newline
(Management]\(https://csrc.nist.gov/publications/detail/sp/800-92/final\)) show newline
(2. [Memo-003: Cryptographic Audit Trail]\(memo-003-audit-trail.html\) 3.) show newline
([Memo-032: Rate Limiting and Quotas]\(memo-032-rate-limiting.html\) 4.) show newline
([Memo-028: Error Handling and Recovery]\(memo-028-error-handling.html\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(CHANGELOG) show newline
(------------------------------------------------------------------------) show newline
() show newline
(  * 2026-01-07) show newline
(  * Initial draft) show newline
() show newline
(------------------------------------------------------------------------) show newline

showpage
%%Trailer
%%Pages: pagenum
%%EOF
