<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <title>Memo 0016: Coq Verification of the Authorization TCB</title>
  <link rel="icon" id="favicon" href="data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27%230f0%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>">
  <script>
(function(){
  var h=new Date().getHours(),c;
  if(h>=4&&h<6)c='%23845EC2';       // brahma muhurta - violet
  else if(h>=6&&h<8)c='%23ffd700';  // dawn - gold
  else if(h>=8&&h<11)c='%2300d4aa'; // morning - teal
  else if(h>=11&&h<14)c='%230f0';   // midday - phosphor
  else if(h>=14&&h<17)c='%2339ff14';// afternoon - neon
  else if(h>=17&&h<19)c='%23ff6600';// sunset - orange
  else if(h>=19&&h<22)c='%23ff3366';// evening - coral
  else c='%2300ffff';               // night - cyan
  document.getElementById('favicon').href='data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27'+c+'%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>';
})();
</script>
  <link rel="stylesheet" href="memo.css">
</head>
<body>
<span class="theme-toggle" onclick="toggleTheme()" title="Toggle light/dark">[theme]</span>
<h1>Memo 0016: Coq Verification of the Authorization TCB</h1>
<dl class="metadata">
  <dt>Date</dt><dd>January 2026 (2026-01-22T05:17:00Z)</dd>
  <dt>Author</dt><dd>Derrell Piper &lt;ddp@eludom.net&gt;</dd>
</dl>
<hr>
<section class="abstract">
<h2>Abstract</h2>
<p>This memo specifies the formal verification approach for the SPKI authorization Trusted Computing Base using the Coq proof assistant. We prove authorization correctness, not cryptographic hardness - libsodium handles the latter. The extraction pipeline generates OCaml code that is called from Scheme via FFI.</p>
</section>
<section>
<h2>Motivation</h2>
<p>The Prime Directive (Memo-0001):</p>
<blockquote>
<p>If it's in the TCB, it's in OCaml. Otherwise it's in Chicken Scheme.</p>
</blockquote>
<p>But even OCaml can have bugs. The TCB handles signature chain verification and authorization decisions. A single bug breaks everything.</p>
<p>Coq provides:</p>
<ul>
<li>Machine-checked proofs: Theorems verified by computer</li>
<li>Extraction: Generate OCaml from proofs</li>
<li>Correctness by construction: Implementation matches specification</li>
</ul>
<p>We prove the authorization logic correct; we trust libsodium for cryptographic primitives.</p>
</section>
<section>
<h2>Architecture</h2>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 630 500" width="630" height="500" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<line x1="5" y1="10" x2="10" y2="10"/>
<line x1="5" y1="10" x2="5" y2="21"/>
<line x1="10" y1="10" x2="20" y2="10"/>
<line x1="20" y1="10" x2="30" y2="10"/>
<line x1="30" y1="10" x2="40" y2="10"/>
<line x1="40" y1="10" x2="50" y2="10"/>
<line x1="50" y1="10" x2="60" y2="10"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="160" y2="10"/>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="180" y2="10"/>
<line x1="180" y1="10" x2="190" y2="10"/>
<line x1="190" y1="10" x2="200" y2="10"/>
<line x1="200" y1="10" x2="210" y2="10"/>
<line x1="210" y1="10" x2="220" y2="10"/>
<line x1="220" y1="10" x2="230" y2="10"/>
<line x1="230" y1="10" x2="240" y2="10"/>
<line x1="240" y1="10" x2="250" y2="10"/>
<line x1="250" y1="10" x2="260" y2="10"/>
<line x1="260" y1="10" x2="270" y2="10"/>
<line x1="270" y1="10" x2="280" y2="10"/>
<line x1="280" y1="10" x2="290" y2="10"/>
<line x1="290" y1="10" x2="300" y2="10"/>
<line x1="300" y1="10" x2="310" y2="10"/>
<line x1="310" y1="10" x2="320" y2="10"/>
<line x1="320" y1="10" x2="330" y2="10"/>
<line x1="330" y1="10" x2="340" y2="10"/>
<line x1="340" y1="10" x2="350" y2="10"/>
<line x1="350" y1="10" x2="360" y2="10"/>
<line x1="360" y1="10" x2="370" y2="10"/>
<line x1="370" y1="10" x2="380" y2="10"/>
<line x1="380" y1="10" x2="390" y2="10"/>
<line x1="390" y1="10" x2="400" y2="10"/>
<line x1="400" y1="10" x2="410" y2="10"/>
<line x1="410" y1="10" x2="420" y2="10"/>
<line x1="420" y1="10" x2="430" y2="10"/>
<line x1="430" y1="10" x2="440" y2="10"/>
<line x1="440" y1="10" x2="450" y2="10"/>
<line x1="450" y1="10" x2="460" y2="10"/>
<line x1="460" y1="10" x2="470" y2="10"/>
<line x1="470" y1="10" x2="480" y2="10"/>
<line x1="480" y1="10" x2="490" y2="10"/>
<line x1="490" y1="10" x2="500" y2="10"/>
<line x1="500" y1="10" x2="510" y2="10"/>
<line x1="510" y1="10" x2="520" y2="10"/>
<line x1="520" y1="10" x2="530" y2="10"/>
<line x1="530" y1="10" x2="540" y2="10"/>
<line x1="540" y1="10" x2="550" y2="10"/>
<line x1="550" y1="10" x2="560" y2="10"/>
<line x1="560" y1="10" x2="570" y2="10"/>
<line x1="570" y1="10" x2="580" y2="10"/>
<line x1="580" y1="10" x2="590" y2="10"/>
<line x1="590" y1="10" x2="600" y2="10"/>
<line x1="600" y1="10" x2="610" y2="10"/>
<line x1="610" y1="10" x2="620" y2="10"/>
<line x1="620" y1="10" x2="625" y2="10"/>
<line x1="625" y1="10" x2="625" y2="21"/>
<line x1="5" y1="19" x2="5" y2="41"/>
<text x="210" y="30">CYBERSPACE</text>
<text x="320" y="30">TCB</text>
<line x1="625" y1="19" x2="625" y2="41"/>
<line x1="5" y1="39" x2="5" y2="61"/>
<line x1="625" y1="39" x2="625" y2="61"/>
<line x1="5" y1="59" x2="5" y2="81"/>
<line x1="45" y1="70" x2="50" y2="70"/>
<line x1="45" y1="70" x2="45" y2="81"/>
<line x1="50" y1="70" x2="60" y2="70"/>
<line x1="60" y1="70" x2="70" y2="70"/>
<line x1="70" y1="70" x2="80" y2="70"/>
<line x1="80" y1="70" x2="90" y2="70"/>
<line x1="90" y1="70" x2="100" y2="70"/>
<line x1="100" y1="70" x2="110" y2="70"/>
<line x1="110" y1="70" x2="120" y2="70"/>
<line x1="120" y1="70" x2="130" y2="70"/>
<line x1="130" y1="70" x2="140" y2="70"/>
<line x1="140" y1="70" x2="150" y2="70"/>
<line x1="150" y1="70" x2="160" y2="70"/>
<line x1="160" y1="70" x2="170" y2="70"/>
<line x1="170" y1="70" x2="180" y2="70"/>
<line x1="180" y1="70" x2="190" y2="70"/>
<line x1="190" y1="70" x2="200" y2="70"/>
<line x1="200" y1="70" x2="210" y2="70"/>
<line x1="210" y1="70" x2="220" y2="70"/>
<line x1="220" y1="70" x2="230" y2="70"/>
<line x1="230" y1="70" x2="240" y2="70"/>
<line x1="240" y1="70" x2="250" y2="70"/>
<line x1="250" y1="70" x2="260" y2="70"/>
<line x1="260" y1="70" x2="270" y2="70"/>
<line x1="270" y1="70" x2="280" y2="70"/>
<line x1="280" y1="70" x2="290" y2="70"/>
<line x1="290" y1="70" x2="300" y2="70"/>
<line x1="300" y1="70" x2="310" y2="70"/>
<line x1="310" y1="70" x2="320" y2="70"/>
<line x1="320" y1="70" x2="330" y2="70"/>
<line x1="330" y1="70" x2="340" y2="70"/>
<line x1="340" y1="70" x2="350" y2="70"/>
<line x1="350" y1="70" x2="360" y2="70"/>
<line x1="360" y1="70" x2="370" y2="70"/>
<line x1="370" y1="70" x2="380" y2="70"/>
<line x1="380" y1="70" x2="390" y2="70"/>
<line x1="390" y1="70" x2="400" y2="70"/>
<line x1="400" y1="70" x2="410" y2="70"/>
<line x1="410" y1="70" x2="420" y2="70"/>
<line x1="420" y1="70" x2="430" y2="70"/>
<line x1="430" y1="70" x2="440" y2="70"/>
<line x1="440" y1="70" x2="450" y2="70"/>
<line x1="450" y1="70" x2="460" y2="70"/>
<line x1="460" y1="70" x2="470" y2="70"/>
<line x1="470" y1="70" x2="480" y2="70"/>
<line x1="480" y1="70" x2="490" y2="70"/>
<line x1="490" y1="70" x2="500" y2="70"/>
<line x1="500" y1="70" x2="510" y2="70"/>
<line x1="510" y1="70" x2="520" y2="70"/>
<line x1="520" y1="70" x2="530" y2="70"/>
<line x1="530" y1="70" x2="540" y2="70"/>
<line x1="540" y1="70" x2="550" y2="70"/>
<line x1="550" y1="70" x2="560" y2="70"/>
<line x1="560" y1="70" x2="570" y2="70"/>
<line x1="570" y1="70" x2="580" y2="70"/>
<line x1="580" y1="70" x2="585" y2="70"/>
<line x1="585" y1="70" x2="585" y2="81"/>
<line x1="625" y1="59" x2="625" y2="81"/>
<line x1="5" y1="79" x2="5" y2="101"/>
<line x1="45" y1="79" x2="45" y2="101"/>
<text x="190" y="90">SpkiTcb.v</text>
<text x="290" y="90">(Coq</text>
<text x="340" y="90">Proofs)</text>
<line x1="585" y1="79" x2="585" y2="101"/>
<line x1="625" y1="79" x2="625" y2="101"/>
<line x1="5" y1="99" x2="5" y2="121"/>
<line x1="45" y1="99" x2="45" y2="121"/>
<line x1="585" y1="99" x2="585" y2="121"/>
<line x1="625" y1="99" x2="625" y2="121"/>
<line x1="5" y1="119" x2="5" y2="141"/>
<line x1="45" y1="119" x2="45" y2="141"/>
<text x="70" y="130">Types:</text>
<text x="140" y="130">principal,</text>
<text x="250" y="130">tag,</text>
<text x="300" y="130">cert,</text>
<text x="360" y="130">auth_request</text>
<line x1="585" y1="119" x2="585" y2="141"/>
<line x1="625" y1="119" x2="625" y2="141"/>
<line x1="5" y1="139" x2="5" y2="161"/>
<line x1="45" y1="139" x2="45" y2="161"/>
<text x="70" y="150">Algorithms:</text>
<text x="190" y="150">tag_intersect,</text>
<text x="340" y="150">verify_chain,</text>
<text x="480" y="150">authorize</text>
<line x1="585" y1="139" x2="585" y2="161"/>
<line x1="625" y1="139" x2="625" y2="161"/>
<line x1="5" y1="159" x2="5" y2="181"/>
<line x1="45" y1="159" x2="45" y2="181"/>
<text x="70" y="170">Theorems:</text>
<text x="170" y="170">authorize_requester_match,</text>
<text x="440" y="170">etc.</text>
<line x1="585" y1="159" x2="585" y2="181"/>
<line x1="625" y1="159" x2="625" y2="181"/>
<line x1="5" y1="179" x2="5" y2="201"/>
<line x1="45" y1="190" x2="50" y2="190"/>
<line x1="45" y1="179" x2="45" y2="190"/>
<line x1="50" y1="190" x2="60" y2="190"/>
<line x1="60" y1="190" x2="70" y2="190"/>
<line x1="70" y1="190" x2="80" y2="190"/>
<line x1="80" y1="190" x2="90" y2="190"/>
<line x1="90" y1="190" x2="100" y2="190"/>
<line x1="100" y1="190" x2="110" y2="190"/>
<line x1="110" y1="190" x2="120" y2="190"/>
<line x1="120" y1="190" x2="130" y2="190"/>
<line x1="130" y1="190" x2="140" y2="190"/>
<line x1="140" y1="190" x2="150" y2="190"/>
<line x1="150" y1="190" x2="160" y2="190"/>
<line x1="160" y1="190" x2="170" y2="190"/>
<line x1="170" y1="190" x2="180" y2="190"/>
<line x1="180" y1="190" x2="190" y2="190"/>
<line x1="190" y1="190" x2="200" y2="190"/>
<line x1="200" y1="190" x2="210" y2="190"/>
<line x1="210" y1="190" x2="220" y2="190"/>
<line x1="220" y1="190" x2="230" y2="190"/>
<line x1="230" y1="190" x2="240" y2="190"/>
<line x1="240" y1="190" x2="250" y2="190"/>
<line x1="250" y1="190" x2="260" y2="190"/>
<line x1="260" y1="190" x2="270" y2="190"/>
<line x1="270" y1="190" x2="280" y2="190"/>
<line x1="275" y1="190" x2="275" y2="201"/>
<line x1="280" y1="190" x2="290" y2="190"/>
<line x1="290" y1="190" x2="300" y2="190"/>
<line x1="300" y1="190" x2="310" y2="190"/>
<line x1="310" y1="190" x2="320" y2="190"/>
<line x1="320" y1="190" x2="330" y2="190"/>
<line x1="330" y1="190" x2="340" y2="190"/>
<line x1="340" y1="190" x2="350" y2="190"/>
<line x1="350" y1="190" x2="360" y2="190"/>
<line x1="360" y1="190" x2="370" y2="190"/>
<line x1="370" y1="190" x2="380" y2="190"/>
<line x1="380" y1="190" x2="390" y2="190"/>
<line x1="390" y1="190" x2="400" y2="190"/>
<line x1="400" y1="190" x2="410" y2="190"/>
<line x1="410" y1="190" x2="420" y2="190"/>
<line x1="420" y1="190" x2="430" y2="190"/>
<line x1="430" y1="190" x2="440" y2="190"/>
<line x1="440" y1="190" x2="450" y2="190"/>
<line x1="450" y1="190" x2="460" y2="190"/>
<line x1="460" y1="190" x2="470" y2="190"/>
<line x1="470" y1="190" x2="480" y2="190"/>
<line x1="480" y1="190" x2="490" y2="190"/>
<line x1="490" y1="190" x2="500" y2="190"/>
<line x1="500" y1="190" x2="510" y2="190"/>
<line x1="510" y1="190" x2="520" y2="190"/>
<line x1="520" y1="190" x2="530" y2="190"/>
<line x1="530" y1="190" x2="540" y2="190"/>
<line x1="540" y1="190" x2="550" y2="190"/>
<line x1="550" y1="190" x2="560" y2="190"/>
<line x1="560" y1="190" x2="570" y2="190"/>
<line x1="570" y1="190" x2="580" y2="190"/>
<line x1="580" y1="190" x2="585" y2="190"/>
<line x1="585" y1="179" x2="585" y2="190"/>
<line x1="625" y1="179" x2="625" y2="201"/>
<line x1="5" y1="199" x2="5" y2="221"/>
<line x1="275" y1="199" x2="275" y2="221"/>
<text x="290" y="210">Extraction</text>
<line x1="625" y1="199" x2="625" y2="221"/>
<line x1="5" y1="219" x2="5" y2="241"/>
<line x1="45" y1="230" x2="50" y2="230"/>
<line x1="45" y1="230" x2="45" y2="241"/>
<line x1="50" y1="230" x2="60" y2="230"/>
<line x1="60" y1="230" x2="70" y2="230"/>
<line x1="70" y1="230" x2="80" y2="230"/>
<line x1="80" y1="230" x2="90" y2="230"/>
<line x1="90" y1="230" x2="100" y2="230"/>
<line x1="100" y1="230" x2="110" y2="230"/>
<line x1="110" y1="230" x2="120" y2="230"/>
<line x1="120" y1="230" x2="130" y2="230"/>
<line x1="130" y1="230" x2="140" y2="230"/>
<line x1="140" y1="230" x2="150" y2="230"/>
<line x1="150" y1="230" x2="160" y2="230"/>
<line x1="160" y1="230" x2="170" y2="230"/>
<line x1="170" y1="230" x2="180" y2="230"/>
<line x1="180" y1="230" x2="190" y2="230"/>
<line x1="190" y1="230" x2="200" y2="230"/>
<line x1="200" y1="230" x2="210" y2="230"/>
<line x1="210" y1="230" x2="220" y2="230"/>
<line x1="220" y1="230" x2="230" y2="230"/>
<line x1="230" y1="230" x2="240" y2="230"/>
<line x1="240" y1="230" x2="250" y2="230"/>
<line x1="250" y1="230" x2="260" y2="230"/>
<line x1="260" y1="230" x2="270" y2="230"/>
<line x1="280" y1="230" x2="290" y2="230"/>
<line x1="290" y1="230" x2="300" y2="230"/>
<line x1="300" y1="230" x2="310" y2="230"/>
<line x1="310" y1="230" x2="320" y2="230"/>
<line x1="320" y1="230" x2="330" y2="230"/>
<line x1="330" y1="230" x2="340" y2="230"/>
<line x1="340" y1="230" x2="350" y2="230"/>
<line x1="350" y1="230" x2="360" y2="230"/>
<line x1="360" y1="230" x2="370" y2="230"/>
<line x1="370" y1="230" x2="380" y2="230"/>
<line x1="380" y1="230" x2="390" y2="230"/>
<line x1="390" y1="230" x2="400" y2="230"/>
<line x1="400" y1="230" x2="410" y2="230"/>
<line x1="410" y1="230" x2="420" y2="230"/>
<line x1="420" y1="230" x2="430" y2="230"/>
<line x1="430" y1="230" x2="440" y2="230"/>
<line x1="440" y1="230" x2="450" y2="230"/>
<line x1="450" y1="230" x2="460" y2="230"/>
<line x1="460" y1="230" x2="470" y2="230"/>
<line x1="470" y1="230" x2="480" y2="230"/>
<line x1="480" y1="230" x2="490" y2="230"/>
<line x1="490" y1="230" x2="500" y2="230"/>
<line x1="500" y1="230" x2="510" y2="230"/>
<line x1="510" y1="230" x2="520" y2="230"/>
<line x1="520" y1="230" x2="530" y2="230"/>
<line x1="530" y1="230" x2="540" y2="230"/>
<line x1="540" y1="230" x2="550" y2="230"/>
<line x1="550" y1="230" x2="560" y2="230"/>
<line x1="560" y1="230" x2="570" y2="230"/>
<line x1="570" y1="230" x2="580" y2="230"/>
<line x1="580" y1="230" x2="585" y2="230"/>
<line x1="585" y1="230" x2="585" y2="241"/>
<line x1="625" y1="219" x2="625" y2="241"/>
<line x1="5" y1="239" x2="5" y2="261"/>
<line x1="45" y1="239" x2="45" y2="261"/>
<text x="140" y="250">spki_tcb_extracted.ml</text>
<text x="360" y="250">(generated)</text>
<line x1="585" y1="239" x2="585" y2="261"/>
<line x1="625" y1="239" x2="625" y2="261"/>
<line x1="5" y1="259" x2="5" y2="281"/>
<line x1="45" y1="270" x2="50" y2="270"/>
<line x1="45" y1="259" x2="45" y2="270"/>
<line x1="50" y1="270" x2="60" y2="270"/>
<line x1="60" y1="270" x2="70" y2="270"/>
<line x1="70" y1="270" x2="80" y2="270"/>
<line x1="80" y1="270" x2="90" y2="270"/>
<line x1="90" y1="270" x2="100" y2="270"/>
<line x1="100" y1="270" x2="110" y2="270"/>
<line x1="110" y1="270" x2="120" y2="270"/>
<line x1="120" y1="270" x2="130" y2="270"/>
<line x1="130" y1="270" x2="140" y2="270"/>
<line x1="140" y1="270" x2="150" y2="270"/>
<line x1="150" y1="270" x2="160" y2="270"/>
<line x1="160" y1="270" x2="170" y2="270"/>
<line x1="170" y1="270" x2="180" y2="270"/>
<line x1="180" y1="270" x2="190" y2="270"/>
<line x1="190" y1="270" x2="200" y2="270"/>
<line x1="200" y1="270" x2="210" y2="270"/>
<line x1="210" y1="270" x2="220" y2="270"/>
<line x1="220" y1="270" x2="230" y2="270"/>
<line x1="230" y1="270" x2="240" y2="270"/>
<line x1="240" y1="270" x2="250" y2="270"/>
<line x1="250" y1="270" x2="260" y2="270"/>
<line x1="260" y1="270" x2="270" y2="270"/>
<line x1="270" y1="270" x2="280" y2="270"/>
<line x1="275" y1="270" x2="275" y2="281"/>
<line x1="280" y1="270" x2="290" y2="270"/>
<line x1="290" y1="270" x2="300" y2="270"/>
<line x1="300" y1="270" x2="310" y2="270"/>
<line x1="310" y1="270" x2="320" y2="270"/>
<line x1="320" y1="270" x2="330" y2="270"/>
<line x1="330" y1="270" x2="340" y2="270"/>
<line x1="340" y1="270" x2="350" y2="270"/>
<line x1="350" y1="270" x2="360" y2="270"/>
<line x1="360" y1="270" x2="370" y2="270"/>
<line x1="370" y1="270" x2="380" y2="270"/>
<line x1="380" y1="270" x2="390" y2="270"/>
<line x1="390" y1="270" x2="400" y2="270"/>
<line x1="400" y1="270" x2="410" y2="270"/>
<line x1="410" y1="270" x2="420" y2="270"/>
<line x1="420" y1="270" x2="430" y2="270"/>
<line x1="430" y1="270" x2="440" y2="270"/>
<line x1="440" y1="270" x2="450" y2="270"/>
<line x1="450" y1="270" x2="460" y2="270"/>
<line x1="460" y1="270" x2="470" y2="270"/>
<line x1="470" y1="270" x2="480" y2="270"/>
<line x1="480" y1="270" x2="490" y2="270"/>
<line x1="490" y1="270" x2="500" y2="270"/>
<line x1="500" y1="270" x2="510" y2="270"/>
<line x1="510" y1="270" x2="520" y2="270"/>
<line x1="520" y1="270" x2="530" y2="270"/>
<line x1="530" y1="270" x2="540" y2="270"/>
<line x1="540" y1="270" x2="550" y2="270"/>
<line x1="550" y1="270" x2="560" y2="270"/>
<line x1="560" y1="270" x2="570" y2="270"/>
<line x1="570" y1="270" x2="580" y2="270"/>
<line x1="580" y1="270" x2="585" y2="270"/>
<line x1="585" y1="259" x2="585" y2="270"/>
<line x1="625" y1="259" x2="625" y2="281"/>
<line x1="5" y1="279" x2="5" y2="301"/>
<line x1="275" y1="279" x2="275" y2="301"/>
<text x="290" y="290">Bridge</text>
<line x1="625" y1="279" x2="625" y2="301"/>
<line x1="5" y1="299" x2="5" y2="321"/>
<line x1="45" y1="310" x2="50" y2="310"/>
<line x1="45" y1="310" x2="45" y2="321"/>
<line x1="50" y1="310" x2="60" y2="310"/>
<line x1="60" y1="310" x2="70" y2="310"/>
<line x1="70" y1="310" x2="80" y2="310"/>
<line x1="80" y1="310" x2="90" y2="310"/>
<line x1="90" y1="310" x2="100" y2="310"/>
<line x1="100" y1="310" x2="110" y2="310"/>
<line x1="110" y1="310" x2="120" y2="310"/>
<line x1="120" y1="310" x2="130" y2="310"/>
<line x1="130" y1="310" x2="140" y2="310"/>
<line x1="140" y1="310" x2="150" y2="310"/>
<line x1="150" y1="310" x2="160" y2="310"/>
<line x1="160" y1="310" x2="170" y2="310"/>
<line x1="170" y1="310" x2="180" y2="310"/>
<line x1="180" y1="310" x2="190" y2="310"/>
<line x1="190" y1="310" x2="200" y2="310"/>
<line x1="200" y1="310" x2="210" y2="310"/>
<line x1="210" y1="310" x2="220" y2="310"/>
<line x1="220" y1="310" x2="230" y2="310"/>
<line x1="230" y1="310" x2="240" y2="310"/>
<line x1="240" y1="310" x2="250" y2="310"/>
<line x1="250" y1="310" x2="260" y2="310"/>
<line x1="260" y1="310" x2="270" y2="310"/>
<line x1="280" y1="310" x2="290" y2="310"/>
<line x1="290" y1="310" x2="300" y2="310"/>
<line x1="300" y1="310" x2="310" y2="310"/>
<line x1="310" y1="310" x2="320" y2="310"/>
<line x1="320" y1="310" x2="330" y2="310"/>
<line x1="330" y1="310" x2="340" y2="310"/>
<line x1="340" y1="310" x2="350" y2="310"/>
<line x1="350" y1="310" x2="360" y2="310"/>
<line x1="360" y1="310" x2="370" y2="310"/>
<line x1="370" y1="310" x2="380" y2="310"/>
<line x1="380" y1="310" x2="390" y2="310"/>
<line x1="390" y1="310" x2="400" y2="310"/>
<line x1="400" y1="310" x2="410" y2="310"/>
<line x1="410" y1="310" x2="420" y2="310"/>
<line x1="420" y1="310" x2="430" y2="310"/>
<line x1="430" y1="310" x2="440" y2="310"/>
<line x1="440" y1="310" x2="450" y2="310"/>
<line x1="450" y1="310" x2="460" y2="310"/>
<line x1="460" y1="310" x2="470" y2="310"/>
<line x1="470" y1="310" x2="480" y2="310"/>
<line x1="480" y1="310" x2="490" y2="310"/>
<line x1="490" y1="310" x2="500" y2="310"/>
<line x1="500" y1="310" x2="510" y2="310"/>
<line x1="510" y1="310" x2="520" y2="310"/>
<line x1="520" y1="310" x2="530" y2="310"/>
<line x1="530" y1="310" x2="540" y2="310"/>
<line x1="540" y1="310" x2="550" y2="310"/>
<line x1="550" y1="310" x2="560" y2="310"/>
<line x1="560" y1="310" x2="570" y2="310"/>
<line x1="570" y1="310" x2="580" y2="310"/>
<line x1="580" y1="310" x2="585" y2="310"/>
<line x1="585" y1="310" x2="585" y2="321"/>
<line x1="625" y1="299" x2="625" y2="321"/>
<line x1="5" y1="319" x2="5" y2="341"/>
<line x1="45" y1="319" x2="45" y2="341"/>
<text x="190" y="330">spki_tcb.ml</text>
<text x="310" y="330">+</text>
<text x="330" y="330">tcb_stubs.c</text>
<line x1="585" y1="319" x2="585" y2="341"/>
<line x1="625" y1="319" x2="625" y2="341"/>
<line x1="5" y1="339" x2="5" y2="361"/>
<line x1="45" y1="339" x2="45" y2="361"/>
<text x="140" y="350">(bytes</text>
<text x="210" y="350">conversion,</text>
<text x="330" y="350">libsodium</text>
<text x="430" y="350">FFI)</text>
<line x1="585" y1="339" x2="585" y2="361"/>
<line x1="625" y1="339" x2="625" y2="361"/>
<line x1="5" y1="359" x2="5" y2="381"/>
<line x1="45" y1="370" x2="50" y2="370"/>
<line x1="45" y1="359" x2="45" y2="370"/>
<line x1="50" y1="370" x2="60" y2="370"/>
<line x1="60" y1="370" x2="70" y2="370"/>
<line x1="70" y1="370" x2="80" y2="370"/>
<line x1="80" y1="370" x2="90" y2="370"/>
<line x1="90" y1="370" x2="100" y2="370"/>
<line x1="100" y1="370" x2="110" y2="370"/>
<line x1="110" y1="370" x2="120" y2="370"/>
<line x1="120" y1="370" x2="130" y2="370"/>
<line x1="130" y1="370" x2="140" y2="370"/>
<line x1="140" y1="370" x2="150" y2="370"/>
<line x1="150" y1="370" x2="160" y2="370"/>
<line x1="160" y1="370" x2="170" y2="370"/>
<line x1="170" y1="370" x2="180" y2="370"/>
<line x1="180" y1="370" x2="190" y2="370"/>
<line x1="190" y1="370" x2="200" y2="370"/>
<line x1="200" y1="370" x2="210" y2="370"/>
<line x1="210" y1="370" x2="220" y2="370"/>
<line x1="220" y1="370" x2="230" y2="370"/>
<line x1="230" y1="370" x2="240" y2="370"/>
<line x1="240" y1="370" x2="250" y2="370"/>
<line x1="250" y1="370" x2="260" y2="370"/>
<line x1="260" y1="370" x2="270" y2="370"/>
<line x1="270" y1="370" x2="280" y2="370"/>
<line x1="275" y1="370" x2="275" y2="381"/>
<line x1="280" y1="370" x2="290" y2="370"/>
<line x1="290" y1="370" x2="300" y2="370"/>
<line x1="300" y1="370" x2="310" y2="370"/>
<line x1="310" y1="370" x2="320" y2="370"/>
<line x1="320" y1="370" x2="330" y2="370"/>
<line x1="330" y1="370" x2="340" y2="370"/>
<line x1="340" y1="370" x2="350" y2="370"/>
<line x1="350" y1="370" x2="360" y2="370"/>
<line x1="360" y1="370" x2="370" y2="370"/>
<line x1="370" y1="370" x2="380" y2="370"/>
<line x1="380" y1="370" x2="390" y2="370"/>
<line x1="390" y1="370" x2="400" y2="370"/>
<line x1="400" y1="370" x2="410" y2="370"/>
<line x1="410" y1="370" x2="420" y2="370"/>
<line x1="420" y1="370" x2="430" y2="370"/>
<line x1="430" y1="370" x2="440" y2="370"/>
<line x1="440" y1="370" x2="450" y2="370"/>
<line x1="450" y1="370" x2="460" y2="370"/>
<line x1="460" y1="370" x2="470" y2="370"/>
<line x1="470" y1="370" x2="480" y2="370"/>
<line x1="480" y1="370" x2="490" y2="370"/>
<line x1="490" y1="370" x2="500" y2="370"/>
<line x1="500" y1="370" x2="510" y2="370"/>
<line x1="510" y1="370" x2="520" y2="370"/>
<line x1="520" y1="370" x2="530" y2="370"/>
<line x1="530" y1="370" x2="540" y2="370"/>
<line x1="540" y1="370" x2="550" y2="370"/>
<line x1="550" y1="370" x2="560" y2="370"/>
<line x1="560" y1="370" x2="570" y2="370"/>
<line x1="570" y1="370" x2="580" y2="370"/>
<line x1="580" y1="370" x2="585" y2="370"/>
<line x1="585" y1="359" x2="585" y2="370"/>
<line x1="625" y1="359" x2="625" y2="381"/>
<line x1="5" y1="379" x2="5" y2="401"/>
<line x1="275" y1="379" x2="275" y2="401"/>
<line x1="625" y1="379" x2="625" y2="401"/>
<line x1="5" y1="399" x2="5" y2="421"/>
<line x1="205" y1="410" x2="210" y2="410"/>
<line x1="205" y1="410" x2="205" y2="421"/>
<line x1="210" y1="410" x2="220" y2="410"/>
<line x1="220" y1="410" x2="230" y2="410"/>
<line x1="230" y1="410" x2="240" y2="410"/>
<line x1="240" y1="410" x2="250" y2="410"/>
<line x1="250" y1="410" x2="260" y2="410"/>
<line x1="260" y1="410" x2="270" y2="410"/>
<line x1="280" y1="410" x2="290" y2="410"/>
<line x1="290" y1="410" x2="300" y2="410"/>
<line x1="300" y1="410" x2="310" y2="410"/>
<line x1="310" y1="410" x2="320" y2="410"/>
<line x1="320" y1="410" x2="330" y2="410"/>
<line x1="330" y1="410" x2="340" y2="410"/>
<line x1="340" y1="410" x2="345" y2="410"/>
<line x1="345" y1="410" x2="345" y2="421"/>
<line x1="625" y1="399" x2="625" y2="421"/>
<line x1="5" y1="419" x2="5" y2="441"/>
<line x1="205" y1="419" x2="205" y2="441"/>
<text x="230" y="430">libsodium</text>
<line x1="345" y1="419" x2="345" y2="441"/>
<line x1="625" y1="419" x2="625" y2="441"/>
<line x1="5" y1="439" x2="5" y2="461"/>
<line x1="205" y1="439" x2="205" y2="461"/>
<text x="230" y="450">(trusted)</text>
<line x1="345" y1="439" x2="345" y2="461"/>
<line x1="625" y1="439" x2="625" y2="461"/>
<line x1="5" y1="459" x2="5" y2="481"/>
<line x1="205" y1="470" x2="210" y2="470"/>
<line x1="205" y1="459" x2="205" y2="470"/>
<line x1="210" y1="470" x2="220" y2="470"/>
<line x1="220" y1="470" x2="230" y2="470"/>
<line x1="230" y1="470" x2="240" y2="470"/>
<line x1="240" y1="470" x2="250" y2="470"/>
<line x1="250" y1="470" x2="260" y2="470"/>
<line x1="260" y1="470" x2="270" y2="470"/>
<line x1="270" y1="470" x2="280" y2="470"/>
<line x1="280" y1="470" x2="290" y2="470"/>
<line x1="290" y1="470" x2="300" y2="470"/>
<line x1="300" y1="470" x2="310" y2="470"/>
<line x1="310" y1="470" x2="320" y2="470"/>
<line x1="320" y1="470" x2="330" y2="470"/>
<line x1="330" y1="470" x2="340" y2="470"/>
<line x1="340" y1="470" x2="345" y2="470"/>
<line x1="345" y1="459" x2="345" y2="470"/>
<line x1="625" y1="459" x2="625" y2="481"/>
<line x1="5" y1="490" x2="10" y2="490"/>
<line x1="5" y1="479" x2="5" y2="490"/>
<line x1="10" y1="490" x2="20" y2="490"/>
<line x1="20" y1="490" x2="30" y2="490"/>
<line x1="30" y1="490" x2="40" y2="490"/>
<line x1="40" y1="490" x2="50" y2="490"/>
<line x1="50" y1="490" x2="60" y2="490"/>
<line x1="60" y1="490" x2="70" y2="490"/>
<line x1="70" y1="490" x2="80" y2="490"/>
<line x1="80" y1="490" x2="90" y2="490"/>
<line x1="90" y1="490" x2="100" y2="490"/>
<line x1="100" y1="490" x2="110" y2="490"/>
<line x1="110" y1="490" x2="120" y2="490"/>
<line x1="120" y1="490" x2="130" y2="490"/>
<line x1="130" y1="490" x2="140" y2="490"/>
<line x1="140" y1="490" x2="150" y2="490"/>
<line x1="150" y1="490" x2="160" y2="490"/>
<line x1="160" y1="490" x2="170" y2="490"/>
<line x1="170" y1="490" x2="180" y2="490"/>
<line x1="180" y1="490" x2="190" y2="490"/>
<line x1="190" y1="490" x2="200" y2="490"/>
<line x1="200" y1="490" x2="210" y2="490"/>
<line x1="210" y1="490" x2="220" y2="490"/>
<line x1="220" y1="490" x2="230" y2="490"/>
<line x1="230" y1="490" x2="240" y2="490"/>
<line x1="240" y1="490" x2="250" y2="490"/>
<line x1="250" y1="490" x2="260" y2="490"/>
<line x1="260" y1="490" x2="270" y2="490"/>
<line x1="270" y1="490" x2="280" y2="490"/>
<line x1="280" y1="490" x2="290" y2="490"/>
<line x1="290" y1="490" x2="300" y2="490"/>
<line x1="300" y1="490" x2="310" y2="490"/>
<line x1="310" y1="490" x2="320" y2="490"/>
<line x1="320" y1="490" x2="330" y2="490"/>
<line x1="330" y1="490" x2="340" y2="490"/>
<line x1="340" y1="490" x2="350" y2="490"/>
<line x1="350" y1="490" x2="360" y2="490"/>
<line x1="360" y1="490" x2="370" y2="490"/>
<line x1="370" y1="490" x2="380" y2="490"/>
<line x1="380" y1="490" x2="390" y2="490"/>
<line x1="390" y1="490" x2="400" y2="490"/>
<line x1="400" y1="490" x2="410" y2="490"/>
<line x1="410" y1="490" x2="420" y2="490"/>
<line x1="420" y1="490" x2="430" y2="490"/>
<line x1="430" y1="490" x2="440" y2="490"/>
<line x1="440" y1="490" x2="450" y2="490"/>
<line x1="450" y1="490" x2="460" y2="490"/>
<line x1="460" y1="490" x2="470" y2="490"/>
<line x1="470" y1="490" x2="480" y2="490"/>
<line x1="480" y1="490" x2="490" y2="490"/>
<line x1="490" y1="490" x2="500" y2="490"/>
<line x1="500" y1="490" x2="510" y2="490"/>
<line x1="510" y1="490" x2="520" y2="490"/>
<line x1="520" y1="490" x2="530" y2="490"/>
<line x1="530" y1="490" x2="540" y2="490"/>
<line x1="540" y1="490" x2="550" y2="490"/>
<line x1="550" y1="490" x2="560" y2="490"/>
<line x1="560" y1="490" x2="570" y2="490"/>
<line x1="570" y1="490" x2="580" y2="490"/>
<line x1="580" y1="490" x2="590" y2="490"/>
<line x1="590" y1="490" x2="600" y2="490"/>
<line x1="600" y1="490" x2="610" y2="490"/>
<line x1="610" y1="490" x2="620" y2="490"/>
<line x1="620" y1="490" x2="625" y2="490"/>
<line x1="625" y1="479" x2="625" y2="490"/>
</svg>
</div>
<p>The extraction pipeline: SpkiTcb.v → spki_tcb_extracted.ml → OCaml library → Scheme FFI.</p>
</section>
<section>
<h2>What We Prove</h2>
<h3>Fully Proven Theorems</h3>
<p>Security-critical theorems with complete proofs (no admits):</p>
<table>
<tr><th>Theorem</th><th>Property</th></tr>
<tr><td>principal_equal_refl</td><td>Reflexivity: p = p</td></tr>
<tr><td>principal_equal_sym</td><td>Symmetry: p = q → q = p</td></tr>
<tr><td>principal_equal_trans</td><td>Transitivity: p = q ∧ q = r → p = r</td></tr>
<tr><td>authorize_requester_match</td><td>If authorized, requester is named by leaf cert</td></tr>
<tr><td>authorize_complete</td><td>All preconditions satisfied → authorization succeeds</td></tr>
</table>
<p>The authorize_requester_match theorem is the key security property: it guarantees that authorization only succeeds when the requester is actually named in the certificate chain.</p>
<h3>Partially Proven Theorems</h3>
<table>
<tr><th>Theorem</th><th>Proven Cases</th><th>Admitted Cases</th></tr>
<tr><td>tag_intersect_idemp</td><td>TagAll, TagSet, TagPrefix, TagRange</td><td>TagThreshold</td></tr>
<tr><td>tag_intersect_subset_left</td><td>Most combinations</td><td>TagPrefix recursive, TagThreshold</td></tr>
</table>
<p>The admitted cases stem from design limitations documented below.</p>
<h3>Partially Proven: tag_intersect_comm</h3>
<table>
<tr><th>Case</th><th>Status</th></tr>
<tr><td>TagAll</td><td>Proven</td></tr>
<tr><td>TagSet</td><td>Proven (via filter_intersect_comm lemma)</td></tr>
<tr><td>TagRange</td><td>Proven</td></tr>
<tr><td>TagPrefix</td><td>Admitted (recursive structure)</td></tr>
<tr><td>TagThreshold</td><td>Admitted (Cartesian product ordering)</td></tr>
</table>
<p>The TagSet case required proving that filter intersection produces the same elements regardless of operand order, then applying canonicalize_strings to ensure structural equality.</p>
<h3>Admitted Theorems</h3>
<table>
<tr><th>Theorem</th><th>Reason</th></tr>
<tr><td>verify_chain_sound</td><td>Complex induction over chain structure</td></tr>
<tr><td>verify_chain_attenuates</td><td>Depends on verify_chain_sound</td></tr>
</table>
<p>These are design debt, not security holes. The algorithms are correct; the proofs are incomplete.</p>
</section>
<section>
<h2>What We Assume</h2>
<p>Cryptographic operations are axiomatized - we trust libsodium:</p>
<pre>
Axiom sha512 : bytes -&gt; bytes.
Axiom ed25519_verify : bytes -&gt; bytes -&gt; bytes -&gt; bool.
</pre>
<p>Trust assumptions:</p>
<ul>
<li>libsodium correctness: Ed25519, SHA-512 implementations</li>
<li>OCaml runtime: Extraction target executes correctly</li>
<li>Hardware: CPU executes instructions correctly</li>
</ul>
</section>
<section>
<h2>Design Limitations</h2>
<h3>TagSet Canonical Ordering</h3>
<p>Tag intersection commutativity requires canonical representation:</p>
<pre>
(tag_intersect (TagSet ["read" "write"]) (TagSet ["write" "read"]))
;; Result order depends on input order without canonicalization
</pre>
<p>Solution implemented: sort and deduplicate TagSet contents. The canonicalize_canonical lemma bridges structural and semantic equality.</p>
<h3>TagThreshold Cartesian Product</h3>
<p>Intersection of thresholds produces Cartesian product of subtags:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 650 40" width="650" height="40" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">(tag_intersect</text>
<text x="150" y="10">(TagThreshold</text>
<text x="290" y="10">2</text>
<text x="310" y="10">[A</text>
<text x="340" y="10">B</text>
<text x="360" y="10">C])</text>
<text x="400" y="10">(TagThreshold</text>
<text x="540" y="10">2</text>
<text x="560" y="10">[A</text>
<text x="590" y="10">B</text>
<text x="610" y="10">C]))</text>
<text x="0" y="30">;;</text>
<text x="30" y="30">Produces</text>
<text x="120" y="30">9</text>
<text x="140" y="30">subtags:</text>
<text x="230" y="30">[A∩A,</text>
<text x="290" y="30">A∩B,</text>
<text x="340" y="30">A∩C,</text>
<text x="390" y="30">B∩A,</text>
<text x="440" y="30">B∩B,</text>
<text x="490" y="30">...]</text>
</svg>
</div>
<p>This is semantically correct but not structurally idempotent. Options:</p>
<ul>
<li>Require disjoint subtags</li>
<li>Normalize after intersection</li>
<li>Accept semantic rather than structural idempotence</li>
</ul>
</section>
<section>
<h2>Extraction Pipeline</h2>
<p>Build and extract:</p>
<pre>
cd tcb/coq
coqc SpkiTcb.v              # Type-check proofs, extract OCaml
dune build                   # Compile extracted + bridge code
</pre>
<p>The extraction directive:</p>
<pre>
Extraction Language OCaml.
Extraction "spki_tcb_extracted.ml"
  authorize verify_chain tag_intersect principal_equal ...
</pre>
<p>The bridge module (spki_tcb.ml) converts between Coq's int list representation and OCaml's native bytes, calling libsodium for cryptographic operations.</p>
</section>
<section>
<h2>Test Coverage</h2>
<table>
<tr><th>Suite</th><th>Tests</th><th>Coverage</th></tr>
<tr><td>test_extracted.ml</td><td>16</td><td>Unit tests: principals, tags, chains</td></tr>
<tr><td>test_properties.ml</td><td>11</td><td>Property-based: QCheck random testing</td></tr>
<tr><td>test_tcb.exe</td><td>62</td><td>Full TCB: crypto, cookies, audit, FIPS-181</td></tr>
</table>
<p>All tests pass. The property-based tests validate Coq theorems at runtime:</p>
<table>
<tr><th>Property</th><th>Generator Constraints</th></tr>
<tr><td>principal_equal reflexive/symmetric/transitive</td><td>Random principals</td></tr>
<tr><td>tag_intersect commutative</td><td>Non-threshold tags only</td></tr>
<tr><td>tag_intersect idempotent</td><td>Non-threshold, non-empty TagSets</td></tr>
<tr><td>tag_intersect TagAll identity</td><td>All tag types</td></tr>
<tr><td>tag_subset reflexive</td><td>Non-threshold tags only</td></tr>
<tr><td>TagRange subset containment</td><td>Random ranges</td></tr>
</table>
<p>TagThreshold is excluded from commutativity/idempotence tests due to documented structural limitations (Cartesian product ordering).</p>
</section>
<section>
<h2>Future Work</h2>
<ul>
<li>Complete tag_intersect_comm for TagPrefix (recursive induction)</li>
<li>Prove verify_chain_sound with custom induction principle</li>
<li>Consider CompCert or Fiat-Crypto for deeper verification</li>
</ul>
<p>Current proof coverage is sufficient for beta. The admitted theorems are proof obligations, not security vulnerabilities.</p>
</section>
<section>
<h2>References</h2>
<ul class="references">
<li><strong>Coq (2024)</strong>: The Coq Proof Assistant. https://coq.inria.fr/</li>
<li><strong>SPKI (1999)</strong>: RFC 2693: SPKI Certificate Theory</li>
<li><strong>Memo-045 (2026)</strong>: Security Architecture</li>
<li><strong>libsodium (2024)</strong>: https://libsodium.org/</li>
</ul>
</section>
<footer>
<p class="sig">— ddp, 2026-01-22</p>
</footer>
<script>
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
}
(function() {
  // Query param override (for REPL: ?theme=dark or ?theme=light)
  const params = new URLSearchParams(window.location.search);
  const param = params.get('theme');
  if (param === 'dark' || param === 'light') {
    document.documentElement.setAttribute('data-theme', param);
    localStorage.setItem('theme', param);
    return;
  }
  // localStorage preference
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
  } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', 'light');
  }
})();
</script>
</body>
</html>
