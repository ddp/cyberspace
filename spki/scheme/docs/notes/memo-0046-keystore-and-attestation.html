<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <title>Memo 0046: Realm Keystore and Attestation</title>
  <link rel="icon" id="favicon" href="data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27%230f0%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>">
  <script>
(function(){
  var h=new Date().getHours(),c;
  if(h>=4&&h<6)c='%23845EC2';       // brahma muhurta - violet
  else if(h>=6&&h<8)c='%23ffd700';  // dawn - gold
  else if(h>=8&&h<11)c='%2300d4aa'; // morning - teal
  else if(h>=11&&h<14)c='%230f0';   // midday - phosphor
  else if(h>=14&&h<17)c='%2339ff14';// afternoon - neon
  else if(h>=17&&h<19)c='%23ff6600';// sunset - orange
  else if(h>=19&&h<22)c='%23ff3366';// evening - coral
  else c='%2300ffff';               // night - cyan
  document.getElementById('favicon').href='data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27'+c+'%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>';
})();
</script>
  <link rel="stylesheet" href="memo.css">
</head>
<body>
<span class="theme-toggle" onclick="toggleTheme()" title="Toggle light/dark">[theme]</span>
<h1>Memo 0046: Realm Keystore and Attestation</h1>
<dl class="metadata">
</dl>
<hr>
<section>
<h2>Abstract</h2>
<p>A realm without identity is not sovereign. This Memo defines two protected stores within the vault:</p>
<ul>
<li>Keystore - where cryptographic identity lives (Ed25519 signing keys)</li>
<li>Attestation Store - where proofs about the realm live (hardware, software, identity claims)</li>
</ul>
<p>Together they form the inner vault - the protected core of a realm. Keys prove who you are. Attestations prove what you are.</p>
</section>
<section>
<h2>Motivation</h2>
<p>Memo-040 established that capabilities flow from Ed25519 signatures. Every certificate, every sealed release, every audit entry requires a signature. But where does the signing key live?</p>
<p>Currently: ephemeral, generated per session. This is fine for testing but broken for production. A realm needs:</p>
<ul>
<li>Persistent identity - the same principal across sessions</li>
<li>Protected storage - keys encrypted at rest</li>
<li>Recovery path - don't lose your realm to a forgotten passphrase</li>
<li>Rotation support - keys age, compromise happens</li>
</ul>
<p>A realm without persistent identity cannot accumulate trust, cannot be referenced by peers, and loses all context on restart. The keystore provides the cryptographic continuity that makes realm sovereignty meaningful.</p>
</section>
<section>
<h2>Realm Continuity</h2>
<p>A realm is not a snapshot. It accumulates.</p>
<p>Identity continuity - Your principal persists across sessions, machines, years. Key rotation creates a signed chain: each new key vouched for by the old. The chain IS your history.</p>
<p>Context accumulation - Every capability granted, every object stored, every federation established - these form the realm's memory. The audit chain records what happened. The attestation store proves what you were at each moment.</p>
<p>History matters - A realm that has existed for ten years, rotated keys three times, accumulated thousands of attestations, federated with hundreds of peers - this realm has weight. Trust accrues. Reputation emerges from the chain.</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 680 220" width="680" height="220" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<line x1="5" y1="10" x2="10" y2="10"/>
<line x1="5" y1="10" x2="5" y2="21"/>
<line x1="10" y1="10" x2="20" y2="10"/>
<line x1="20" y1="10" x2="30" y2="10"/>
<line x1="30" y1="10" x2="40" y2="10"/>
<line x1="40" y1="10" x2="50" y2="10"/>
<line x1="50" y1="10" x2="60" y2="10"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="160" y2="10"/>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="180" y2="10"/>
<line x1="180" y1="10" x2="190" y2="10"/>
<line x1="190" y1="10" x2="200" y2="10"/>
<line x1="200" y1="10" x2="210" y2="10"/>
<line x1="210" y1="10" x2="220" y2="10"/>
<line x1="220" y1="10" x2="230" y2="10"/>
<line x1="230" y1="10" x2="240" y2="10"/>
<line x1="240" y1="10" x2="250" y2="10"/>
<line x1="250" y1="10" x2="260" y2="10"/>
<line x1="260" y1="10" x2="270" y2="10"/>
<line x1="270" y1="10" x2="280" y2="10"/>
<line x1="280" y1="10" x2="290" y2="10"/>
<line x1="290" y1="10" x2="300" y2="10"/>
<line x1="300" y1="10" x2="310" y2="10"/>
<line x1="310" y1="10" x2="320" y2="10"/>
<line x1="320" y1="10" x2="330" y2="10"/>
<line x1="330" y1="10" x2="340" y2="10"/>
<line x1="340" y1="10" x2="350" y2="10"/>
<line x1="350" y1="10" x2="360" y2="10"/>
<line x1="360" y1="10" x2="370" y2="10"/>
<line x1="370" y1="10" x2="380" y2="10"/>
<line x1="380" y1="10" x2="390" y2="10"/>
<line x1="390" y1="10" x2="400" y2="10"/>
<line x1="400" y1="10" x2="410" y2="10"/>
<line x1="410" y1="10" x2="420" y2="10"/>
<line x1="420" y1="10" x2="430" y2="10"/>
<line x1="430" y1="10" x2="440" y2="10"/>
<line x1="440" y1="10" x2="450" y2="10"/>
<line x1="450" y1="10" x2="460" y2="10"/>
<line x1="460" y1="10" x2="470" y2="10"/>
<line x1="470" y1="10" x2="480" y2="10"/>
<line x1="480" y1="10" x2="490" y2="10"/>
<line x1="490" y1="10" x2="500" y2="10"/>
<line x1="500" y1="10" x2="510" y2="10"/>
<line x1="510" y1="10" x2="520" y2="10"/>
<line x1="520" y1="10" x2="530" y2="10"/>
<line x1="530" y1="10" x2="540" y2="10"/>
<line x1="540" y1="10" x2="550" y2="10"/>
<line x1="550" y1="10" x2="560" y2="10"/>
<line x1="560" y1="10" x2="570" y2="10"/>
<line x1="570" y1="10" x2="580" y2="10"/>
<line x1="580" y1="10" x2="590" y2="10"/>
<line x1="590" y1="10" x2="600" y2="10"/>
<line x1="600" y1="10" x2="610" y2="10"/>
<line x1="610" y1="10" x2="620" y2="10"/>
<line x1="620" y1="10" x2="630" y2="10"/>
<line x1="630" y1="10" x2="640" y2="10"/>
<line x1="640" y1="10" x2="650" y2="10"/>
<line x1="650" y1="10" x2="660" y2="10"/>
<line x1="670" y1="10" x2="675" y2="10"/>
<line x1="675" y1="10" x2="675" y2="21"/>
<line x1="5" y1="19" x2="5" y2="41"/>
<text x="250" y="30">REALM</text>
<text x="310" y="30">TIMELINE</text>
<line x1="675" y1="19" x2="675" y2="41"/>
<line x1="5" y1="39" x2="5" y2="61"/>
<line x1="5" y1="50" x2="10" y2="50"/>
<line x1="10" y1="50" x2="20" y2="50"/>
<line x1="20" y1="50" x2="30" y2="50"/>
<line x1="30" y1="50" x2="40" y2="50"/>
<line x1="40" y1="50" x2="50" y2="50"/>
<line x1="50" y1="50" x2="60" y2="50"/>
<line x1="60" y1="50" x2="70" y2="50"/>
<line x1="70" y1="50" x2="80" y2="50"/>
<line x1="80" y1="50" x2="90" y2="50"/>
<line x1="90" y1="50" x2="100" y2="50"/>
<line x1="100" y1="50" x2="110" y2="50"/>
<line x1="110" y1="50" x2="120" y2="50"/>
<line x1="120" y1="50" x2="130" y2="50"/>
<line x1="130" y1="50" x2="140" y2="50"/>
<line x1="140" y1="50" x2="150" y2="50"/>
<line x1="150" y1="50" x2="160" y2="50"/>
<line x1="160" y1="50" x2="170" y2="50"/>
<line x1="170" y1="50" x2="180" y2="50"/>
<line x1="180" y1="50" x2="190" y2="50"/>
<line x1="190" y1="50" x2="200" y2="50"/>
<line x1="200" y1="50" x2="210" y2="50"/>
<line x1="210" y1="50" x2="220" y2="50"/>
<line x1="220" y1="50" x2="230" y2="50"/>
<line x1="230" y1="50" x2="240" y2="50"/>
<line x1="240" y1="50" x2="250" y2="50"/>
<line x1="250" y1="50" x2="260" y2="50"/>
<line x1="260" y1="50" x2="270" y2="50"/>
<line x1="270" y1="50" x2="280" y2="50"/>
<line x1="280" y1="50" x2="290" y2="50"/>
<line x1="290" y1="50" x2="300" y2="50"/>
<line x1="300" y1="50" x2="310" y2="50"/>
<line x1="310" y1="50" x2="320" y2="50"/>
<line x1="320" y1="50" x2="330" y2="50"/>
<line x1="330" y1="50" x2="340" y2="50"/>
<line x1="340" y1="50" x2="350" y2="50"/>
<line x1="350" y1="50" x2="360" y2="50"/>
<line x1="360" y1="50" x2="370" y2="50"/>
<line x1="370" y1="50" x2="380" y2="50"/>
<line x1="380" y1="50" x2="390" y2="50"/>
<line x1="390" y1="50" x2="400" y2="50"/>
<line x1="400" y1="50" x2="410" y2="50"/>
<line x1="410" y1="50" x2="420" y2="50"/>
<line x1="420" y1="50" x2="430" y2="50"/>
<line x1="430" y1="50" x2="440" y2="50"/>
<line x1="440" y1="50" x2="450" y2="50"/>
<line x1="450" y1="50" x2="460" y2="50"/>
<line x1="460" y1="50" x2="470" y2="50"/>
<line x1="470" y1="50" x2="480" y2="50"/>
<line x1="480" y1="50" x2="490" y2="50"/>
<line x1="490" y1="50" x2="500" y2="50"/>
<line x1="500" y1="50" x2="510" y2="50"/>
<line x1="510" y1="50" x2="520" y2="50"/>
<line x1="520" y1="50" x2="530" y2="50"/>
<line x1="530" y1="50" x2="540" y2="50"/>
<line x1="540" y1="50" x2="550" y2="50"/>
<line x1="550" y1="50" x2="560" y2="50"/>
<line x1="560" y1="50" x2="570" y2="50"/>
<line x1="570" y1="50" x2="580" y2="50"/>
<line x1="580" y1="50" x2="590" y2="50"/>
<line x1="590" y1="50" x2="600" y2="50"/>
<line x1="600" y1="50" x2="610" y2="50"/>
<line x1="610" y1="50" x2="620" y2="50"/>
<line x1="620" y1="50" x2="630" y2="50"/>
<line x1="630" y1="50" x2="640" y2="50"/>
<line x1="640" y1="50" x2="650" y2="50"/>
<line x1="650" y1="50" x2="660" y2="50"/>
<line x1="675" y1="39" x2="675" y2="61"/>
<line x1="670" y1="50" x2="675" y2="50"/>
<line x1="5" y1="59" x2="5" y2="81"/>
<line x1="675" y1="59" x2="675" y2="81"/>
<line x1="5" y1="79" x2="5" y2="101"/>
<text x="30" y="90">Genesis</text>
<line x1="110" y1="90" x2="120" y2="90"/>
<line x1="120" y1="90" x2="130" y2="90"/>
<text x="150" y="90">Key₁</text>
<line x1="200" y1="90" x2="210" y2="90"/>
<line x1="210" y1="90" x2="220" y2="90"/>
<text x="240" y="90">Key₂</text>
<line x1="290" y1="90" x2="300" y2="90"/>
<line x1="300" y1="90" x2="310" y2="90"/>
<text x="330" y="90">Key₃</text>
<line x1="380" y1="90" x2="390" y2="90"/>
<line x1="390" y1="90" x2="400" y2="90"/>
<text x="420" y="90">...</text>
<line x1="460" y1="90" x2="470" y2="90"/>
<line x1="470" y1="90" x2="480" y2="90"/>
<text x="500" y="90">Current</text>
<line x1="675" y1="79" x2="675" y2="101"/>
<line x1="5" y1="99" x2="5" y2="121"/>
<line x1="65" y1="99" x2="65" y2="121"/>
<line x1="175" y1="99" x2="175" y2="121"/>
<line x1="265" y1="99" x2="265" y2="121"/>
<line x1="355" y1="99" x2="355" y2="121"/>
<line x1="555" y1="99" x2="555" y2="121"/>
<line x1="675" y1="99" x2="675" y2="121"/>
<line x1="5" y1="119" x2="5" y2="141"/>
<line x1="675" y1="119" x2="675" y2="141"/>
<line x1="5" y1="139" x2="5" y2="161"/>
<text x="30" y="150">[att₀]</text>
<text x="130" y="150">[att₁₋₁₀]</text>
<text x="230" y="150">[att₁₁₋₅₀]</text>
<text x="340" y="150">[att₅₁₋₁₀₀]</text>
<text x="490" y="150">[att_n]</text>
<line x1="675" y1="139" x2="675" y2="161"/>
<line x1="5" y1="159" x2="5" y2="181"/>
<line x1="675" y1="159" x2="675" y2="181"/>
<line x1="5" y1="179" x2="5" y2="201"/>
<text x="30" y="190">Context</text>
<text x="110" y="190">grows.</text>
<text x="180" y="190">History</text>
<text x="260" y="190">deepens.</text>
<text x="350" y="190">Trust</text>
<text x="410" y="190">accumulates.</text>
<line x1="675" y1="179" x2="675" y2="201"/>
<line x1="5" y1="210" x2="10" y2="210"/>
<line x1="5" y1="199" x2="5" y2="210"/>
<line x1="10" y1="210" x2="20" y2="210"/>
<line x1="20" y1="210" x2="30" y2="210"/>
<line x1="30" y1="210" x2="40" y2="210"/>
<line x1="40" y1="210" x2="50" y2="210"/>
<line x1="50" y1="210" x2="60" y2="210"/>
<line x1="60" y1="210" x2="70" y2="210"/>
<line x1="70" y1="210" x2="80" y2="210"/>
<line x1="80" y1="210" x2="90" y2="210"/>
<line x1="90" y1="210" x2="100" y2="210"/>
<line x1="100" y1="210" x2="110" y2="210"/>
<line x1="110" y1="210" x2="120" y2="210"/>
<line x1="120" y1="210" x2="130" y2="210"/>
<line x1="130" y1="210" x2="140" y2="210"/>
<line x1="140" y1="210" x2="150" y2="210"/>
<line x1="150" y1="210" x2="160" y2="210"/>
<line x1="160" y1="210" x2="170" y2="210"/>
<line x1="170" y1="210" x2="180" y2="210"/>
<line x1="180" y1="210" x2="190" y2="210"/>
<line x1="190" y1="210" x2="200" y2="210"/>
<line x1="200" y1="210" x2="210" y2="210"/>
<line x1="210" y1="210" x2="220" y2="210"/>
<line x1="220" y1="210" x2="230" y2="210"/>
<line x1="230" y1="210" x2="240" y2="210"/>
<line x1="240" y1="210" x2="250" y2="210"/>
<line x1="250" y1="210" x2="260" y2="210"/>
<line x1="260" y1="210" x2="270" y2="210"/>
<line x1="270" y1="210" x2="280" y2="210"/>
<line x1="280" y1="210" x2="290" y2="210"/>
<line x1="290" y1="210" x2="300" y2="210"/>
<line x1="300" y1="210" x2="310" y2="210"/>
<line x1="310" y1="210" x2="320" y2="210"/>
<line x1="320" y1="210" x2="330" y2="210"/>
<line x1="330" y1="210" x2="340" y2="210"/>
<line x1="340" y1="210" x2="350" y2="210"/>
<line x1="350" y1="210" x2="360" y2="210"/>
<line x1="360" y1="210" x2="370" y2="210"/>
<line x1="370" y1="210" x2="380" y2="210"/>
<line x1="380" y1="210" x2="390" y2="210"/>
<line x1="390" y1="210" x2="400" y2="210"/>
<line x1="400" y1="210" x2="410" y2="210"/>
<line x1="410" y1="210" x2="420" y2="210"/>
<line x1="420" y1="210" x2="430" y2="210"/>
<line x1="430" y1="210" x2="440" y2="210"/>
<line x1="440" y1="210" x2="450" y2="210"/>
<line x1="450" y1="210" x2="460" y2="210"/>
<line x1="460" y1="210" x2="470" y2="210"/>
<line x1="470" y1="210" x2="480" y2="210"/>
<line x1="480" y1="210" x2="490" y2="210"/>
<line x1="490" y1="210" x2="500" y2="210"/>
<line x1="500" y1="210" x2="510" y2="210"/>
<line x1="510" y1="210" x2="520" y2="210"/>
<line x1="520" y1="210" x2="530" y2="210"/>
<line x1="530" y1="210" x2="540" y2="210"/>
<line x1="540" y1="210" x2="550" y2="210"/>
<line x1="550" y1="210" x2="560" y2="210"/>
<line x1="560" y1="210" x2="570" y2="210"/>
<line x1="570" y1="210" x2="580" y2="210"/>
<line x1="580" y1="210" x2="590" y2="210"/>
<line x1="590" y1="210" x2="600" y2="210"/>
<line x1="600" y1="210" x2="610" y2="210"/>
<line x1="610" y1="210" x2="620" y2="210"/>
<line x1="620" y1="210" x2="630" y2="210"/>
<line x1="630" y1="210" x2="640" y2="210"/>
<line x1="640" y1="210" x2="650" y2="210"/>
<line x1="650" y1="210" x2="660" y2="210"/>
<line x1="670" y1="210" x2="675" y2="210"/>
<line x1="675" y1="199" x2="675" y2="210"/>
</svg>
</div>
<p>The inner vault preserves this continuity: - Keystore - the chain of identity - Attestations - the record of what you were - Audit - the log of what you did</p>
<p>A realm without history is newborn. A realm with history has standing.</p>
<h3>The Sealed Closure</h3>
<p>A realm is a sealed closure - it closes over its environment and that closure is cryptographically bound.</p>
<pre class="language-scheme">
;; The realm as closure
(lambda (request)
  ;; Closed over:
  ;;   - genesis: the first key, the origin moment
  ;;   - keychain: every rotation, signed by predecessor
  ;;   - attestations: every proof of what we were
  ;;   - audit: every action taken
  ;;   - capabilities: every right we hold
  ;;   - objects: every thing we store
  ;;
  ;; The closure is sealed:
  ;;   - Hash-chained: tamper-evident
  ;;   - Signed: non-repudiable
  ;;   - Content-addressed: self-verifying
  ;;
  (verify-and-respond request))
</pre>
<p>You cannot forge a realm. You cannot inject false history. You cannot claim attestations you don't have. The closure is sealed at every point - verify any moment, the chain holds or it doesn't.</p>
<p>Import a realm? You import the entire closure - genesis to present.</p>
<p>Fork a realm? You create a new closure that references the old. The fork point is signed.</p>
<p>Merge realms? The histories must be compatible. Conflicts are visible.</p>
<p>The sealed closure is the unit of trust in cyberspace.</p>
<h3>Living in the Soup</h3>
<p>The sealed closure doesn't exist in a vacuum - it lives in the soup.</p>
<p>The soup is the medium. Objects float in it - content-addressed, immutable, queryable. The realm swims through the soup, accumulating objects, granting capabilities, leaving audit trails. Everything the realm touches becomes part of its context.</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 680 260" width="680" height="260" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<line x1="5" y1="10" x2="10" y2="10"/>
<line x1="5" y1="10" x2="5" y2="21"/>
<line x1="10" y1="10" x2="20" y2="10"/>
<line x1="20" y1="10" x2="30" y2="10"/>
<line x1="30" y1="10" x2="40" y2="10"/>
<line x1="40" y1="10" x2="50" y2="10"/>
<line x1="50" y1="10" x2="60" y2="10"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="160" y2="10"/>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="180" y2="10"/>
<line x1="180" y1="10" x2="190" y2="10"/>
<line x1="190" y1="10" x2="200" y2="10"/>
<line x1="200" y1="10" x2="210" y2="10"/>
<line x1="210" y1="10" x2="220" y2="10"/>
<line x1="220" y1="10" x2="230" y2="10"/>
<line x1="230" y1="10" x2="240" y2="10"/>
<line x1="240" y1="10" x2="250" y2="10"/>
<line x1="250" y1="10" x2="260" y2="10"/>
<line x1="260" y1="10" x2="270" y2="10"/>
<line x1="270" y1="10" x2="280" y2="10"/>
<line x1="280" y1="10" x2="290" y2="10"/>
<line x1="290" y1="10" x2="300" y2="10"/>
<line x1="300" y1="10" x2="310" y2="10"/>
<line x1="310" y1="10" x2="320" y2="10"/>
<line x1="320" y1="10" x2="330" y2="10"/>
<line x1="330" y1="10" x2="340" y2="10"/>
<line x1="340" y1="10" x2="350" y2="10"/>
<line x1="350" y1="10" x2="360" y2="10"/>
<line x1="360" y1="10" x2="370" y2="10"/>
<line x1="370" y1="10" x2="380" y2="10"/>
<line x1="380" y1="10" x2="390" y2="10"/>
<line x1="390" y1="10" x2="400" y2="10"/>
<line x1="400" y1="10" x2="410" y2="10"/>
<line x1="410" y1="10" x2="420" y2="10"/>
<line x1="420" y1="10" x2="430" y2="10"/>
<line x1="430" y1="10" x2="440" y2="10"/>
<line x1="440" y1="10" x2="450" y2="10"/>
<line x1="450" y1="10" x2="460" y2="10"/>
<line x1="460" y1="10" x2="470" y2="10"/>
<line x1="470" y1="10" x2="480" y2="10"/>
<line x1="480" y1="10" x2="490" y2="10"/>
<line x1="490" y1="10" x2="500" y2="10"/>
<line x1="500" y1="10" x2="510" y2="10"/>
<line x1="510" y1="10" x2="520" y2="10"/>
<line x1="520" y1="10" x2="530" y2="10"/>
<line x1="530" y1="10" x2="540" y2="10"/>
<line x1="540" y1="10" x2="550" y2="10"/>
<line x1="550" y1="10" x2="560" y2="10"/>
<line x1="560" y1="10" x2="570" y2="10"/>
<line x1="570" y1="10" x2="580" y2="10"/>
<line x1="580" y1="10" x2="590" y2="10"/>
<line x1="590" y1="10" x2="600" y2="10"/>
<line x1="600" y1="10" x2="610" y2="10"/>
<line x1="610" y1="10" x2="620" y2="10"/>
<line x1="620" y1="10" x2="630" y2="10"/>
<line x1="630" y1="10" x2="640" y2="10"/>
<line x1="640" y1="10" x2="650" y2="10"/>
<line x1="650" y1="10" x2="660" y2="10"/>
<line x1="670" y1="10" x2="675" y2="10"/>
<line x1="675" y1="10" x2="675" y2="21"/>
<line x1="5" y1="19" x2="5" y2="41"/>
<text x="270" y="30">THE</text>
<text x="310" y="30">SOUP</text>
<line x1="675" y1="19" x2="675" y2="41"/>
<line x1="5" y1="39" x2="5" y2="61"/>
<line x1="675" y1="39" x2="675" y2="61"/>
<line x1="5" y1="59" x2="5" y2="81"/>
<text x="60" y="70">○</text>
<text x="80" y="70">obj</text>
<text x="150" y="70">○</text>
<text x="170" y="70">obj</text>
<line x1="275" y1="70" x2="280" y2="70"/>
<line x1="275" y1="70" x2="275" y2="81"/>
<line x1="280" y1="70" x2="290" y2="70"/>
<line x1="290" y1="70" x2="300" y2="70"/>
<line x1="300" y1="70" x2="310" y2="70"/>
<line x1="310" y1="70" x2="320" y2="70"/>
<line x1="320" y1="70" x2="330" y2="70"/>
<line x1="330" y1="70" x2="340" y2="70"/>
<line x1="340" y1="70" x2="350" y2="70"/>
<line x1="350" y1="70" x2="360" y2="70"/>
<line x1="360" y1="70" x2="370" y2="70"/>
<line x1="370" y1="70" x2="380" y2="70"/>
<line x1="380" y1="70" x2="390" y2="70"/>
<line x1="390" y1="70" x2="400" y2="70"/>
<line x1="400" y1="70" x2="410" y2="70"/>
<line x1="410" y1="70" x2="420" y2="70"/>
<line x1="420" y1="70" x2="430" y2="70"/>
<line x1="430" y1="70" x2="440" y2="70"/>
<line x1="440" y1="70" x2="450" y2="70"/>
<line x1="450" y1="70" x2="455" y2="70"/>
<line x1="455" y1="70" x2="455" y2="81"/>
<text x="520" y="70">○</text>
<text x="540" y="70">obj</text>
<line x1="675" y1="59" x2="675" y2="81"/>
<line x1="5" y1="79" x2="5" y2="101"/>
<text x="110" y="90">○</text>
<text x="130" y="90">obj</text>
<line x1="275" y1="79" x2="275" y2="101"/>
<line x1="455" y1="79" x2="455" y2="101"/>
<text x="570" y="90">○</text>
<text x="590" y="90">obj</text>
<line x1="675" y1="79" x2="675" y2="101"/>
<line x1="5" y1="99" x2="5" y2="121"/>
<text x="50" y="110">○</text>
<text x="70" y="110">obj</text>
<text x="200" y="110">○</text>
<text x="220" y="110">obj</text>
<line x1="275" y1="99" x2="275" y2="121"/>
<text x="330" y="110">REALM</text>
<line x1="455" y1="99" x2="455" y2="121"/>
<text x="500" y="110">○</text>
<text x="520" y="110">obj</text>
<line x1="675" y1="99" x2="675" y2="121"/>
<line x1="5" y1="119" x2="5" y2="141"/>
<text x="100" y="130">○</text>
<text x="120" y="130">obj</text>
<line x1="275" y1="119" x2="275" y2="141"/>
<text x="320" y="130">(island)</text>
<line x1="455" y1="119" x2="455" y2="141"/>
<text x="550" y="130">○</text>
<text x="570" y="130">obj</text>
<line x1="675" y1="119" x2="675" y2="141"/>
<line x1="5" y1="139" x2="5" y2="161"/>
<text x="40" y="150">○</text>
<text x="60" y="150">obj</text>
<text x="160" y="150">○</text>
<text x="180" y="150">obj</text>
<line x1="275" y1="139" x2="275" y2="161"/>
<line x1="455" y1="139" x2="455" y2="161"/>
<text x="480" y="150">○</text>
<text x="500" y="150">obj</text>
<line x1="675" y1="139" x2="675" y2="161"/>
<line x1="5" y1="159" x2="5" y2="181"/>
<text x="90" y="170">○</text>
<text x="110" y="170">obj</text>
<line x1="275" y1="170" x2="280" y2="170"/>
<line x1="275" y1="159" x2="275" y2="170"/>
<line x1="280" y1="170" x2="290" y2="170"/>
<line x1="290" y1="170" x2="300" y2="170"/>
<line x1="300" y1="170" x2="310" y2="170"/>
<line x1="310" y1="170" x2="320" y2="170"/>
<line x1="320" y1="170" x2="330" y2="170"/>
<line x1="330" y1="170" x2="340" y2="170"/>
<line x1="340" y1="170" x2="350" y2="170"/>
<line x1="350" y1="170" x2="360" y2="170"/>
<line x1="360" y1="170" x2="370" y2="170"/>
<line x1="370" y1="170" x2="380" y2="170"/>
<line x1="380" y1="170" x2="390" y2="170"/>
<line x1="390" y1="170" x2="400" y2="170"/>
<line x1="400" y1="170" x2="410" y2="170"/>
<line x1="410" y1="170" x2="420" y2="170"/>
<line x1="420" y1="170" x2="430" y2="170"/>
<line x1="430" y1="170" x2="440" y2="170"/>
<line x1="440" y1="170" x2="450" y2="170"/>
<line x1="450" y1="170" x2="455" y2="170"/>
<line x1="455" y1="159" x2="455" y2="170"/>
<text x="530" y="170">○</text>
<text x="550" y="170">obj</text>
<line x1="675" y1="159" x2="675" y2="181"/>
<line x1="5" y1="179" x2="5" y2="201"/>
<text x="40" y="190">○</text>
<text x="60" y="190">obj</text>
<text x="130" y="190">○</text>
<text x="150" y="190">obj</text>
<text x="230" y="190">○</text>
<text x="250" y="190">obj</text>
<text x="390" y="190">○</text>
<text x="410" y="190">obj</text>
<text x="480" y="190">○</text>
<text x="500" y="190">obj</text>
<line x1="675" y1="179" x2="675" y2="201"/>
<line x1="5" y1="199" x2="5" y2="221"/>
<line x1="675" y1="199" x2="675" y2="221"/>
<line x1="5" y1="219" x2="5" y2="241"/>
<text x="40" y="230">Objects</text>
<text x="120" y="230">float.</text>
<text x="190" y="230">The</text>
<text x="230" y="230">realm</text>
<text x="290" y="230">is</text>
<text x="320" y="230">sovereign</text>
<text x="420" y="230">territory.</text>
<line x1="675" y1="219" x2="675" y2="241"/>
<line x1="5" y1="250" x2="10" y2="250"/>
<line x1="5" y1="239" x2="5" y2="250"/>
<line x1="10" y1="250" x2="20" y2="250"/>
<line x1="20" y1="250" x2="30" y2="250"/>
<line x1="30" y1="250" x2="40" y2="250"/>
<line x1="40" y1="250" x2="50" y2="250"/>
<line x1="50" y1="250" x2="60" y2="250"/>
<line x1="60" y1="250" x2="70" y2="250"/>
<line x1="70" y1="250" x2="80" y2="250"/>
<line x1="80" y1="250" x2="90" y2="250"/>
<line x1="90" y1="250" x2="100" y2="250"/>
<line x1="100" y1="250" x2="110" y2="250"/>
<line x1="110" y1="250" x2="120" y2="250"/>
<line x1="120" y1="250" x2="130" y2="250"/>
<line x1="130" y1="250" x2="140" y2="250"/>
<line x1="140" y1="250" x2="150" y2="250"/>
<line x1="150" y1="250" x2="160" y2="250"/>
<line x1="160" y1="250" x2="170" y2="250"/>
<line x1="170" y1="250" x2="180" y2="250"/>
<line x1="180" y1="250" x2="190" y2="250"/>
<line x1="190" y1="250" x2="200" y2="250"/>
<line x1="200" y1="250" x2="210" y2="250"/>
<line x1="210" y1="250" x2="220" y2="250"/>
<line x1="220" y1="250" x2="230" y2="250"/>
<line x1="230" y1="250" x2="240" y2="250"/>
<line x1="240" y1="250" x2="250" y2="250"/>
<line x1="250" y1="250" x2="260" y2="250"/>
<line x1="260" y1="250" x2="270" y2="250"/>
<line x1="270" y1="250" x2="280" y2="250"/>
<line x1="280" y1="250" x2="290" y2="250"/>
<line x1="290" y1="250" x2="300" y2="250"/>
<line x1="300" y1="250" x2="310" y2="250"/>
<line x1="310" y1="250" x2="320" y2="250"/>
<line x1="320" y1="250" x2="330" y2="250"/>
<line x1="330" y1="250" x2="340" y2="250"/>
<line x1="340" y1="250" x2="350" y2="250"/>
<line x1="350" y1="250" x2="360" y2="250"/>
<line x1="360" y1="250" x2="370" y2="250"/>
<line x1="370" y1="250" x2="380" y2="250"/>
<line x1="380" y1="250" x2="390" y2="250"/>
<line x1="390" y1="250" x2="400" y2="250"/>
<line x1="400" y1="250" x2="410" y2="250"/>
<line x1="410" y1="250" x2="420" y2="250"/>
<line x1="420" y1="250" x2="430" y2="250"/>
<line x1="430" y1="250" x2="440" y2="250"/>
<line x1="440" y1="250" x2="450" y2="250"/>
<line x1="450" y1="250" x2="460" y2="250"/>
<line x1="460" y1="250" x2="470" y2="250"/>
<line x1="470" y1="250" x2="480" y2="250"/>
<line x1="480" y1="250" x2="490" y2="250"/>
<line x1="490" y1="250" x2="500" y2="250"/>
<line x1="500" y1="250" x2="510" y2="250"/>
<line x1="510" y1="250" x2="520" y2="250"/>
<line x1="520" y1="250" x2="530" y2="250"/>
<line x1="530" y1="250" x2="540" y2="250"/>
<line x1="540" y1="250" x2="550" y2="250"/>
<line x1="550" y1="250" x2="560" y2="250"/>
<line x1="560" y1="250" x2="570" y2="250"/>
<line x1="570" y1="250" x2="580" y2="250"/>
<line x1="580" y1="250" x2="590" y2="250"/>
<line x1="590" y1="250" x2="600" y2="250"/>
<line x1="600" y1="250" x2="610" y2="250"/>
<line x1="610" y1="250" x2="620" y2="250"/>
<line x1="620" y1="250" x2="630" y2="250"/>
<line x1="630" y1="250" x2="640" y2="250"/>
<line x1="640" y1="250" x2="650" y2="250"/>
<line x1="650" y1="250" x2="660" y2="250"/>
<line x1="670" y1="250" x2="675" y2="250"/>
<line x1="675" y1="239" x2="675" y2="250"/>
</svg>
</div>
<p>The realm is an island in the soup - an enclave of sovereignty, an instance you can address. Objects float past, currents of content flow through cyberspace, but the island is bounded. Its shores are defined by capabilities: what it can see, what it can grant, what attests to it.</p>
<p>Every realm has coordinates: its principal. ed25519:7f3a2b4c... isn't just an identifier - it's a place you can teleport to. Present the right capability, and you're there. The soup connects all islands; the principal is your destination.</p>
<p>Or send an agent.</p>
<p>You needn't go yourself. Delegate a capability to an agent - a subprocess, a daemon, a trusted emissary - and it travels on your behalf. The agent carries your authority (attenuated, scoped, time-limited) and acts in the soup. It visits realms, fetches objects, negotiates federation. When it returns, its audit trail merges with yours.</p>
<pre class="language-scheme">
(delegate-agent
  (parent "ed25519:your-realm...")
  (agent "ed25519:agent-key...")
  (capabilities
    (read "sha512:*")              ; Can read any object
    (federate "ed25519:peer..."))  ; Can negotiate with this peer
  (valid (not-after 1736500000))   ; Expires in 24h
  (sandbox                          ; Constraints
    (no-propagate)                  ; Cannot delegate further
    (audit-required)))              ; Must return audit chain
</pre>
<p>The agent is a sealed closure too - spawned from yours, carrying delegated authority, accumulating its own history. When the mission ends, the histories merge or the agent is revoked.</p>
<p>Lineage:</p>
<p>Go yourself - like telnet or VMS SET HOST. You're there, synchronous, your session on that node. Direct presence in another realm.</p>
<p>Send an agent - like General Magic's Magic Cap and Telescript. Autonomous travelers carrying your intent, visiting places, doing work, returning with results. But recast in the spirit of Newton - agents swim in the soup, query objects, accumulate context. The soup is their medium, capabilities their passport.</p>
<p>The soup is a wilderness of mirrors. Objects reference objects. Hashes point to hashes. Capabilities chain through delegation. Attestations vouch for attestations. An agent navigating the soup sees reflections within reflections - content-addressed identity means every object is its own mirror. The agent must hold the thread of its capability chain or be lost in infinite regress.</p>
<p>This is not a safe place. It's cyberspace.</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 570 300" width="570" height="300" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<line x1="5" y1="10" x2="10" y2="10"/>
<line x1="5" y1="10" x2="5" y2="21"/>
<line x1="10" y1="10" x2="20" y2="10"/>
<line x1="20" y1="10" x2="30" y2="10"/>
<line x1="30" y1="10" x2="40" y2="10"/>
<line x1="40" y1="10" x2="50" y2="10"/>
<line x1="50" y1="10" x2="60" y2="10"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="160" y2="10"/>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="175" y2="10"/>
<line x1="175" y1="10" x2="175" y2="21"/>
<line x1="385" y1="10" x2="390" y2="10"/>
<line x1="385" y1="10" x2="385" y2="21"/>
<line x1="390" y1="10" x2="400" y2="10"/>
<line x1="400" y1="10" x2="410" y2="10"/>
<line x1="410" y1="10" x2="420" y2="10"/>
<line x1="420" y1="10" x2="430" y2="10"/>
<line x1="430" y1="10" x2="440" y2="10"/>
<line x1="440" y1="10" x2="450" y2="10"/>
<line x1="450" y1="10" x2="460" y2="10"/>
<line x1="460" y1="10" x2="470" y2="10"/>
<line x1="470" y1="10" x2="480" y2="10"/>
<line x1="480" y1="10" x2="490" y2="10"/>
<line x1="490" y1="10" x2="500" y2="10"/>
<line x1="500" y1="10" x2="510" y2="10"/>
<line x1="510" y1="10" x2="520" y2="10"/>
<line x1="520" y1="10" x2="530" y2="10"/>
<line x1="530" y1="10" x2="540" y2="10"/>
<line x1="540" y1="10" x2="550" y2="10"/>
<line x1="560" y1="10" x2="565" y2="10"/>
<line x1="565" y1="10" x2="565" y2="21"/>
<line x1="5" y1="19" x2="5" y2="41"/>
<text x="40" y="30">YOUR</text>
<text x="90" y="30">REALM</text>
<line x1="175" y1="19" x2="175" y2="41"/>
<line x1="385" y1="19" x2="385" y2="41"/>
<text x="420" y="30">PEER</text>
<text x="470" y="30">REALM</text>
<line x1="565" y1="19" x2="565" y2="41"/>
<line x1="5" y1="39" x2="5" y2="61"/>
<line x1="175" y1="39" x2="175" y2="61"/>
<line x1="385" y1="39" x2="385" y2="61"/>
<line x1="565" y1="39" x2="565" y2="61"/>
<line x1="5" y1="59" x2="5" y2="81"/>
<line x1="35" y1="70" x2="40" y2="70"/>
<line x1="35" y1="70" x2="35" y2="81"/>
<line x1="40" y1="70" x2="50" y2="70"/>
<line x1="50" y1="70" x2="60" y2="70"/>
<line x1="60" y1="70" x2="70" y2="70"/>
<line x1="70" y1="70" x2="80" y2="70"/>
<line x1="80" y1="70" x2="90" y2="70"/>
<line x1="90" y1="70" x2="100" y2="70"/>
<line x1="100" y1="70" x2="110" y2="70"/>
<line x1="110" y1="70" x2="120" y2="70"/>
<line x1="120" y1="70" x2="130" y2="70"/>
<line x1="130" y1="70" x2="140" y2="70"/>
<line x1="140" y1="70" x2="145" y2="70"/>
<line x1="145" y1="70" x2="145" y2="81"/>
<line x1="175" y1="59" x2="175" y2="81"/>
<text x="220" y="70">SET</text>
<text x="260" y="70">HOST</text>
<text x="310" y="70">/</text>
<line x1="385" y1="59" x2="385" y2="81"/>
<line x1="415" y1="70" x2="420" y2="70"/>
<line x1="415" y1="70" x2="415" y2="81"/>
<line x1="420" y1="70" x2="430" y2="70"/>
<line x1="430" y1="70" x2="440" y2="70"/>
<line x1="440" y1="70" x2="450" y2="70"/>
<line x1="450" y1="70" x2="460" y2="70"/>
<line x1="460" y1="70" x2="470" y2="70"/>
<line x1="470" y1="70" x2="480" y2="70"/>
<line x1="480" y1="70" x2="490" y2="70"/>
<line x1="490" y1="70" x2="500" y2="70"/>
<line x1="500" y1="70" x2="510" y2="70"/>
<line x1="510" y1="70" x2="520" y2="70"/>
<line x1="520" y1="70" x2="525" y2="70"/>
<line x1="525" y1="70" x2="525" y2="81"/>
<line x1="565" y1="59" x2="565" y2="81"/>
<line x1="5" y1="79" x2="5" y2="101"/>
<line x1="35" y1="79" x2="35" y2="101"/>
<text x="70" y="90">you</text>
<line x1="145" y1="79" x2="145" y2="101"/>
<line x1="405" y1="79" x2="405" y2="101"/>
<text x="440" y="90">you</text>
<line x1="515" y1="79" x2="515" y2="101"/>
<line x1="565" y1="79" x2="565" y2="101"/>
<line x1="5" y1="99" x2="5" y2="121"/>
<line x1="35" y1="110" x2="40" y2="110"/>
<line x1="35" y1="99" x2="35" y2="110"/>
<line x1="40" y1="110" x2="50" y2="110"/>
<line x1="50" y1="110" x2="60" y2="110"/>
<line x1="60" y1="110" x2="70" y2="110"/>
<line x1="70" y1="110" x2="80" y2="110"/>
<line x1="80" y1="110" x2="90" y2="110"/>
<line x1="90" y1="110" x2="100" y2="110"/>
<line x1="100" y1="110" x2="110" y2="110"/>
<line x1="110" y1="110" x2="120" y2="110"/>
<line x1="120" y1="110" x2="130" y2="110"/>
<line x1="130" y1="110" x2="140" y2="110"/>
<line x1="140" y1="110" x2="145" y2="110"/>
<line x1="145" y1="99" x2="145" y2="110"/>
<line x1="175" y1="99" x2="175" y2="121"/>
<text x="220" y="110">telnet</text>
<line x1="395" y1="99" x2="395" y2="121"/>
<line x1="425" y1="110" x2="430" y2="110"/>
<line x1="425" y1="99" x2="425" y2="110"/>
<line x1="430" y1="110" x2="440" y2="110"/>
<line x1="440" y1="110" x2="450" y2="110"/>
<line x1="450" y1="110" x2="460" y2="110"/>
<line x1="460" y1="110" x2="470" y2="110"/>
<line x1="470" y1="110" x2="480" y2="110"/>
<line x1="480" y1="110" x2="490" y2="110"/>
<line x1="490" y1="110" x2="500" y2="110"/>
<line x1="500" y1="110" x2="510" y2="110"/>
<line x1="510" y1="110" x2="520" y2="110"/>
<line x1="520" y1="110" x2="530" y2="110"/>
<line x1="530" y1="110" x2="535" y2="110"/>
<line x1="535" y1="99" x2="535" y2="110"/>
<line x1="565" y1="99" x2="565" y2="121"/>
<line x1="5" y1="119" x2="5" y2="141"/>
<line x1="175" y1="119" x2="175" y2="141"/>
<line x1="385" y1="119" x2="385" y2="141"/>
<line x1="565" y1="119" x2="565" y2="141"/>
<line x1="5" y1="139" x2="5" y2="161"/>
<line x1="35" y1="150" x2="40" y2="150"/>
<line x1="35" y1="150" x2="35" y2="161"/>
<line x1="40" y1="150" x2="50" y2="150"/>
<line x1="50" y1="150" x2="60" y2="150"/>
<line x1="60" y1="150" x2="70" y2="150"/>
<line x1="70" y1="150" x2="80" y2="150"/>
<line x1="80" y1="150" x2="90" y2="150"/>
<line x1="90" y1="150" x2="100" y2="150"/>
<line x1="100" y1="150" x2="110" y2="150"/>
<line x1="110" y1="150" x2="120" y2="150"/>
<line x1="120" y1="150" x2="130" y2="150"/>
<line x1="130" y1="150" x2="140" y2="150"/>
<line x1="140" y1="150" x2="145" y2="150"/>
<line x1="145" y1="150" x2="145" y2="161"/>
<line x1="175" y1="139" x2="175" y2="161"/>
<text x="220" y="150">delegate</text>
<line x1="385" y1="139" x2="385" y2="161"/>
<line x1="415" y1="150" x2="420" y2="150"/>
<line x1="415" y1="150" x2="415" y2="161"/>
<line x1="420" y1="150" x2="430" y2="150"/>
<line x1="430" y1="150" x2="440" y2="150"/>
<line x1="440" y1="150" x2="450" y2="150"/>
<line x1="450" y1="150" x2="460" y2="150"/>
<line x1="460" y1="150" x2="470" y2="150"/>
<line x1="470" y1="150" x2="480" y2="150"/>
<line x1="480" y1="150" x2="490" y2="150"/>
<line x1="490" y1="150" x2="500" y2="150"/>
<line x1="500" y1="150" x2="510" y2="150"/>
<line x1="510" y1="150" x2="520" y2="150"/>
<line x1="520" y1="150" x2="525" y2="150"/>
<line x1="525" y1="150" x2="525" y2="161"/>
<line x1="565" y1="139" x2="565" y2="161"/>
<line x1="5" y1="159" x2="5" y2="181"/>
<line x1="35" y1="159" x2="35" y2="181"/>
<text x="60" y="170">agent</text>
<line x1="145" y1="159" x2="145" y2="181"/>
<line x1="405" y1="159" x2="405" y2="181"/>
<text x="430" y="170">agent</text>
<line x1="515" y1="159" x2="515" y2="181"/>
<line x1="565" y1="159" x2="565" y2="181"/>
<line x1="5" y1="179" x2="5" y2="201"/>
<line x1="35" y1="190" x2="40" y2="190"/>
<line x1="35" y1="179" x2="35" y2="190"/>
<line x1="40" y1="190" x2="50" y2="190"/>
<line x1="50" y1="190" x2="60" y2="190"/>
<line x1="60" y1="190" x2="70" y2="190"/>
<line x1="70" y1="190" x2="80" y2="190"/>
<line x1="80" y1="190" x2="90" y2="190"/>
<line x1="90" y1="190" x2="100" y2="190"/>
<line x1="100" y1="190" x2="110" y2="190"/>
<line x1="110" y1="190" x2="120" y2="190"/>
<line x1="120" y1="190" x2="130" y2="190"/>
<line x1="130" y1="190" x2="140" y2="190"/>
<line x1="140" y1="190" x2="145" y2="190"/>
<line x1="145" y1="179" x2="145" y2="190"/>
<line x1="175" y1="179" x2="175" y2="201"/>
<text x="220" y="190">(Magic</text>
<text x="290" y="190">Cap)</text>
<line x1="395" y1="179" x2="395" y2="201"/>
<line x1="425" y1="190" x2="430" y2="190"/>
<line x1="425" y1="179" x2="425" y2="190"/>
<line x1="430" y1="190" x2="440" y2="190"/>
<line x1="440" y1="190" x2="450" y2="190"/>
<line x1="450" y1="190" x2="460" y2="190"/>
<line x1="460" y1="190" x2="470" y2="190"/>
<line x1="470" y1="190" x2="480" y2="190"/>
<line x1="480" y1="190" x2="490" y2="190"/>
<line x1="490" y1="190" x2="500" y2="190"/>
<line x1="500" y1="190" x2="510" y2="190"/>
<line x1="510" y1="190" x2="520" y2="190"/>
<line x1="520" y1="190" x2="530" y2="190"/>
<line x1="530" y1="190" x2="535" y2="190"/>
<line x1="535" y1="179" x2="535" y2="190"/>
<line x1="565" y1="179" x2="565" y2="201"/>
<line x1="5" y1="199" x2="5" y2="221"/>
<line x1="175" y1="199" x2="175" y2="221"/>
<line x1="385" y1="199" x2="385" y2="221"/>
<line x1="565" y1="199" x2="565" y2="221"/>
<line x1="5" y1="230" x2="10" y2="230"/>
<line x1="5" y1="219" x2="5" y2="230"/>
<line x1="10" y1="230" x2="20" y2="230"/>
<line x1="20" y1="230" x2="30" y2="230"/>
<line x1="30" y1="230" x2="40" y2="230"/>
<line x1="40" y1="230" x2="50" y2="230"/>
<line x1="50" y1="230" x2="60" y2="230"/>
<line x1="60" y1="230" x2="70" y2="230"/>
<line x1="70" y1="230" x2="80" y2="230"/>
<line x1="80" y1="230" x2="90" y2="230"/>
<line x1="90" y1="230" x2="100" y2="230"/>
<line x1="100" y1="230" x2="110" y2="230"/>
<line x1="110" y1="230" x2="120" y2="230"/>
<line x1="120" y1="230" x2="130" y2="230"/>
<line x1="130" y1="230" x2="140" y2="230"/>
<line x1="140" y1="230" x2="150" y2="230"/>
<line x1="150" y1="230" x2="160" y2="230"/>
<line x1="160" y1="230" x2="170" y2="230"/>
<line x1="170" y1="230" x2="175" y2="230"/>
<line x1="175" y1="219" x2="175" y2="230"/>
<line x1="385" y1="230" x2="390" y2="230"/>
<line x1="385" y1="219" x2="385" y2="230"/>
<line x1="390" y1="230" x2="400" y2="230"/>
<line x1="400" y1="230" x2="410" y2="230"/>
<line x1="410" y1="230" x2="420" y2="230"/>
<line x1="420" y1="230" x2="430" y2="230"/>
<line x1="430" y1="230" x2="440" y2="230"/>
<line x1="440" y1="230" x2="450" y2="230"/>
<line x1="450" y1="230" x2="460" y2="230"/>
<line x1="460" y1="230" x2="470" y2="230"/>
<line x1="470" y1="230" x2="480" y2="230"/>
<line x1="480" y1="230" x2="490" y2="230"/>
<line x1="490" y1="230" x2="500" y2="230"/>
<line x1="500" y1="230" x2="510" y2="230"/>
<line x1="510" y1="230" x2="520" y2="230"/>
<line x1="520" y1="230" x2="530" y2="230"/>
<line x1="530" y1="230" x2="540" y2="230"/>
<line x1="540" y1="230" x2="550" y2="230"/>
<line x1="560" y1="230" x2="565" y2="230"/>
<line x1="565" y1="219" x2="565" y2="230"/>
<text x="200" y="270">THE</text>
<text x="240" y="270">SOUP</text>
<text x="170" y="290">(Newton's</text>
<text x="270" y="290">medium)</text>
</svg>
</div>
<p>Objects have no access control - they're just content, identified by hash. The realm closure holds the capabilities that give meaning: "I can read this," "I granted that," "This attests to me."</p>
<p>The soup is shared. Islands may be near or far. Federation is building bridges between islands - agreeing to share objects, honor capabilities, witness each other's audit chains.</p>
<h3>Addressing Objects</h3>
<p>Objects in cyberspace have coordinates:</p>
<pre class="language-scheme">
;; Local (this realm)
"releases/1.0.3"                    ; By path
"sha512:abc123..."                  ; By hash

;; Remote (another realm) - @ syntax
"@ed25519:7f3a2b.../releases/1.0.3"     ; Named object at realm
"@ed25519:7f3a2b.../sha512:abc123..."   ; Hash-addressed at realm

;; With role context - @principal+role:/path
"@ed25519:7f3a2b...+curator:/collections/rare-books"
"@ed25519:7f3a2b...+guardian:/vault/keys"
"@ed25519:7f3a2b...+witness:/audit/signatures"

;; With explicit capabilities - @principal+{caps}:/path
"@ed25519:7f3a2b...+{read}:/objects/sha512:abc..."
"@ed25519:7f3a2b...+{read,write}:/collections/working"
"@ed25519:7f3a2b...+{read,delegate(read)}:/shared/docs"

;; Role with capability refinement
"@ed25519:7f3a2b...+curator{read}:/collections/rare-books"  ; curator, read only

;; Inspect remote sealed object
(soup-inspect "@ed25519:7f3a2b.../releases/1.0.3")

;; Fetch requires capability
(soup-fetch "@ed25519:7f3a2b.../sha512:abc123..."
  capability: my-read-cert)

;; Fetch with role context
(soup-fetch "@ed25519:7f3a2b...+curator:/collections/rare-books"
  capability: my-curator-cert)
</pre>
<p>The @principal:/path syntax reads: "at this realm, this object." The principal is your teleport destination. The path or hash is what you're looking for.</p>
<p>The @principal+role:/path syntax adds role context: "at this realm, acting as this role, this object."</p>
<p>The @principal+{caps}:/path syntax specifies explicit capabilities: "at this realm, with these specific capabilities, this object." Roles are shorthand for capability bundles; the +{caps} form is the truth underneath.</p>
<p>+role{caps} combines both: use this role, but only these capabilities from it. Principle of least authority - request only what you need.</p>
<p>Without a capability granting access, you can see the object exists (if the realm publishes its bloom filter) but cannot fetch its contents. The wilderness of mirrors shows reflections - but you need the right key to step through.</p>
</section>
<section>
<h2>Architecture</h2>
<h3>The Inner Vault</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 690 460" width="690" height="460" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">.vault/</text>
<line x1="5" y1="19" x2="5" y2="41"/>
<line x1="5" y1="30" x2="10" y2="30"/>
<line x1="10" y1="30" x2="20" y2="30"/>
<line x1="20" y1="30" x2="30" y2="30"/>
<text x="40" y="30">keystore/</text>
<text x="330" y="30">#</text>
<text x="350" y="30">Identity</text>
<text x="440" y="30">store</text>
<line x1="5" y1="39" x2="5" y2="61"/>
<line x1="45" y1="39" x2="45" y2="61"/>
<line x1="45" y1="50" x2="50" y2="50"/>
<line x1="50" y1="50" x2="60" y2="50"/>
<line x1="60" y1="50" x2="70" y2="50"/>
<text x="80" y="50">realm.key</text>
<text x="320" y="50">#</text>
<text x="340" y="50">Encrypted</text>
<text x="440" y="50">private</text>
<text x="520" y="50">key</text>
<line x1="5" y1="59" x2="5" y2="81"/>
<line x1="45" y1="59" x2="45" y2="81"/>
<line x1="45" y1="70" x2="50" y2="70"/>
<line x1="50" y1="70" x2="60" y2="70"/>
<line x1="60" y1="70" x2="70" y2="70"/>
<text x="80" y="70">realm.pub</text>
<text x="320" y="70">#</text>
<text x="340" y="70">Public</text>
<text x="410" y="70">key</text>
<text x="450" y="70">(this</text>
<text x="510" y="70">is</text>
<text x="540" y="70">your</text>
<text x="590" y="70">principal)</text>
<line x1="5" y1="79" x2="5" y2="101"/>
<line x1="45" y1="79" x2="45" y2="101"/>
<line x1="45" y1="90" x2="50" y2="90"/>
<line x1="50" y1="90" x2="60" y2="90"/>
<line x1="60" y1="90" x2="70" y2="90"/>
<text x="80" y="90">keystore.meta</text>
<text x="320" y="90">#</text>
<text x="340" y="90">Metadata,</text>
<text x="440" y="90">parameters</text>
<line x1="5" y1="99" x2="5" y2="121"/>
<line x1="45" y1="110" x2="50" y2="110"/>
<line x1="45" y1="99" x2="45" y2="110"/>
<line x1="50" y1="110" x2="60" y2="110"/>
<line x1="60" y1="110" x2="70" y2="110"/>
<text x="80" y="110">recovery/</text>
<text x="320" y="110">#</text>
<text x="340" y="110">Optional</text>
<text x="430" y="110">threshold</text>
<text x="530" y="110">shares</text>
<line x1="5" y1="119" x2="5" y2="141"/>
<line x1="85" y1="119" x2="85" y2="141"/>
<line x1="85" y1="130" x2="90" y2="130"/>
<line x1="90" y1="130" x2="100" y2="130"/>
<line x1="100" y1="130" x2="110" y2="130"/>
<text x="120" y="130">share.1.key</text>
<line x1="5" y1="139" x2="5" y2="161"/>
<line x1="85" y1="150" x2="90" y2="150"/>
<line x1="85" y1="139" x2="85" y2="150"/>
<line x1="90" y1="150" x2="100" y2="150"/>
<line x1="100" y1="150" x2="110" y2="150"/>
<text x="120" y="150">share.2.key</text>
<line x1="5" y1="159" x2="5" y2="181"/>
<line x1="5" y1="170" x2="10" y2="170"/>
<line x1="10" y1="170" x2="20" y2="170"/>
<line x1="20" y1="170" x2="30" y2="170"/>
<text x="40" y="170">attestations/</text>
<text x="330" y="170">#</text>
<text x="350" y="170">Proof</text>
<text x="410" y="170">store</text>
<line x1="5" y1="179" x2="5" y2="201"/>
<line x1="45" y1="179" x2="45" y2="201"/>
<line x1="45" y1="190" x2="50" y2="190"/>
<line x1="50" y1="190" x2="60" y2="190"/>
<line x1="60" y1="190" x2="70" y2="190"/>
<text x="80" y="190">hardware/</text>
<text x="320" y="190">#</text>
<text x="340" y="190">Hardware</text>
<text x="430" y="190">attestations</text>
<line x1="5" y1="199" x2="5" y2="221"/>
<line x1="45" y1="199" x2="45" y2="221"/>
<line x1="85" y1="199" x2="85" y2="221"/>
<line x1="85" y1="210" x2="90" y2="210"/>
<line x1="90" y1="210" x2="100" y2="210"/>
<line x1="100" y1="210" x2="110" y2="210"/>
<text x="120" y="210">anchor-quote.att</text>
<text x="350" y="210">#</text>
<text x="370" y="210">Anchor</text>
<text x="440" y="210">measurement</text>
<line x1="5" y1="219" x2="5" y2="241"/>
<line x1="45" y1="219" x2="45" y2="241"/>
<line x1="85" y1="230" x2="90" y2="230"/>
<line x1="85" y1="219" x2="85" y2="230"/>
<line x1="90" y1="230" x2="100" y2="230"/>
<line x1="100" y1="230" x2="110" y2="230"/>
<text x="120" y="230">secure-enclave.att</text>
<text x="320" y="230">#</text>
<text x="340" y="230">Apple</text>
<text x="400" y="230">SE</text>
<text x="430" y="230">attestation</text>
<line x1="5" y1="239" x2="5" y2="261"/>
<line x1="45" y1="239" x2="45" y2="261"/>
<line x1="45" y1="250" x2="50" y2="250"/>
<line x1="50" y1="250" x2="60" y2="250"/>
<line x1="60" y1="250" x2="70" y2="250"/>
<text x="80" y="250">software/</text>
<text x="320" y="250">#</text>
<text x="340" y="250">Software</text>
<text x="430" y="250">attestations</text>
<line x1="5" y1="259" x2="5" y2="281"/>
<line x1="45" y1="259" x2="45" y2="281"/>
<line x1="85" y1="259" x2="85" y2="281"/>
<line x1="85" y1="270" x2="90" y2="270"/>
<line x1="90" y1="270" x2="100" y2="270"/>
<line x1="100" y1="270" x2="110" y2="270"/>
<text x="120" y="270">boot-hash.att</text>
<text x="320" y="270">#</text>
<text x="340" y="270">Measured</text>
<text x="430" y="270">boot</text>
<line x1="5" y1="279" x2="5" y2="301"/>
<line x1="45" y1="279" x2="45" y2="301"/>
<line x1="85" y1="290" x2="90" y2="290"/>
<line x1="85" y1="279" x2="85" y2="290"/>
<line x1="90" y1="290" x2="100" y2="290"/>
<line x1="100" y1="290" x2="110" y2="290"/>
<text x="120" y="290">runtime-hash.att</text>
<text x="320" y="290">#</text>
<text x="340" y="290">Runtime</text>
<text x="420" y="290">measurements</text>
<line x1="5" y1="299" x2="5" y2="321"/>
<line x1="45" y1="299" x2="45" y2="321"/>
<line x1="45" y1="310" x2="50" y2="310"/>
<line x1="50" y1="310" x2="60" y2="310"/>
<line x1="60" y1="310" x2="70" y2="310"/>
<text x="80" y="310">identity/</text>
<text x="320" y="310">#</text>
<text x="340" y="310">Third-party</text>
<text x="460" y="310">vouches</text>
<line x1="5" y1="319" x2="5" y2="341"/>
<line x1="45" y1="319" x2="45" y2="341"/>
<line x1="85" y1="330" x2="90" y2="330"/>
<line x1="85" y1="319" x2="85" y2="330"/>
<line x1="90" y1="330" x2="100" y2="330"/>
<line x1="100" y1="330" x2="110" y2="330"/>
<text x="120" y="330">ca-cert.att</text>
<text x="320" y="330">#</text>
<text x="340" y="330">External</text>
<text x="430" y="330">CA</text>
<text x="460" y="330">attestation</text>
<line x1="5" y1="339" x2="5" y2="361"/>
<line x1="45" y1="350" x2="50" y2="350"/>
<line x1="45" y1="339" x2="45" y2="350"/>
<line x1="50" y1="350" x2="60" y2="350"/>
<line x1="60" y1="350" x2="70" y2="350"/>
<text x="80" y="350">attestations.meta</text>
<text x="320" y="350">#</text>
<text x="340" y="350">Attestation</text>
<text x="460" y="350">catalog</text>
<line x1="5" y1="359" x2="5" y2="381"/>
<line x1="5" y1="370" x2="10" y2="370"/>
<line x1="10" y1="370" x2="20" y2="370"/>
<line x1="20" y1="370" x2="30" y2="370"/>
<text x="40" y="370">releases/</text>
<line x1="5" y1="379" x2="5" y2="401"/>
<line x1="5" y1="390" x2="10" y2="390"/>
<line x1="10" y1="390" x2="20" y2="390"/>
<line x1="20" y1="390" x2="30" y2="390"/>
<text x="40" y="390">objects/</text>
<line x1="5" y1="399" x2="5" y2="421"/>
<line x1="5" y1="410" x2="10" y2="410"/>
<line x1="10" y1="410" x2="20" y2="410"/>
<line x1="20" y1="410" x2="30" y2="410"/>
<text x="40" y="410">capabilities/</text>
<line x1="5" y1="419" x2="5" y2="441"/>
<line x1="5" y1="430" x2="10" y2="430"/>
<line x1="10" y1="430" x2="20" y2="430"/>
<line x1="20" y1="430" x2="30" y2="430"/>
<text x="40" y="430">audit/</text>
<line x1="5" y1="450" x2="10" y2="450"/>
<line x1="5" y1="439" x2="5" y2="450"/>
<line x1="10" y1="450" x2="20" y2="450"/>
<line x1="20" y1="450" x2="30" y2="450"/>
<text x="40" y="450">node-hardware</text>
</svg>
</div>
<h3>Key Files</h3>
<p>realm.pub - Your public identity, shareable:</p>
<pre class="language-scheme">
(realm-public-key
  (version 1)
  (created 1736400000)
  (algorithm "ed25519")
  (public-key #${7f3a2b4c...}))
</pre>
<p>realm.key - Your private key, encrypted:</p>
<pre class="language-scheme">
(realm-private-key
  (version 1)
  (algorithm "ed25519")
  (protection "passphrase")      ; or "hardware", "threshold"
  (kdf "argon2id")
  (kdf-params
    (ops-limit 3)                ; cryptopwhashOPSLIMIT_MODERATE
    (mem-limit 268435456)        ; 256 MB
    (salt #${random-32-bytes}))
  (cipher "xchacha20-poly1305")
  (nonce #${random-24-bytes})
  (ciphertext #${encrypted-private-key}))
</pre>
<p>keystore.meta - Configuration:</p>
<pre class="language-scheme">
(keystore-meta
  (version 1)
  (created 1736400000)
  (last-accessed 1736450000)
  (protection "passphrase")
  (backup-reminder 7776000)      ; 90 days
  (rotation-reminder 31536000))  ; 1 year
</pre>
</section>
<section>
<h2>Cryptographic Operations</h2>
<h3>Key Derivation</h3>
<p>Passphrase → encryption key via Argon2id:</p>
<pre class="language-scheme">
(define (derive-key passphrase salt)
  "Derive encryption key from passphrase using Argon2id"
  (let ((key (make-blob 32)))
    (sodium-pwhash!
      key
      passphrase
      salt
      3                          ; ops-limit (moderate)
      268435456                  ; mem-limit (256 MB)
      'argon2id)
    key))
</pre>
<p>Why Argon2id: - Memory-hard: resists GPU/ASIC attacks - Time-hard: configurable iterations - Side-channel resistant: hybrid of Argon2i and Argon2d - Winner of Password Hashing Competition - Already in libsodium</p>
<h3>Encryption</h3>
<p>Private key encrypted via XChaCha20-Poly1305:</p>
<pre class="language-scheme">
(define (encrypt-private-key private-key encryption-key)
  "Encrypt private key for storage"
  (let ((nonce (random-bytes 24)))
    (values
      nonce
      (sodium-secretbox private-key nonce encryption-key))))

(define (decrypt-private-key ciphertext nonce encryption-key)
  "Decrypt private key from storage"
  (sodium-secretbox-open ciphertext nonce encryption-key))
</pre>
<p>Why XChaCha20-Poly1305: - 256-bit key, 192-bit nonce - Extended nonce allows random generation (no counter needed) - Authenticated: tampering detected - Fast in software - Already in libsodium (crypto_secretbox)</p>
</section>
<section>
<h2>Bootstrap Flow</h2>
<h3>New Realm</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 620 500" width="620" height="500" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">$</text>
<text x="20" y="10">./repl</text>
<line x1="5" y1="30" x2="10" y2="30"/>
<line x1="5" y1="30" x2="5" y2="41"/>
<line x1="10" y1="30" x2="20" y2="30"/>
<line x1="20" y1="30" x2="30" y2="30"/>
<line x1="30" y1="30" x2="40" y2="30"/>
<line x1="40" y1="30" x2="50" y2="30"/>
<line x1="50" y1="30" x2="60" y2="30"/>
<line x1="60" y1="30" x2="70" y2="30"/>
<line x1="70" y1="30" x2="80" y2="30"/>
<line x1="80" y1="30" x2="90" y2="30"/>
<line x1="90" y1="30" x2="100" y2="30"/>
<line x1="100" y1="30" x2="110" y2="30"/>
<line x1="110" y1="30" x2="120" y2="30"/>
<line x1="120" y1="30" x2="130" y2="30"/>
<line x1="130" y1="30" x2="140" y2="30"/>
<line x1="140" y1="30" x2="150" y2="30"/>
<line x1="150" y1="30" x2="160" y2="30"/>
<line x1="160" y1="30" x2="170" y2="30"/>
<line x1="170" y1="30" x2="180" y2="30"/>
<line x1="180" y1="30" x2="190" y2="30"/>
<line x1="190" y1="30" x2="200" y2="30"/>
<line x1="200" y1="30" x2="210" y2="30"/>
<line x1="210" y1="30" x2="220" y2="30"/>
<line x1="220" y1="30" x2="230" y2="30"/>
<line x1="230" y1="30" x2="240" y2="30"/>
<line x1="240" y1="30" x2="250" y2="30"/>
<line x1="250" y1="30" x2="260" y2="30"/>
<line x1="260" y1="30" x2="270" y2="30"/>
<line x1="270" y1="30" x2="280" y2="30"/>
<line x1="280" y1="30" x2="290" y2="30"/>
<line x1="290" y1="30" x2="300" y2="30"/>
<line x1="300" y1="30" x2="310" y2="30"/>
<line x1="310" y1="30" x2="320" y2="30"/>
<line x1="320" y1="30" x2="330" y2="30"/>
<line x1="330" y1="30" x2="340" y2="30"/>
<line x1="340" y1="30" x2="350" y2="30"/>
<line x1="350" y1="30" x2="360" y2="30"/>
<line x1="360" y1="30" x2="370" y2="30"/>
<line x1="370" y1="30" x2="380" y2="30"/>
<line x1="380" y1="30" x2="390" y2="30"/>
<line x1="390" y1="30" x2="400" y2="30"/>
<line x1="400" y1="30" x2="410" y2="30"/>
<line x1="410" y1="30" x2="420" y2="30"/>
<line x1="420" y1="30" x2="430" y2="30"/>
<line x1="430" y1="30" x2="440" y2="30"/>
<line x1="440" y1="30" x2="450" y2="30"/>
<line x1="450" y1="30" x2="460" y2="30"/>
<line x1="460" y1="30" x2="470" y2="30"/>
<line x1="470" y1="30" x2="480" y2="30"/>
<line x1="480" y1="30" x2="490" y2="30"/>
<line x1="490" y1="30" x2="500" y2="30"/>
<line x1="500" y1="30" x2="510" y2="30"/>
<line x1="510" y1="30" x2="520" y2="30"/>
<line x1="520" y1="30" x2="530" y2="30"/>
<line x1="530" y1="30" x2="540" y2="30"/>
<line x1="540" y1="30" x2="550" y2="30"/>
<line x1="550" y1="30" x2="560" y2="30"/>
<line x1="560" y1="30" x2="570" y2="30"/>
<line x1="570" y1="30" x2="580" y2="30"/>
<line x1="580" y1="30" x2="590" y2="30"/>
<line x1="590" y1="30" x2="600" y2="30"/>
<line x1="610" y1="30" x2="615" y2="30"/>
<line x1="615" y1="30" x2="615" y2="41"/>
<line x1="5" y1="39" x2="5" y2="61"/>
<text x="210" y="50">REALM</text>
<text x="270" y="50">BOOTSTRAP</text>
<line x1="615" y1="39" x2="615" y2="61"/>
<line x1="5" y1="70" x2="10" y2="70"/>
<line x1="5" y1="59" x2="5" y2="70"/>
<line x1="10" y1="70" x2="20" y2="70"/>
<line x1="20" y1="70" x2="30" y2="70"/>
<line x1="30" y1="70" x2="40" y2="70"/>
<line x1="40" y1="70" x2="50" y2="70"/>
<line x1="50" y1="70" x2="60" y2="70"/>
<line x1="60" y1="70" x2="70" y2="70"/>
<line x1="70" y1="70" x2="80" y2="70"/>
<line x1="80" y1="70" x2="90" y2="70"/>
<line x1="90" y1="70" x2="100" y2="70"/>
<line x1="100" y1="70" x2="110" y2="70"/>
<line x1="110" y1="70" x2="120" y2="70"/>
<line x1="120" y1="70" x2="130" y2="70"/>
<line x1="130" y1="70" x2="140" y2="70"/>
<line x1="140" y1="70" x2="150" y2="70"/>
<line x1="150" y1="70" x2="160" y2="70"/>
<line x1="160" y1="70" x2="170" y2="70"/>
<line x1="170" y1="70" x2="180" y2="70"/>
<line x1="180" y1="70" x2="190" y2="70"/>
<line x1="190" y1="70" x2="200" y2="70"/>
<line x1="200" y1="70" x2="210" y2="70"/>
<line x1="210" y1="70" x2="220" y2="70"/>
<line x1="220" y1="70" x2="230" y2="70"/>
<line x1="230" y1="70" x2="240" y2="70"/>
<line x1="240" y1="70" x2="250" y2="70"/>
<line x1="250" y1="70" x2="260" y2="70"/>
<line x1="260" y1="70" x2="270" y2="70"/>
<line x1="270" y1="70" x2="280" y2="70"/>
<line x1="280" y1="70" x2="290" y2="70"/>
<line x1="290" y1="70" x2="300" y2="70"/>
<line x1="300" y1="70" x2="310" y2="70"/>
<line x1="310" y1="70" x2="320" y2="70"/>
<line x1="320" y1="70" x2="330" y2="70"/>
<line x1="330" y1="70" x2="340" y2="70"/>
<line x1="340" y1="70" x2="350" y2="70"/>
<line x1="350" y1="70" x2="360" y2="70"/>
<line x1="360" y1="70" x2="370" y2="70"/>
<line x1="370" y1="70" x2="380" y2="70"/>
<line x1="380" y1="70" x2="390" y2="70"/>
<line x1="390" y1="70" x2="400" y2="70"/>
<line x1="400" y1="70" x2="410" y2="70"/>
<line x1="410" y1="70" x2="420" y2="70"/>
<line x1="420" y1="70" x2="430" y2="70"/>
<line x1="430" y1="70" x2="440" y2="70"/>
<line x1="440" y1="70" x2="450" y2="70"/>
<line x1="450" y1="70" x2="460" y2="70"/>
<line x1="460" y1="70" x2="470" y2="70"/>
<line x1="470" y1="70" x2="480" y2="70"/>
<line x1="480" y1="70" x2="490" y2="70"/>
<line x1="490" y1="70" x2="500" y2="70"/>
<line x1="500" y1="70" x2="510" y2="70"/>
<line x1="510" y1="70" x2="520" y2="70"/>
<line x1="520" y1="70" x2="530" y2="70"/>
<line x1="530" y1="70" x2="540" y2="70"/>
<line x1="540" y1="70" x2="550" y2="70"/>
<line x1="550" y1="70" x2="560" y2="70"/>
<line x1="560" y1="70" x2="570" y2="70"/>
<line x1="570" y1="70" x2="580" y2="70"/>
<line x1="580" y1="70" x2="590" y2="70"/>
<line x1="590" y1="70" x2="600" y2="70"/>
<line x1="610" y1="70" x2="615" y2="70"/>
<line x1="615" y1="59" x2="615" y2="70"/>
<text x="0" y="90">No</text>
<text x="30" y="90">realm</text>
<text x="90" y="90">identity</text>
<text x="180" y="90">found</text>
<text x="240" y="90">in</text>
<text x="270" y="90">.vault/keystore/</text>
<text x="0" y="110">Create</text>
<text x="70" y="110">new</text>
<text x="110" y="110">realm?</text>
<text x="180" y="110">[y/n]</text>
<text x="240" y="110">y</text>
<text x="0" y="130">Choose</text>
<text x="70" y="130">protection</text>
<text x="180" y="130">method:</text>
<text x="20" y="150">1.</text>
<text x="50" y="150">Passphrase</text>
<text x="160" y="150">(recommended)</text>
<text x="20" y="170">2.</text>
<text x="50" y="170">Hardware</text>
<text x="140" y="170">token</text>
<text x="200" y="170">(requires</text>
<text x="300" y="170">YubiKey)</text>
<text x="20" y="190">3.</text>
<text x="50" y="190">Threshold</text>
<text x="150" y="190">(k-of-n</text>
<text x="230" y="190">shares)</text>
<text x="0" y="210">Selection:</text>
<text x="110" y="210">1</text>
<text x="0" y="230">Enter</text>
<text x="60" y="230">passphrase:</text>
<text x="0" y="250">Confirm</text>
<text x="80" y="250">passphrase:</text>
<text x="0" y="270">Generating</text>
<text x="110" y="270">Ed25519</text>
<text x="190" y="270">keypair...</text>
<text x="0" y="290">Encrypting</text>
<text x="110" y="290">with</text>
<text x="160" y="290">Argon2id</text>
<text x="250" y="290">(this</text>
<text x="310" y="290">takes</text>
<text x="370" y="290">a</text>
<text x="390" y="290">moment)...</text>
<line x1="5" y1="310" x2="10" y2="310"/>
<line x1="5" y1="310" x2="5" y2="321"/>
<line x1="10" y1="310" x2="20" y2="310"/>
<line x1="20" y1="310" x2="30" y2="310"/>
<line x1="30" y1="310" x2="40" y2="310"/>
<line x1="40" y1="310" x2="50" y2="310"/>
<line x1="50" y1="310" x2="60" y2="310"/>
<line x1="60" y1="310" x2="70" y2="310"/>
<line x1="70" y1="310" x2="80" y2="310"/>
<line x1="80" y1="310" x2="90" y2="310"/>
<line x1="90" y1="310" x2="100" y2="310"/>
<line x1="100" y1="310" x2="110" y2="310"/>
<line x1="110" y1="310" x2="120" y2="310"/>
<line x1="120" y1="310" x2="130" y2="310"/>
<line x1="130" y1="310" x2="140" y2="310"/>
<line x1="140" y1="310" x2="150" y2="310"/>
<line x1="150" y1="310" x2="160" y2="310"/>
<line x1="160" y1="310" x2="170" y2="310"/>
<line x1="170" y1="310" x2="180" y2="310"/>
<line x1="180" y1="310" x2="190" y2="310"/>
<line x1="190" y1="310" x2="200" y2="310"/>
<line x1="200" y1="310" x2="210" y2="310"/>
<line x1="210" y1="310" x2="220" y2="310"/>
<line x1="220" y1="310" x2="230" y2="310"/>
<line x1="230" y1="310" x2="240" y2="310"/>
<line x1="240" y1="310" x2="250" y2="310"/>
<line x1="250" y1="310" x2="260" y2="310"/>
<line x1="260" y1="310" x2="270" y2="310"/>
<line x1="270" y1="310" x2="280" y2="310"/>
<line x1="280" y1="310" x2="290" y2="310"/>
<line x1="290" y1="310" x2="300" y2="310"/>
<line x1="300" y1="310" x2="310" y2="310"/>
<line x1="310" y1="310" x2="320" y2="310"/>
<line x1="320" y1="310" x2="330" y2="310"/>
<line x1="330" y1="310" x2="340" y2="310"/>
<line x1="340" y1="310" x2="350" y2="310"/>
<line x1="350" y1="310" x2="360" y2="310"/>
<line x1="360" y1="310" x2="370" y2="310"/>
<line x1="370" y1="310" x2="380" y2="310"/>
<line x1="380" y1="310" x2="390" y2="310"/>
<line x1="390" y1="310" x2="400" y2="310"/>
<line x1="400" y1="310" x2="410" y2="310"/>
<line x1="410" y1="310" x2="420" y2="310"/>
<line x1="420" y1="310" x2="430" y2="310"/>
<line x1="430" y1="310" x2="440" y2="310"/>
<line x1="440" y1="310" x2="450" y2="310"/>
<line x1="450" y1="310" x2="460" y2="310"/>
<line x1="460" y1="310" x2="470" y2="310"/>
<line x1="470" y1="310" x2="480" y2="310"/>
<line x1="480" y1="310" x2="490" y2="310"/>
<line x1="490" y1="310" x2="500" y2="310"/>
<line x1="500" y1="310" x2="510" y2="310"/>
<line x1="510" y1="310" x2="520" y2="310"/>
<line x1="520" y1="310" x2="530" y2="310"/>
<line x1="530" y1="310" x2="540" y2="310"/>
<line x1="540" y1="310" x2="550" y2="310"/>
<line x1="550" y1="310" x2="560" y2="310"/>
<line x1="560" y1="310" x2="570" y2="310"/>
<line x1="570" y1="310" x2="580" y2="310"/>
<line x1="580" y1="310" x2="590" y2="310"/>
<line x1="590" y1="310" x2="600" y2="310"/>
<line x1="610" y1="310" x2="615" y2="310"/>
<line x1="615" y1="310" x2="615" y2="321"/>
<line x1="5" y1="319" x2="5" y2="341"/>
<text x="30" y="330">REALM</text>
<text x="90" y="330">CREATED</text>
<line x1="615" y1="319" x2="615" y2="341"/>
<line x1="5" y1="339" x2="5" y2="361"/>
<line x1="615" y1="339" x2="615" y2="361"/>
<line x1="5" y1="359" x2="5" y2="381"/>
<text x="30" y="370">Principal:</text>
<text x="140" y="370">ed25519:7f3a2b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e</text>
<line x1="615" y1="359" x2="615" y2="381"/>
<line x1="5" y1="379" x2="5" y2="401"/>
<text x="30" y="390">Created:</text>
<text x="140" y="390">2026-01-08</text>
<text x="250" y="390">14:30:00</text>
<text x="340" y="390">UTC</text>
<line x1="615" y1="379" x2="615" y2="401"/>
<line x1="5" y1="399" x2="5" y2="421"/>
<line x1="615" y1="399" x2="615" y2="421"/>
<line x1="5" y1="419" x2="5" y2="441"/>
<text x="30" y="430">IMPORTANT:</text>
<text x="140" y="430">Your</text>
<text x="190" y="430">passphrase</text>
<text x="300" y="430">cannot</text>
<text x="370" y="430">be</text>
<text x="400" y="430">recovered.</text>
<line x1="615" y1="419" x2="615" y2="441"/>
<line x1="5" y1="439" x2="5" y2="461"/>
<text x="30" y="450">Consider</text>
<text x="120" y="450">creating</text>
<text x="210" y="450">recovery</text>
<text x="300" y="450">shares</text>
<text x="370" y="450">with</text>
<text x="420" y="450">(keystore-backup)</text>
<line x1="615" y1="439" x2="615" y2="461"/>
<line x1="5" y1="470" x2="10" y2="470"/>
<line x1="5" y1="459" x2="5" y2="470"/>
<line x1="10" y1="470" x2="20" y2="470"/>
<line x1="20" y1="470" x2="30" y2="470"/>
<line x1="30" y1="470" x2="40" y2="470"/>
<line x1="40" y1="470" x2="50" y2="470"/>
<line x1="50" y1="470" x2="60" y2="470"/>
<line x1="60" y1="470" x2="70" y2="470"/>
<line x1="70" y1="470" x2="80" y2="470"/>
<line x1="80" y1="470" x2="90" y2="470"/>
<line x1="90" y1="470" x2="100" y2="470"/>
<line x1="100" y1="470" x2="110" y2="470"/>
<line x1="110" y1="470" x2="120" y2="470"/>
<line x1="120" y1="470" x2="130" y2="470"/>
<line x1="130" y1="470" x2="140" y2="470"/>
<line x1="140" y1="470" x2="150" y2="470"/>
<line x1="150" y1="470" x2="160" y2="470"/>
<line x1="160" y1="470" x2="170" y2="470"/>
<line x1="170" y1="470" x2="180" y2="470"/>
<line x1="180" y1="470" x2="190" y2="470"/>
<line x1="190" y1="470" x2="200" y2="470"/>
<line x1="200" y1="470" x2="210" y2="470"/>
<line x1="210" y1="470" x2="220" y2="470"/>
<line x1="220" y1="470" x2="230" y2="470"/>
<line x1="230" y1="470" x2="240" y2="470"/>
<line x1="240" y1="470" x2="250" y2="470"/>
<line x1="250" y1="470" x2="260" y2="470"/>
<line x1="260" y1="470" x2="270" y2="470"/>
<line x1="270" y1="470" x2="280" y2="470"/>
<line x1="280" y1="470" x2="290" y2="470"/>
<line x1="290" y1="470" x2="300" y2="470"/>
<line x1="300" y1="470" x2="310" y2="470"/>
<line x1="310" y1="470" x2="320" y2="470"/>
<line x1="320" y1="470" x2="330" y2="470"/>
<line x1="330" y1="470" x2="340" y2="470"/>
<line x1="340" y1="470" x2="350" y2="470"/>
<line x1="350" y1="470" x2="360" y2="470"/>
<line x1="360" y1="470" x2="370" y2="470"/>
<line x1="370" y1="470" x2="380" y2="470"/>
<line x1="380" y1="470" x2="390" y2="470"/>
<line x1="390" y1="470" x2="400" y2="470"/>
<line x1="400" y1="470" x2="410" y2="470"/>
<line x1="410" y1="470" x2="420" y2="470"/>
<line x1="420" y1="470" x2="430" y2="470"/>
<line x1="430" y1="470" x2="440" y2="470"/>
<line x1="440" y1="470" x2="450" y2="470"/>
<line x1="450" y1="470" x2="460" y2="470"/>
<line x1="460" y1="470" x2="470" y2="470"/>
<line x1="470" y1="470" x2="480" y2="470"/>
<line x1="480" y1="470" x2="490" y2="470"/>
<line x1="490" y1="470" x2="500" y2="470"/>
<line x1="500" y1="470" x2="510" y2="470"/>
<line x1="510" y1="470" x2="520" y2="470"/>
<line x1="520" y1="470" x2="530" y2="470"/>
<line x1="530" y1="470" x2="540" y2="470"/>
<line x1="540" y1="470" x2="550" y2="470"/>
<line x1="550" y1="470" x2="560" y2="470"/>
<line x1="560" y1="470" x2="570" y2="470"/>
<line x1="570" y1="470" x2="580" y2="470"/>
<line x1="580" y1="470" x2="590" y2="470"/>
<line x1="590" y1="470" x2="600" y2="470"/>
<line x1="610" y1="470" x2="615" y2="470"/>
<line x1="615" y1="459" x2="615" y2="470"/>
<text x="0" y="490">cyberspace&gt;</text>
</svg>
</div>
<h3>Existing Realm</h3>
<pre>
$ ./repl

Realm: ed25519:7f3a2b4c...
Passphrase: 

Unlocking keystore...

cyberspace&gt; ; Ready, identity loaded
</pre>
<h3>Failed Unlock</h3>
<pre>
Passphrase: 

ERROR: Decryption failed (wrong passphrase?)
Attempts remaining: 2

Passphrase: 

ERROR: Decryption failed
Attempts remaining: 1

WARNING: One attempt remaining. Consider:
  - Recovery shares if configured
  - The passphrase is case-sensitive
  - Check caps lock
</pre>
</section>
<section>
<h2>Recovery</h2>
<h3>Threshold Shares</h3>
<p>For high-value realms, split the key into k-of-n shares (Memo-008):</p>
<pre class="language-scheme">
(keystore-backup
  threshold: 2                   ; k - shares needed
  shares: 3)                     ; n - shares created

;; Output:
;; Share 1 of 3 (requires 2 to recover):
;; CYBER-SHARE-1-7f3a2b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2
;;
;; Share 2 of 3 (requires 2 to recover):
;; CYBER-SHARE-2-8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8
;;
;; Share 3 of 3 (requires 2 to recover):
;; CYBER-SHARE-3-9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9
;;
;; STORE THESE SEPARATELY. Any 2 can recover your realm.
</pre>
<p>Recovery:</p>
<pre class="language-scheme">
(keystore-recover
  "CYBER-SHARE-1-7f3a2b4c..."
  "CYBER-SHARE-3-9b0c1d2e...")

;; Realm recovered. Set new passphrase:
;; New passphrase: 
;; Confirm: 
;; Keystore restored.
</pre>
<h3>Paper Backup</h3>
<p>For the paranoid (wisely so):</p>
<pre class="language-scheme">
(keystore-paper-backup)

;; Generates QR code + text backup for offline storage
;; Encrypted with passphrase, prints to terminal/file
</pre>
</section>
<section>
<h2>Key Rotation</h2>
<p>Keys should rotate periodically. Old key signs new key, creating continuity:</p>
<pre class="language-scheme">
(keystore-rotate)

;; Current principal: ed25519:7f3a2b4c...
;;
;; This will:
;;   1. Generate new Ed25519 keypair
;;   2. Sign rotation certificate with old key
;;   3. Store rotation chain in keystore
;;   4. New principal becomes active
;;
;; Proceed? [y/n] y
;;
;; Enter current passphrase: 
;; Enter new passphrase (or same): 
;;
;; Generating new keypair...
;; Signing rotation certificate...
;;
;; ROTATION COMPLETE
;; Old principal: ed25519:7f3a2b4c...
;; New principal: ed25519:2c3d4e5f...
;; Rotation cert: sha512:rotation-cert-hash...
;;
;; Old capabilities referencing ed25519:7f3a2b4c will need reissuance.
</pre>
<p>Rotation certificate:</p>
<pre class="language-scheme">
(rotation-cert
  (old-principal "ed25519:7f3a2b4c...")
  (new-principal "ed25519:2c3d4e5f...")
  (timestamp 1736500000)
  (reason "scheduled-rotation")
  (signature "ed25519:old-key-signature..."))
</pre>
</section>
<section>
<h2>Attestation Store</h2>
<p>Attestations are signed claims about the realm. They answer: "What can you prove about yourself?"</p>
<h3>Attestation Types</h3>
<p>Hardware Attestations - proofs from silicon:</p>
<pre class="language-scheme">
(hardware-attestation
  (type "anchor-quote")
  (timestamp 1736400000)
  (platform "Darwin-arm64")
  (measurements
    (rune-boot #${boot-measurement...})
    (rune-policy #${secureboot-policy...}))
  (signature #${anchor-signature...})
  (certificate #${endorsement-key-cert...}))
</pre>
<p>Software Attestations - proofs from code:</p>
<pre class="language-scheme">
(software-attestation
  (type "runtime-measurement")
  (timestamp 1736400000)
  (binary-hash "sha512:repl...")
  (library-hashes
    ("libsodium.dylib" "sha512:...")
    ("libchicken.dylib" "sha512:..."))
  (signature #${realm-signature...}))
</pre>
<p>Identity Attestations - third-party vouches:</p>
<pre class="language-scheme">
(identity-attestation
  (type "ca-vouch")
  (timestamp 1736400000)
  (subject "ed25519:7f3a2b4c...")         ; This realm
  (issuer "ed25519:ca-public-key...")     ; Vouching authority
  (claims
    (organization "Acme Corp")
    (role "coordinator"))
  (valid (not-after 1767936000))
  (signature #${ca-signature...}))
</pre>
<p>Capability Attestations - proof of holding:</p>
<pre class="language-scheme">
(capability-attestation
  (type "capability-proof")
  (timestamp 1736400000)
  (capability "sha512:cert-hash...")
  (holder "ed25519:7f3a2b4c...")
  (challenge #${nonce...})                ; Prevents replay
  (response #${signed-challenge...}))
</pre>
<h3>Attestation Catalog</h3>
<p>The attestation store maintains a catalog for fast lookup:</p>
<pre class="language-scheme">
(attestations-meta
  (version 1)
  (count 5)
  (types
    (hardware 2)
    (software 1)
    (identity 1)
    (capability 1))
  (latest-refresh 1736400000)
  (entries
    ((id "att-001") (type hardware) (file "hardware/anchor-quote.att") (expires #f))
    ((id "att-002") (type hardware) (file "hardware/secure-enclave.att") (expires #f))
    ((id "att-003") (type software) (file "software/runtime-hash.att") (expires #f))
    ((id "att-004") (type identity) (file "identity/ca-cert.att") (expires 1767936000))
    ((id "att-005") (type capability) (file "capability/coord-role.att") (expires 1736500000))))
</pre>
<h3>Attestation Operations</h3>
<pre class="language-scheme">
;; Refresh hardware attestations (re-measure)
(attestation-refresh-hardware)
;; =&gt; Querying Anchor... done.
;; =&gt; Querying Secure Enclave... done.
;; =&gt; 2 hardware attestations updated.

;; Measure current software state
(attestation-measure-software)
;; =&gt; Hashing repl... done.
;; =&gt; Hashing loaded libraries... done.
;; =&gt; Software attestation stored.

;; Request identity attestation from CA
(attestation-request-identity "ed25519:ca-key...")
;; =&gt; Sending attestation request to CA...
;; =&gt; (requires CA to sign and return)

;; Prove capability holding (for remote verification)
(attestation-prove-capability "sha512:cert-hash..." challenge)
;; =&gt; (capability-attestation ...)

;; List all attestations
(attestation-list)
;; =&gt; ((att-001 hardware anchor-quote valid)
;;     (att-002 hardware secure-enclave valid)
;;     (att-003 software runtime-hash valid)
;;     (att-004 identity ca-cert expires:2026-12-31)
;;     (att-005 capability coord-role expires:2026-01-10))

;; Verify an attestation
(attestation-verify "att-001")
;; =&gt; (attestation att-001 (status valid) (type hardware) (verified #t))

;; Export for remote verification
(attestation-export "att-001")
;; =&gt; (hardware-attestation (type "anchor-quote") ...)
</pre>
<h3>Attestation Chain</h3>
<p>Attestations can chain - a hardware attestation vouches for software, software vouches for capabilities:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 630 360" width="630" height="360" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<line x1="5" y1="10" x2="10" y2="10"/>
<line x1="5" y1="10" x2="5" y2="21"/>
<line x1="10" y1="10" x2="20" y2="10"/>
<line x1="20" y1="10" x2="30" y2="10"/>
<line x1="30" y1="10" x2="40" y2="10"/>
<line x1="40" y1="10" x2="50" y2="10"/>
<line x1="50" y1="10" x2="60" y2="10"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="160" y2="10"/>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="180" y2="10"/>
<line x1="180" y1="10" x2="190" y2="10"/>
<line x1="190" y1="10" x2="200" y2="10"/>
<line x1="200" y1="10" x2="210" y2="10"/>
<line x1="210" y1="10" x2="220" y2="10"/>
<line x1="220" y1="10" x2="230" y2="10"/>
<line x1="230" y1="10" x2="240" y2="10"/>
<line x1="240" y1="10" x2="250" y2="10"/>
<line x1="250" y1="10" x2="260" y2="10"/>
<line x1="260" y1="10" x2="270" y2="10"/>
<line x1="270" y1="10" x2="280" y2="10"/>
<line x1="620" y1="10" x2="625" y2="10"/>
<line x1="625" y1="10" x2="625" y2="21"/>
<line x1="5" y1="19" x2="5" y2="41"/>
<text x="50" y="30">The</text>
<text x="90" y="30">Anchor</text>
<text x="160" y="30">(Silicon)</text>
<line x1="285" y1="19" x2="285" y2="41"/>
<text x="310" y="30">"This</text>
<text x="370" y="30">boot</text>
<text x="420" y="30">sequence</text>
<text x="510" y="30">is</text>
<text x="540" y="30">measured"</text>
<line x1="5" y1="50" x2="10" y2="50"/>
<line x1="5" y1="39" x2="5" y2="50"/>
<line x1="10" y1="50" x2="20" y2="50"/>
<line x1="20" y1="50" x2="30" y2="50"/>
<line x1="30" y1="50" x2="40" y2="50"/>
<line x1="40" y1="50" x2="50" y2="50"/>
<line x1="50" y1="50" x2="60" y2="50"/>
<line x1="60" y1="50" x2="70" y2="50"/>
<line x1="70" y1="50" x2="80" y2="50"/>
<line x1="80" y1="50" x2="90" y2="50"/>
<line x1="90" y1="50" x2="100" y2="50"/>
<line x1="100" y1="50" x2="110" y2="50"/>
<line x1="110" y1="50" x2="120" y2="50"/>
<line x1="120" y1="50" x2="130" y2="50"/>
<line x1="130" y1="50" x2="140" y2="50"/>
<line x1="140" y1="50" x2="150" y2="50"/>
<line x1="145" y1="50" x2="145" y2="61"/>
<line x1="150" y1="50" x2="160" y2="50"/>
<line x1="160" y1="50" x2="170" y2="50"/>
<line x1="170" y1="50" x2="180" y2="50"/>
<line x1="180" y1="50" x2="190" y2="50"/>
<line x1="190" y1="50" x2="200" y2="50"/>
<line x1="200" y1="50" x2="210" y2="50"/>
<line x1="210" y1="50" x2="220" y2="50"/>
<line x1="220" y1="50" x2="230" y2="50"/>
<line x1="230" y1="50" x2="240" y2="50"/>
<line x1="240" y1="50" x2="250" y2="50"/>
<line x1="250" y1="50" x2="260" y2="50"/>
<line x1="260" y1="50" x2="270" y2="50"/>
<line x1="270" y1="50" x2="280" y2="50"/>
<line x1="620" y1="50" x2="625" y2="50"/>
<line x1="625" y1="39" x2="625" y2="50"/>
<line x1="145" y1="59" x2="145" y2="81"/>
<text x="160" y="70">vouches</text>
<text x="240" y="70">for</text>
<line x1="5" y1="110" x2="10" y2="110"/>
<line x1="5" y1="110" x2="5" y2="121"/>
<line x1="10" y1="110" x2="20" y2="110"/>
<line x1="20" y1="110" x2="30" y2="110"/>
<line x1="30" y1="110" x2="40" y2="110"/>
<line x1="40" y1="110" x2="50" y2="110"/>
<line x1="50" y1="110" x2="60" y2="110"/>
<line x1="60" y1="110" x2="70" y2="110"/>
<line x1="70" y1="110" x2="80" y2="110"/>
<line x1="80" y1="110" x2="90" y2="110"/>
<line x1="90" y1="110" x2="100" y2="110"/>
<line x1="100" y1="110" x2="110" y2="110"/>
<line x1="110" y1="110" x2="120" y2="110"/>
<line x1="120" y1="110" x2="130" y2="110"/>
<line x1="130" y1="110" x2="140" y2="110"/>
<line x1="140" y1="110" x2="150" y2="110"/>
<line x1="150" y1="110" x2="160" y2="110"/>
<line x1="160" y1="110" x2="170" y2="110"/>
<line x1="170" y1="110" x2="180" y2="110"/>
<line x1="180" y1="110" x2="190" y2="110"/>
<line x1="190" y1="110" x2="200" y2="110"/>
<line x1="200" y1="110" x2="210" y2="110"/>
<line x1="210" y1="110" x2="220" y2="110"/>
<line x1="220" y1="110" x2="230" y2="110"/>
<line x1="230" y1="110" x2="240" y2="110"/>
<line x1="240" y1="110" x2="250" y2="110"/>
<line x1="250" y1="110" x2="260" y2="110"/>
<line x1="260" y1="110" x2="270" y2="110"/>
<line x1="270" y1="110" x2="280" y2="110"/>
<line x1="620" y1="110" x2="625" y2="110"/>
<line x1="625" y1="110" x2="625" y2="121"/>
<line x1="5" y1="119" x2="5" y2="141"/>
<text x="50" y="130">Software</text>
<text x="140" y="130">Runes</text>
<line x1="285" y1="119" x2="285" y2="141"/>
<text x="310" y="130">"These</text>
<text x="380" y="130">binaries</text>
<text x="470" y="130">are</text>
<text x="510" y="130">running"</text>
<line x1="5" y1="150" x2="10" y2="150"/>
<line x1="5" y1="139" x2="5" y2="150"/>
<line x1="10" y1="150" x2="20" y2="150"/>
<line x1="20" y1="150" x2="30" y2="150"/>
<line x1="30" y1="150" x2="40" y2="150"/>
<line x1="40" y1="150" x2="50" y2="150"/>
<line x1="50" y1="150" x2="60" y2="150"/>
<line x1="60" y1="150" x2="70" y2="150"/>
<line x1="70" y1="150" x2="80" y2="150"/>
<line x1="80" y1="150" x2="90" y2="150"/>
<line x1="90" y1="150" x2="100" y2="150"/>
<line x1="100" y1="150" x2="110" y2="150"/>
<line x1="110" y1="150" x2="120" y2="150"/>
<line x1="120" y1="150" x2="130" y2="150"/>
<line x1="130" y1="150" x2="140" y2="150"/>
<line x1="140" y1="150" x2="150" y2="150"/>
<line x1="145" y1="150" x2="145" y2="161"/>
<line x1="150" y1="150" x2="160" y2="150"/>
<line x1="160" y1="150" x2="170" y2="150"/>
<line x1="170" y1="150" x2="180" y2="150"/>
<line x1="180" y1="150" x2="190" y2="150"/>
<line x1="190" y1="150" x2="200" y2="150"/>
<line x1="200" y1="150" x2="210" y2="150"/>
<line x1="210" y1="150" x2="220" y2="150"/>
<line x1="220" y1="150" x2="230" y2="150"/>
<line x1="230" y1="150" x2="240" y2="150"/>
<line x1="240" y1="150" x2="250" y2="150"/>
<line x1="250" y1="150" x2="260" y2="150"/>
<line x1="260" y1="150" x2="270" y2="150"/>
<line x1="270" y1="150" x2="280" y2="150"/>
<line x1="620" y1="150" x2="625" y2="150"/>
<line x1="625" y1="139" x2="625" y2="150"/>
<line x1="145" y1="159" x2="145" y2="181"/>
<text x="160" y="170">vouches</text>
<text x="240" y="170">for</text>
<line x1="5" y1="210" x2="10" y2="210"/>
<line x1="5" y1="210" x2="5" y2="221"/>
<line x1="10" y1="210" x2="20" y2="210"/>
<line x1="20" y1="210" x2="30" y2="210"/>
<line x1="30" y1="210" x2="40" y2="210"/>
<line x1="40" y1="210" x2="50" y2="210"/>
<line x1="50" y1="210" x2="60" y2="210"/>
<line x1="60" y1="210" x2="70" y2="210"/>
<line x1="70" y1="210" x2="80" y2="210"/>
<line x1="80" y1="210" x2="90" y2="210"/>
<line x1="90" y1="210" x2="100" y2="210"/>
<line x1="100" y1="210" x2="110" y2="210"/>
<line x1="110" y1="210" x2="120" y2="210"/>
<line x1="120" y1="210" x2="130" y2="210"/>
<line x1="130" y1="210" x2="140" y2="210"/>
<line x1="140" y1="210" x2="150" y2="210"/>
<line x1="150" y1="210" x2="160" y2="210"/>
<line x1="160" y1="210" x2="170" y2="210"/>
<line x1="170" y1="210" x2="180" y2="210"/>
<line x1="180" y1="210" x2="190" y2="210"/>
<line x1="190" y1="210" x2="200" y2="210"/>
<line x1="200" y1="210" x2="210" y2="210"/>
<line x1="210" y1="210" x2="220" y2="210"/>
<line x1="220" y1="210" x2="230" y2="210"/>
<line x1="230" y1="210" x2="240" y2="210"/>
<line x1="240" y1="210" x2="250" y2="210"/>
<line x1="250" y1="210" x2="260" y2="210"/>
<line x1="260" y1="210" x2="270" y2="210"/>
<line x1="270" y1="210" x2="280" y2="210"/>
<line x1="620" y1="210" x2="625" y2="210"/>
<line x1="625" y1="210" x2="625" y2="221"/>
<line x1="5" y1="219" x2="5" y2="241"/>
<text x="50" y="230">Realm</text>
<text x="110" y="230">Identity</text>
<line x1="285" y1="219" x2="285" y2="241"/>
<text x="310" y="230">"This</text>
<text x="370" y="230">is</text>
<text x="400" y="230">my</text>
<text x="430" y="230">signing</text>
<text x="510" y="230">key"</text>
<line x1="5" y1="250" x2="10" y2="250"/>
<line x1="5" y1="239" x2="5" y2="250"/>
<line x1="10" y1="250" x2="20" y2="250"/>
<line x1="20" y1="250" x2="30" y2="250"/>
<line x1="30" y1="250" x2="40" y2="250"/>
<line x1="40" y1="250" x2="50" y2="250"/>
<line x1="50" y1="250" x2="60" y2="250"/>
<line x1="60" y1="250" x2="70" y2="250"/>
<line x1="70" y1="250" x2="80" y2="250"/>
<line x1="80" y1="250" x2="90" y2="250"/>
<line x1="90" y1="250" x2="100" y2="250"/>
<line x1="100" y1="250" x2="110" y2="250"/>
<line x1="110" y1="250" x2="120" y2="250"/>
<line x1="120" y1="250" x2="130" y2="250"/>
<line x1="130" y1="250" x2="140" y2="250"/>
<line x1="140" y1="250" x2="150" y2="250"/>
<line x1="145" y1="250" x2="145" y2="261"/>
<line x1="150" y1="250" x2="160" y2="250"/>
<line x1="160" y1="250" x2="170" y2="250"/>
<line x1="170" y1="250" x2="180" y2="250"/>
<line x1="180" y1="250" x2="190" y2="250"/>
<line x1="190" y1="250" x2="200" y2="250"/>
<line x1="200" y1="250" x2="210" y2="250"/>
<line x1="210" y1="250" x2="220" y2="250"/>
<line x1="220" y1="250" x2="230" y2="250"/>
<line x1="230" y1="250" x2="240" y2="250"/>
<line x1="240" y1="250" x2="250" y2="250"/>
<line x1="250" y1="250" x2="260" y2="250"/>
<line x1="260" y1="250" x2="270" y2="250"/>
<line x1="270" y1="250" x2="280" y2="250"/>
<line x1="620" y1="250" x2="625" y2="250"/>
<line x1="625" y1="239" x2="625" y2="250"/>
<line x1="145" y1="259" x2="145" y2="281"/>
<text x="160" y="270">vouches</text>
<text x="240" y="270">for</text>
<line x1="5" y1="310" x2="10" y2="310"/>
<line x1="5" y1="310" x2="5" y2="321"/>
<line x1="10" y1="310" x2="20" y2="310"/>
<line x1="20" y1="310" x2="30" y2="310"/>
<line x1="30" y1="310" x2="40" y2="310"/>
<line x1="40" y1="310" x2="50" y2="310"/>
<line x1="50" y1="310" x2="60" y2="310"/>
<line x1="60" y1="310" x2="70" y2="310"/>
<line x1="70" y1="310" x2="80" y2="310"/>
<line x1="80" y1="310" x2="90" y2="310"/>
<line x1="90" y1="310" x2="100" y2="310"/>
<line x1="100" y1="310" x2="110" y2="310"/>
<line x1="110" y1="310" x2="120" y2="310"/>
<line x1="120" y1="310" x2="130" y2="310"/>
<line x1="130" y1="310" x2="140" y2="310"/>
<line x1="140" y1="310" x2="150" y2="310"/>
<line x1="150" y1="310" x2="160" y2="310"/>
<line x1="160" y1="310" x2="170" y2="310"/>
<line x1="170" y1="310" x2="180" y2="310"/>
<line x1="180" y1="310" x2="190" y2="310"/>
<line x1="190" y1="310" x2="200" y2="310"/>
<line x1="200" y1="310" x2="210" y2="310"/>
<line x1="210" y1="310" x2="220" y2="310"/>
<line x1="220" y1="310" x2="230" y2="310"/>
<line x1="230" y1="310" x2="240" y2="310"/>
<line x1="240" y1="310" x2="250" y2="310"/>
<line x1="250" y1="310" x2="260" y2="310"/>
<line x1="260" y1="310" x2="270" y2="310"/>
<line x1="270" y1="310" x2="280" y2="310"/>
<line x1="620" y1="310" x2="625" y2="310"/>
<line x1="625" y1="310" x2="625" y2="321"/>
<line x1="5" y1="319" x2="5" y2="341"/>
<text x="50" y="330">Capabilities</text>
<text x="180" y="330">Held</text>
<line x1="285" y1="319" x2="285" y2="341"/>
<text x="310" y="330">"I</text>
<text x="340" y="330">can</text>
<text x="380" y="330">do</text>
<text x="410" y="330">these</text>
<text x="470" y="330">things"</text>
<line x1="5" y1="350" x2="10" y2="350"/>
<line x1="5" y1="339" x2="5" y2="350"/>
<line x1="10" y1="350" x2="20" y2="350"/>
<line x1="20" y1="350" x2="30" y2="350"/>
<line x1="30" y1="350" x2="40" y2="350"/>
<line x1="40" y1="350" x2="50" y2="350"/>
<line x1="50" y1="350" x2="60" y2="350"/>
<line x1="60" y1="350" x2="70" y2="350"/>
<line x1="70" y1="350" x2="80" y2="350"/>
<line x1="80" y1="350" x2="90" y2="350"/>
<line x1="90" y1="350" x2="100" y2="350"/>
<line x1="100" y1="350" x2="110" y2="350"/>
<line x1="110" y1="350" x2="120" y2="350"/>
<line x1="120" y1="350" x2="130" y2="350"/>
<line x1="130" y1="350" x2="140" y2="350"/>
<line x1="140" y1="350" x2="150" y2="350"/>
<line x1="150" y1="350" x2="160" y2="350"/>
<line x1="160" y1="350" x2="170" y2="350"/>
<line x1="170" y1="350" x2="180" y2="350"/>
<line x1="180" y1="350" x2="190" y2="350"/>
<line x1="190" y1="350" x2="200" y2="350"/>
<line x1="200" y1="350" x2="210" y2="350"/>
<line x1="210" y1="350" x2="220" y2="350"/>
<line x1="220" y1="350" x2="230" y2="350"/>
<line x1="230" y1="350" x2="240" y2="350"/>
<line x1="240" y1="350" x2="250" y2="350"/>
<line x1="250" y1="350" x2="260" y2="350"/>
<line x1="260" y1="350" x2="270" y2="350"/>
<line x1="270" y1="350" x2="280" y2="350"/>
<line x1="620" y1="350" x2="625" y2="350"/>
<line x1="625" y1="339" x2="625" y2="350"/>
</svg>
</div>
<p>Remote verifier can walk the chain: "Show me your hardware attestation, software measurement, and the capability you claim."</p>
<h3>Use Cases</h3>
<p>Coordinator Election (Memo-037): Candidate presents attestations proving hardware capability and identity. Voters verify before granting coordinator role.</p>
<p>Federation Trust (Memo-039): Realms exchange attestations when federating. "Before I sync objects with you, prove your software is legitimate."</p>
<p>High-Security Operations: Some capabilities might require fresh attestation: "This capability requires Anchor attestation less than 1 hour old."</p>
</section>
<section>
<h2>Hardware Token Support</h2>
<p>Future: YubiKey, secure enclaves, hardware anchors.</p>
<pre class="language-scheme">
(keystore-meta
  (version 1)
  (protection "hardware")
  (hardware-type "yubikey-5")
  (hardware-serial "12345678")
  (public-key #${...}))          ; Private key never leaves device
</pre>
<p>The private key never touches disk - it lives in the hardware token. Operations requiring signature prompt for touch.</p>
</section>
<section>
<h2>Security Considerations</h2>
<h3>What We Protect Against</h3>
<table>
<tr><th>Threat </th><th>Mitigation </th></tr>
<tr><td>Disk theft </td><td>Encrypted at rest (XChaCha20-Poly1305) </td></tr>
<tr><td>Weak passphrase </td><td>Argon2id memory-hard KDF </td></tr>
<tr><td>Brute force </td><td>Rate limiting, attempt counter </td></tr>
<tr><td>Memory dump </td><td>Zero memory after use </td></tr>
<tr><td>Forgotten passphrase </td><td>Threshold recovery shares </td></tr>
<tr><td>Key compromise </td><td>Rotation support </td></tr>
</table>
<h3>What We Don't Protect Against</h3>
<table>
<tr><th>Threat </th><th>Why </th></tr>
<tr><td>Compromised endpoint </td><td>If attacker has root, game over </td></tr>
<tr><td>Keylogger capturing passphrase </td><td>Endpoint security problem </td></tr>
<tr><td>Rubber hose cryptanalysis </td><td>Math doesn't help </td></tr>
<tr><td>Quantum computers </td><td>Ed25519 vulnerable (migration planned) </td></tr>
</table>
<h3>Memory Handling</h3>
<pre class="language-scheme">
(define (with-sensitive-data data thunk)
  "Execute thunk with sensitive data, zero on exit"
  (dynamic-wind
    (lambda () #f)
    thunk
    (lambda () (sodium-memzero! data))))
</pre>
<p>Private keys are zeroed immediately after use. Passphrases are zeroed after key derivation.</p>
</section>
<section>
<h2>REPL Commands</h2>
<pre class="language-scheme">
;; Check keystore status
(keystore-status)
;; =&gt; (keystore (status unlocked) (principal "ed25519:7f3a...") (protection passphrase))

;; Lock keystore (zero keys from memory)
(keystore-lock)
;; =&gt; Keystore locked. Re-authentication required for signing.

;; Unlock keystore
(keystore-unlock)
;; =&gt; Passphrase: 
;; =&gt; Keystore unlocked.

;; Change passphrase
(keystore-change-passphrase)
;; =&gt; Current passphrase: 
;; =&gt; New passphrase: 
;; =&gt; Confirm: 
;; =&gt; Passphrase changed.

;; Create recovery shares
(keystore-backup threshold: 2 shares: 3)

;; Recover from shares
(keystore-recover share1 share2)

;; Rotate key
(keystore-rotate)

;; Export public key (safe to share)
(keystore-export-public)
;; =&gt; (realm-public-key (algorithm "ed25519") (public-key #${7f3a...}))
</pre>
</section>
<section>
<h2>Vault Protection</h2>
<p>The keystore protects itself. The operating system is not trusted.</p>
<p>realm.key - Never stored plaintext. The ciphertext blob is meaningless without the passphrase. Even if someone copies the file, they have nothing.</p>
<p>realm.pub - Public by nature. This IS your identity. Share it freely.</p>
<p>attestations/ - Signed claims. Tamper-evident by construction. Copy them, share them - forgery is computationally infeasible.</p>
<p>The vault doesn't rely on filesystem permissions, SELinux, or any operating system mechanism. Cyberspace assumes the OS is compromised. Protection comes from:</p>
<ul>
<li>Encryption - Private key encrypted at rest</li>
<li>Memory zeroing - Keys cleared immediately after use</li>
<li>Signatures - Everything signed, tampering detected</li>
<li>Content addressing - Hash IS identity</li>
</ul>
<p>If someone has root on your machine, they can install a keylogger - that's a physical security problem, not a cryptographic one. Cyberspace protects the math. Protect the machine yourself.</p>
</section>
<section>
<h2>Integration</h2>
<h3>With seal-release (Memo-033)</h3>
<pre class="language-scheme">
(seal-release "1.0.4" name: "phoenix")
;; Uses keystore signing key automatically
;; Prompts for unlock if keystore locked
</pre>
<h3>With capabilities (Memo-004)</h3>
<pre class="language-scheme">
(spki-cert-create
  subject: "ed25519:bob..."
  tag: '(read "sha512:doc..."))
;; Signed with keystore key
;; Issuer automatically set to realm principal
</pre>
<h3>With audit (Memo-040)</h3>
<pre class="language-scheme">
;; Audit entries signed with keystore key
;; Principal identity consistent across sessions
</pre>
</section>
<section>
<h2>Invariants</h2>
<h3>Keystore</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 750 200" width="750" height="200" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">K1.</text>
<text x="40" y="10">Private</text>
<text x="120" y="10">key</text>
<text x="160" y="10">never</text>
<text x="220" y="10">stored</text>
<text x="290" y="10">plaintext</text>
<text x="40" y="30">stored(private-key)</text>
<text x="260" y="30">encrypted(private-key)</text>
<text x="0" y="50">K2.</text>
<text x="40" y="50">Decryption</text>
<text x="150" y="50">requires</text>
<text x="240" y="50">authentication</text>
<text x="40" y="70">decrypt(keystore)</text>
<text x="240" y="70">auth(passphrase)</text>
<text x="410" y="70">∨</text>
<text x="430" y="70">auth(hardware)</text>
<text x="580" y="70">∨</text>
<text x="600" y="70">auth(threshold)</text>
<text x="0" y="90">K3.</text>
<text x="40" y="90">Memory</text>
<text x="110" y="90">zeroed</text>
<text x="180" y="90">after</text>
<text x="240" y="90">use</text>
<text x="40" y="110">use(sensitive-data)</text>
<text x="260" y="110">zero(sensitive-data)</text>
<text x="0" y="130">K4.</text>
<text x="40" y="130">Rotation</text>
<text x="130" y="130">preserves</text>
<text x="230" y="130">identity</text>
<text x="320" y="130">chain</text>
<text x="40" y="150">rotate(k₁,k₂)</text>
<text x="200" y="150">signed(k₂,</text>
<text x="310" y="150">k₁)</text>
<text x="0" y="170">K5.</text>
<text x="40" y="170">Recovery</text>
<text x="130" y="170">requires</text>
<text x="220" y="170">threshold</text>
<text x="40" y="190">recover(keystore)</text>
<text x="240" y="190">shares</text>
<text x="310" y="190">≥</text>
<text x="330" y="190">k</text>
</svg>
</div>
<h3>Attestation</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 520 200" width="520" height="200" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">A1.</text>
<text x="40" y="10">Attestations</text>
<text x="170" y="10">are</text>
<text x="210" y="10">signed</text>
<text x="40" y="30">store(attestation)</text>
<text x="250" y="30">signed(attestation,</text>
<text x="450" y="30">issuer)</text>
<text x="0" y="50">A2.</text>
<text x="40" y="50">Attestation</text>
<text x="160" y="50">chains</text>
<text x="230" y="50">are</text>
<text x="270" y="50">verifiable</text>
<text x="40" y="70">chain(a₁</text>
<text x="130" y="70">a₂</text>
<text x="160" y="70">...</text>
<text x="200" y="70">aₙ)</text>
<text x="260" y="70">∀i:</text>
<text x="300" y="70">valid_sig(aᵢ)</text>
<text x="0" y="90">A3.</text>
<text x="40" y="90">Hardware</text>
<text x="130" y="90">attestations</text>
<text x="260" y="90">originate</text>
<text x="360" y="90">from</text>
<text x="410" y="90">anchors</text>
<text x="40" y="110">hardware-attestation(a)</text>
<text x="300" y="110">anchor-signed(a)</text>
<text x="0" y="130">A4.</text>
<text x="40" y="130">Attestations</text>
<text x="170" y="130">are</text>
<text x="210" y="130">timestamped</text>
<text x="40" y="150">attestation(a)</text>
<text x="210" y="150">timestamp(a)</text>
<text x="340" y="150">∧</text>
<text x="360" y="150">fresh(a,</text>
<text x="450" y="150">policy)</text>
<text x="0" y="170">A5.</text>
<text x="40" y="170">Expired</text>
<text x="120" y="170">attestations</text>
<text x="250" y="170">are</text>
<text x="290" y="170">invalid</text>
<text x="40" y="190">expired(a)</text>
<text x="170" y="190">¬valid(a)</text>
</svg>
</div>
</section>
<section>
<h2>Quantum Resistance</h2>
<p>SHA-512 won't survive. Grover's algorithm halves the security - 256 bits becomes 128. For the wilderness of mirrors to endure, we need quantum-resistant Merkle trees.</p>
<p>The Path Forward:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 630 40" width="630" height="40" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">Current:</text>
<text x="130" y="10">sha512(content)</text>
<text x="310" y="10">object</text>
<text x="380" y="10">identity</text>
<text x="0" y="30">Future:</text>
<text x="130" y="30">merkle-root(shake256(chunks...))</text>
<text x="480" y="30">object</text>
<text x="550" y="30">identity</text>
</svg>
</div>
<p>Why Merkle trees: - Incremental updates without rehashing everything - Selective disclosure - prove a branch without revealing siblings - Tree structure means log(n) proof sizes - Quantum-resistant hash at each node</p>
<p>Candidate hash functions:</p>
<table>
<tr><th>Function </th><th>Output </th><th>Notes </th></tr>
<tr><td>SHAKE256 </td><td>Variable </td><td>SHA-3 family, NIST approved, used by SPHINCS+ </td></tr>
<tr><td>BLAKE3 </td><td>256-bit </td><td>Fast, tree-based internally, modern </td></tr>
<tr><td>SHA-3-512 </td><td>512-bit </td><td>Conservative choice, different construction than SHA-2 </td></tr>
</table>
<p>Migration:</p>
<p>Objects can carry both hashes during transition:</p>
<pre class="language-scheme">
(object
  (content-hash "sha512:abc123...")           ; Legacy
  (merkle-root "shake256:def456...")          ; Quantum-resistant
  (tree-depth 4)
  (chunk-size 4096))
</pre>
<p>The soup becomes a forest of Merkle trees. Each object a tree, each tree quantum-hardened. The wilderness of mirrors, built to outlast the quantum winter.</p>
<p>Ed25519 replacement: SPHINCS+ or CRYSTALS-Dilithium for signatures. That's a separate RFC.</p>
</section>
<section>
<h2>References</h2>
<ul>
<li>libsodium documentation - Password Hashing, Secret-key Encryption</li>
<li>Argon2 specification - https://github.com/P-H-C/phc-winner-argon2</li>
<li>Shamir's Secret Sharing - Shamir, A., "How to Share a Secret", 1979</li>
<li>Memo-008 - Threshold Governance</li>
<li>Memo-040 - Cyberspace Security Architecture</li>
</ul>
</section>
<section>
<h2>Changelog</h2>
<ul>
<li>2026-01-08</li>
<li>Initial draft</li>
</ul>
</section>
<script>
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
}
(function() {
  // Query param override (for REPL: ?theme=dark or ?theme=light)
  const params = new URLSearchParams(window.location.search);
  const param = params.get('theme');
  if (param === 'dark' || param === 'light') {
    document.documentElement.setAttribute('data-theme', param);
    localStorage.setItem('theme', param);
    return;
  }
  // localStorage preference
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
  } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', 'light');
  }
})();
</script>
</body>
</html>
