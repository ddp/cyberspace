<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <title>Memo 0046: Realm Keystore and Attestation</title>
  <link rel="icon" id="favicon" href="data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27%230f0%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>">
  <script>
(function(){
  var h=new Date().getHours(),c;
  if(h>=4&&h<6)c='%23845EC2';       // brahma muhurta - violet
  else if(h>=6&&h<8)c='%23ffd700';  // dawn - gold
  else if(h>=8&&h<11)c='%2300d4aa'; // morning - teal
  else if(h>=11&&h<14)c='%230f0';   // midday - phosphor
  else if(h>=14&&h<17)c='%2339ff14';// afternoon - neon
  else if(h>=17&&h<19)c='%23ff6600';// sunset - orange
  else if(h>=19&&h<22)c='%23ff3366';// evening - coral
  else c='%2300ffff';               // night - cyan
  document.getElementById('favicon').href='data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27'+c+'%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>';
})();
</script>
  <link rel="stylesheet" href="memo.css">
</head>
<body>
<span class="theme-toggle" onclick="toggleTheme()" title="Toggle light/dark">[theme]</span>
<h1>Memo 0046: Realm Keystore and Attestation</h1>
<dl class="metadata">
</dl>
<hr>
<section>
<h2>Abstract</h2>
<p>A realm without identity is not sovereign. This Memo defines two protected stores within the vault:</p>
<ul>
<li>Keystore - where cryptographic identity lives (Ed25519 signing keys)</li>
<li>Attestation Store - where proofs about the realm live (hardware, software, identity claims)</li>
</ul>
<p>Together they form the inner vault - the protected core of a realm. Keys prove who you are. Attestations prove what you are.</p>
</section>
<section>
<h2>Motivation</h2>
<p>Memo-040 established that capabilities flow from Ed25519 signatures. Every certificate, every sealed release, every audit entry requires a signature. But where does the signing key live?</p>
<p>Currently: ephemeral, generated per session. This is fine for testing but broken for production. A realm needs:</p>
<ul>
<li>Persistent identity - the same principal across sessions</li>
<li>Protected storage - keys encrypted at rest</li>
<li>Recovery path - don't lose your realm to a forgotten passphrase</li>
<li>Rotation support - keys age, compromise happens</li>
</ul>
<p>A realm without persistent identity cannot accumulate trust, cannot be referenced by peers, and loses all context on restart. The keystore provides the cryptographic continuity that makes realm sovereignty meaningful.</p>
</section>
<section>
<h2>Realm Continuity</h2>
<p>A realm is not a snapshot. It accumulates.</p>
<p>Identity continuity - Your principal persists across sessions, machines, years. Key rotation creates a signed chain: each new key vouched for by the old. The chain IS your history.</p>
<p>Context accumulation - Every capability granted, every object stored, every federation established - these form the realm's memory. The audit chain records what happened. The attestation store proves what you were at each moment.</p>
<p>History matters - A realm that has existed for ten years, rotated keys three times, accumulated thousands of attestations, federated with hundreds of peers - this realm has weight. Trust accrues. Reputation emerges from the chain.</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 680 220" width="680" height="220" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<line x1="5" y1="10" x2="10" y2="10"/>
<line x1="5" y1="10" x2="5" y2="21"/>
<line x1="10" y1="10" x2="20" y2="10"/>
<line x1="20" y1="10" x2="30" y2="10"/>
<line x1="30" y1="10" x2="40" y2="10"/>
<line x1="40" y1="10" x2="50" y2="10"/>
<line x1="50" y1="10" x2="60" y2="10"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="160" y2="10"/>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="180" y2="10"/>
<line x1="180" y1="10" x2="190" y2="10"/>
<line x1="190" y1="10" x2="200" y2="10"/>
<line x1="200" y1="10" x2="210" y2="10"/>
<line x1="210" y1="10" x2="220" y2="10"/>
<line x1="220" y1="10" x2="230" y2="10"/>
<line x1="230" y1="10" x2="240" y2="10"/>
<line x1="240" y1="10" x2="250" y2="10"/>
<line x1="250" y1="10" x2="260" y2="10"/>
<line x1="260" y1="10" x2="270" y2="10"/>
<line x1="270" y1="10" x2="280" y2="10"/>
<line x1="280" y1="10" x2="290" y2="10"/>
<line x1="290" y1="10" x2="300" y2="10"/>
<line x1="300" y1="10" x2="310" y2="10"/>
<line x1="310" y1="10" x2="320" y2="10"/>
<line x1="320" y1="10" x2="330" y2="10"/>
<line x1="330" y1="10" x2="340" y2="10"/>
<line x1="340" y1="10" x2="350" y2="10"/>
<line x1="350" y1="10" x2="360" y2="10"/>
<line x1="360" y1="10" x2="370" y2="10"/>
<line x1="370" y1="10" x2="380" y2="10"/>
<line x1="380" y1="10" x2="390" y2="10"/>
<line x1="390" y1="10" x2="400" y2="10"/>
<line x1="400" y1="10" x2="410" y2="10"/>
<line x1="410" y1="10" x2="420" y2="10"/>
<line x1="420" y1="10" x2="430" y2="10"/>
<line x1="430" y1="10" x2="440" y2="10"/>
<line x1="440" y1="10" x2="450" y2="10"/>
<line x1="450" y1="10" x2="460" y2="10"/>
<line x1="460" y1="10" x2="470" y2="10"/>
<line x1="470" y1="10" x2="480" y2="10"/>
<line x1="480" y1="10" x2="490" y2="10"/>
<line x1="490" y1="10" x2="500" y2="10"/>
<line x1="500" y1="10" x2="510" y2="10"/>
<line x1="510" y1="10" x2="520" y2="10"/>
<line x1="520" y1="10" x2="530" y2="10"/>
<line x1="530" y1="10" x2="540" y2="10"/>
<line x1="540" y1="10" x2="550" y2="10"/>
<line x1="550" y1="10" x2="560" y2="10"/>
<line x1="560" y1="10" x2="570" y2="10"/>
<line x1="570" y1="10" x2="580" y2="10"/>
<line x1="580" y1="10" x2="590" y2="10"/>
<line x1="590" y1="10" x2="600" y2="10"/>
<line x1="600" y1="10" x2="610" y2="10"/>
<line x1="610" y1="10" x2="620" y2="10"/>
<line x1="620" y1="10" x2="630" y2="10"/>
<line x1="630" y1="10" x2="640" y2="10"/>
<line x1="640" y1="10" x2="650" y2="10"/>
<line x1="650" y1="10" x2="660" y2="10"/>
<line x1="670" y1="10" x2="675" y2="10"/>
<line x1="675" y1="10" x2="675" y2="21"/>
<line x1="5" y1="19" x2="5" y2="41"/>
<text x="255" y="30">R</text>
<text x="265" y="30">E</text>
<text x="275" y="30">A</text>
<text x="285" y="30">L</text>
<text x="295" y="30">M</text>
<text x="315" y="30">T</text>
<text x="325" y="30">I</text>
<text x="335" y="30">M</text>
<text x="345" y="30">E</text>
<text x="355" y="30">L</text>
<text x="365" y="30">I</text>
<text x="375" y="30">N</text>
<text x="385" y="30">E</text>
<line x1="675" y1="19" x2="675" y2="41"/>
<line x1="5" y1="39" x2="5" y2="61"/>
<line x1="5" y1="50" x2="10" y2="50"/>
<line x1="10" y1="50" x2="20" y2="50"/>
<line x1="20" y1="50" x2="30" y2="50"/>
<line x1="30" y1="50" x2="40" y2="50"/>
<line x1="40" y1="50" x2="50" y2="50"/>
<line x1="50" y1="50" x2="60" y2="50"/>
<line x1="60" y1="50" x2="70" y2="50"/>
<line x1="70" y1="50" x2="80" y2="50"/>
<line x1="80" y1="50" x2="90" y2="50"/>
<line x1="90" y1="50" x2="100" y2="50"/>
<line x1="100" y1="50" x2="110" y2="50"/>
<line x1="110" y1="50" x2="120" y2="50"/>
<line x1="120" y1="50" x2="130" y2="50"/>
<line x1="130" y1="50" x2="140" y2="50"/>
<line x1="140" y1="50" x2="150" y2="50"/>
<line x1="150" y1="50" x2="160" y2="50"/>
<line x1="160" y1="50" x2="170" y2="50"/>
<line x1="170" y1="50" x2="180" y2="50"/>
<line x1="180" y1="50" x2="190" y2="50"/>
<line x1="190" y1="50" x2="200" y2="50"/>
<line x1="200" y1="50" x2="210" y2="50"/>
<line x1="210" y1="50" x2="220" y2="50"/>
<line x1="220" y1="50" x2="230" y2="50"/>
<line x1="230" y1="50" x2="240" y2="50"/>
<line x1="240" y1="50" x2="250" y2="50"/>
<line x1="250" y1="50" x2="260" y2="50"/>
<line x1="260" y1="50" x2="270" y2="50"/>
<line x1="270" y1="50" x2="280" y2="50"/>
<line x1="280" y1="50" x2="290" y2="50"/>
<line x1="290" y1="50" x2="300" y2="50"/>
<line x1="300" y1="50" x2="310" y2="50"/>
<line x1="310" y1="50" x2="320" y2="50"/>
<line x1="320" y1="50" x2="330" y2="50"/>
<line x1="330" y1="50" x2="340" y2="50"/>
<line x1="340" y1="50" x2="350" y2="50"/>
<line x1="350" y1="50" x2="360" y2="50"/>
<line x1="360" y1="50" x2="370" y2="50"/>
<line x1="370" y1="50" x2="380" y2="50"/>
<line x1="380" y1="50" x2="390" y2="50"/>
<line x1="390" y1="50" x2="400" y2="50"/>
<line x1="400" y1="50" x2="410" y2="50"/>
<line x1="410" y1="50" x2="420" y2="50"/>
<line x1="420" y1="50" x2="430" y2="50"/>
<line x1="430" y1="50" x2="440" y2="50"/>
<line x1="440" y1="50" x2="450" y2="50"/>
<line x1="450" y1="50" x2="460" y2="50"/>
<line x1="460" y1="50" x2="470" y2="50"/>
<line x1="470" y1="50" x2="480" y2="50"/>
<line x1="480" y1="50" x2="490" y2="50"/>
<line x1="490" y1="50" x2="500" y2="50"/>
<line x1="500" y1="50" x2="510" y2="50"/>
<line x1="510" y1="50" x2="520" y2="50"/>
<line x1="520" y1="50" x2="530" y2="50"/>
<line x1="530" y1="50" x2="540" y2="50"/>
<line x1="540" y1="50" x2="550" y2="50"/>
<line x1="550" y1="50" x2="560" y2="50"/>
<line x1="560" y1="50" x2="570" y2="50"/>
<line x1="570" y1="50" x2="580" y2="50"/>
<line x1="580" y1="50" x2="590" y2="50"/>
<line x1="590" y1="50" x2="600" y2="50"/>
<line x1="600" y1="50" x2="610" y2="50"/>
<line x1="610" y1="50" x2="620" y2="50"/>
<line x1="620" y1="50" x2="630" y2="50"/>
<line x1="630" y1="50" x2="640" y2="50"/>
<line x1="640" y1="50" x2="650" y2="50"/>
<line x1="650" y1="50" x2="660" y2="50"/>
<line x1="675" y1="39" x2="675" y2="61"/>
<line x1="670" y1="50" x2="675" y2="50"/>
<line x1="5" y1="59" x2="5" y2="81"/>
<line x1="675" y1="59" x2="675" y2="81"/>
<line x1="5" y1="79" x2="5" y2="101"/>
<text x="35" y="90">G</text>
<text x="45" y="90">e</text>
<text x="55" y="90">n</text>
<text x="65" y="90">e</text>
<text x="75" y="90">s</text>
<text x="85" y="90">i</text>
<text x="95" y="90">s</text>
<line x1="110" y1="90" x2="120" y2="90"/>
<line x1="120" y1="90" x2="130" y2="90"/>
<text x="135" y="90">→</text>
<text x="155" y="90">K</text>
<text x="165" y="90">e</text>
<text x="175" y="90">y</text>
<text x="185" y="90">₁</text>
<line x1="200" y1="90" x2="210" y2="90"/>
<line x1="210" y1="90" x2="220" y2="90"/>
<text x="225" y="90">→</text>
<text x="245" y="90">K</text>
<text x="255" y="90">e</text>
<text x="265" y="90">y</text>
<text x="275" y="90">₂</text>
<line x1="290" y1="90" x2="300" y2="90"/>
<line x1="300" y1="90" x2="310" y2="90"/>
<text x="315" y="90">→</text>
<text x="335" y="90">K</text>
<text x="345" y="90">e</text>
<text x="355" y="90">y</text>
<text x="365" y="90">₃</text>
<line x1="380" y1="90" x2="390" y2="90"/>
<line x1="390" y1="90" x2="400" y2="90"/>
<text x="405" y="90">→</text>
<text x="425" y="90">.</text>
<text x="435" y="90">.</text>
<text x="445" y="90">.</text>
<line x1="460" y1="90" x2="470" y2="90"/>
<line x1="470" y1="90" x2="480" y2="90"/>
<text x="485" y="90">→</text>
<text x="505" y="90">C</text>
<text x="515" y="90">u</text>
<text x="525" y="90">r</text>
<text x="535" y="90">r</text>
<text x="545" y="90">e</text>
<text x="555" y="90">n</text>
<text x="565" y="90">t</text>
<line x1="675" y1="79" x2="675" y2="101"/>
<line x1="5" y1="99" x2="5" y2="121"/>
<line x1="65" y1="99" x2="65" y2="121"/>
<line x1="175" y1="99" x2="175" y2="121"/>
<line x1="265" y1="99" x2="265" y2="121"/>
<line x1="355" y1="99" x2="355" y2="121"/>
<line x1="555" y1="99" x2="555" y2="121"/>
<line x1="675" y1="99" x2="675" y2="121"/>
<line x1="5" y1="119" x2="5" y2="141"/>
<text x="65" y="130">↓</text>
<text x="175" y="130">↓</text>
<text x="265" y="130">↓</text>
<text x="355" y="130">↓</text>
<text x="555" y="130">↓</text>
<line x1="675" y1="119" x2="675" y2="141"/>
<line x1="5" y1="139" x2="5" y2="161"/>
<text x="35" y="150">[</text>
<text x="45" y="150">a</text>
<text x="55" y="150">t</text>
<text x="65" y="150">t</text>
<text x="75" y="150">₀</text>
<text x="85" y="150">]</text>
<text x="135" y="150">[</text>
<text x="145" y="150">a</text>
<text x="155" y="150">t</text>
<text x="165" y="150">t</text>
<text x="175" y="150">₁</text>
<text x="185" y="150">₋</text>
<text x="195" y="150">₁</text>
<text x="205" y="150">₀</text>
<text x="215" y="150">]</text>
<text x="235" y="150">[</text>
<text x="245" y="150">a</text>
<text x="255" y="150">t</text>
<text x="265" y="150">t</text>
<text x="275" y="150">₁</text>
<text x="285" y="150">₁</text>
<text x="295" y="150">₋</text>
<text x="305" y="150">₅</text>
<text x="315" y="150">₀</text>
<text x="325" y="150">]</text>
<text x="345" y="150">[</text>
<text x="355" y="150">a</text>
<text x="365" y="150">t</text>
<text x="375" y="150">t</text>
<text x="385" y="150">₅</text>
<text x="395" y="150">₁</text>
<text x="405" y="150">₋</text>
<text x="415" y="150">₁</text>
<text x="425" y="150">₀</text>
<text x="435" y="150">₀</text>
<text x="445" y="150">]</text>
<text x="495" y="150">[</text>
<text x="505" y="150">a</text>
<text x="515" y="150">t</text>
<text x="525" y="150">t</text>
<text x="535" y="150">_</text>
<text x="545" y="150">n</text>
<text x="555" y="150">]</text>
<line x1="675" y1="139" x2="675" y2="161"/>
<line x1="5" y1="159" x2="5" y2="181"/>
<line x1="675" y1="159" x2="675" y2="181"/>
<line x1="5" y1="179" x2="5" y2="201"/>
<text x="35" y="190">C</text>
<text x="45" y="190">o</text>
<text x="55" y="190">n</text>
<text x="65" y="190">t</text>
<text x="75" y="190">e</text>
<text x="85" y="190">x</text>
<text x="95" y="190">t</text>
<text x="115" y="190">g</text>
<text x="125" y="190">r</text>
<text x="135" y="190">o</text>
<text x="145" y="190">w</text>
<text x="155" y="190">s</text>
<text x="165" y="190">.</text>
<text x="185" y="190">H</text>
<text x="195" y="190">i</text>
<text x="205" y="190">s</text>
<text x="215" y="190">t</text>
<text x="225" y="190">o</text>
<text x="235" y="190">r</text>
<text x="245" y="190">y</text>
<text x="265" y="190">d</text>
<text x="275" y="190">e</text>
<text x="285" y="190">e</text>
<text x="295" y="190">p</text>
<text x="305" y="190">e</text>
<text x="315" y="190">n</text>
<text x="325" y="190">s</text>
<text x="335" y="190">.</text>
<text x="355" y="190">T</text>
<text x="365" y="190">r</text>
<text x="375" y="190">u</text>
<text x="385" y="190">s</text>
<text x="395" y="190">t</text>
<text x="415" y="190">a</text>
<text x="425" y="190">c</text>
<text x="435" y="190">c</text>
<text x="445" y="190">u</text>
<text x="455" y="190">m</text>
<text x="465" y="190">u</text>
<text x="475" y="190">l</text>
<text x="485" y="190">a</text>
<text x="495" y="190">t</text>
<text x="505" y="190">e</text>
<text x="515" y="190">s</text>
<text x="525" y="190">.</text>
<line x1="675" y1="179" x2="675" y2="201"/>
<line x1="5" y1="210" x2="10" y2="210"/>
<line x1="5" y1="199" x2="5" y2="210"/>
<line x1="10" y1="210" x2="20" y2="210"/>
<line x1="20" y1="210" x2="30" y2="210"/>
<line x1="30" y1="210" x2="40" y2="210"/>
<line x1="40" y1="210" x2="50" y2="210"/>
<line x1="50" y1="210" x2="60" y2="210"/>
<line x1="60" y1="210" x2="70" y2="210"/>
<line x1="70" y1="210" x2="80" y2="210"/>
<line x1="80" y1="210" x2="90" y2="210"/>
<line x1="90" y1="210" x2="100" y2="210"/>
<line x1="100" y1="210" x2="110" y2="210"/>
<line x1="110" y1="210" x2="120" y2="210"/>
<line x1="120" y1="210" x2="130" y2="210"/>
<line x1="130" y1="210" x2="140" y2="210"/>
<line x1="140" y1="210" x2="150" y2="210"/>
<line x1="150" y1="210" x2="160" y2="210"/>
<line x1="160" y1="210" x2="170" y2="210"/>
<line x1="170" y1="210" x2="180" y2="210"/>
<line x1="180" y1="210" x2="190" y2="210"/>
<line x1="190" y1="210" x2="200" y2="210"/>
<line x1="200" y1="210" x2="210" y2="210"/>
<line x1="210" y1="210" x2="220" y2="210"/>
<line x1="220" y1="210" x2="230" y2="210"/>
<line x1="230" y1="210" x2="240" y2="210"/>
<line x1="240" y1="210" x2="250" y2="210"/>
<line x1="250" y1="210" x2="260" y2="210"/>
<line x1="260" y1="210" x2="270" y2="210"/>
<line x1="270" y1="210" x2="280" y2="210"/>
<line x1="280" y1="210" x2="290" y2="210"/>
<line x1="290" y1="210" x2="300" y2="210"/>
<line x1="300" y1="210" x2="310" y2="210"/>
<line x1="310" y1="210" x2="320" y2="210"/>
<line x1="320" y1="210" x2="330" y2="210"/>
<line x1="330" y1="210" x2="340" y2="210"/>
<line x1="340" y1="210" x2="350" y2="210"/>
<line x1="350" y1="210" x2="360" y2="210"/>
<line x1="360" y1="210" x2="370" y2="210"/>
<line x1="370" y1="210" x2="380" y2="210"/>
<line x1="380" y1="210" x2="390" y2="210"/>
<line x1="390" y1="210" x2="400" y2="210"/>
<line x1="400" y1="210" x2="410" y2="210"/>
<line x1="410" y1="210" x2="420" y2="210"/>
<line x1="420" y1="210" x2="430" y2="210"/>
<line x1="430" y1="210" x2="440" y2="210"/>
<line x1="440" y1="210" x2="450" y2="210"/>
<line x1="450" y1="210" x2="460" y2="210"/>
<line x1="460" y1="210" x2="470" y2="210"/>
<line x1="470" y1="210" x2="480" y2="210"/>
<line x1="480" y1="210" x2="490" y2="210"/>
<line x1="490" y1="210" x2="500" y2="210"/>
<line x1="500" y1="210" x2="510" y2="210"/>
<line x1="510" y1="210" x2="520" y2="210"/>
<line x1="520" y1="210" x2="530" y2="210"/>
<line x1="530" y1="210" x2="540" y2="210"/>
<line x1="540" y1="210" x2="550" y2="210"/>
<line x1="550" y1="210" x2="560" y2="210"/>
<line x1="560" y1="210" x2="570" y2="210"/>
<line x1="570" y1="210" x2="580" y2="210"/>
<line x1="580" y1="210" x2="590" y2="210"/>
<line x1="590" y1="210" x2="600" y2="210"/>
<line x1="600" y1="210" x2="610" y2="210"/>
<line x1="610" y1="210" x2="620" y2="210"/>
<line x1="620" y1="210" x2="630" y2="210"/>
<line x1="630" y1="210" x2="640" y2="210"/>
<line x1="640" y1="210" x2="650" y2="210"/>
<line x1="650" y1="210" x2="660" y2="210"/>
<line x1="670" y1="210" x2="675" y2="210"/>
<line x1="675" y1="199" x2="675" y2="210"/>
</svg>
</div>
<p>The inner vault preserves this continuity: - Keystore - the chain of identity - Attestations - the record of what you were - Audit - the log of what you did</p>
<p>A realm without history is newborn. A realm with history has standing.</p>
<h3>The Sealed Closure</h3>
<p>A realm is a sealed closure - it closes over its environment and that closure is cryptographically bound.</p>
<pre class="language-scheme">
;; The realm as closure
(lambda (request)
  ;; Closed over:
  ;;   - genesis: the first key, the origin moment
  ;;   - keychain: every rotation, signed by predecessor
  ;;   - attestations: every proof of what we were
  ;;   - audit: every action taken
  ;;   - capabilities: every right we hold
  ;;   - objects: every thing we store
  ;;
  ;; The closure is sealed:
  ;;   - Hash-chained: tamper-evident
  ;;   - Signed: non-repudiable
  ;;   - Content-addressed: self-verifying
  ;;
  (verify-and-respond request))
</pre>
<p>You cannot forge a realm. You cannot inject false history. You cannot claim attestations you don't have. The closure is sealed at every point - verify any moment, the chain holds or it doesn't.</p>
<p>Import a realm? You import the entire closure - genesis to present.</p>
<p>Fork a realm? You create a new closure that references the old. The fork point is signed.</p>
<p>Merge realms? The histories must be compatible. Conflicts are visible.</p>
<p>The sealed closure is the unit of trust in cyberspace.</p>
<h3>Living in the Soup</h3>
<p>The sealed closure doesn't exist in a vacuum - it lives in the soup.</p>
<p>The soup is the medium. Objects float in it - content-addressed, immutable, queryable. The realm swims through the soup, accumulating objects, granting capabilities, leaving audit trails. Everything the realm touches becomes part of its context.</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 680 260" width="680" height="260" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<line x1="5" y1="10" x2="10" y2="10"/>
<line x1="5" y1="10" x2="5" y2="21"/>
<line x1="10" y1="10" x2="20" y2="10"/>
<line x1="20" y1="10" x2="30" y2="10"/>
<line x1="30" y1="10" x2="40" y2="10"/>
<line x1="40" y1="10" x2="50" y2="10"/>
<line x1="50" y1="10" x2="60" y2="10"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="160" y2="10"/>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="180" y2="10"/>
<line x1="180" y1="10" x2="190" y2="10"/>
<line x1="190" y1="10" x2="200" y2="10"/>
<line x1="200" y1="10" x2="210" y2="10"/>
<line x1="210" y1="10" x2="220" y2="10"/>
<line x1="220" y1="10" x2="230" y2="10"/>
<line x1="230" y1="10" x2="240" y2="10"/>
<line x1="240" y1="10" x2="250" y2="10"/>
<line x1="250" y1="10" x2="260" y2="10"/>
<line x1="260" y1="10" x2="270" y2="10"/>
<line x1="270" y1="10" x2="280" y2="10"/>
<line x1="280" y1="10" x2="290" y2="10"/>
<line x1="290" y1="10" x2="300" y2="10"/>
<line x1="300" y1="10" x2="310" y2="10"/>
<line x1="310" y1="10" x2="320" y2="10"/>
<line x1="320" y1="10" x2="330" y2="10"/>
<line x1="330" y1="10" x2="340" y2="10"/>
<line x1="340" y1="10" x2="350" y2="10"/>
<line x1="350" y1="10" x2="360" y2="10"/>
<line x1="360" y1="10" x2="370" y2="10"/>
<line x1="370" y1="10" x2="380" y2="10"/>
<line x1="380" y1="10" x2="390" y2="10"/>
<line x1="390" y1="10" x2="400" y2="10"/>
<line x1="400" y1="10" x2="410" y2="10"/>
<line x1="410" y1="10" x2="420" y2="10"/>
<line x1="420" y1="10" x2="430" y2="10"/>
<line x1="430" y1="10" x2="440" y2="10"/>
<line x1="440" y1="10" x2="450" y2="10"/>
<line x1="450" y1="10" x2="460" y2="10"/>
<line x1="460" y1="10" x2="470" y2="10"/>
<line x1="470" y1="10" x2="480" y2="10"/>
<line x1="480" y1="10" x2="490" y2="10"/>
<line x1="490" y1="10" x2="500" y2="10"/>
<line x1="500" y1="10" x2="510" y2="10"/>
<line x1="510" y1="10" x2="520" y2="10"/>
<line x1="520" y1="10" x2="530" y2="10"/>
<line x1="530" y1="10" x2="540" y2="10"/>
<line x1="540" y1="10" x2="550" y2="10"/>
<line x1="550" y1="10" x2="560" y2="10"/>
<line x1="560" y1="10" x2="570" y2="10"/>
<line x1="570" y1="10" x2="580" y2="10"/>
<line x1="580" y1="10" x2="590" y2="10"/>
<line x1="590" y1="10" x2="600" y2="10"/>
<line x1="600" y1="10" x2="610" y2="10"/>
<line x1="610" y1="10" x2="620" y2="10"/>
<line x1="620" y1="10" x2="630" y2="10"/>
<line x1="630" y1="10" x2="640" y2="10"/>
<line x1="640" y1="10" x2="650" y2="10"/>
<line x1="650" y1="10" x2="660" y2="10"/>
<line x1="670" y1="10" x2="675" y2="10"/>
<line x1="675" y1="10" x2="675" y2="21"/>
<line x1="5" y1="19" x2="5" y2="41"/>
<text x="275" y="30">T</text>
<text x="285" y="30">H</text>
<text x="295" y="30">E</text>
<text x="315" y="30">S</text>
<text x="325" y="30">O</text>
<text x="335" y="30">U</text>
<text x="345" y="30">P</text>
<line x1="675" y1="19" x2="675" y2="41"/>
<line x1="5" y1="39" x2="5" y2="61"/>
<line x1="675" y1="39" x2="675" y2="61"/>
<line x1="5" y1="59" x2="5" y2="81"/>
<text x="65" y="70">○</text>
<text x="85" y="70">o</text>
<text x="95" y="70">b</text>
<text x="105" y="70">j</text>
<text x="155" y="70">○</text>
<text x="175" y="70">o</text>
<text x="185" y="70">b</text>
<text x="195" y="70">j</text>
<line x1="275" y1="70" x2="280" y2="70"/>
<line x1="275" y1="70" x2="275" y2="81"/>
<line x1="280" y1="70" x2="290" y2="70"/>
<line x1="290" y1="70" x2="300" y2="70"/>
<line x1="300" y1="70" x2="310" y2="70"/>
<line x1="310" y1="70" x2="320" y2="70"/>
<line x1="320" y1="70" x2="330" y2="70"/>
<line x1="330" y1="70" x2="340" y2="70"/>
<line x1="340" y1="70" x2="350" y2="70"/>
<line x1="350" y1="70" x2="360" y2="70"/>
<line x1="360" y1="70" x2="370" y2="70"/>
<line x1="370" y1="70" x2="380" y2="70"/>
<line x1="380" y1="70" x2="390" y2="70"/>
<line x1="390" y1="70" x2="400" y2="70"/>
<line x1="400" y1="70" x2="410" y2="70"/>
<line x1="410" y1="70" x2="420" y2="70"/>
<line x1="420" y1="70" x2="430" y2="70"/>
<line x1="430" y1="70" x2="440" y2="70"/>
<line x1="440" y1="70" x2="450" y2="70"/>
<line x1="450" y1="70" x2="455" y2="70"/>
<line x1="455" y1="70" x2="455" y2="81"/>
<text x="525" y="70">○</text>
<text x="545" y="70">o</text>
<text x="555" y="70">b</text>
<text x="565" y="70">j</text>
<line x1="675" y1="59" x2="675" y2="81"/>
<line x1="5" y1="79" x2="5" y2="101"/>
<text x="115" y="90">○</text>
<text x="135" y="90">o</text>
<text x="145" y="90">b</text>
<text x="155" y="90">j</text>
<line x1="275" y1="79" x2="275" y2="101"/>
<line x1="455" y1="79" x2="455" y2="101"/>
<text x="575" y="90">○</text>
<text x="595" y="90">o</text>
<text x="605" y="90">b</text>
<text x="615" y="90">j</text>
<line x1="675" y1="79" x2="675" y2="101"/>
<line x1="5" y1="99" x2="5" y2="121"/>
<text x="55" y="110">○</text>
<text x="75" y="110">o</text>
<text x="85" y="110">b</text>
<text x="95" y="110">j</text>
<text x="205" y="110">○</text>
<text x="225" y="110">o</text>
<text x="235" y="110">b</text>
<text x="245" y="110">j</text>
<line x1="275" y1="99" x2="275" y2="121"/>
<text x="335" y="110">R</text>
<text x="345" y="110">E</text>
<text x="355" y="110">A</text>
<text x="365" y="110">L</text>
<text x="375" y="110">M</text>
<line x1="455" y1="99" x2="455" y2="121"/>
<text x="505" y="110">○</text>
<text x="525" y="110">o</text>
<text x="535" y="110">b</text>
<text x="545" y="110">j</text>
<line x1="675" y1="99" x2="675" y2="121"/>
<line x1="5" y1="119" x2="5" y2="141"/>
<text x="105" y="130">○</text>
<text x="125" y="130">o</text>
<text x="135" y="130">b</text>
<text x="145" y="130">j</text>
<line x1="275" y1="119" x2="275" y2="141"/>
<text x="325" y="130">(</text>
<text x="335" y="130">i</text>
<text x="345" y="130">s</text>
<text x="355" y="130">l</text>
<text x="365" y="130">a</text>
<text x="375" y="130">n</text>
<text x="385" y="130">d</text>
<text x="395" y="130">)</text>
<line x1="455" y1="119" x2="455" y2="141"/>
<text x="555" y="130">○</text>
<text x="575" y="130">o</text>
<text x="585" y="130">b</text>
<text x="595" y="130">j</text>
<line x1="675" y1="119" x2="675" y2="141"/>
<line x1="5" y1="139" x2="5" y2="161"/>
<text x="45" y="150">○</text>
<text x="65" y="150">o</text>
<text x="75" y="150">b</text>
<text x="85" y="150">j</text>
<text x="165" y="150">○</text>
<text x="185" y="150">o</text>
<text x="195" y="150">b</text>
<text x="205" y="150">j</text>
<line x1="275" y1="139" x2="275" y2="161"/>
<line x1="455" y1="139" x2="455" y2="161"/>
<text x="485" y="150">○</text>
<text x="505" y="150">o</text>
<text x="515" y="150">b</text>
<text x="525" y="150">j</text>
<line x1="675" y1="139" x2="675" y2="161"/>
<line x1="5" y1="159" x2="5" y2="181"/>
<text x="95" y="170">○</text>
<text x="115" y="170">o</text>
<text x="125" y="170">b</text>
<text x="135" y="170">j</text>
<line x1="275" y1="170" x2="280" y2="170"/>
<line x1="275" y1="159" x2="275" y2="170"/>
<line x1="280" y1="170" x2="290" y2="170"/>
<line x1="290" y1="170" x2="300" y2="170"/>
<line x1="300" y1="170" x2="310" y2="170"/>
<line x1="310" y1="170" x2="320" y2="170"/>
<line x1="320" y1="170" x2="330" y2="170"/>
<line x1="330" y1="170" x2="340" y2="170"/>
<line x1="340" y1="170" x2="350" y2="170"/>
<line x1="350" y1="170" x2="360" y2="170"/>
<line x1="360" y1="170" x2="370" y2="170"/>
<line x1="370" y1="170" x2="380" y2="170"/>
<line x1="380" y1="170" x2="390" y2="170"/>
<line x1="390" y1="170" x2="400" y2="170"/>
<line x1="400" y1="170" x2="410" y2="170"/>
<line x1="410" y1="170" x2="420" y2="170"/>
<line x1="420" y1="170" x2="430" y2="170"/>
<line x1="430" y1="170" x2="440" y2="170"/>
<line x1="440" y1="170" x2="450" y2="170"/>
<line x1="450" y1="170" x2="455" y2="170"/>
<line x1="455" y1="159" x2="455" y2="170"/>
<text x="535" y="170">○</text>
<text x="555" y="170">o</text>
<text x="565" y="170">b</text>
<text x="575" y="170">j</text>
<line x1="675" y1="159" x2="675" y2="181"/>
<line x1="5" y1="179" x2="5" y2="201"/>
<text x="45" y="190">○</text>
<text x="65" y="190">o</text>
<text x="75" y="190">b</text>
<text x="85" y="190">j</text>
<text x="135" y="190">○</text>
<text x="155" y="190">o</text>
<text x="165" y="190">b</text>
<text x="175" y="190">j</text>
<text x="235" y="190">○</text>
<text x="255" y="190">o</text>
<text x="265" y="190">b</text>
<text x="275" y="190">j</text>
<text x="395" y="190">○</text>
<text x="415" y="190">o</text>
<text x="425" y="190">b</text>
<text x="435" y="190">j</text>
<text x="485" y="190">○</text>
<text x="505" y="190">o</text>
<text x="515" y="190">b</text>
<text x="525" y="190">j</text>
<line x1="675" y1="179" x2="675" y2="201"/>
<line x1="5" y1="199" x2="5" y2="221"/>
<line x1="675" y1="199" x2="675" y2="221"/>
<line x1="5" y1="219" x2="5" y2="241"/>
<text x="45" y="230">O</text>
<text x="55" y="230">b</text>
<text x="65" y="230">j</text>
<text x="75" y="230">e</text>
<text x="85" y="230">c</text>
<text x="95" y="230">t</text>
<text x="105" y="230">s</text>
<text x="125" y="230">f</text>
<text x="135" y="230">l</text>
<text x="145" y="230">o</text>
<text x="155" y="230">a</text>
<text x="165" y="230">t</text>
<text x="175" y="230">.</text>
<text x="195" y="230">T</text>
<text x="205" y="230">h</text>
<text x="215" y="230">e</text>
<text x="235" y="230">r</text>
<text x="245" y="230">e</text>
<text x="255" y="230">a</text>
<text x="265" y="230">l</text>
<text x="275" y="230">m</text>
<text x="295" y="230">i</text>
<text x="305" y="230">s</text>
<text x="325" y="230">s</text>
<text x="335" y="230">o</text>
<text x="345" y="230">v</text>
<text x="355" y="230">e</text>
<text x="365" y="230">r</text>
<text x="375" y="230">e</text>
<text x="385" y="230">i</text>
<text x="395" y="230">g</text>
<text x="405" y="230">n</text>
<text x="425" y="230">t</text>
<text x="435" y="230">e</text>
<text x="445" y="230">r</text>
<text x="455" y="230">r</text>
<text x="465" y="230">i</text>
<text x="475" y="230">t</text>
<text x="485" y="230">o</text>
<text x="495" y="230">r</text>
<text x="505" y="230">y</text>
<text x="515" y="230">.</text>
<line x1="675" y1="219" x2="675" y2="241"/>
<line x1="5" y1="250" x2="10" y2="250"/>
<line x1="5" y1="239" x2="5" y2="250"/>
<line x1="10" y1="250" x2="20" y2="250"/>
<line x1="20" y1="250" x2="30" y2="250"/>
<line x1="30" y1="250" x2="40" y2="250"/>
<line x1="40" y1="250" x2="50" y2="250"/>
<line x1="50" y1="250" x2="60" y2="250"/>
<line x1="60" y1="250" x2="70" y2="250"/>
<line x1="70" y1="250" x2="80" y2="250"/>
<line x1="80" y1="250" x2="90" y2="250"/>
<line x1="90" y1="250" x2="100" y2="250"/>
<line x1="100" y1="250" x2="110" y2="250"/>
<line x1="110" y1="250" x2="120" y2="250"/>
<line x1="120" y1="250" x2="130" y2="250"/>
<line x1="130" y1="250" x2="140" y2="250"/>
<line x1="140" y1="250" x2="150" y2="250"/>
<line x1="150" y1="250" x2="160" y2="250"/>
<line x1="160" y1="250" x2="170" y2="250"/>
<line x1="170" y1="250" x2="180" y2="250"/>
<line x1="180" y1="250" x2="190" y2="250"/>
<line x1="190" y1="250" x2="200" y2="250"/>
<line x1="200" y1="250" x2="210" y2="250"/>
<line x1="210" y1="250" x2="220" y2="250"/>
<line x1="220" y1="250" x2="230" y2="250"/>
<line x1="230" y1="250" x2="240" y2="250"/>
<line x1="240" y1="250" x2="250" y2="250"/>
<line x1="250" y1="250" x2="260" y2="250"/>
<line x1="260" y1="250" x2="270" y2="250"/>
<line x1="270" y1="250" x2="280" y2="250"/>
<line x1="280" y1="250" x2="290" y2="250"/>
<line x1="290" y1="250" x2="300" y2="250"/>
<line x1="300" y1="250" x2="310" y2="250"/>
<line x1="310" y1="250" x2="320" y2="250"/>
<line x1="320" y1="250" x2="330" y2="250"/>
<line x1="330" y1="250" x2="340" y2="250"/>
<line x1="340" y1="250" x2="350" y2="250"/>
<line x1="350" y1="250" x2="360" y2="250"/>
<line x1="360" y1="250" x2="370" y2="250"/>
<line x1="370" y1="250" x2="380" y2="250"/>
<line x1="380" y1="250" x2="390" y2="250"/>
<line x1="390" y1="250" x2="400" y2="250"/>
<line x1="400" y1="250" x2="410" y2="250"/>
<line x1="410" y1="250" x2="420" y2="250"/>
<line x1="420" y1="250" x2="430" y2="250"/>
<line x1="430" y1="250" x2="440" y2="250"/>
<line x1="440" y1="250" x2="450" y2="250"/>
<line x1="450" y1="250" x2="460" y2="250"/>
<line x1="460" y1="250" x2="470" y2="250"/>
<line x1="470" y1="250" x2="480" y2="250"/>
<line x1="480" y1="250" x2="490" y2="250"/>
<line x1="490" y1="250" x2="500" y2="250"/>
<line x1="500" y1="250" x2="510" y2="250"/>
<line x1="510" y1="250" x2="520" y2="250"/>
<line x1="520" y1="250" x2="530" y2="250"/>
<line x1="530" y1="250" x2="540" y2="250"/>
<line x1="540" y1="250" x2="550" y2="250"/>
<line x1="550" y1="250" x2="560" y2="250"/>
<line x1="560" y1="250" x2="570" y2="250"/>
<line x1="570" y1="250" x2="580" y2="250"/>
<line x1="580" y1="250" x2="590" y2="250"/>
<line x1="590" y1="250" x2="600" y2="250"/>
<line x1="600" y1="250" x2="610" y2="250"/>
<line x1="610" y1="250" x2="620" y2="250"/>
<line x1="620" y1="250" x2="630" y2="250"/>
<line x1="630" y1="250" x2="640" y2="250"/>
<line x1="640" y1="250" x2="650" y2="250"/>
<line x1="650" y1="250" x2="660" y2="250"/>
<line x1="670" y1="250" x2="675" y2="250"/>
<line x1="675" y1="239" x2="675" y2="250"/>
</svg>
</div>
<p>The realm is an island in the soup - an enclave of sovereignty, an instance you can address. Objects float past, currents of content flow through cyberspace, but the island is bounded. Its shores are defined by capabilities: what it can see, what it can grant, what attests to it.</p>
<p>Every realm has coordinates: its principal. ed25519:7f3a2b4c... isn't just an identifier - it's a place you can teleport to. Present the right capability, and you're there. The soup connects all islands; the principal is your destination.</p>
<p>Or send an agent.</p>
<p>You needn't go yourself. Delegate a capability to an agent - a subprocess, a daemon, a trusted emissary - and it travels on your behalf. The agent carries your authority (attenuated, scoped, time-limited) and acts in the soup. It visits realms, fetches objects, negotiates federation. When it returns, its audit trail merges with yours.</p>
<pre class="language-scheme">
(delegate-agent
  (parent "ed25519:your-realm...")
  (agent "ed25519:agent-key...")
  (capabilities
    (read "sha512:*")              ; Can read any object
    (federate "ed25519:peer..."))  ; Can negotiate with this peer
  (valid (not-after 1736500000))   ; Expires in 24h
  (sandbox                          ; Constraints
    (no-propagate)                  ; Cannot delegate further
    (audit-required)))              ; Must return audit chain
</pre>
<p>The agent is a sealed closure too - spawned from yours, carrying delegated authority, accumulating its own history. When the mission ends, the histories merge or the agent is revoked.</p>
<p>Lineage:</p>
<p>Go yourself - like telnet or VMS SET HOST. You're there, synchronous, your session on that node. Direct presence in another realm.</p>
<p>Send an agent - like General Magic's Magic Cap and Telescript. Autonomous travelers carrying your intent, visiting places, doing work, returning with results. But recast in the spirit of Newton - agents swim in the soup, query objects, accumulate context. The soup is their medium, capabilities their passport.</p>
<p>The soup is a wilderness of mirrors. Objects reference objects. Hashes point to hashes. Capabilities chain through delegation. Attestations vouch for attestations. An agent navigating the soup sees reflections within reflections - content-addressed identity means every object is its own mirror. The agent must hold the thread of its capability chain or be lost in infinite regress.</p>
<p>This is not a safe place. It's cyberspace.</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 570 300" width="570" height="300" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<line x1="5" y1="10" x2="10" y2="10"/>
<line x1="5" y1="10" x2="5" y2="21"/>
<line x1="10" y1="10" x2="20" y2="10"/>
<line x1="20" y1="10" x2="30" y2="10"/>
<line x1="30" y1="10" x2="40" y2="10"/>
<line x1="40" y1="10" x2="50" y2="10"/>
<line x1="50" y1="10" x2="60" y2="10"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="160" y2="10"/>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="175" y2="10"/>
<line x1="175" y1="10" x2="175" y2="21"/>
<line x1="385" y1="10" x2="390" y2="10"/>
<line x1="385" y1="10" x2="385" y2="21"/>
<line x1="390" y1="10" x2="400" y2="10"/>
<line x1="400" y1="10" x2="410" y2="10"/>
<line x1="410" y1="10" x2="420" y2="10"/>
<line x1="420" y1="10" x2="430" y2="10"/>
<line x1="430" y1="10" x2="440" y2="10"/>
<line x1="440" y1="10" x2="450" y2="10"/>
<line x1="450" y1="10" x2="460" y2="10"/>
<line x1="460" y1="10" x2="470" y2="10"/>
<line x1="470" y1="10" x2="480" y2="10"/>
<line x1="480" y1="10" x2="490" y2="10"/>
<line x1="490" y1="10" x2="500" y2="10"/>
<line x1="500" y1="10" x2="510" y2="10"/>
<line x1="510" y1="10" x2="520" y2="10"/>
<line x1="520" y1="10" x2="530" y2="10"/>
<line x1="530" y1="10" x2="540" y2="10"/>
<line x1="540" y1="10" x2="550" y2="10"/>
<line x1="560" y1="10" x2="565" y2="10"/>
<line x1="565" y1="10" x2="565" y2="21"/>
<line x1="5" y1="19" x2="5" y2="41"/>
<text x="45" y="30">Y</text>
<text x="55" y="30">O</text>
<text x="65" y="30">U</text>
<text x="75" y="30">R</text>
<text x="95" y="30">R</text>
<text x="105" y="30">E</text>
<text x="115" y="30">A</text>
<text x="125" y="30">L</text>
<text x="135" y="30">M</text>
<line x1="175" y1="19" x2="175" y2="41"/>
<line x1="385" y1="19" x2="385" y2="41"/>
<text x="425" y="30">P</text>
<text x="435" y="30">E</text>
<text x="445" y="30">E</text>
<text x="455" y="30">R</text>
<text x="475" y="30">R</text>
<text x="485" y="30">E</text>
<text x="495" y="30">A</text>
<text x="505" y="30">L</text>
<text x="515" y="30">M</text>
<line x1="565" y1="19" x2="565" y2="41"/>
<line x1="5" y1="39" x2="5" y2="61"/>
<line x1="175" y1="39" x2="175" y2="61"/>
<line x1="385" y1="39" x2="385" y2="61"/>
<line x1="565" y1="39" x2="565" y2="61"/>
<line x1="5" y1="59" x2="5" y2="81"/>
<line x1="35" y1="70" x2="40" y2="70"/>
<line x1="35" y1="70" x2="35" y2="81"/>
<line x1="40" y1="70" x2="50" y2="70"/>
<line x1="50" y1="70" x2="60" y2="70"/>
<line x1="60" y1="70" x2="70" y2="70"/>
<line x1="70" y1="70" x2="80" y2="70"/>
<line x1="80" y1="70" x2="90" y2="70"/>
<line x1="90" y1="70" x2="100" y2="70"/>
<line x1="100" y1="70" x2="110" y2="70"/>
<line x1="110" y1="70" x2="120" y2="70"/>
<line x1="120" y1="70" x2="130" y2="70"/>
<line x1="130" y1="70" x2="140" y2="70"/>
<line x1="140" y1="70" x2="145" y2="70"/>
<line x1="145" y1="70" x2="145" y2="81"/>
<line x1="175" y1="59" x2="175" y2="81"/>
<text x="225" y="70">S</text>
<text x="235" y="70">E</text>
<text x="245" y="70">T</text>
<text x="265" y="70">H</text>
<text x="275" y="70">O</text>
<text x="285" y="70">S</text>
<text x="295" y="70">T</text>
<text x="315" y="70">/</text>
<line x1="385" y1="59" x2="385" y2="81"/>
<line x1="415" y1="70" x2="420" y2="70"/>
<line x1="415" y1="70" x2="415" y2="81"/>
<line x1="420" y1="70" x2="430" y2="70"/>
<line x1="430" y1="70" x2="440" y2="70"/>
<line x1="440" y1="70" x2="450" y2="70"/>
<line x1="450" y1="70" x2="460" y2="70"/>
<line x1="460" y1="70" x2="470" y2="70"/>
<line x1="470" y1="70" x2="480" y2="70"/>
<line x1="480" y1="70" x2="490" y2="70"/>
<line x1="490" y1="70" x2="500" y2="70"/>
<line x1="500" y1="70" x2="510" y2="70"/>
<line x1="510" y1="70" x2="520" y2="70"/>
<line x1="520" y1="70" x2="525" y2="70"/>
<line x1="525" y1="70" x2="525" y2="81"/>
<line x1="565" y1="59" x2="565" y2="81"/>
<line x1="5" y1="79" x2="5" y2="101"/>
<line x1="35" y1="79" x2="35" y2="101"/>
<text x="75" y="90">y</text>
<text x="85" y="90">o</text>
<text x="95" y="90">u</text>
<line x1="145" y1="79" x2="145" y2="101"/>
<text x="395" y="90">→</text>
<line x1="405" y1="79" x2="405" y2="101"/>
<text x="445" y="90">y</text>
<text x="455" y="90">o</text>
<text x="465" y="90">u</text>
<line x1="515" y1="79" x2="515" y2="101"/>
<line x1="565" y1="79" x2="565" y2="101"/>
<line x1="5" y1="99" x2="5" y2="121"/>
<line x1="35" y1="110" x2="40" y2="110"/>
<line x1="35" y1="99" x2="35" y2="110"/>
<line x1="40" y1="110" x2="50" y2="110"/>
<line x1="50" y1="110" x2="60" y2="110"/>
<line x1="60" y1="110" x2="70" y2="110"/>
<line x1="70" y1="110" x2="80" y2="110"/>
<line x1="80" y1="110" x2="90" y2="110"/>
<line x1="90" y1="110" x2="100" y2="110"/>
<line x1="100" y1="110" x2="110" y2="110"/>
<line x1="110" y1="110" x2="120" y2="110"/>
<line x1="120" y1="110" x2="130" y2="110"/>
<line x1="130" y1="110" x2="140" y2="110"/>
<line x1="140" y1="110" x2="145" y2="110"/>
<line x1="145" y1="99" x2="145" y2="110"/>
<line x1="175" y1="99" x2="175" y2="121"/>
<text x="225" y="110">t</text>
<text x="235" y="110">e</text>
<text x="245" y="110">l</text>
<text x="255" y="110">n</text>
<text x="265" y="110">e</text>
<text x="275" y="110">t</text>
<line x1="395" y1="99" x2="395" y2="121"/>
<line x1="425" y1="110" x2="430" y2="110"/>
<line x1="425" y1="99" x2="425" y2="110"/>
<line x1="430" y1="110" x2="440" y2="110"/>
<line x1="440" y1="110" x2="450" y2="110"/>
<line x1="450" y1="110" x2="460" y2="110"/>
<line x1="460" y1="110" x2="470" y2="110"/>
<line x1="470" y1="110" x2="480" y2="110"/>
<line x1="480" y1="110" x2="490" y2="110"/>
<line x1="490" y1="110" x2="500" y2="110"/>
<line x1="500" y1="110" x2="510" y2="110"/>
<line x1="510" y1="110" x2="520" y2="110"/>
<line x1="520" y1="110" x2="530" y2="110"/>
<line x1="530" y1="110" x2="535" y2="110"/>
<line x1="535" y1="99" x2="535" y2="110"/>
<line x1="565" y1="99" x2="565" y2="121"/>
<line x1="5" y1="119" x2="5" y2="141"/>
<line x1="175" y1="119" x2="175" y2="141"/>
<line x1="385" y1="119" x2="385" y2="141"/>
<line x1="565" y1="119" x2="565" y2="141"/>
<line x1="5" y1="139" x2="5" y2="161"/>
<line x1="35" y1="150" x2="40" y2="150"/>
<line x1="35" y1="150" x2="35" y2="161"/>
<line x1="40" y1="150" x2="50" y2="150"/>
<line x1="50" y1="150" x2="60" y2="150"/>
<line x1="60" y1="150" x2="70" y2="150"/>
<line x1="70" y1="150" x2="80" y2="150"/>
<line x1="80" y1="150" x2="90" y2="150"/>
<line x1="90" y1="150" x2="100" y2="150"/>
<line x1="100" y1="150" x2="110" y2="150"/>
<line x1="110" y1="150" x2="120" y2="150"/>
<line x1="120" y1="150" x2="130" y2="150"/>
<line x1="130" y1="150" x2="140" y2="150"/>
<line x1="140" y1="150" x2="145" y2="150"/>
<line x1="145" y1="150" x2="145" y2="161"/>
<line x1="175" y1="139" x2="175" y2="161"/>
<text x="225" y="150">d</text>
<text x="235" y="150">e</text>
<text x="245" y="150">l</text>
<text x="255" y="150">e</text>
<text x="265" y="150">g</text>
<text x="275" y="150">a</text>
<text x="285" y="150">t</text>
<text x="295" y="150">e</text>
<line x1="385" y1="139" x2="385" y2="161"/>
<line x1="415" y1="150" x2="420" y2="150"/>
<line x1="415" y1="150" x2="415" y2="161"/>
<line x1="420" y1="150" x2="430" y2="150"/>
<line x1="430" y1="150" x2="440" y2="150"/>
<line x1="440" y1="150" x2="450" y2="150"/>
<line x1="450" y1="150" x2="460" y2="150"/>
<line x1="460" y1="150" x2="470" y2="150"/>
<line x1="470" y1="150" x2="480" y2="150"/>
<line x1="480" y1="150" x2="490" y2="150"/>
<line x1="490" y1="150" x2="500" y2="150"/>
<line x1="500" y1="150" x2="510" y2="150"/>
<line x1="510" y1="150" x2="520" y2="150"/>
<line x1="520" y1="150" x2="525" y2="150"/>
<line x1="525" y1="150" x2="525" y2="161"/>
<line x1="565" y1="139" x2="565" y2="161"/>
<line x1="5" y1="159" x2="5" y2="181"/>
<line x1="35" y1="159" x2="35" y2="181"/>
<text x="65" y="170">a</text>
<text x="75" y="170">g</text>
<text x="85" y="170">e</text>
<text x="95" y="170">n</text>
<text x="105" y="170">t</text>
<line x1="145" y1="159" x2="145" y2="181"/>
<text x="395" y="170">→</text>
<line x1="405" y1="159" x2="405" y2="181"/>
<text x="435" y="170">a</text>
<text x="445" y="170">g</text>
<text x="455" y="170">e</text>
<text x="465" y="170">n</text>
<text x="475" y="170">t</text>
<line x1="515" y1="159" x2="515" y2="181"/>
<line x1="565" y1="159" x2="565" y2="181"/>
<line x1="5" y1="179" x2="5" y2="201"/>
<line x1="35" y1="190" x2="40" y2="190"/>
<line x1="35" y1="179" x2="35" y2="190"/>
<line x1="40" y1="190" x2="50" y2="190"/>
<line x1="50" y1="190" x2="60" y2="190"/>
<line x1="60" y1="190" x2="70" y2="190"/>
<line x1="70" y1="190" x2="80" y2="190"/>
<line x1="80" y1="190" x2="90" y2="190"/>
<line x1="90" y1="190" x2="100" y2="190"/>
<line x1="100" y1="190" x2="110" y2="190"/>
<line x1="110" y1="190" x2="120" y2="190"/>
<line x1="120" y1="190" x2="130" y2="190"/>
<line x1="130" y1="190" x2="140" y2="190"/>
<line x1="140" y1="190" x2="145" y2="190"/>
<line x1="145" y1="179" x2="145" y2="190"/>
<line x1="175" y1="179" x2="175" y2="201"/>
<text x="225" y="190">(</text>
<text x="235" y="190">M</text>
<text x="245" y="190">a</text>
<text x="255" y="190">g</text>
<text x="265" y="190">i</text>
<text x="275" y="190">c</text>
<text x="295" y="190">C</text>
<text x="305" y="190">a</text>
<text x="315" y="190">p</text>
<text x="325" y="190">)</text>
<line x1="395" y1="179" x2="395" y2="201"/>
<line x1="425" y1="190" x2="430" y2="190"/>
<line x1="425" y1="179" x2="425" y2="190"/>
<line x1="430" y1="190" x2="440" y2="190"/>
<line x1="440" y1="190" x2="450" y2="190"/>
<line x1="450" y1="190" x2="460" y2="190"/>
<line x1="460" y1="190" x2="470" y2="190"/>
<line x1="470" y1="190" x2="480" y2="190"/>
<line x1="480" y1="190" x2="490" y2="190"/>
<line x1="490" y1="190" x2="500" y2="190"/>
<line x1="500" y1="190" x2="510" y2="190"/>
<line x1="510" y1="190" x2="520" y2="190"/>
<line x1="520" y1="190" x2="530" y2="190"/>
<line x1="530" y1="190" x2="535" y2="190"/>
<line x1="535" y1="179" x2="535" y2="190"/>
<line x1="565" y1="179" x2="565" y2="201"/>
<line x1="5" y1="199" x2="5" y2="221"/>
<line x1="175" y1="199" x2="175" y2="221"/>
<line x1="385" y1="199" x2="385" y2="221"/>
<line x1="565" y1="199" x2="565" y2="221"/>
<line x1="5" y1="230" x2="10" y2="230"/>
<line x1="5" y1="219" x2="5" y2="230"/>
<line x1="10" y1="230" x2="20" y2="230"/>
<line x1="20" y1="230" x2="30" y2="230"/>
<line x1="30" y1="230" x2="40" y2="230"/>
<line x1="40" y1="230" x2="50" y2="230"/>
<line x1="50" y1="230" x2="60" y2="230"/>
<line x1="60" y1="230" x2="70" y2="230"/>
<line x1="70" y1="230" x2="80" y2="230"/>
<line x1="80" y1="230" x2="90" y2="230"/>
<line x1="90" y1="230" x2="100" y2="230"/>
<line x1="100" y1="230" x2="110" y2="230"/>
<line x1="110" y1="230" x2="120" y2="230"/>
<line x1="120" y1="230" x2="130" y2="230"/>
<line x1="130" y1="230" x2="140" y2="230"/>
<line x1="140" y1="230" x2="150" y2="230"/>
<line x1="150" y1="230" x2="160" y2="230"/>
<line x1="160" y1="230" x2="170" y2="230"/>
<line x1="170" y1="230" x2="175" y2="230"/>
<line x1="175" y1="219" x2="175" y2="230"/>
<line x1="385" y1="230" x2="390" y2="230"/>
<line x1="385" y1="219" x2="385" y2="230"/>
<line x1="390" y1="230" x2="400" y2="230"/>
<line x1="400" y1="230" x2="410" y2="230"/>
<line x1="410" y1="230" x2="420" y2="230"/>
<line x1="420" y1="230" x2="430" y2="230"/>
<line x1="430" y1="230" x2="440" y2="230"/>
<line x1="440" y1="230" x2="450" y2="230"/>
<line x1="450" y1="230" x2="460" y2="230"/>
<line x1="460" y1="230" x2="470" y2="230"/>
<line x1="470" y1="230" x2="480" y2="230"/>
<line x1="480" y1="230" x2="490" y2="230"/>
<line x1="490" y1="230" x2="500" y2="230"/>
<line x1="500" y1="230" x2="510" y2="230"/>
<line x1="510" y1="230" x2="520" y2="230"/>
<line x1="520" y1="230" x2="530" y2="230"/>
<line x1="530" y1="230" x2="540" y2="230"/>
<line x1="540" y1="230" x2="550" y2="230"/>
<line x1="560" y1="230" x2="565" y2="230"/>
<line x1="565" y1="219" x2="565" y2="230"/>
<text x="255" y="250">↑</text>
<text x="205" y="270">T</text>
<text x="215" y="270">H</text>
<text x="225" y="270">E</text>
<text x="245" y="270">S</text>
<text x="255" y="270">O</text>
<text x="265" y="270">U</text>
<text x="275" y="270">P</text>
<text x="175" y="290">(</text>
<text x="185" y="290">N</text>
<text x="195" y="290">e</text>
<text x="205" y="290">w</text>
<text x="215" y="290">t</text>
<text x="225" y="290">o</text>
<text x="235" y="290">n</text>
<text x="245" y="290">'</text>
<text x="255" y="290">s</text>
<text x="275" y="290">m</text>
<text x="285" y="290">e</text>
<text x="295" y="290">d</text>
<text x="305" y="290">i</text>
<text x="315" y="290">u</text>
<text x="325" y="290">m</text>
<text x="335" y="290">)</text>
</svg>
</div>
<p>Objects have no access control - they're just content, identified by hash. The realm closure holds the capabilities that give meaning: "I can read this," "I granted that," "This attests to me."</p>
<p>The soup is shared. Islands may be near or far. Federation is building bridges between islands - agreeing to share objects, honor capabilities, witness each other's audit chains.</p>
<h3>Addressing Objects</h3>
<p>Objects in cyberspace have coordinates:</p>
<pre class="language-scheme">
;; Local (this realm)
"releases/1.0.3"                    ; By path
"sha512:abc123..."                  ; By hash

;; Remote (another realm) - @ syntax
"@ed25519:7f3a2b.../releases/1.0.3"     ; Named object at realm
"@ed25519:7f3a2b.../sha512:abc123..."   ; Hash-addressed at realm

;; With role context - @principal+role:/path
"@ed25519:7f3a2b...+curator:/collections/rare-books"
"@ed25519:7f3a2b...+guardian:/vault/keys"
"@ed25519:7f3a2b...+witness:/audit/signatures"

;; With explicit capabilities - @principal+{caps}:/path
"@ed25519:7f3a2b...+{read}:/objects/sha512:abc..."
"@ed25519:7f3a2b...+{read,write}:/collections/working"
"@ed25519:7f3a2b...+{read,delegate(read)}:/shared/docs"

;; Role with capability refinement
"@ed25519:7f3a2b...+curator{read}:/collections/rare-books"  ; curator, read only

;; Inspect remote sealed object
(soup-inspect "@ed25519:7f3a2b.../releases/1.0.3")

;; Fetch requires capability
(soup-fetch "@ed25519:7f3a2b.../sha512:abc123..."
  capability: my-read-cert)

;; Fetch with role context
(soup-fetch "@ed25519:7f3a2b...+curator:/collections/rare-books"
  capability: my-curator-cert)
</pre>
<p>The @principal:/path syntax reads: "at this realm, this object." The principal is your teleport destination. The path or hash is what you're looking for.</p>
<p>The @principal+role:/path syntax adds role context: "at this realm, acting as this role, this object."</p>
<p>The @principal+{caps}:/path syntax specifies explicit capabilities: "at this realm, with these specific capabilities, this object." Roles are shorthand for capability bundles; the +{caps} form is the truth underneath.</p>
<p>+role{caps} combines both: use this role, but only these capabilities from it. Principle of least authority - request only what you need.</p>
<p>Without a capability granting access, you can see the object exists (if the realm publishes its bloom filter) but cannot fetch its contents. The wilderness of mirrors shows reflections - but you need the right key to step through.</p>
</section>
<section>
<h2>Architecture</h2>
<h3>The Inner Vault</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 690 460" width="690" height="460" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<text x="5" y="10">.</text>
<text x="15" y="10">v</text>
<text x="25" y="10">a</text>
<text x="35" y="10">u</text>
<text x="45" y="10">l</text>
<text x="55" y="10">t</text>
<text x="65" y="10">/</text>
<line x1="5" y1="19" x2="5" y2="41"/>
<line x1="5" y1="30" x2="10" y2="30"/>
<line x1="10" y1="30" x2="20" y2="30"/>
<line x1="20" y1="30" x2="30" y2="30"/>
<text x="45" y="30">k</text>
<text x="55" y="30">e</text>
<text x="65" y="30">y</text>
<text x="75" y="30">s</text>
<text x="85" y="30">t</text>
<text x="95" y="30">o</text>
<text x="105" y="30">r</text>
<text x="115" y="30">e</text>
<text x="125" y="30">/</text>
<text x="335" y="30">#</text>
<text x="355" y="30">I</text>
<text x="365" y="30">d</text>
<text x="375" y="30">e</text>
<text x="385" y="30">n</text>
<text x="395" y="30">t</text>
<text x="405" y="30">i</text>
<text x="415" y="30">t</text>
<text x="425" y="30">y</text>
<text x="445" y="30">s</text>
<text x="455" y="30">t</text>
<text x="465" y="30">o</text>
<text x="475" y="30">r</text>
<text x="485" y="30">e</text>
<line x1="5" y1="39" x2="5" y2="61"/>
<line x1="45" y1="39" x2="45" y2="61"/>
<line x1="45" y1="50" x2="50" y2="50"/>
<line x1="50" y1="50" x2="60" y2="50"/>
<line x1="60" y1="50" x2="70" y2="50"/>
<text x="85" y="50">r</text>
<text x="95" y="50">e</text>
<text x="105" y="50">a</text>
<text x="115" y="50">l</text>
<text x="125" y="50">m</text>
<text x="135" y="50">.</text>
<text x="145" y="50">k</text>
<text x="155" y="50">e</text>
<text x="165" y="50">y</text>
<text x="325" y="50">#</text>
<text x="345" y="50">E</text>
<text x="355" y="50">n</text>
<text x="365" y="50">c</text>
<text x="375" y="50">r</text>
<text x="385" y="50">y</text>
<text x="395" y="50">p</text>
<text x="405" y="50">t</text>
<text x="415" y="50">e</text>
<text x="425" y="50">d</text>
<text x="445" y="50">p</text>
<text x="455" y="50">r</text>
<text x="465" y="50">i</text>
<text x="475" y="50">v</text>
<text x="485" y="50">a</text>
<text x="495" y="50">t</text>
<text x="505" y="50">e</text>
<text x="525" y="50">k</text>
<text x="535" y="50">e</text>
<text x="545" y="50">y</text>
<line x1="5" y1="59" x2="5" y2="81"/>
<line x1="45" y1="59" x2="45" y2="81"/>
<line x1="45" y1="70" x2="50" y2="70"/>
<line x1="50" y1="70" x2="60" y2="70"/>
<line x1="60" y1="70" x2="70" y2="70"/>
<text x="85" y="70">r</text>
<text x="95" y="70">e</text>
<text x="105" y="70">a</text>
<text x="115" y="70">l</text>
<text x="125" y="70">m</text>
<text x="135" y="70">.</text>
<text x="145" y="70">p</text>
<text x="155" y="70">u</text>
<text x="165" y="70">b</text>
<text x="325" y="70">#</text>
<text x="345" y="70">P</text>
<text x="355" y="70">u</text>
<text x="365" y="70">b</text>
<text x="375" y="70">l</text>
<text x="385" y="70">i</text>
<text x="395" y="70">c</text>
<text x="415" y="70">k</text>
<text x="425" y="70">e</text>
<text x="435" y="70">y</text>
<text x="455" y="70">(</text>
<text x="465" y="70">t</text>
<text x="475" y="70">h</text>
<text x="485" y="70">i</text>
<text x="495" y="70">s</text>
<text x="515" y="70">i</text>
<text x="525" y="70">s</text>
<text x="545" y="70">y</text>
<text x="555" y="70">o</text>
<text x="565" y="70">u</text>
<text x="575" y="70">r</text>
<text x="595" y="70">p</text>
<text x="605" y="70">r</text>
<text x="615" y="70">i</text>
<text x="625" y="70">n</text>
<text x="635" y="70">c</text>
<text x="645" y="70">i</text>
<text x="655" y="70">p</text>
<text x="665" y="70">a</text>
<text x="675" y="70">l</text>
<text x="685" y="70">)</text>
<line x1="5" y1="79" x2="5" y2="101"/>
<line x1="45" y1="79" x2="45" y2="101"/>
<line x1="45" y1="90" x2="50" y2="90"/>
<line x1="50" y1="90" x2="60" y2="90"/>
<line x1="60" y1="90" x2="70" y2="90"/>
<text x="85" y="90">k</text>
<text x="95" y="90">e</text>
<text x="105" y="90">y</text>
<text x="115" y="90">s</text>
<text x="125" y="90">t</text>
<text x="135" y="90">o</text>
<text x="145" y="90">r</text>
<text x="155" y="90">e</text>
<text x="165" y="90">.</text>
<text x="175" y="90">m</text>
<text x="185" y="90">e</text>
<text x="195" y="90">t</text>
<text x="205" y="90">a</text>
<text x="325" y="90">#</text>
<text x="345" y="90">M</text>
<text x="355" y="90">e</text>
<text x="365" y="90">t</text>
<text x="375" y="90">a</text>
<text x="385" y="90">d</text>
<text x="395" y="90">a</text>
<text x="405" y="90">t</text>
<text x="415" y="90">a</text>
<text x="425" y="90">,</text>
<text x="445" y="90">p</text>
<text x="455" y="90">a</text>
<text x="465" y="90">r</text>
<text x="475" y="90">a</text>
<text x="485" y="90">m</text>
<text x="495" y="90">e</text>
<text x="505" y="90">t</text>
<text x="515" y="90">e</text>
<text x="525" y="90">r</text>
<text x="535" y="90">s</text>
<line x1="5" y1="99" x2="5" y2="121"/>
<line x1="45" y1="110" x2="50" y2="110"/>
<line x1="45" y1="99" x2="45" y2="110"/>
<line x1="50" y1="110" x2="60" y2="110"/>
<line x1="60" y1="110" x2="70" y2="110"/>
<text x="85" y="110">r</text>
<text x="95" y="110">e</text>
<text x="105" y="110">c</text>
<text x="115" y="110">o</text>
<text x="125" y="110">v</text>
<text x="135" y="110">e</text>
<text x="145" y="110">r</text>
<text x="155" y="110">y</text>
<text x="165" y="110">/</text>
<text x="325" y="110">#</text>
<text x="345" y="110">O</text>
<text x="355" y="110">p</text>
<text x="365" y="110">t</text>
<text x="375" y="110">i</text>
<text x="385" y="110">o</text>
<text x="395" y="110">n</text>
<text x="405" y="110">a</text>
<text x="415" y="110">l</text>
<text x="435" y="110">t</text>
<text x="445" y="110">h</text>
<text x="455" y="110">r</text>
<text x="465" y="110">e</text>
<text x="475" y="110">s</text>
<text x="485" y="110">h</text>
<text x="495" y="110">o</text>
<text x="505" y="110">l</text>
<text x="515" y="110">d</text>
<text x="535" y="110">s</text>
<text x="545" y="110">h</text>
<text x="555" y="110">a</text>
<text x="565" y="110">r</text>
<text x="575" y="110">e</text>
<text x="585" y="110">s</text>
<line x1="5" y1="119" x2="5" y2="141"/>
<line x1="85" y1="119" x2="85" y2="141"/>
<line x1="85" y1="130" x2="90" y2="130"/>
<line x1="90" y1="130" x2="100" y2="130"/>
<line x1="100" y1="130" x2="110" y2="130"/>
<text x="125" y="130">s</text>
<text x="135" y="130">h</text>
<text x="145" y="130">a</text>
<text x="155" y="130">r</text>
<text x="165" y="130">e</text>
<text x="175" y="130">.</text>
<text x="185" y="130">1</text>
<text x="195" y="130">.</text>
<text x="205" y="130">k</text>
<text x="215" y="130">e</text>
<text x="225" y="130">y</text>
<line x1="5" y1="139" x2="5" y2="161"/>
<line x1="85" y1="150" x2="90" y2="150"/>
<line x1="85" y1="139" x2="85" y2="150"/>
<line x1="90" y1="150" x2="100" y2="150"/>
<line x1="100" y1="150" x2="110" y2="150"/>
<text x="125" y="150">s</text>
<text x="135" y="150">h</text>
<text x="145" y="150">a</text>
<text x="155" y="150">r</text>
<text x="165" y="150">e</text>
<text x="175" y="150">.</text>
<text x="185" y="150">2</text>
<text x="195" y="150">.</text>
<text x="205" y="150">k</text>
<text x="215" y="150">e</text>
<text x="225" y="150">y</text>
<line x1="5" y1="159" x2="5" y2="181"/>
<line x1="5" y1="170" x2="10" y2="170"/>
<line x1="10" y1="170" x2="20" y2="170"/>
<line x1="20" y1="170" x2="30" y2="170"/>
<text x="45" y="170">a</text>
<text x="55" y="170">t</text>
<text x="65" y="170">t</text>
<text x="75" y="170">e</text>
<text x="85" y="170">s</text>
<text x="95" y="170">t</text>
<text x="105" y="170">a</text>
<text x="115" y="170">t</text>
<text x="125" y="170">i</text>
<text x="135" y="170">o</text>
<text x="145" y="170">n</text>
<text x="155" y="170">s</text>
<text x="165" y="170">/</text>
<text x="335" y="170">#</text>
<text x="355" y="170">P</text>
<text x="365" y="170">r</text>
<text x="375" y="170">o</text>
<text x="385" y="170">o</text>
<text x="395" y="170">f</text>
<text x="415" y="170">s</text>
<text x="425" y="170">t</text>
<text x="435" y="170">o</text>
<text x="445" y="170">r</text>
<text x="455" y="170">e</text>
<line x1="5" y1="179" x2="5" y2="201"/>
<line x1="45" y1="179" x2="45" y2="201"/>
<line x1="45" y1="190" x2="50" y2="190"/>
<line x1="50" y1="190" x2="60" y2="190"/>
<line x1="60" y1="190" x2="70" y2="190"/>
<text x="85" y="190">h</text>
<text x="95" y="190">a</text>
<text x="105" y="190">r</text>
<text x="115" y="190">d</text>
<text x="125" y="190">w</text>
<text x="135" y="190">a</text>
<text x="145" y="190">r</text>
<text x="155" y="190">e</text>
<text x="165" y="190">/</text>
<text x="325" y="190">#</text>
<text x="345" y="190">H</text>
<text x="355" y="190">a</text>
<text x="365" y="190">r</text>
<text x="375" y="190">d</text>
<text x="385" y="190">w</text>
<text x="395" y="190">a</text>
<text x="405" y="190">r</text>
<text x="415" y="190">e</text>
<text x="435" y="190">a</text>
<text x="445" y="190">t</text>
<text x="455" y="190">t</text>
<text x="465" y="190">e</text>
<text x="475" y="190">s</text>
<text x="485" y="190">t</text>
<text x="495" y="190">a</text>
<text x="505" y="190">t</text>
<text x="515" y="190">i</text>
<text x="525" y="190">o</text>
<text x="535" y="190">n</text>
<text x="545" y="190">s</text>
<line x1="5" y1="199" x2="5" y2="221"/>
<line x1="45" y1="199" x2="45" y2="221"/>
<line x1="85" y1="199" x2="85" y2="221"/>
<line x1="85" y1="210" x2="90" y2="210"/>
<line x1="90" y1="210" x2="100" y2="210"/>
<line x1="100" y1="210" x2="110" y2="210"/>
<text x="125" y="210">a</text>
<text x="135" y="210">n</text>
<text x="145" y="210">c</text>
<text x="155" y="210">h</text>
<text x="165" y="210">o</text>
<text x="175" y="210">r</text>
<text x="185" y="210">-</text>
<text x="195" y="210">q</text>
<text x="205" y="210">u</text>
<text x="215" y="210">o</text>
<text x="225" y="210">t</text>
<text x="235" y="210">e</text>
<text x="245" y="210">.</text>
<text x="255" y="210">a</text>
<text x="265" y="210">t</text>
<text x="275" y="210">t</text>
<text x="355" y="210">#</text>
<text x="375" y="210">A</text>
<text x="385" y="210">n</text>
<text x="395" y="210">c</text>
<text x="405" y="210">h</text>
<text x="415" y="210">o</text>
<text x="425" y="210">r</text>
<text x="445" y="210">m</text>
<text x="455" y="210">e</text>
<text x="465" y="210">a</text>
<text x="475" y="210">s</text>
<text x="485" y="210">u</text>
<text x="495" y="210">r</text>
<text x="505" y="210">e</text>
<text x="515" y="210">m</text>
<text x="525" y="210">e</text>
<text x="535" y="210">n</text>
<text x="545" y="210">t</text>
<line x1="5" y1="219" x2="5" y2="241"/>
<line x1="45" y1="219" x2="45" y2="241"/>
<line x1="85" y1="230" x2="90" y2="230"/>
<line x1="85" y1="219" x2="85" y2="230"/>
<line x1="90" y1="230" x2="100" y2="230"/>
<line x1="100" y1="230" x2="110" y2="230"/>
<text x="125" y="230">s</text>
<text x="135" y="230">e</text>
<text x="145" y="230">c</text>
<text x="155" y="230">u</text>
<text x="165" y="230">r</text>
<text x="175" y="230">e</text>
<text x="185" y="230">-</text>
<text x="195" y="230">e</text>
<text x="205" y="230">n</text>
<text x="215" y="230">c</text>
<text x="225" y="230">l</text>
<text x="235" y="230">a</text>
<text x="245" y="230">v</text>
<text x="255" y="230">e</text>
<text x="265" y="230">.</text>
<text x="275" y="230">a</text>
<text x="285" y="230">t</text>
<text x="295" y="230">t</text>
<text x="325" y="230">#</text>
<text x="345" y="230">A</text>
<text x="355" y="230">p</text>
<text x="365" y="230">p</text>
<text x="375" y="230">l</text>
<text x="385" y="230">e</text>
<text x="405" y="230">S</text>
<text x="415" y="230">E</text>
<text x="435" y="230">a</text>
<text x="445" y="230">t</text>
<text x="455" y="230">t</text>
<text x="465" y="230">e</text>
<text x="475" y="230">s</text>
<text x="485" y="230">t</text>
<text x="495" y="230">a</text>
<text x="505" y="230">t</text>
<text x="515" y="230">i</text>
<text x="525" y="230">o</text>
<text x="535" y="230">n</text>
<line x1="5" y1="239" x2="5" y2="261"/>
<line x1="45" y1="239" x2="45" y2="261"/>
<line x1="45" y1="250" x2="50" y2="250"/>
<line x1="50" y1="250" x2="60" y2="250"/>
<line x1="60" y1="250" x2="70" y2="250"/>
<text x="85" y="250">s</text>
<text x="95" y="250">o</text>
<text x="105" y="250">f</text>
<text x="115" y="250">t</text>
<text x="125" y="250">w</text>
<text x="135" y="250">a</text>
<text x="145" y="250">r</text>
<text x="155" y="250">e</text>
<text x="165" y="250">/</text>
<text x="325" y="250">#</text>
<text x="345" y="250">S</text>
<text x="355" y="250">o</text>
<text x="365" y="250">f</text>
<text x="375" y="250">t</text>
<text x="385" y="250">w</text>
<text x="395" y="250">a</text>
<text x="405" y="250">r</text>
<text x="415" y="250">e</text>
<text x="435" y="250">a</text>
<text x="445" y="250">t</text>
<text x="455" y="250">t</text>
<text x="465" y="250">e</text>
<text x="475" y="250">s</text>
<text x="485" y="250">t</text>
<text x="495" y="250">a</text>
<text x="505" y="250">t</text>
<text x="515" y="250">i</text>
<text x="525" y="250">o</text>
<text x="535" y="250">n</text>
<text x="545" y="250">s</text>
<line x1="5" y1="259" x2="5" y2="281"/>
<line x1="45" y1="259" x2="45" y2="281"/>
<line x1="85" y1="259" x2="85" y2="281"/>
<line x1="85" y1="270" x2="90" y2="270"/>
<line x1="90" y1="270" x2="100" y2="270"/>
<line x1="100" y1="270" x2="110" y2="270"/>
<text x="125" y="270">b</text>
<text x="135" y="270">o</text>
<text x="145" y="270">o</text>
<text x="155" y="270">t</text>
<text x="165" y="270">-</text>
<text x="175" y="270">h</text>
<text x="185" y="270">a</text>
<text x="195" y="270">s</text>
<text x="205" y="270">h</text>
<text x="215" y="270">.</text>
<text x="225" y="270">a</text>
<text x="235" y="270">t</text>
<text x="245" y="270">t</text>
<text x="325" y="270">#</text>
<text x="345" y="270">M</text>
<text x="355" y="270">e</text>
<text x="365" y="270">a</text>
<text x="375" y="270">s</text>
<text x="385" y="270">u</text>
<text x="395" y="270">r</text>
<text x="405" y="270">e</text>
<text x="415" y="270">d</text>
<text x="435" y="270">b</text>
<text x="445" y="270">o</text>
<text x="455" y="270">o</text>
<text x="465" y="270">t</text>
<line x1="5" y1="279" x2="5" y2="301"/>
<line x1="45" y1="279" x2="45" y2="301"/>
<line x1="85" y1="290" x2="90" y2="290"/>
<line x1="85" y1="279" x2="85" y2="290"/>
<line x1="90" y1="290" x2="100" y2="290"/>
<line x1="100" y1="290" x2="110" y2="290"/>
<text x="125" y="290">r</text>
<text x="135" y="290">u</text>
<text x="145" y="290">n</text>
<text x="155" y="290">t</text>
<text x="165" y="290">i</text>
<text x="175" y="290">m</text>
<text x="185" y="290">e</text>
<text x="195" y="290">-</text>
<text x="205" y="290">h</text>
<text x="215" y="290">a</text>
<text x="225" y="290">s</text>
<text x="235" y="290">h</text>
<text x="245" y="290">.</text>
<text x="255" y="290">a</text>
<text x="265" y="290">t</text>
<text x="275" y="290">t</text>
<text x="325" y="290">#</text>
<text x="345" y="290">R</text>
<text x="355" y="290">u</text>
<text x="365" y="290">n</text>
<text x="375" y="290">t</text>
<text x="385" y="290">i</text>
<text x="395" y="290">m</text>
<text x="405" y="290">e</text>
<text x="425" y="290">m</text>
<text x="435" y="290">e</text>
<text x="445" y="290">a</text>
<text x="455" y="290">s</text>
<text x="465" y="290">u</text>
<text x="475" y="290">r</text>
<text x="485" y="290">e</text>
<text x="495" y="290">m</text>
<text x="505" y="290">e</text>
<text x="515" y="290">n</text>
<text x="525" y="290">t</text>
<text x="535" y="290">s</text>
<line x1="5" y1="299" x2="5" y2="321"/>
<line x1="45" y1="299" x2="45" y2="321"/>
<line x1="45" y1="310" x2="50" y2="310"/>
<line x1="50" y1="310" x2="60" y2="310"/>
<line x1="60" y1="310" x2="70" y2="310"/>
<text x="85" y="310">i</text>
<text x="95" y="310">d</text>
<text x="105" y="310">e</text>
<text x="115" y="310">n</text>
<text x="125" y="310">t</text>
<text x="135" y="310">i</text>
<text x="145" y="310">t</text>
<text x="155" y="310">y</text>
<text x="165" y="310">/</text>
<text x="325" y="310">#</text>
<text x="345" y="310">T</text>
<text x="355" y="310">h</text>
<text x="365" y="310">i</text>
<text x="375" y="310">r</text>
<text x="385" y="310">d</text>
<text x="395" y="310">-</text>
<text x="405" y="310">p</text>
<text x="415" y="310">a</text>
<text x="425" y="310">r</text>
<text x="435" y="310">t</text>
<text x="445" y="310">y</text>
<text x="465" y="310">v</text>
<text x="475" y="310">o</text>
<text x="485" y="310">u</text>
<text x="495" y="310">c</text>
<text x="505" y="310">h</text>
<text x="515" y="310">e</text>
<text x="525" y="310">s</text>
<line x1="5" y1="319" x2="5" y2="341"/>
<line x1="45" y1="319" x2="45" y2="341"/>
<line x1="85" y1="330" x2="90" y2="330"/>
<line x1="85" y1="319" x2="85" y2="330"/>
<line x1="90" y1="330" x2="100" y2="330"/>
<line x1="100" y1="330" x2="110" y2="330"/>
<text x="125" y="330">c</text>
<text x="135" y="330">a</text>
<text x="145" y="330">-</text>
<text x="155" y="330">c</text>
<text x="165" y="330">e</text>
<text x="175" y="330">r</text>
<text x="185" y="330">t</text>
<text x="195" y="330">.</text>
<text x="205" y="330">a</text>
<text x="215" y="330">t</text>
<text x="225" y="330">t</text>
<text x="325" y="330">#</text>
<text x="345" y="330">E</text>
<text x="355" y="330">x</text>
<text x="365" y="330">t</text>
<text x="375" y="330">e</text>
<text x="385" y="330">r</text>
<text x="395" y="330">n</text>
<text x="405" y="330">a</text>
<text x="415" y="330">l</text>
<text x="435" y="330">C</text>
<text x="445" y="330">A</text>
<text x="465" y="330">a</text>
<text x="475" y="330">t</text>
<text x="485" y="330">t</text>
<text x="495" y="330">e</text>
<text x="505" y="330">s</text>
<text x="515" y="330">t</text>
<text x="525" y="330">a</text>
<text x="535" y="330">t</text>
<text x="545" y="330">i</text>
<text x="555" y="330">o</text>
<text x="565" y="330">n</text>
<line x1="5" y1="339" x2="5" y2="361"/>
<line x1="45" y1="350" x2="50" y2="350"/>
<line x1="45" y1="339" x2="45" y2="350"/>
<line x1="50" y1="350" x2="60" y2="350"/>
<line x1="60" y1="350" x2="70" y2="350"/>
<text x="85" y="350">a</text>
<text x="95" y="350">t</text>
<text x="105" y="350">t</text>
<text x="115" y="350">e</text>
<text x="125" y="350">s</text>
<text x="135" y="350">t</text>
<text x="145" y="350">a</text>
<text x="155" y="350">t</text>
<text x="165" y="350">i</text>
<text x="175" y="350">o</text>
<text x="185" y="350">n</text>
<text x="195" y="350">s</text>
<text x="205" y="350">.</text>
<text x="215" y="350">m</text>
<text x="225" y="350">e</text>
<text x="235" y="350">t</text>
<text x="245" y="350">a</text>
<text x="325" y="350">#</text>
<text x="345" y="350">A</text>
<text x="355" y="350">t</text>
<text x="365" y="350">t</text>
<text x="375" y="350">e</text>
<text x="385" y="350">s</text>
<text x="395" y="350">t</text>
<text x="405" y="350">a</text>
<text x="415" y="350">t</text>
<text x="425" y="350">i</text>
<text x="435" y="350">o</text>
<text x="445" y="350">n</text>
<text x="465" y="350">c</text>
<text x="475" y="350">a</text>
<text x="485" y="350">t</text>
<text x="495" y="350">a</text>
<text x="505" y="350">l</text>
<text x="515" y="350">o</text>
<text x="525" y="350">g</text>
<line x1="5" y1="359" x2="5" y2="381"/>
<line x1="5" y1="370" x2="10" y2="370"/>
<line x1="10" y1="370" x2="20" y2="370"/>
<line x1="20" y1="370" x2="30" y2="370"/>
<text x="45" y="370">r</text>
<text x="55" y="370">e</text>
<text x="65" y="370">l</text>
<text x="75" y="370">e</text>
<text x="85" y="370">a</text>
<text x="95" y="370">s</text>
<text x="105" y="370">e</text>
<text x="115" y="370">s</text>
<text x="125" y="370">/</text>
<line x1="5" y1="379" x2="5" y2="401"/>
<line x1="5" y1="390" x2="10" y2="390"/>
<line x1="10" y1="390" x2="20" y2="390"/>
<line x1="20" y1="390" x2="30" y2="390"/>
<text x="45" y="390">o</text>
<text x="55" y="390">b</text>
<text x="65" y="390">j</text>
<text x="75" y="390">e</text>
<text x="85" y="390">c</text>
<text x="95" y="390">t</text>
<text x="105" y="390">s</text>
<text x="115" y="390">/</text>
<line x1="5" y1="399" x2="5" y2="421"/>
<line x1="5" y1="410" x2="10" y2="410"/>
<line x1="10" y1="410" x2="20" y2="410"/>
<line x1="20" y1="410" x2="30" y2="410"/>
<text x="45" y="410">c</text>
<text x="55" y="410">a</text>
<text x="65" y="410">p</text>
<text x="75" y="410">a</text>
<text x="85" y="410">b</text>
<text x="95" y="410">i</text>
<text x="105" y="410">l</text>
<text x="115" y="410">i</text>
<text x="125" y="410">t</text>
<text x="135" y="410">i</text>
<text x="145" y="410">e</text>
<text x="155" y="410">s</text>
<text x="165" y="410">/</text>
<line x1="5" y1="419" x2="5" y2="441"/>
<line x1="5" y1="430" x2="10" y2="430"/>
<line x1="10" y1="430" x2="20" y2="430"/>
<line x1="20" y1="430" x2="30" y2="430"/>
<text x="45" y="430">a</text>
<text x="55" y="430">u</text>
<text x="65" y="430">d</text>
<text x="75" y="430">i</text>
<text x="85" y="430">t</text>
<text x="95" y="430">/</text>
<line x1="5" y1="450" x2="10" y2="450"/>
<line x1="5" y1="439" x2="5" y2="450"/>
<line x1="10" y1="450" x2="20" y2="450"/>
<line x1="20" y1="450" x2="30" y2="450"/>
<text x="45" y="450">n</text>
<text x="55" y="450">o</text>
<text x="65" y="450">d</text>
<text x="75" y="450">e</text>
<text x="85" y="450">-</text>
<text x="95" y="450">h</text>
<text x="105" y="450">a</text>
<text x="115" y="450">r</text>
<text x="125" y="450">d</text>
<text x="135" y="450">w</text>
<text x="145" y="450">a</text>
<text x="155" y="450">r</text>
<text x="165" y="450">e</text>
</svg>
</div>
<h3>Key Files</h3>
<p>realm.pub - Your public identity, shareable:</p>
<pre class="language-scheme">
(realm-public-key
  (version 1)
  (created 1736400000)
  (algorithm "ed25519")
  (public-key #${7f3a2b4c...}))
</pre>
<p>realm.key - Your private key, encrypted:</p>
<pre class="language-scheme">
(realm-private-key
  (version 1)
  (algorithm "ed25519")
  (protection "passphrase")      ; or "hardware", "threshold"
  (kdf "argon2id")
  (kdf-params
    (ops-limit 3)                ; cryptopwhashOPSLIMIT_MODERATE
    (mem-limit 268435456)        ; 256 MB
    (salt #${random-32-bytes}))
  (cipher "xchacha20-poly1305")
  (nonce #${random-24-bytes})
  (ciphertext #${encrypted-private-key}))
</pre>
<p>keystore.meta - Configuration:</p>
<pre class="language-scheme">
(keystore-meta
  (version 1)
  (created 1736400000)
  (last-accessed 1736450000)
  (protection "passphrase")
  (backup-reminder 7776000)      ; 90 days
  (rotation-reminder 31536000))  ; 1 year
</pre>
</section>
<section>
<h2>Cryptographic Operations</h2>
<h3>Key Derivation</h3>
<p>Passphrase → encryption key via Argon2id:</p>
<pre class="language-scheme">
(define (derive-key passphrase salt)
  "Derive encryption key from passphrase using Argon2id"
  (let ((key (make-blob 32)))
    (sodium-pwhash!
      key
      passphrase
      salt
      3                          ; ops-limit (moderate)
      268435456                  ; mem-limit (256 MB)
      'argon2id)
    key))
</pre>
<p>Why Argon2id: - Memory-hard: resists GPU/ASIC attacks - Time-hard: configurable iterations - Side-channel resistant: hybrid of Argon2i and Argon2d - Winner of Password Hashing Competition - Already in libsodium</p>
<h3>Encryption</h3>
<p>Private key encrypted via XChaCha20-Poly1305:</p>
<pre class="language-scheme">
(define (encrypt-private-key private-key encryption-key)
  "Encrypt private key for storage"
  (let ((nonce (random-bytes 24)))
    (values
      nonce
      (sodium-secretbox private-key nonce encryption-key))))

(define (decrypt-private-key ciphertext nonce encryption-key)
  "Decrypt private key from storage"
  (sodium-secretbox-open ciphertext nonce encryption-key))
</pre>
<p>Why XChaCha20-Poly1305: - 256-bit key, 192-bit nonce - Extended nonce allows random generation (no counter needed) - Authenticated: tampering detected - Fast in software - Already in libsodium (crypto_secretbox)</p>
</section>
<section>
<h2>Bootstrap Flow</h2>
<h3>New Realm</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 620 500" width="620" height="500" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<text x="5" y="10">$</text>
<text x="25" y="10">.</text>
<text x="35" y="10">/</text>
<text x="45" y="10">c</text>
<text x="55" y="10">y</text>
<text x="65" y="10">b</text>
<text x="75" y="10">e</text>
<text x="85" y="10">r</text>
<text x="95" y="10">s</text>
<text x="105" y="10">p</text>
<text x="115" y="10">a</text>
<text x="125" y="10">c</text>
<text x="135" y="10">e</text>
<text x="145" y="10">-</text>
<text x="155" y="10">r</text>
<text x="165" y="10">e</text>
<text x="175" y="10">p</text>
<text x="185" y="10">l</text>
<line x1="5" y1="30" x2="10" y2="30"/>
<line x1="5" y1="30" x2="5" y2="41"/>
<line x1="10" y1="30" x2="20" y2="30"/>
<line x1="20" y1="30" x2="30" y2="30"/>
<line x1="30" y1="30" x2="40" y2="30"/>
<line x1="40" y1="30" x2="50" y2="30"/>
<line x1="50" y1="30" x2="60" y2="30"/>
<line x1="60" y1="30" x2="70" y2="30"/>
<line x1="70" y1="30" x2="80" y2="30"/>
<line x1="80" y1="30" x2="90" y2="30"/>
<line x1="90" y1="30" x2="100" y2="30"/>
<line x1="100" y1="30" x2="110" y2="30"/>
<line x1="110" y1="30" x2="120" y2="30"/>
<line x1="120" y1="30" x2="130" y2="30"/>
<line x1="130" y1="30" x2="140" y2="30"/>
<line x1="140" y1="30" x2="150" y2="30"/>
<line x1="150" y1="30" x2="160" y2="30"/>
<line x1="160" y1="30" x2="170" y2="30"/>
<line x1="170" y1="30" x2="180" y2="30"/>
<line x1="180" y1="30" x2="190" y2="30"/>
<line x1="190" y1="30" x2="200" y2="30"/>
<line x1="200" y1="30" x2="210" y2="30"/>
<line x1="210" y1="30" x2="220" y2="30"/>
<line x1="220" y1="30" x2="230" y2="30"/>
<line x1="230" y1="30" x2="240" y2="30"/>
<line x1="240" y1="30" x2="250" y2="30"/>
<line x1="250" y1="30" x2="260" y2="30"/>
<line x1="260" y1="30" x2="270" y2="30"/>
<line x1="270" y1="30" x2="280" y2="30"/>
<line x1="280" y1="30" x2="290" y2="30"/>
<line x1="290" y1="30" x2="300" y2="30"/>
<line x1="300" y1="30" x2="310" y2="30"/>
<line x1="310" y1="30" x2="320" y2="30"/>
<line x1="320" y1="30" x2="330" y2="30"/>
<line x1="330" y1="30" x2="340" y2="30"/>
<line x1="340" y1="30" x2="350" y2="30"/>
<line x1="350" y1="30" x2="360" y2="30"/>
<line x1="360" y1="30" x2="370" y2="30"/>
<line x1="370" y1="30" x2="380" y2="30"/>
<line x1="380" y1="30" x2="390" y2="30"/>
<line x1="390" y1="30" x2="400" y2="30"/>
<line x1="400" y1="30" x2="410" y2="30"/>
<line x1="410" y1="30" x2="420" y2="30"/>
<line x1="420" y1="30" x2="430" y2="30"/>
<line x1="430" y1="30" x2="440" y2="30"/>
<line x1="440" y1="30" x2="450" y2="30"/>
<line x1="450" y1="30" x2="460" y2="30"/>
<line x1="460" y1="30" x2="470" y2="30"/>
<line x1="470" y1="30" x2="480" y2="30"/>
<line x1="480" y1="30" x2="490" y2="30"/>
<line x1="490" y1="30" x2="500" y2="30"/>
<line x1="500" y1="30" x2="510" y2="30"/>
<line x1="510" y1="30" x2="520" y2="30"/>
<line x1="520" y1="30" x2="530" y2="30"/>
<line x1="530" y1="30" x2="540" y2="30"/>
<line x1="540" y1="30" x2="550" y2="30"/>
<line x1="550" y1="30" x2="560" y2="30"/>
<line x1="560" y1="30" x2="570" y2="30"/>
<line x1="570" y1="30" x2="580" y2="30"/>
<line x1="580" y1="30" x2="590" y2="30"/>
<line x1="590" y1="30" x2="600" y2="30"/>
<line x1="610" y1="30" x2="615" y2="30"/>
<line x1="615" y1="30" x2="615" y2="41"/>
<line x1="5" y1="39" x2="5" y2="61"/>
<text x="215" y="50">R</text>
<text x="225" y="50">E</text>
<text x="235" y="50">A</text>
<text x="245" y="50">L</text>
<text x="255" y="50">M</text>
<text x="275" y="50">B</text>
<text x="285" y="50">O</text>
<text x="295" y="50">O</text>
<text x="305" y="50">T</text>
<text x="315" y="50">S</text>
<text x="325" y="50">T</text>
<text x="335" y="50">R</text>
<text x="345" y="50">A</text>
<text x="355" y="50">P</text>
<line x1="615" y1="39" x2="615" y2="61"/>
<line x1="5" y1="70" x2="10" y2="70"/>
<line x1="5" y1="59" x2="5" y2="70"/>
<line x1="10" y1="70" x2="20" y2="70"/>
<line x1="20" y1="70" x2="30" y2="70"/>
<line x1="30" y1="70" x2="40" y2="70"/>
<line x1="40" y1="70" x2="50" y2="70"/>
<line x1="50" y1="70" x2="60" y2="70"/>
<line x1="60" y1="70" x2="70" y2="70"/>
<line x1="70" y1="70" x2="80" y2="70"/>
<line x1="80" y1="70" x2="90" y2="70"/>
<line x1="90" y1="70" x2="100" y2="70"/>
<line x1="100" y1="70" x2="110" y2="70"/>
<line x1="110" y1="70" x2="120" y2="70"/>
<line x1="120" y1="70" x2="130" y2="70"/>
<line x1="130" y1="70" x2="140" y2="70"/>
<line x1="140" y1="70" x2="150" y2="70"/>
<line x1="150" y1="70" x2="160" y2="70"/>
<line x1="160" y1="70" x2="170" y2="70"/>
<line x1="170" y1="70" x2="180" y2="70"/>
<line x1="180" y1="70" x2="190" y2="70"/>
<line x1="190" y1="70" x2="200" y2="70"/>
<line x1="200" y1="70" x2="210" y2="70"/>
<line x1="210" y1="70" x2="220" y2="70"/>
<line x1="220" y1="70" x2="230" y2="70"/>
<line x1="230" y1="70" x2="240" y2="70"/>
<line x1="240" y1="70" x2="250" y2="70"/>
<line x1="250" y1="70" x2="260" y2="70"/>
<line x1="260" y1="70" x2="270" y2="70"/>
<line x1="270" y1="70" x2="280" y2="70"/>
<line x1="280" y1="70" x2="290" y2="70"/>
<line x1="290" y1="70" x2="300" y2="70"/>
<line x1="300" y1="70" x2="310" y2="70"/>
<line x1="310" y1="70" x2="320" y2="70"/>
<line x1="320" y1="70" x2="330" y2="70"/>
<line x1="330" y1="70" x2="340" y2="70"/>
<line x1="340" y1="70" x2="350" y2="70"/>
<line x1="350" y1="70" x2="360" y2="70"/>
<line x1="360" y1="70" x2="370" y2="70"/>
<line x1="370" y1="70" x2="380" y2="70"/>
<line x1="380" y1="70" x2="390" y2="70"/>
<line x1="390" y1="70" x2="400" y2="70"/>
<line x1="400" y1="70" x2="410" y2="70"/>
<line x1="410" y1="70" x2="420" y2="70"/>
<line x1="420" y1="70" x2="430" y2="70"/>
<line x1="430" y1="70" x2="440" y2="70"/>
<line x1="440" y1="70" x2="450" y2="70"/>
<line x1="450" y1="70" x2="460" y2="70"/>
<line x1="460" y1="70" x2="470" y2="70"/>
<line x1="470" y1="70" x2="480" y2="70"/>
<line x1="480" y1="70" x2="490" y2="70"/>
<line x1="490" y1="70" x2="500" y2="70"/>
<line x1="500" y1="70" x2="510" y2="70"/>
<line x1="510" y1="70" x2="520" y2="70"/>
<line x1="520" y1="70" x2="530" y2="70"/>
<line x1="530" y1="70" x2="540" y2="70"/>
<line x1="540" y1="70" x2="550" y2="70"/>
<line x1="550" y1="70" x2="560" y2="70"/>
<line x1="560" y1="70" x2="570" y2="70"/>
<line x1="570" y1="70" x2="580" y2="70"/>
<line x1="580" y1="70" x2="590" y2="70"/>
<line x1="590" y1="70" x2="600" y2="70"/>
<line x1="610" y1="70" x2="615" y2="70"/>
<line x1="615" y1="59" x2="615" y2="70"/>
<text x="5" y="90">N</text>
<text x="15" y="90">o</text>
<text x="35" y="90">r</text>
<text x="45" y="90">e</text>
<text x="55" y="90">a</text>
<text x="65" y="90">l</text>
<text x="75" y="90">m</text>
<text x="95" y="90">i</text>
<text x="105" y="90">d</text>
<text x="115" y="90">e</text>
<text x="125" y="90">n</text>
<text x="135" y="90">t</text>
<text x="145" y="90">i</text>
<text x="155" y="90">t</text>
<text x="165" y="90">y</text>
<text x="185" y="90">f</text>
<text x="195" y="90">o</text>
<text x="205" y="90">u</text>
<text x="215" y="90">n</text>
<text x="225" y="90">d</text>
<text x="245" y="90">i</text>
<text x="255" y="90">n</text>
<text x="275" y="90">.</text>
<text x="285" y="90">v</text>
<text x="295" y="90">a</text>
<text x="305" y="90">u</text>
<text x="315" y="90">l</text>
<text x="325" y="90">t</text>
<text x="335" y="90">/</text>
<text x="345" y="90">k</text>
<text x="355" y="90">e</text>
<text x="365" y="90">y</text>
<text x="375" y="90">s</text>
<text x="385" y="90">t</text>
<text x="395" y="90">o</text>
<text x="405" y="90">r</text>
<text x="415" y="90">e</text>
<text x="425" y="90">/</text>
<text x="5" y="110">C</text>
<text x="15" y="110">r</text>
<text x="25" y="110">e</text>
<text x="35" y="110">a</text>
<text x="45" y="110">t</text>
<text x="55" y="110">e</text>
<text x="75" y="110">n</text>
<text x="85" y="110">e</text>
<text x="95" y="110">w</text>
<text x="115" y="110">r</text>
<text x="125" y="110">e</text>
<text x="135" y="110">a</text>
<text x="145" y="110">l</text>
<text x="155" y="110">m</text>
<text x="165" y="110">?</text>
<text x="185" y="110">[</text>
<text x="195" y="110">y</text>
<text x="205" y="110">/</text>
<text x="215" y="110">n</text>
<text x="225" y="110">]</text>
<text x="245" y="110">y</text>
<text x="5" y="130">C</text>
<text x="15" y="130">h</text>
<text x="25" y="130">o</text>
<text x="35" y="130">o</text>
<text x="45" y="130">s</text>
<text x="55" y="130">e</text>
<text x="75" y="130">p</text>
<text x="85" y="130">r</text>
<text x="95" y="130">o</text>
<text x="105" y="130">t</text>
<text x="115" y="130">e</text>
<text x="125" y="130">c</text>
<text x="135" y="130">t</text>
<text x="145" y="130">i</text>
<text x="155" y="130">o</text>
<text x="165" y="130">n</text>
<text x="185" y="130">m</text>
<text x="195" y="130">e</text>
<text x="205" y="130">t</text>
<text x="215" y="130">h</text>
<text x="225" y="130">o</text>
<text x="235" y="130">d</text>
<text x="245" y="130">:</text>
<text x="25" y="150">1</text>
<text x="35" y="150">.</text>
<text x="55" y="150">P</text>
<text x="65" y="150">a</text>
<text x="75" y="150">s</text>
<text x="85" y="150">s</text>
<text x="95" y="150">p</text>
<text x="105" y="150">h</text>
<text x="115" y="150">r</text>
<text x="125" y="150">a</text>
<text x="135" y="150">s</text>
<text x="145" y="150">e</text>
<text x="165" y="150">(</text>
<text x="175" y="150">r</text>
<text x="185" y="150">e</text>
<text x="195" y="150">c</text>
<text x="205" y="150">o</text>
<text x="215" y="150">m</text>
<text x="225" y="150">m</text>
<text x="235" y="150">e</text>
<text x="245" y="150">n</text>
<text x="255" y="150">d</text>
<text x="265" y="150">e</text>
<text x="275" y="150">d</text>
<text x="285" y="150">)</text>
<text x="25" y="170">2</text>
<text x="35" y="170">.</text>
<text x="55" y="170">H</text>
<text x="65" y="170">a</text>
<text x="75" y="170">r</text>
<text x="85" y="170">d</text>
<text x="95" y="170">w</text>
<text x="105" y="170">a</text>
<text x="115" y="170">r</text>
<text x="125" y="170">e</text>
<text x="145" y="170">t</text>
<text x="155" y="170">o</text>
<text x="165" y="170">k</text>
<text x="175" y="170">e</text>
<text x="185" y="170">n</text>
<text x="205" y="170">(</text>
<text x="215" y="170">r</text>
<text x="225" y="170">e</text>
<text x="235" y="170">q</text>
<text x="245" y="170">u</text>
<text x="255" y="170">i</text>
<text x="265" y="170">r</text>
<text x="275" y="170">e</text>
<text x="285" y="170">s</text>
<text x="305" y="170">Y</text>
<text x="315" y="170">u</text>
<text x="325" y="170">b</text>
<text x="335" y="170">i</text>
<text x="345" y="170">K</text>
<text x="355" y="170">e</text>
<text x="365" y="170">y</text>
<text x="375" y="170">)</text>
<text x="25" y="190">3</text>
<text x="35" y="190">.</text>
<text x="55" y="190">T</text>
<text x="65" y="190">h</text>
<text x="75" y="190">r</text>
<text x="85" y="190">e</text>
<text x="95" y="190">s</text>
<text x="105" y="190">h</text>
<text x="115" y="190">o</text>
<text x="125" y="190">l</text>
<text x="135" y="190">d</text>
<text x="155" y="190">(</text>
<text x="165" y="190">k</text>
<text x="175" y="190">-</text>
<text x="185" y="190">o</text>
<text x="195" y="190">f</text>
<text x="205" y="190">-</text>
<text x="215" y="190">n</text>
<text x="235" y="190">s</text>
<text x="245" y="190">h</text>
<text x="255" y="190">a</text>
<text x="265" y="190">r</text>
<text x="275" y="190">e</text>
<text x="285" y="190">s</text>
<text x="295" y="190">)</text>
<text x="5" y="210">S</text>
<text x="15" y="210">e</text>
<text x="25" y="210">l</text>
<text x="35" y="210">e</text>
<text x="45" y="210">c</text>
<text x="55" y="210">t</text>
<text x="65" y="210">i</text>
<text x="75" y="210">o</text>
<text x="85" y="210">n</text>
<text x="95" y="210">:</text>
<text x="115" y="210">1</text>
<text x="5" y="230">E</text>
<text x="15" y="230">n</text>
<text x="25" y="230">t</text>
<text x="35" y="230">e</text>
<text x="45" y="230">r</text>
<text x="65" y="230">p</text>
<text x="75" y="230">a</text>
<text x="85" y="230">s</text>
<text x="95" y="230">s</text>
<text x="105" y="230">p</text>
<text x="115" y="230">h</text>
<text x="125" y="230">r</text>
<text x="135" y="230">a</text>
<text x="145" y="230">s</text>
<text x="155" y="230">e</text>
<text x="165" y="230">:</text>
<text x="5" y="250">C</text>
<text x="15" y="250">o</text>
<text x="25" y="250">n</text>
<text x="35" y="250">f</text>
<text x="45" y="250">i</text>
<text x="55" y="250">r</text>
<text x="65" y="250">m</text>
<text x="85" y="250">p</text>
<text x="95" y="250">a</text>
<text x="105" y="250">s</text>
<text x="115" y="250">s</text>
<text x="125" y="250">p</text>
<text x="135" y="250">h</text>
<text x="145" y="250">r</text>
<text x="155" y="250">a</text>
<text x="165" y="250">s</text>
<text x="175" y="250">e</text>
<text x="185" y="250">:</text>
<text x="5" y="270">G</text>
<text x="15" y="270">e</text>
<text x="25" y="270">n</text>
<text x="35" y="270">e</text>
<text x="45" y="270">r</text>
<text x="55" y="270">a</text>
<text x="65" y="270">t</text>
<text x="75" y="270">i</text>
<text x="85" y="270">n</text>
<text x="95" y="270">g</text>
<text x="115" y="270">E</text>
<text x="125" y="270">d</text>
<text x="135" y="270">2</text>
<text x="145" y="270">5</text>
<text x="155" y="270">5</text>
<text x="165" y="270">1</text>
<text x="175" y="270">9</text>
<text x="195" y="270">k</text>
<text x="205" y="270">e</text>
<text x="215" y="270">y</text>
<text x="225" y="270">p</text>
<text x="235" y="270">a</text>
<text x="245" y="270">i</text>
<text x="255" y="270">r</text>
<text x="265" y="270">.</text>
<text x="275" y="270">.</text>
<text x="285" y="270">.</text>
<text x="5" y="290">E</text>
<text x="15" y="290">n</text>
<text x="25" y="290">c</text>
<text x="35" y="290">r</text>
<text x="45" y="290">y</text>
<text x="55" y="290">p</text>
<text x="65" y="290">t</text>
<text x="75" y="290">i</text>
<text x="85" y="290">n</text>
<text x="95" y="290">g</text>
<text x="115" y="290">w</text>
<text x="125" y="290">i</text>
<text x="135" y="290">t</text>
<text x="145" y="290">h</text>
<text x="165" y="290">A</text>
<text x="175" y="290">r</text>
<text x="185" y="290">g</text>
<text x="195" y="290">o</text>
<text x="205" y="290">n</text>
<text x="215" y="290">2</text>
<text x="225" y="290">i</text>
<text x="235" y="290">d</text>
<text x="255" y="290">(</text>
<text x="265" y="290">t</text>
<text x="275" y="290">h</text>
<text x="285" y="290">i</text>
<text x="295" y="290">s</text>
<text x="315" y="290">t</text>
<text x="325" y="290">a</text>
<text x="335" y="290">k</text>
<text x="345" y="290">e</text>
<text x="355" y="290">s</text>
<text x="375" y="290">a</text>
<text x="395" y="290">m</text>
<text x="405" y="290">o</text>
<text x="415" y="290">m</text>
<text x="425" y="290">e</text>
<text x="435" y="290">n</text>
<text x="445" y="290">t</text>
<text x="455" y="290">)</text>
<text x="465" y="290">.</text>
<text x="475" y="290">.</text>
<text x="485" y="290">.</text>
<line x1="5" y1="310" x2="10" y2="310"/>
<line x1="5" y1="310" x2="5" y2="321"/>
<line x1="10" y1="310" x2="20" y2="310"/>
<line x1="20" y1="310" x2="30" y2="310"/>
<line x1="30" y1="310" x2="40" y2="310"/>
<line x1="40" y1="310" x2="50" y2="310"/>
<line x1="50" y1="310" x2="60" y2="310"/>
<line x1="60" y1="310" x2="70" y2="310"/>
<line x1="70" y1="310" x2="80" y2="310"/>
<line x1="80" y1="310" x2="90" y2="310"/>
<line x1="90" y1="310" x2="100" y2="310"/>
<line x1="100" y1="310" x2="110" y2="310"/>
<line x1="110" y1="310" x2="120" y2="310"/>
<line x1="120" y1="310" x2="130" y2="310"/>
<line x1="130" y1="310" x2="140" y2="310"/>
<line x1="140" y1="310" x2="150" y2="310"/>
<line x1="150" y1="310" x2="160" y2="310"/>
<line x1="160" y1="310" x2="170" y2="310"/>
<line x1="170" y1="310" x2="180" y2="310"/>
<line x1="180" y1="310" x2="190" y2="310"/>
<line x1="190" y1="310" x2="200" y2="310"/>
<line x1="200" y1="310" x2="210" y2="310"/>
<line x1="210" y1="310" x2="220" y2="310"/>
<line x1="220" y1="310" x2="230" y2="310"/>
<line x1="230" y1="310" x2="240" y2="310"/>
<line x1="240" y1="310" x2="250" y2="310"/>
<line x1="250" y1="310" x2="260" y2="310"/>
<line x1="260" y1="310" x2="270" y2="310"/>
<line x1="270" y1="310" x2="280" y2="310"/>
<line x1="280" y1="310" x2="290" y2="310"/>
<line x1="290" y1="310" x2="300" y2="310"/>
<line x1="300" y1="310" x2="310" y2="310"/>
<line x1="310" y1="310" x2="320" y2="310"/>
<line x1="320" y1="310" x2="330" y2="310"/>
<line x1="330" y1="310" x2="340" y2="310"/>
<line x1="340" y1="310" x2="350" y2="310"/>
<line x1="350" y1="310" x2="360" y2="310"/>
<line x1="360" y1="310" x2="370" y2="310"/>
<line x1="370" y1="310" x2="380" y2="310"/>
<line x1="380" y1="310" x2="390" y2="310"/>
<line x1="390" y1="310" x2="400" y2="310"/>
<line x1="400" y1="310" x2="410" y2="310"/>
<line x1="410" y1="310" x2="420" y2="310"/>
<line x1="420" y1="310" x2="430" y2="310"/>
<line x1="430" y1="310" x2="440" y2="310"/>
<line x1="440" y1="310" x2="450" y2="310"/>
<line x1="450" y1="310" x2="460" y2="310"/>
<line x1="460" y1="310" x2="470" y2="310"/>
<line x1="470" y1="310" x2="480" y2="310"/>
<line x1="480" y1="310" x2="490" y2="310"/>
<line x1="490" y1="310" x2="500" y2="310"/>
<line x1="500" y1="310" x2="510" y2="310"/>
<line x1="510" y1="310" x2="520" y2="310"/>
<line x1="520" y1="310" x2="530" y2="310"/>
<line x1="530" y1="310" x2="540" y2="310"/>
<line x1="540" y1="310" x2="550" y2="310"/>
<line x1="550" y1="310" x2="560" y2="310"/>
<line x1="560" y1="310" x2="570" y2="310"/>
<line x1="570" y1="310" x2="580" y2="310"/>
<line x1="580" y1="310" x2="590" y2="310"/>
<line x1="590" y1="310" x2="600" y2="310"/>
<line x1="610" y1="310" x2="615" y2="310"/>
<line x1="615" y1="310" x2="615" y2="321"/>
<line x1="5" y1="319" x2="5" y2="341"/>
<text x="35" y="330">R</text>
<text x="45" y="330">E</text>
<text x="55" y="330">A</text>
<text x="65" y="330">L</text>
<text x="75" y="330">M</text>
<text x="95" y="330">C</text>
<text x="105" y="330">R</text>
<text x="115" y="330">E</text>
<text x="125" y="330">A</text>
<text x="135" y="330">T</text>
<text x="145" y="330">E</text>
<text x="155" y="330">D</text>
<line x1="615" y1="319" x2="615" y2="341"/>
<line x1="5" y1="339" x2="5" y2="361"/>
<line x1="615" y1="339" x2="615" y2="361"/>
<line x1="5" y1="359" x2="5" y2="381"/>
<text x="35" y="370">P</text>
<text x="45" y="370">r</text>
<text x="55" y="370">i</text>
<text x="65" y="370">n</text>
<text x="75" y="370">c</text>
<text x="85" y="370">i</text>
<text x="95" y="370">p</text>
<text x="105" y="370">a</text>
<text x="115" y="370">l</text>
<text x="125" y="370">:</text>
<text x="145" y="370">e</text>
<text x="155" y="370">d</text>
<text x="165" y="370">2</text>
<text x="175" y="370">5</text>
<text x="185" y="370">5</text>
<text x="195" y="370">1</text>
<text x="205" y="370">9</text>
<text x="215" y="370">:</text>
<text x="225" y="370">7</text>
<text x="235" y="370">f</text>
<text x="245" y="370">3</text>
<text x="255" y="370">a</text>
<text x="265" y="370">2</text>
<text x="275" y="370">b</text>
<text x="285" y="370">4</text>
<text x="295" y="370">c</text>
<text x="305" y="370">5</text>
<text x="315" y="370">d</text>
<text x="325" y="370">6</text>
<text x="335" y="370">e</text>
<text x="345" y="370">7</text>
<text x="355" y="370">f</text>
<text x="365" y="370">8</text>
<text x="375" y="370">a</text>
<text x="385" y="370">9</text>
<text x="395" y="370">b</text>
<text x="405" y="370">0</text>
<text x="415" y="370">c</text>
<text x="425" y="370">1</text>
<text x="435" y="370">d</text>
<text x="445" y="370">2</text>
<text x="455" y="370">e</text>
<text x="465" y="370">3</text>
<text x="475" y="370">f</text>
<text x="485" y="370">4</text>
<text x="495" y="370">a</text>
<text x="505" y="370">5</text>
<text x="515" y="370">b</text>
<text x="525" y="370">6</text>
<text x="535" y="370">c</text>
<text x="545" y="370">7</text>
<text x="555" y="370">d</text>
<text x="565" y="370">8</text>
<text x="575" y="370">e</text>
<line x1="615" y1="359" x2="615" y2="381"/>
<line x1="5" y1="379" x2="5" y2="401"/>
<text x="35" y="390">C</text>
<text x="45" y="390">r</text>
<text x="55" y="390">e</text>
<text x="65" y="390">a</text>
<text x="75" y="390">t</text>
<text x="85" y="390">e</text>
<text x="95" y="390">d</text>
<text x="105" y="390">:</text>
<text x="145" y="390">2</text>
<text x="155" y="390">0</text>
<text x="165" y="390">2</text>
<text x="175" y="390">6</text>
<text x="185" y="390">-</text>
<text x="195" y="390">0</text>
<text x="205" y="390">1</text>
<text x="215" y="390">-</text>
<text x="225" y="390">0</text>
<text x="235" y="390">8</text>
<text x="255" y="390">1</text>
<text x="265" y="390">4</text>
<text x="275" y="390">:</text>
<text x="285" y="390">3</text>
<text x="295" y="390">0</text>
<text x="305" y="390">:</text>
<text x="315" y="390">0</text>
<text x="325" y="390">0</text>
<text x="345" y="390">U</text>
<text x="355" y="390">T</text>
<text x="365" y="390">C</text>
<line x1="615" y1="379" x2="615" y2="401"/>
<line x1="5" y1="399" x2="5" y2="421"/>
<line x1="615" y1="399" x2="615" y2="421"/>
<line x1="5" y1="419" x2="5" y2="441"/>
<text x="35" y="430">I</text>
<text x="45" y="430">M</text>
<text x="55" y="430">P</text>
<text x="65" y="430">O</text>
<text x="75" y="430">R</text>
<text x="85" y="430">T</text>
<text x="95" y="430">A</text>
<text x="105" y="430">N</text>
<text x="115" y="430">T</text>
<text x="125" y="430">:</text>
<text x="145" y="430">Y</text>
<text x="155" y="430">o</text>
<text x="165" y="430">u</text>
<text x="175" y="430">r</text>
<text x="195" y="430">p</text>
<text x="205" y="430">a</text>
<text x="215" y="430">s</text>
<text x="225" y="430">s</text>
<text x="235" y="430">p</text>
<text x="245" y="430">h</text>
<text x="255" y="430">r</text>
<text x="265" y="430">a</text>
<text x="275" y="430">s</text>
<text x="285" y="430">e</text>
<text x="305" y="430">c</text>
<text x="315" y="430">a</text>
<text x="325" y="430">n</text>
<text x="335" y="430">n</text>
<text x="345" y="430">o</text>
<text x="355" y="430">t</text>
<text x="375" y="430">b</text>
<text x="385" y="430">e</text>
<text x="405" y="430">r</text>
<text x="415" y="430">e</text>
<text x="425" y="430">c</text>
<text x="435" y="430">o</text>
<text x="445" y="430">v</text>
<text x="455" y="430">e</text>
<text x="465" y="430">r</text>
<text x="475" y="430">e</text>
<text x="485" y="430">d</text>
<text x="495" y="430">.</text>
<line x1="615" y1="419" x2="615" y2="441"/>
<line x1="5" y1="439" x2="5" y2="461"/>
<text x="35" y="450">C</text>
<text x="45" y="450">o</text>
<text x="55" y="450">n</text>
<text x="65" y="450">s</text>
<text x="75" y="450">i</text>
<text x="85" y="450">d</text>
<text x="95" y="450">e</text>
<text x="105" y="450">r</text>
<text x="125" y="450">c</text>
<text x="135" y="450">r</text>
<text x="145" y="450">e</text>
<text x="155" y="450">a</text>
<text x="165" y="450">t</text>
<text x="175" y="450">i</text>
<text x="185" y="450">n</text>
<text x="195" y="450">g</text>
<text x="215" y="450">r</text>
<text x="225" y="450">e</text>
<text x="235" y="450">c</text>
<text x="245" y="450">o</text>
<text x="255" y="450">v</text>
<text x="265" y="450">e</text>
<text x="275" y="450">r</text>
<text x="285" y="450">y</text>
<text x="305" y="450">s</text>
<text x="315" y="450">h</text>
<text x="325" y="450">a</text>
<text x="335" y="450">r</text>
<text x="345" y="450">e</text>
<text x="355" y="450">s</text>
<text x="375" y="450">w</text>
<text x="385" y="450">i</text>
<text x="395" y="450">t</text>
<text x="405" y="450">h</text>
<text x="425" y="450">(</text>
<text x="435" y="450">k</text>
<text x="445" y="450">e</text>
<text x="455" y="450">y</text>
<text x="465" y="450">s</text>
<text x="475" y="450">t</text>
<text x="485" y="450">o</text>
<text x="495" y="450">r</text>
<text x="505" y="450">e</text>
<text x="515" y="450">-</text>
<text x="525" y="450">b</text>
<text x="535" y="450">a</text>
<text x="545" y="450">c</text>
<text x="555" y="450">k</text>
<text x="565" y="450">u</text>
<text x="575" y="450">p</text>
<text x="585" y="450">)</text>
<line x1="615" y1="439" x2="615" y2="461"/>
<line x1="5" y1="470" x2="10" y2="470"/>
<line x1="5" y1="459" x2="5" y2="470"/>
<line x1="10" y1="470" x2="20" y2="470"/>
<line x1="20" y1="470" x2="30" y2="470"/>
<line x1="30" y1="470" x2="40" y2="470"/>
<line x1="40" y1="470" x2="50" y2="470"/>
<line x1="50" y1="470" x2="60" y2="470"/>
<line x1="60" y1="470" x2="70" y2="470"/>
<line x1="70" y1="470" x2="80" y2="470"/>
<line x1="80" y1="470" x2="90" y2="470"/>
<line x1="90" y1="470" x2="100" y2="470"/>
<line x1="100" y1="470" x2="110" y2="470"/>
<line x1="110" y1="470" x2="120" y2="470"/>
<line x1="120" y1="470" x2="130" y2="470"/>
<line x1="130" y1="470" x2="140" y2="470"/>
<line x1="140" y1="470" x2="150" y2="470"/>
<line x1="150" y1="470" x2="160" y2="470"/>
<line x1="160" y1="470" x2="170" y2="470"/>
<line x1="170" y1="470" x2="180" y2="470"/>
<line x1="180" y1="470" x2="190" y2="470"/>
<line x1="190" y1="470" x2="200" y2="470"/>
<line x1="200" y1="470" x2="210" y2="470"/>
<line x1="210" y1="470" x2="220" y2="470"/>
<line x1="220" y1="470" x2="230" y2="470"/>
<line x1="230" y1="470" x2="240" y2="470"/>
<line x1="240" y1="470" x2="250" y2="470"/>
<line x1="250" y1="470" x2="260" y2="470"/>
<line x1="260" y1="470" x2="270" y2="470"/>
<line x1="270" y1="470" x2="280" y2="470"/>
<line x1="280" y1="470" x2="290" y2="470"/>
<line x1="290" y1="470" x2="300" y2="470"/>
<line x1="300" y1="470" x2="310" y2="470"/>
<line x1="310" y1="470" x2="320" y2="470"/>
<line x1="320" y1="470" x2="330" y2="470"/>
<line x1="330" y1="470" x2="340" y2="470"/>
<line x1="340" y1="470" x2="350" y2="470"/>
<line x1="350" y1="470" x2="360" y2="470"/>
<line x1="360" y1="470" x2="370" y2="470"/>
<line x1="370" y1="470" x2="380" y2="470"/>
<line x1="380" y1="470" x2="390" y2="470"/>
<line x1="390" y1="470" x2="400" y2="470"/>
<line x1="400" y1="470" x2="410" y2="470"/>
<line x1="410" y1="470" x2="420" y2="470"/>
<line x1="420" y1="470" x2="430" y2="470"/>
<line x1="430" y1="470" x2="440" y2="470"/>
<line x1="440" y1="470" x2="450" y2="470"/>
<line x1="450" y1="470" x2="460" y2="470"/>
<line x1="460" y1="470" x2="470" y2="470"/>
<line x1="470" y1="470" x2="480" y2="470"/>
<line x1="480" y1="470" x2="490" y2="470"/>
<line x1="490" y1="470" x2="500" y2="470"/>
<line x1="500" y1="470" x2="510" y2="470"/>
<line x1="510" y1="470" x2="520" y2="470"/>
<line x1="520" y1="470" x2="530" y2="470"/>
<line x1="530" y1="470" x2="540" y2="470"/>
<line x1="540" y1="470" x2="550" y2="470"/>
<line x1="550" y1="470" x2="560" y2="470"/>
<line x1="560" y1="470" x2="570" y2="470"/>
<line x1="570" y1="470" x2="580" y2="470"/>
<line x1="580" y1="470" x2="590" y2="470"/>
<line x1="590" y1="470" x2="600" y2="470"/>
<line x1="610" y1="470" x2="615" y2="470"/>
<line x1="615" y1="459" x2="615" y2="470"/>
<text x="5" y="490">c</text>
<text x="15" y="490">y</text>
<text x="25" y="490">b</text>
<text x="35" y="490">e</text>
<text x="45" y="490">r</text>
<text x="55" y="490">s</text>
<text x="65" y="490">p</text>
<text x="75" y="490">a</text>
<text x="85" y="490">c</text>
<text x="95" y="490">e</text>
<text x="105" y="490">&gt;</text>
</svg>
</div>
<h3>Existing Realm</h3>
<pre>
$ ./cyberspace-repl

Realm: ed25519:7f3a2b4c...
Passphrase: 

Unlocking keystore...

cyberspace&gt; ; Ready, identity loaded
</pre>
<h3>Failed Unlock</h3>
<pre>
Passphrase: 

ERROR: Decryption failed (wrong passphrase?)
Attempts remaining: 2

Passphrase: 

ERROR: Decryption failed
Attempts remaining: 1

WARNING: One attempt remaining. Consider:
  - Recovery shares if configured
  - The passphrase is case-sensitive
  - Check caps lock
</pre>
</section>
<section>
<h2>Recovery</h2>
<h3>Threshold Shares</h3>
<p>For high-value realms, split the key into k-of-n shares (Memo-008):</p>
<pre class="language-scheme">
(keystore-backup
  threshold: 2                   ; k - shares needed
  shares: 3)                     ; n - shares created

;; Output:
;; Share 1 of 3 (requires 2 to recover):
;; CYBER-SHARE-1-7f3a2b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2
;;
;; Share 2 of 3 (requires 2 to recover):
;; CYBER-SHARE-2-8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8
;;
;; Share 3 of 3 (requires 2 to recover):
;; CYBER-SHARE-3-9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9
;;
;; STORE THESE SEPARATELY. Any 2 can recover your realm.
</pre>
<p>Recovery:</p>
<pre class="language-scheme">
(keystore-recover
  "CYBER-SHARE-1-7f3a2b4c..."
  "CYBER-SHARE-3-9b0c1d2e...")

;; Realm recovered. Set new passphrase:
;; New passphrase: 
;; Confirm: 
;; Keystore restored.
</pre>
<h3>Paper Backup</h3>
<p>For the paranoid (wisely so):</p>
<pre class="language-scheme">
(keystore-paper-backup)

;; Generates QR code + text backup for offline storage
;; Encrypted with passphrase, prints to terminal/file
</pre>
</section>
<section>
<h2>Key Rotation</h2>
<p>Keys should rotate periodically. Old key signs new key, creating continuity:</p>
<pre class="language-scheme">
(keystore-rotate)

;; Current principal: ed25519:7f3a2b4c...
;;
;; This will:
;;   1. Generate new Ed25519 keypair
;;   2. Sign rotation certificate with old key
;;   3. Store rotation chain in keystore
;;   4. New principal becomes active
;;
;; Proceed? [y/n] y
;;
;; Enter current passphrase: 
;; Enter new passphrase (or same): 
;;
;; Generating new keypair...
;; Signing rotation certificate...
;;
;; ROTATION COMPLETE
;; Old principal: ed25519:7f3a2b4c...
;; New principal: ed25519:2c3d4e5f...
;; Rotation cert: sha512:rotation-cert-hash...
;;
;; Old capabilities referencing ed25519:7f3a2b4c will need reissuance.
</pre>
<p>Rotation certificate:</p>
<pre class="language-scheme">
(rotation-cert
  (old-principal "ed25519:7f3a2b4c...")
  (new-principal "ed25519:2c3d4e5f...")
  (timestamp 1736500000)
  (reason "scheduled-rotation")
  (signature "ed25519:old-key-signature..."))
</pre>
</section>
<section>
<h2>Attestation Store</h2>
<p>Attestations are signed claims about the realm. They answer: "What can you prove about yourself?"</p>
<h3>Attestation Types</h3>
<p>Hardware Attestations - proofs from silicon:</p>
<pre class="language-scheme">
(hardware-attestation
  (type "anchor-quote")
  (timestamp 1736400000)
  (platform "Darwin-arm64")
  (measurements
    (rune-boot #${boot-measurement...})
    (rune-policy #${secureboot-policy...}))
  (signature #${anchor-signature...})
  (certificate #${endorsement-key-cert...}))
</pre>
<p>Software Attestations - proofs from code:</p>
<pre class="language-scheme">
(software-attestation
  (type "runtime-measurement")
  (timestamp 1736400000)
  (binary-hash "sha512:cyberspace-repl...")
  (library-hashes
    ("libsodium.dylib" "sha512:...")
    ("libchicken.dylib" "sha512:..."))
  (signature #${realm-signature...}))
</pre>
<p>Identity Attestations - third-party vouches:</p>
<pre class="language-scheme">
(identity-attestation
  (type "ca-vouch")
  (timestamp 1736400000)
  (subject "ed25519:7f3a2b4c...")         ; This realm
  (issuer "ed25519:ca-public-key...")     ; Vouching authority
  (claims
    (organization "Acme Corp")
    (role "coordinator"))
  (valid (not-after 1767936000))
  (signature #${ca-signature...}))
</pre>
<p>Capability Attestations - proof of holding:</p>
<pre class="language-scheme">
(capability-attestation
  (type "capability-proof")
  (timestamp 1736400000)
  (capability "sha512:cert-hash...")
  (holder "ed25519:7f3a2b4c...")
  (challenge #${nonce...})                ; Prevents replay
  (response #${signed-challenge...}))
</pre>
<h3>Attestation Catalog</h3>
<p>The attestation store maintains a catalog for fast lookup:</p>
<pre class="language-scheme">
(attestations-meta
  (version 1)
  (count 5)
  (types
    (hardware 2)
    (software 1)
    (identity 1)
    (capability 1))
  (latest-refresh 1736400000)
  (entries
    ((id "att-001") (type hardware) (file "hardware/anchor-quote.att") (expires #f))
    ((id "att-002") (type hardware) (file "hardware/secure-enclave.att") (expires #f))
    ((id "att-003") (type software) (file "software/runtime-hash.att") (expires #f))
    ((id "att-004") (type identity) (file "identity/ca-cert.att") (expires 1767936000))
    ((id "att-005") (type capability) (file "capability/coord-role.att") (expires 1736500000))))
</pre>
<h3>Attestation Operations</h3>
<pre class="language-scheme">
;; Refresh hardware attestations (re-measure)
(attestation-refresh-hardware)
;; =&gt; Querying Anchor... done.
;; =&gt; Querying Secure Enclave... done.
;; =&gt; 2 hardware attestations updated.

;; Measure current software state
(attestation-measure-software)
;; =&gt; Hashing cyberspace-repl... done.
;; =&gt; Hashing loaded libraries... done.
;; =&gt; Software attestation stored.

;; Request identity attestation from CA
(attestation-request-identity "ed25519:ca-key...")
;; =&gt; Sending attestation request to CA...
;; =&gt; (requires CA to sign and return)

;; Prove capability holding (for remote verification)
(attestation-prove-capability "sha512:cert-hash..." challenge)
;; =&gt; (capability-attestation ...)

;; List all attestations
(attestation-list)
;; =&gt; ((att-001 hardware anchor-quote valid)
;;     (att-002 hardware secure-enclave valid)
;;     (att-003 software runtime-hash valid)
;;     (att-004 identity ca-cert expires:2026-12-31)
;;     (att-005 capability coord-role expires:2026-01-10))

;; Verify an attestation
(attestation-verify "att-001")
;; =&gt; (attestation att-001 (status valid) (type hardware) (verified #t))

;; Export for remote verification
(attestation-export "att-001")
;; =&gt; (hardware-attestation (type "anchor-quote") ...)
</pre>
<h3>Attestation Chain</h3>
<p>Attestations can chain - a hardware attestation vouches for software, software vouches for capabilities:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 630 360" width="630" height="360" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<line x1="5" y1="10" x2="10" y2="10"/>
<line x1="5" y1="10" x2="5" y2="21"/>
<line x1="10" y1="10" x2="20" y2="10"/>
<line x1="20" y1="10" x2="30" y2="10"/>
<line x1="30" y1="10" x2="40" y2="10"/>
<line x1="40" y1="10" x2="50" y2="10"/>
<line x1="50" y1="10" x2="60" y2="10"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="160" y2="10"/>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="180" y2="10"/>
<line x1="180" y1="10" x2="190" y2="10"/>
<line x1="190" y1="10" x2="200" y2="10"/>
<line x1="200" y1="10" x2="210" y2="10"/>
<line x1="210" y1="10" x2="220" y2="10"/>
<line x1="220" y1="10" x2="230" y2="10"/>
<line x1="230" y1="10" x2="240" y2="10"/>
<line x1="240" y1="10" x2="250" y2="10"/>
<line x1="250" y1="10" x2="260" y2="10"/>
<line x1="260" y1="10" x2="270" y2="10"/>
<line x1="270" y1="10" x2="280" y2="10"/>
<line x1="620" y1="10" x2="625" y2="10"/>
<line x1="625" y1="10" x2="625" y2="21"/>
<line x1="5" y1="19" x2="5" y2="41"/>
<text x="55" y="30">T</text>
<text x="65" y="30">h</text>
<text x="75" y="30">e</text>
<text x="95" y="30">A</text>
<text x="105" y="30">n</text>
<text x="115" y="30">c</text>
<text x="125" y="30">h</text>
<text x="135" y="30">o</text>
<text x="145" y="30">r</text>
<text x="165" y="30">(</text>
<text x="175" y="30">S</text>
<text x="185" y="30">i</text>
<text x="195" y="30">l</text>
<text x="205" y="30">i</text>
<text x="215" y="30">c</text>
<text x="225" y="30">o</text>
<text x="235" y="30">n</text>
<text x="245" y="30">)</text>
<line x1="285" y1="19" x2="285" y2="41"/>
<text x="315" y="30">"</text>
<text x="325" y="30">T</text>
<text x="335" y="30">h</text>
<text x="345" y="30">i</text>
<text x="355" y="30">s</text>
<text x="375" y="30">b</text>
<text x="385" y="30">o</text>
<text x="395" y="30">o</text>
<text x="405" y="30">t</text>
<text x="425" y="30">s</text>
<text x="435" y="30">e</text>
<text x="445" y="30">q</text>
<text x="455" y="30">u</text>
<text x="465" y="30">e</text>
<text x="475" y="30">n</text>
<text x="485" y="30">c</text>
<text x="495" y="30">e</text>
<text x="515" y="30">i</text>
<text x="525" y="30">s</text>
<text x="545" y="30">m</text>
<text x="555" y="30">e</text>
<text x="565" y="30">a</text>
<text x="575" y="30">s</text>
<text x="585" y="30">u</text>
<text x="595" y="30">r</text>
<text x="605" y="30">e</text>
<text x="615" y="30">d</text>
<text x="625" y="30">"</text>
<line x1="5" y1="50" x2="10" y2="50"/>
<line x1="5" y1="39" x2="5" y2="50"/>
<line x1="10" y1="50" x2="20" y2="50"/>
<line x1="20" y1="50" x2="30" y2="50"/>
<line x1="30" y1="50" x2="40" y2="50"/>
<line x1="40" y1="50" x2="50" y2="50"/>
<line x1="50" y1="50" x2="60" y2="50"/>
<line x1="60" y1="50" x2="70" y2="50"/>
<line x1="70" y1="50" x2="80" y2="50"/>
<line x1="80" y1="50" x2="90" y2="50"/>
<line x1="90" y1="50" x2="100" y2="50"/>
<line x1="100" y1="50" x2="110" y2="50"/>
<line x1="110" y1="50" x2="120" y2="50"/>
<line x1="120" y1="50" x2="130" y2="50"/>
<line x1="130" y1="50" x2="140" y2="50"/>
<line x1="140" y1="50" x2="150" y2="50"/>
<line x1="145" y1="50" x2="145" y2="61"/>
<line x1="150" y1="50" x2="160" y2="50"/>
<line x1="160" y1="50" x2="170" y2="50"/>
<line x1="170" y1="50" x2="180" y2="50"/>
<line x1="180" y1="50" x2="190" y2="50"/>
<line x1="190" y1="50" x2="200" y2="50"/>
<line x1="200" y1="50" x2="210" y2="50"/>
<line x1="210" y1="50" x2="220" y2="50"/>
<line x1="220" y1="50" x2="230" y2="50"/>
<line x1="230" y1="50" x2="240" y2="50"/>
<line x1="240" y1="50" x2="250" y2="50"/>
<line x1="250" y1="50" x2="260" y2="50"/>
<line x1="260" y1="50" x2="270" y2="50"/>
<line x1="270" y1="50" x2="280" y2="50"/>
<line x1="620" y1="50" x2="625" y2="50"/>
<line x1="625" y1="39" x2="625" y2="50"/>
<line x1="145" y1="59" x2="145" y2="81"/>
<text x="165" y="70">v</text>
<text x="175" y="70">o</text>
<text x="185" y="70">u</text>
<text x="195" y="70">c</text>
<text x="205" y="70">h</text>
<text x="215" y="70">e</text>
<text x="225" y="70">s</text>
<text x="245" y="70">f</text>
<text x="255" y="70">o</text>
<text x="265" y="70">r</text>
<text x="145" y="90">↓</text>
<line x1="5" y1="110" x2="10" y2="110"/>
<line x1="5" y1="110" x2="5" y2="121"/>
<line x1="10" y1="110" x2="20" y2="110"/>
<line x1="20" y1="110" x2="30" y2="110"/>
<line x1="30" y1="110" x2="40" y2="110"/>
<line x1="40" y1="110" x2="50" y2="110"/>
<line x1="50" y1="110" x2="60" y2="110"/>
<line x1="60" y1="110" x2="70" y2="110"/>
<line x1="70" y1="110" x2="80" y2="110"/>
<line x1="80" y1="110" x2="90" y2="110"/>
<line x1="90" y1="110" x2="100" y2="110"/>
<line x1="100" y1="110" x2="110" y2="110"/>
<line x1="110" y1="110" x2="120" y2="110"/>
<line x1="120" y1="110" x2="130" y2="110"/>
<line x1="130" y1="110" x2="140" y2="110"/>
<line x1="140" y1="110" x2="150" y2="110"/>
<line x1="150" y1="110" x2="160" y2="110"/>
<line x1="160" y1="110" x2="170" y2="110"/>
<line x1="170" y1="110" x2="180" y2="110"/>
<line x1="180" y1="110" x2="190" y2="110"/>
<line x1="190" y1="110" x2="200" y2="110"/>
<line x1="200" y1="110" x2="210" y2="110"/>
<line x1="210" y1="110" x2="220" y2="110"/>
<line x1="220" y1="110" x2="230" y2="110"/>
<line x1="230" y1="110" x2="240" y2="110"/>
<line x1="240" y1="110" x2="250" y2="110"/>
<line x1="250" y1="110" x2="260" y2="110"/>
<line x1="260" y1="110" x2="270" y2="110"/>
<line x1="270" y1="110" x2="280" y2="110"/>
<line x1="620" y1="110" x2="625" y2="110"/>
<line x1="625" y1="110" x2="625" y2="121"/>
<line x1="5" y1="119" x2="5" y2="141"/>
<text x="55" y="130">S</text>
<text x="65" y="130">o</text>
<text x="75" y="130">f</text>
<text x="85" y="130">t</text>
<text x="95" y="130">w</text>
<text x="105" y="130">a</text>
<text x="115" y="130">r</text>
<text x="125" y="130">e</text>
<text x="145" y="130">R</text>
<text x="155" y="130">u</text>
<text x="165" y="130">n</text>
<text x="175" y="130">e</text>
<text x="185" y="130">s</text>
<line x1="285" y1="119" x2="285" y2="141"/>
<text x="315" y="130">"</text>
<text x="325" y="130">T</text>
<text x="335" y="130">h</text>
<text x="345" y="130">e</text>
<text x="355" y="130">s</text>
<text x="365" y="130">e</text>
<text x="385" y="130">b</text>
<text x="395" y="130">i</text>
<text x="405" y="130">n</text>
<text x="415" y="130">a</text>
<text x="425" y="130">r</text>
<text x="435" y="130">i</text>
<text x="445" y="130">e</text>
<text x="455" y="130">s</text>
<text x="475" y="130">a</text>
<text x="485" y="130">r</text>
<text x="495" y="130">e</text>
<text x="515" y="130">r</text>
<text x="525" y="130">u</text>
<text x="535" y="130">n</text>
<text x="545" y="130">n</text>
<text x="555" y="130">i</text>
<text x="565" y="130">n</text>
<text x="575" y="130">g</text>
<text x="585" y="130">"</text>
<line x1="5" y1="150" x2="10" y2="150"/>
<line x1="5" y1="139" x2="5" y2="150"/>
<line x1="10" y1="150" x2="20" y2="150"/>
<line x1="20" y1="150" x2="30" y2="150"/>
<line x1="30" y1="150" x2="40" y2="150"/>
<line x1="40" y1="150" x2="50" y2="150"/>
<line x1="50" y1="150" x2="60" y2="150"/>
<line x1="60" y1="150" x2="70" y2="150"/>
<line x1="70" y1="150" x2="80" y2="150"/>
<line x1="80" y1="150" x2="90" y2="150"/>
<line x1="90" y1="150" x2="100" y2="150"/>
<line x1="100" y1="150" x2="110" y2="150"/>
<line x1="110" y1="150" x2="120" y2="150"/>
<line x1="120" y1="150" x2="130" y2="150"/>
<line x1="130" y1="150" x2="140" y2="150"/>
<line x1="140" y1="150" x2="150" y2="150"/>
<line x1="145" y1="150" x2="145" y2="161"/>
<line x1="150" y1="150" x2="160" y2="150"/>
<line x1="160" y1="150" x2="170" y2="150"/>
<line x1="170" y1="150" x2="180" y2="150"/>
<line x1="180" y1="150" x2="190" y2="150"/>
<line x1="190" y1="150" x2="200" y2="150"/>
<line x1="200" y1="150" x2="210" y2="150"/>
<line x1="210" y1="150" x2="220" y2="150"/>
<line x1="220" y1="150" x2="230" y2="150"/>
<line x1="230" y1="150" x2="240" y2="150"/>
<line x1="240" y1="150" x2="250" y2="150"/>
<line x1="250" y1="150" x2="260" y2="150"/>
<line x1="260" y1="150" x2="270" y2="150"/>
<line x1="270" y1="150" x2="280" y2="150"/>
<line x1="620" y1="150" x2="625" y2="150"/>
<line x1="625" y1="139" x2="625" y2="150"/>
<line x1="145" y1="159" x2="145" y2="181"/>
<text x="165" y="170">v</text>
<text x="175" y="170">o</text>
<text x="185" y="170">u</text>
<text x="195" y="170">c</text>
<text x="205" y="170">h</text>
<text x="215" y="170">e</text>
<text x="225" y="170">s</text>
<text x="245" y="170">f</text>
<text x="255" y="170">o</text>
<text x="265" y="170">r</text>
<text x="145" y="190">↓</text>
<line x1="5" y1="210" x2="10" y2="210"/>
<line x1="5" y1="210" x2="5" y2="221"/>
<line x1="10" y1="210" x2="20" y2="210"/>
<line x1="20" y1="210" x2="30" y2="210"/>
<line x1="30" y1="210" x2="40" y2="210"/>
<line x1="40" y1="210" x2="50" y2="210"/>
<line x1="50" y1="210" x2="60" y2="210"/>
<line x1="60" y1="210" x2="70" y2="210"/>
<line x1="70" y1="210" x2="80" y2="210"/>
<line x1="80" y1="210" x2="90" y2="210"/>
<line x1="90" y1="210" x2="100" y2="210"/>
<line x1="100" y1="210" x2="110" y2="210"/>
<line x1="110" y1="210" x2="120" y2="210"/>
<line x1="120" y1="210" x2="130" y2="210"/>
<line x1="130" y1="210" x2="140" y2="210"/>
<line x1="140" y1="210" x2="150" y2="210"/>
<line x1="150" y1="210" x2="160" y2="210"/>
<line x1="160" y1="210" x2="170" y2="210"/>
<line x1="170" y1="210" x2="180" y2="210"/>
<line x1="180" y1="210" x2="190" y2="210"/>
<line x1="190" y1="210" x2="200" y2="210"/>
<line x1="200" y1="210" x2="210" y2="210"/>
<line x1="210" y1="210" x2="220" y2="210"/>
<line x1="220" y1="210" x2="230" y2="210"/>
<line x1="230" y1="210" x2="240" y2="210"/>
<line x1="240" y1="210" x2="250" y2="210"/>
<line x1="250" y1="210" x2="260" y2="210"/>
<line x1="260" y1="210" x2="270" y2="210"/>
<line x1="270" y1="210" x2="280" y2="210"/>
<line x1="620" y1="210" x2="625" y2="210"/>
<line x1="625" y1="210" x2="625" y2="221"/>
<line x1="5" y1="219" x2="5" y2="241"/>
<text x="55" y="230">R</text>
<text x="65" y="230">e</text>
<text x="75" y="230">a</text>
<text x="85" y="230">l</text>
<text x="95" y="230">m</text>
<text x="115" y="230">I</text>
<text x="125" y="230">d</text>
<text x="135" y="230">e</text>
<text x="145" y="230">n</text>
<text x="155" y="230">t</text>
<text x="165" y="230">i</text>
<text x="175" y="230">t</text>
<text x="185" y="230">y</text>
<line x1="285" y1="219" x2="285" y2="241"/>
<text x="315" y="230">"</text>
<text x="325" y="230">T</text>
<text x="335" y="230">h</text>
<text x="345" y="230">i</text>
<text x="355" y="230">s</text>
<text x="375" y="230">i</text>
<text x="385" y="230">s</text>
<text x="405" y="230">m</text>
<text x="415" y="230">y</text>
<text x="435" y="230">s</text>
<text x="445" y="230">i</text>
<text x="455" y="230">g</text>
<text x="465" y="230">n</text>
<text x="475" y="230">i</text>
<text x="485" y="230">n</text>
<text x="495" y="230">g</text>
<text x="515" y="230">k</text>
<text x="525" y="230">e</text>
<text x="535" y="230">y</text>
<text x="545" y="230">"</text>
<line x1="5" y1="250" x2="10" y2="250"/>
<line x1="5" y1="239" x2="5" y2="250"/>
<line x1="10" y1="250" x2="20" y2="250"/>
<line x1="20" y1="250" x2="30" y2="250"/>
<line x1="30" y1="250" x2="40" y2="250"/>
<line x1="40" y1="250" x2="50" y2="250"/>
<line x1="50" y1="250" x2="60" y2="250"/>
<line x1="60" y1="250" x2="70" y2="250"/>
<line x1="70" y1="250" x2="80" y2="250"/>
<line x1="80" y1="250" x2="90" y2="250"/>
<line x1="90" y1="250" x2="100" y2="250"/>
<line x1="100" y1="250" x2="110" y2="250"/>
<line x1="110" y1="250" x2="120" y2="250"/>
<line x1="120" y1="250" x2="130" y2="250"/>
<line x1="130" y1="250" x2="140" y2="250"/>
<line x1="140" y1="250" x2="150" y2="250"/>
<line x1="145" y1="250" x2="145" y2="261"/>
<line x1="150" y1="250" x2="160" y2="250"/>
<line x1="160" y1="250" x2="170" y2="250"/>
<line x1="170" y1="250" x2="180" y2="250"/>
<line x1="180" y1="250" x2="190" y2="250"/>
<line x1="190" y1="250" x2="200" y2="250"/>
<line x1="200" y1="250" x2="210" y2="250"/>
<line x1="210" y1="250" x2="220" y2="250"/>
<line x1="220" y1="250" x2="230" y2="250"/>
<line x1="230" y1="250" x2="240" y2="250"/>
<line x1="240" y1="250" x2="250" y2="250"/>
<line x1="250" y1="250" x2="260" y2="250"/>
<line x1="260" y1="250" x2="270" y2="250"/>
<line x1="270" y1="250" x2="280" y2="250"/>
<line x1="620" y1="250" x2="625" y2="250"/>
<line x1="625" y1="239" x2="625" y2="250"/>
<line x1="145" y1="259" x2="145" y2="281"/>
<text x="165" y="270">v</text>
<text x="175" y="270">o</text>
<text x="185" y="270">u</text>
<text x="195" y="270">c</text>
<text x="205" y="270">h</text>
<text x="215" y="270">e</text>
<text x="225" y="270">s</text>
<text x="245" y="270">f</text>
<text x="255" y="270">o</text>
<text x="265" y="270">r</text>
<text x="145" y="290">↓</text>
<line x1="5" y1="310" x2="10" y2="310"/>
<line x1="5" y1="310" x2="5" y2="321"/>
<line x1="10" y1="310" x2="20" y2="310"/>
<line x1="20" y1="310" x2="30" y2="310"/>
<line x1="30" y1="310" x2="40" y2="310"/>
<line x1="40" y1="310" x2="50" y2="310"/>
<line x1="50" y1="310" x2="60" y2="310"/>
<line x1="60" y1="310" x2="70" y2="310"/>
<line x1="70" y1="310" x2="80" y2="310"/>
<line x1="80" y1="310" x2="90" y2="310"/>
<line x1="90" y1="310" x2="100" y2="310"/>
<line x1="100" y1="310" x2="110" y2="310"/>
<line x1="110" y1="310" x2="120" y2="310"/>
<line x1="120" y1="310" x2="130" y2="310"/>
<line x1="130" y1="310" x2="140" y2="310"/>
<line x1="140" y1="310" x2="150" y2="310"/>
<line x1="150" y1="310" x2="160" y2="310"/>
<line x1="160" y1="310" x2="170" y2="310"/>
<line x1="170" y1="310" x2="180" y2="310"/>
<line x1="180" y1="310" x2="190" y2="310"/>
<line x1="190" y1="310" x2="200" y2="310"/>
<line x1="200" y1="310" x2="210" y2="310"/>
<line x1="210" y1="310" x2="220" y2="310"/>
<line x1="220" y1="310" x2="230" y2="310"/>
<line x1="230" y1="310" x2="240" y2="310"/>
<line x1="240" y1="310" x2="250" y2="310"/>
<line x1="250" y1="310" x2="260" y2="310"/>
<line x1="260" y1="310" x2="270" y2="310"/>
<line x1="270" y1="310" x2="280" y2="310"/>
<line x1="620" y1="310" x2="625" y2="310"/>
<line x1="625" y1="310" x2="625" y2="321"/>
<line x1="5" y1="319" x2="5" y2="341"/>
<text x="55" y="330">C</text>
<text x="65" y="330">a</text>
<text x="75" y="330">p</text>
<text x="85" y="330">a</text>
<text x="95" y="330">b</text>
<text x="105" y="330">i</text>
<text x="115" y="330">l</text>
<text x="125" y="330">i</text>
<text x="135" y="330">t</text>
<text x="145" y="330">i</text>
<text x="155" y="330">e</text>
<text x="165" y="330">s</text>
<text x="185" y="330">H</text>
<text x="195" y="330">e</text>
<text x="205" y="330">l</text>
<text x="215" y="330">d</text>
<line x1="285" y1="319" x2="285" y2="341"/>
<text x="315" y="330">"</text>
<text x="325" y="330">I</text>
<text x="345" y="330">c</text>
<text x="355" y="330">a</text>
<text x="365" y="330">n</text>
<text x="385" y="330">d</text>
<text x="395" y="330">o</text>
<text x="415" y="330">t</text>
<text x="425" y="330">h</text>
<text x="435" y="330">e</text>
<text x="445" y="330">s</text>
<text x="455" y="330">e</text>
<text x="475" y="330">t</text>
<text x="485" y="330">h</text>
<text x="495" y="330">i</text>
<text x="505" y="330">n</text>
<text x="515" y="330">g</text>
<text x="525" y="330">s</text>
<text x="535" y="330">"</text>
<line x1="5" y1="350" x2="10" y2="350"/>
<line x1="5" y1="339" x2="5" y2="350"/>
<line x1="10" y1="350" x2="20" y2="350"/>
<line x1="20" y1="350" x2="30" y2="350"/>
<line x1="30" y1="350" x2="40" y2="350"/>
<line x1="40" y1="350" x2="50" y2="350"/>
<line x1="50" y1="350" x2="60" y2="350"/>
<line x1="60" y1="350" x2="70" y2="350"/>
<line x1="70" y1="350" x2="80" y2="350"/>
<line x1="80" y1="350" x2="90" y2="350"/>
<line x1="90" y1="350" x2="100" y2="350"/>
<line x1="100" y1="350" x2="110" y2="350"/>
<line x1="110" y1="350" x2="120" y2="350"/>
<line x1="120" y1="350" x2="130" y2="350"/>
<line x1="130" y1="350" x2="140" y2="350"/>
<line x1="140" y1="350" x2="150" y2="350"/>
<line x1="150" y1="350" x2="160" y2="350"/>
<line x1="160" y1="350" x2="170" y2="350"/>
<line x1="170" y1="350" x2="180" y2="350"/>
<line x1="180" y1="350" x2="190" y2="350"/>
<line x1="190" y1="350" x2="200" y2="350"/>
<line x1="200" y1="350" x2="210" y2="350"/>
<line x1="210" y1="350" x2="220" y2="350"/>
<line x1="220" y1="350" x2="230" y2="350"/>
<line x1="230" y1="350" x2="240" y2="350"/>
<line x1="240" y1="350" x2="250" y2="350"/>
<line x1="250" y1="350" x2="260" y2="350"/>
<line x1="260" y1="350" x2="270" y2="350"/>
<line x1="270" y1="350" x2="280" y2="350"/>
<line x1="620" y1="350" x2="625" y2="350"/>
<line x1="625" y1="339" x2="625" y2="350"/>
</svg>
</div>
<p>Remote verifier can walk the chain: "Show me your hardware attestation, software measurement, and the capability you claim."</p>
<h3>Use Cases</h3>
<p>Coordinator Election (Memo-037): Candidate presents attestations proving hardware capability and identity. Voters verify before granting coordinator role.</p>
<p>Federation Trust (Memo-039): Realms exchange attestations when federating. "Before I sync objects with you, prove your software is legitimate."</p>
<p>High-Security Operations: Some capabilities might require fresh attestation: "This capability requires Anchor attestation less than 1 hour old."</p>
</section>
<section>
<h2>Hardware Token Support</h2>
<p>Future: YubiKey, secure enclaves, hardware anchors.</p>
<pre class="language-scheme">
(keystore-meta
  (version 1)
  (protection "hardware")
  (hardware-type "yubikey-5")
  (hardware-serial "12345678")
  (public-key #${...}))          ; Private key never leaves device
</pre>
<p>The private key never touches disk - it lives in the hardware token. Operations requiring signature prompt for touch.</p>
</section>
<section>
<h2>Security Considerations</h2>
<h3>What We Protect Against</h3>
<table>
<tr><th>Threat </th><th>Mitigation </th></tr>
<tr><td>Disk theft </td><td>Encrypted at rest (XChaCha20-Poly1305) </td></tr>
<tr><td>Weak passphrase </td><td>Argon2id memory-hard KDF </td></tr>
<tr><td>Brute force </td><td>Rate limiting, attempt counter </td></tr>
<tr><td>Memory dump </td><td>Zero memory after use </td></tr>
<tr><td>Forgotten passphrase </td><td>Threshold recovery shares </td></tr>
<tr><td>Key compromise </td><td>Rotation support </td></tr>
</table>
<h3>What We Don't Protect Against</h3>
<table>
<tr><th>Threat </th><th>Why </th></tr>
<tr><td>Compromised endpoint </td><td>If attacker has root, game over </td></tr>
<tr><td>Keylogger capturing passphrase </td><td>Endpoint security problem </td></tr>
<tr><td>Rubber hose cryptanalysis </td><td>Math doesn't help </td></tr>
<tr><td>Quantum computers </td><td>Ed25519 vulnerable (migration planned) </td></tr>
</table>
<h3>Memory Handling</h3>
<pre class="language-scheme">
(define (with-sensitive-data data thunk)
  "Execute thunk with sensitive data, zero on exit"
  (dynamic-wind
    (lambda () #f)
    thunk
    (lambda () (sodium-memzero! data))))
</pre>
<p>Private keys are zeroed immediately after use. Passphrases are zeroed after key derivation.</p>
</section>
<section>
<h2>REPL Commands</h2>
<pre class="language-scheme">
;; Check keystore status
(keystore-status)
;; =&gt; (keystore (status unlocked) (principal "ed25519:7f3a...") (protection passphrase))

;; Lock keystore (zero keys from memory)
(keystore-lock)
;; =&gt; Keystore locked. Re-authentication required for signing.

;; Unlock keystore
(keystore-unlock)
;; =&gt; Passphrase: 
;; =&gt; Keystore unlocked.

;; Change passphrase
(keystore-change-passphrase)
;; =&gt; Current passphrase: 
;; =&gt; New passphrase: 
;; =&gt; Confirm: 
;; =&gt; Passphrase changed.

;; Create recovery shares
(keystore-backup threshold: 2 shares: 3)

;; Recover from shares
(keystore-recover share1 share2)

;; Rotate key
(keystore-rotate)

;; Export public key (safe to share)
(keystore-export-public)
;; =&gt; (realm-public-key (algorithm "ed25519") (public-key #${7f3a...}))
</pre>
</section>
<section>
<h2>Vault Protection</h2>
<p>The keystore protects itself. The operating system is not trusted.</p>
<p>realm.key - Never stored plaintext. The ciphertext blob is meaningless without the passphrase. Even if someone copies the file, they have nothing.</p>
<p>realm.pub - Public by nature. This IS your identity. Share it freely.</p>
<p>attestations/ - Signed claims. Tamper-evident by construction. Copy them, share them - forgery is computationally infeasible.</p>
<p>The vault doesn't rely on filesystem permissions, SELinux, or any operating system mechanism. Cyberspace assumes the OS is compromised. Protection comes from:</p>
<ul>
<li>Encryption - Private key encrypted at rest</li>
<li>Memory zeroing - Keys cleared immediately after use</li>
<li>Signatures - Everything signed, tampering detected</li>
<li>Content addressing - Hash IS identity</li>
</ul>
<p>If someone has root on your machine, they can install a keylogger - that's a physical security problem, not a cryptographic one. Cyberspace protects the math. Protect the machine yourself.</p>
</section>
<section>
<h2>Integration</h2>
<h3>With seal-release (Memo-033)</h3>
<pre class="language-scheme">
(seal-release "1.0.4" name: "phoenix")
;; Uses keystore signing key automatically
;; Prompts for unlock if keystore locked
</pre>
<h3>With capabilities (Memo-004)</h3>
<pre class="language-scheme">
(spki-cert-create
  subject: "ed25519:bob..."
  tag: '(read "sha512:doc..."))
;; Signed with keystore key
;; Issuer automatically set to realm principal
</pre>
<h3>With audit (Memo-040)</h3>
<pre class="language-scheme">
;; Audit entries signed with keystore key
;; Principal identity consistent across sessions
</pre>
</section>
<section>
<h2>Invariants</h2>
<h3>Keystore</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 750 200" width="750" height="200" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<text x="5" y="10">K</text>
<text x="15" y="10">1</text>
<text x="25" y="10">.</text>
<text x="45" y="10">P</text>
<text x="55" y="10">r</text>
<text x="65" y="10">i</text>
<text x="75" y="10">v</text>
<text x="85" y="10">a</text>
<text x="95" y="10">t</text>
<text x="105" y="10">e</text>
<text x="125" y="10">k</text>
<text x="135" y="10">e</text>
<text x="145" y="10">y</text>
<text x="165" y="10">n</text>
<text x="175" y="10">e</text>
<text x="185" y="10">v</text>
<text x="195" y="10">e</text>
<text x="205" y="10">r</text>
<text x="225" y="10">s</text>
<text x="235" y="10">t</text>
<text x="245" y="10">o</text>
<text x="255" y="10">r</text>
<text x="265" y="10">e</text>
<text x="275" y="10">d</text>
<text x="295" y="10">p</text>
<text x="305" y="10">l</text>
<text x="315" y="10">a</text>
<text x="325" y="10">i</text>
<text x="335" y="10">n</text>
<text x="345" y="10">t</text>
<text x="355" y="10">e</text>
<text x="365" y="10">x</text>
<text x="375" y="10">t</text>
<text x="45" y="30">s</text>
<text x="55" y="30">t</text>
<text x="65" y="30">o</text>
<text x="75" y="30">r</text>
<text x="85" y="30">e</text>
<text x="95" y="30">d</text>
<text x="105" y="30">(</text>
<text x="115" y="30">p</text>
<text x="125" y="30">r</text>
<text x="135" y="30">i</text>
<text x="145" y="30">v</text>
<text x="155" y="30">a</text>
<text x="165" y="30">t</text>
<text x="175" y="30">e</text>
<text x="185" y="30">-</text>
<text x="195" y="30">k</text>
<text x="205" y="30">e</text>
<text x="215" y="30">y</text>
<text x="225" y="30">)</text>
<text x="245" y="30">→</text>
<text x="265" y="30">e</text>
<text x="275" y="30">n</text>
<text x="285" y="30">c</text>
<text x="295" y="30">r</text>
<text x="305" y="30">y</text>
<text x="315" y="30">p</text>
<text x="325" y="30">t</text>
<text x="335" y="30">e</text>
<text x="345" y="30">d</text>
<text x="355" y="30">(</text>
<text x="365" y="30">p</text>
<text x="375" y="30">r</text>
<text x="385" y="30">i</text>
<text x="395" y="30">v</text>
<text x="405" y="30">a</text>
<text x="415" y="30">t</text>
<text x="425" y="30">e</text>
<text x="435" y="30">-</text>
<text x="445" y="30">k</text>
<text x="455" y="30">e</text>
<text x="465" y="30">y</text>
<text x="475" y="30">)</text>
<text x="5" y="50">K</text>
<text x="15" y="50">2</text>
<text x="25" y="50">.</text>
<text x="45" y="50">D</text>
<text x="55" y="50">e</text>
<text x="65" y="50">c</text>
<text x="75" y="50">r</text>
<text x="85" y="50">y</text>
<text x="95" y="50">p</text>
<text x="105" y="50">t</text>
<text x="115" y="50">i</text>
<text x="125" y="50">o</text>
<text x="135" y="50">n</text>
<text x="155" y="50">r</text>
<text x="165" y="50">e</text>
<text x="175" y="50">q</text>
<text x="185" y="50">u</text>
<text x="195" y="50">i</text>
<text x="205" y="50">r</text>
<text x="215" y="50">e</text>
<text x="225" y="50">s</text>
<text x="245" y="50">a</text>
<text x="255" y="50">u</text>
<text x="265" y="50">t</text>
<text x="275" y="50">h</text>
<text x="285" y="50">e</text>
<text x="295" y="50">n</text>
<text x="305" y="50">t</text>
<text x="315" y="50">i</text>
<text x="325" y="50">c</text>
<text x="335" y="50">a</text>
<text x="345" y="50">t</text>
<text x="355" y="50">i</text>
<text x="365" y="50">o</text>
<text x="375" y="50">n</text>
<text x="45" y="70">d</text>
<text x="55" y="70">e</text>
<text x="65" y="70">c</text>
<text x="75" y="70">r</text>
<text x="85" y="70">y</text>
<text x="95" y="70">p</text>
<text x="105" y="70">t</text>
<text x="115" y="70">(</text>
<text x="125" y="70">k</text>
<text x="135" y="70">e</text>
<text x="145" y="70">y</text>
<text x="155" y="70">s</text>
<text x="165" y="70">t</text>
<text x="175" y="70">o</text>
<text x="185" y="70">r</text>
<text x="195" y="70">e</text>
<text x="205" y="70">)</text>
<text x="225" y="70">→</text>
<text x="245" y="70">a</text>
<text x="255" y="70">u</text>
<text x="265" y="70">t</text>
<text x="275" y="70">h</text>
<text x="285" y="70">(</text>
<text x="295" y="70">p</text>
<text x="305" y="70">a</text>
<text x="315" y="70">s</text>
<text x="325" y="70">s</text>
<text x="335" y="70">p</text>
<text x="345" y="70">h</text>
<text x="355" y="70">r</text>
<text x="365" y="70">a</text>
<text x="375" y="70">s</text>
<text x="385" y="70">e</text>
<text x="395" y="70">)</text>
<text x="415" y="70">∨</text>
<text x="435" y="70">a</text>
<text x="445" y="70">u</text>
<text x="455" y="70">t</text>
<text x="465" y="70">h</text>
<text x="475" y="70">(</text>
<text x="485" y="70">h</text>
<text x="495" y="70">a</text>
<text x="505" y="70">r</text>
<text x="515" y="70">d</text>
<text x="525" y="70">w</text>
<text x="535" y="70">a</text>
<text x="545" y="70">r</text>
<text x="555" y="70">e</text>
<text x="565" y="70">)</text>
<text x="585" y="70">∨</text>
<text x="605" y="70">a</text>
<text x="615" y="70">u</text>
<text x="625" y="70">t</text>
<text x="635" y="70">h</text>
<text x="645" y="70">(</text>
<text x="655" y="70">t</text>
<text x="665" y="70">h</text>
<text x="675" y="70">r</text>
<text x="685" y="70">e</text>
<text x="695" y="70">s</text>
<text x="705" y="70">h</text>
<text x="715" y="70">o</text>
<text x="725" y="70">l</text>
<text x="735" y="70">d</text>
<text x="745" y="70">)</text>
<text x="5" y="90">K</text>
<text x="15" y="90">3</text>
<text x="25" y="90">.</text>
<text x="45" y="90">M</text>
<text x="55" y="90">e</text>
<text x="65" y="90">m</text>
<text x="75" y="90">o</text>
<text x="85" y="90">r</text>
<text x="95" y="90">y</text>
<text x="115" y="90">z</text>
<text x="125" y="90">e</text>
<text x="135" y="90">r</text>
<text x="145" y="90">o</text>
<text x="155" y="90">e</text>
<text x="165" y="90">d</text>
<text x="185" y="90">a</text>
<text x="195" y="90">f</text>
<text x="205" y="90">t</text>
<text x="215" y="90">e</text>
<text x="225" y="90">r</text>
<text x="245" y="90">u</text>
<text x="255" y="90">s</text>
<text x="265" y="90">e</text>
<text x="45" y="110">u</text>
<text x="55" y="110">s</text>
<text x="65" y="110">e</text>
<text x="75" y="110">(</text>
<text x="85" y="110">s</text>
<text x="95" y="110">e</text>
<text x="105" y="110">n</text>
<text x="115" y="110">s</text>
<text x="125" y="110">i</text>
<text x="135" y="110">t</text>
<text x="145" y="110">i</text>
<text x="155" y="110">v</text>
<text x="165" y="110">e</text>
<text x="175" y="110">-</text>
<text x="185" y="110">d</text>
<text x="195" y="110">a</text>
<text x="205" y="110">t</text>
<text x="215" y="110">a</text>
<text x="225" y="110">)</text>
<text x="245" y="110">→</text>
<text x="265" y="110">z</text>
<text x="275" y="110">e</text>
<text x="285" y="110">r</text>
<text x="295" y="110">o</text>
<text x="305" y="110">(</text>
<text x="315" y="110">s</text>
<text x="325" y="110">e</text>
<text x="335" y="110">n</text>
<text x="345" y="110">s</text>
<text x="355" y="110">i</text>
<text x="365" y="110">t</text>
<text x="375" y="110">i</text>
<text x="385" y="110">v</text>
<text x="395" y="110">e</text>
<text x="405" y="110">-</text>
<text x="415" y="110">d</text>
<text x="425" y="110">a</text>
<text x="435" y="110">t</text>
<text x="445" y="110">a</text>
<text x="455" y="110">)</text>
<text x="5" y="130">K</text>
<text x="15" y="130">4</text>
<text x="25" y="130">.</text>
<text x="45" y="130">R</text>
<text x="55" y="130">o</text>
<text x="65" y="130">t</text>
<text x="75" y="130">a</text>
<text x="85" y="130">t</text>
<text x="95" y="130">i</text>
<text x="105" y="130">o</text>
<text x="115" y="130">n</text>
<text x="135" y="130">p</text>
<text x="145" y="130">r</text>
<text x="155" y="130">e</text>
<text x="165" y="130">s</text>
<text x="175" y="130">e</text>
<text x="185" y="130">r</text>
<text x="195" y="130">v</text>
<text x="205" y="130">e</text>
<text x="215" y="130">s</text>
<text x="235" y="130">i</text>
<text x="245" y="130">d</text>
<text x="255" y="130">e</text>
<text x="265" y="130">n</text>
<text x="275" y="130">t</text>
<text x="285" y="130">i</text>
<text x="295" y="130">t</text>
<text x="305" y="130">y</text>
<text x="325" y="130">c</text>
<text x="335" y="130">h</text>
<text x="345" y="130">a</text>
<text x="355" y="130">i</text>
<text x="365" y="130">n</text>
<text x="45" y="150">r</text>
<text x="55" y="150">o</text>
<text x="65" y="150">t</text>
<text x="75" y="150">a</text>
<text x="85" y="150">t</text>
<text x="95" y="150">e</text>
<text x="105" y="150">(</text>
<text x="115" y="150">k</text>
<text x="125" y="150">₁</text>
<text x="135" y="150">,</text>
<text x="145" y="150">k</text>
<text x="155" y="150">₂</text>
<text x="165" y="150">)</text>
<text x="185" y="150">→</text>
<text x="205" y="150">s</text>
<text x="215" y="150">i</text>
<text x="225" y="150">g</text>
<text x="235" y="150">n</text>
<text x="245" y="150">e</text>
<text x="255" y="150">d</text>
<text x="265" y="150">(</text>
<text x="275" y="150">k</text>
<text x="285" y="150">₂</text>
<text x="295" y="150">,</text>
<text x="315" y="150">k</text>
<text x="325" y="150">₁</text>
<text x="335" y="150">)</text>
<text x="5" y="170">K</text>
<text x="15" y="170">5</text>
<text x="25" y="170">.</text>
<text x="45" y="170">R</text>
<text x="55" y="170">e</text>
<text x="65" y="170">c</text>
<text x="75" y="170">o</text>
<text x="85" y="170">v</text>
<text x="95" y="170">e</text>
<text x="105" y="170">r</text>
<text x="115" y="170">y</text>
<text x="135" y="170">r</text>
<text x="145" y="170">e</text>
<text x="155" y="170">q</text>
<text x="165" y="170">u</text>
<text x="175" y="170">i</text>
<text x="185" y="170">r</text>
<text x="195" y="170">e</text>
<text x="205" y="170">s</text>
<text x="225" y="170">t</text>
<text x="235" y="170">h</text>
<text x="245" y="170">r</text>
<text x="255" y="170">e</text>
<text x="265" y="170">s</text>
<text x="275" y="170">h</text>
<text x="285" y="170">o</text>
<text x="295" y="170">l</text>
<text x="305" y="170">d</text>
<text x="45" y="190">r</text>
<text x="55" y="190">e</text>
<text x="65" y="190">c</text>
<text x="75" y="190">o</text>
<text x="85" y="190">v</text>
<text x="95" y="190">e</text>
<text x="105" y="190">r</text>
<text x="115" y="190">(</text>
<text x="125" y="190">k</text>
<text x="135" y="190">e</text>
<text x="145" y="190">y</text>
<text x="155" y="190">s</text>
<text x="165" y="190">t</text>
<text x="175" y="190">o</text>
<text x="185" y="190">r</text>
<text x="195" y="190">e</text>
<text x="205" y="190">)</text>
<text x="225" y="190">→</text>
<text x="245" y="190">s</text>
<text x="255" y="190">h</text>
<text x="265" y="190">a</text>
<text x="275" y="190">r</text>
<text x="285" y="190">e</text>
<text x="295" y="190">s</text>
<text x="315" y="190">≥</text>
<text x="335" y="190">k</text>
</svg>
</div>
<h3>Attestation</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 520 200" width="520" height="200" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<text x="5" y="10">A</text>
<text x="15" y="10">1</text>
<text x="25" y="10">.</text>
<text x="45" y="10">A</text>
<text x="55" y="10">t</text>
<text x="65" y="10">t</text>
<text x="75" y="10">e</text>
<text x="85" y="10">s</text>
<text x="95" y="10">t</text>
<text x="105" y="10">a</text>
<text x="115" y="10">t</text>
<text x="125" y="10">i</text>
<text x="135" y="10">o</text>
<text x="145" y="10">n</text>
<text x="155" y="10">s</text>
<text x="175" y="10">a</text>
<text x="185" y="10">r</text>
<text x="195" y="10">e</text>
<text x="215" y="10">s</text>
<text x="225" y="10">i</text>
<text x="235" y="10">g</text>
<text x="245" y="10">n</text>
<text x="255" y="10">e</text>
<text x="265" y="10">d</text>
<text x="45" y="30">s</text>
<text x="55" y="30">t</text>
<text x="65" y="30">o</text>
<text x="75" y="30">r</text>
<text x="85" y="30">e</text>
<text x="95" y="30">(</text>
<text x="105" y="30">a</text>
<text x="115" y="30">t</text>
<text x="125" y="30">t</text>
<text x="135" y="30">e</text>
<text x="145" y="30">s</text>
<text x="155" y="30">t</text>
<text x="165" y="30">a</text>
<text x="175" y="30">t</text>
<text x="185" y="30">i</text>
<text x="195" y="30">o</text>
<text x="205" y="30">n</text>
<text x="215" y="30">)</text>
<text x="235" y="30">→</text>
<text x="255" y="30">s</text>
<text x="265" y="30">i</text>
<text x="275" y="30">g</text>
<text x="285" y="30">n</text>
<text x="295" y="30">e</text>
<text x="305" y="30">d</text>
<text x="315" y="30">(</text>
<text x="325" y="30">a</text>
<text x="335" y="30">t</text>
<text x="345" y="30">t</text>
<text x="355" y="30">e</text>
<text x="365" y="30">s</text>
<text x="375" y="30">t</text>
<text x="385" y="30">a</text>
<text x="395" y="30">t</text>
<text x="405" y="30">i</text>
<text x="415" y="30">o</text>
<text x="425" y="30">n</text>
<text x="435" y="30">,</text>
<text x="455" y="30">i</text>
<text x="465" y="30">s</text>
<text x="475" y="30">s</text>
<text x="485" y="30">u</text>
<text x="495" y="30">e</text>
<text x="505" y="30">r</text>
<text x="515" y="30">)</text>
<text x="5" y="50">A</text>
<text x="15" y="50">2</text>
<text x="25" y="50">.</text>
<text x="45" y="50">A</text>
<text x="55" y="50">t</text>
<text x="65" y="50">t</text>
<text x="75" y="50">e</text>
<text x="85" y="50">s</text>
<text x="95" y="50">t</text>
<text x="105" y="50">a</text>
<text x="115" y="50">t</text>
<text x="125" y="50">i</text>
<text x="135" y="50">o</text>
<text x="145" y="50">n</text>
<text x="165" y="50">c</text>
<text x="175" y="50">h</text>
<text x="185" y="50">a</text>
<text x="195" y="50">i</text>
<text x="205" y="50">n</text>
<text x="215" y="50">s</text>
<text x="235" y="50">a</text>
<text x="245" y="50">r</text>
<text x="255" y="50">e</text>
<text x="275" y="50">v</text>
<text x="285" y="50">e</text>
<text x="295" y="50">r</text>
<text x="305" y="50">i</text>
<text x="315" y="50">f</text>
<text x="325" y="50">i</text>
<text x="335" y="50">a</text>
<text x="345" y="50">b</text>
<text x="355" y="50">l</text>
<text x="365" y="50">e</text>
<text x="45" y="70">c</text>
<text x="55" y="70">h</text>
<text x="65" y="70">a</text>
<text x="75" y="70">i</text>
<text x="85" y="70">n</text>
<text x="95" y="70">(</text>
<text x="105" y="70">a</text>
<text x="115" y="70">₁</text>
<text x="125" y="70">→</text>
<text x="135" y="70">a</text>
<text x="145" y="70">₂</text>
<text x="155" y="70">→</text>
<text x="165" y="70">.</text>
<text x="175" y="70">.</text>
<text x="185" y="70">.</text>
<text x="195" y="70">→</text>
<text x="205" y="70">a</text>
<text x="215" y="70">ₙ</text>
<text x="225" y="70">)</text>
<text x="245" y="70">→</text>
<text x="265" y="70">∀</text>
<text x="275" y="70">i</text>
<text x="285" y="70">:</text>
<text x="305" y="70">v</text>
<text x="315" y="70">a</text>
<text x="325" y="70">l</text>
<text x="335" y="70">i</text>
<text x="345" y="70">d</text>
<text x="355" y="70">_</text>
<text x="365" y="70">s</text>
<text x="375" y="70">i</text>
<text x="385" y="70">g</text>
<text x="395" y="70">(</text>
<text x="405" y="70">a</text>
<text x="415" y="70">ᵢ</text>
<text x="425" y="70">)</text>
<text x="5" y="90">A</text>
<text x="15" y="90">3</text>
<text x="25" y="90">.</text>
<text x="45" y="90">H</text>
<text x="55" y="90">a</text>
<text x="65" y="90">r</text>
<text x="75" y="90">d</text>
<text x="85" y="90">w</text>
<text x="95" y="90">a</text>
<text x="105" y="90">r</text>
<text x="115" y="90">e</text>
<text x="135" y="90">a</text>
<text x="145" y="90">t</text>
<text x="155" y="90">t</text>
<text x="165" y="90">e</text>
<text x="175" y="90">s</text>
<text x="185" y="90">t</text>
<text x="195" y="90">a</text>
<text x="205" y="90">t</text>
<text x="215" y="90">i</text>
<text x="225" y="90">o</text>
<text x="235" y="90">n</text>
<text x="245" y="90">s</text>
<text x="265" y="90">o</text>
<text x="275" y="90">r</text>
<text x="285" y="90">i</text>
<text x="295" y="90">g</text>
<text x="305" y="90">i</text>
<text x="315" y="90">n</text>
<text x="325" y="90">a</text>
<text x="335" y="90">t</text>
<text x="345" y="90">e</text>
<text x="365" y="90">f</text>
<text x="375" y="90">r</text>
<text x="385" y="90">o</text>
<text x="395" y="90">m</text>
<text x="415" y="90">a</text>
<text x="425" y="90">n</text>
<text x="435" y="90">c</text>
<text x="445" y="90">h</text>
<text x="455" y="90">o</text>
<text x="465" y="90">r</text>
<text x="475" y="90">s</text>
<text x="45" y="110">h</text>
<text x="55" y="110">a</text>
<text x="65" y="110">r</text>
<text x="75" y="110">d</text>
<text x="85" y="110">w</text>
<text x="95" y="110">a</text>
<text x="105" y="110">r</text>
<text x="115" y="110">e</text>
<text x="125" y="110">-</text>
<text x="135" y="110">a</text>
<text x="145" y="110">t</text>
<text x="155" y="110">t</text>
<text x="165" y="110">e</text>
<text x="175" y="110">s</text>
<text x="185" y="110">t</text>
<text x="195" y="110">a</text>
<text x="205" y="110">t</text>
<text x="215" y="110">i</text>
<text x="225" y="110">o</text>
<text x="235" y="110">n</text>
<text x="245" y="110">(</text>
<text x="255" y="110">a</text>
<text x="265" y="110">)</text>
<text x="285" y="110">→</text>
<text x="305" y="110">a</text>
<text x="315" y="110">n</text>
<text x="325" y="110">c</text>
<text x="335" y="110">h</text>
<text x="345" y="110">o</text>
<text x="355" y="110">r</text>
<text x="365" y="110">-</text>
<text x="375" y="110">s</text>
<text x="385" y="110">i</text>
<text x="395" y="110">g</text>
<text x="405" y="110">n</text>
<text x="415" y="110">e</text>
<text x="425" y="110">d</text>
<text x="435" y="110">(</text>
<text x="445" y="110">a</text>
<text x="455" y="110">)</text>
<text x="5" y="130">A</text>
<text x="15" y="130">4</text>
<text x="25" y="130">.</text>
<text x="45" y="130">A</text>
<text x="55" y="130">t</text>
<text x="65" y="130">t</text>
<text x="75" y="130">e</text>
<text x="85" y="130">s</text>
<text x="95" y="130">t</text>
<text x="105" y="130">a</text>
<text x="115" y="130">t</text>
<text x="125" y="130">i</text>
<text x="135" y="130">o</text>
<text x="145" y="130">n</text>
<text x="155" y="130">s</text>
<text x="175" y="130">a</text>
<text x="185" y="130">r</text>
<text x="195" y="130">e</text>
<text x="215" y="130">t</text>
<text x="225" y="130">i</text>
<text x="235" y="130">m</text>
<text x="245" y="130">e</text>
<text x="255" y="130">s</text>
<text x="265" y="130">t</text>
<text x="275" y="130">a</text>
<text x="285" y="130">m</text>
<text x="295" y="130">p</text>
<text x="305" y="130">e</text>
<text x="315" y="130">d</text>
<text x="45" y="150">a</text>
<text x="55" y="150">t</text>
<text x="65" y="150">t</text>
<text x="75" y="150">e</text>
<text x="85" y="150">s</text>
<text x="95" y="150">t</text>
<text x="105" y="150">a</text>
<text x="115" y="150">t</text>
<text x="125" y="150">i</text>
<text x="135" y="150">o</text>
<text x="145" y="150">n</text>
<text x="155" y="150">(</text>
<text x="165" y="150">a</text>
<text x="175" y="150">)</text>
<text x="195" y="150">→</text>
<text x="215" y="150">t</text>
<text x="225" y="150">i</text>
<text x="235" y="150">m</text>
<text x="245" y="150">e</text>
<text x="255" y="150">s</text>
<text x="265" y="150">t</text>
<text x="275" y="150">a</text>
<text x="285" y="150">m</text>
<text x="295" y="150">p</text>
<text x="305" y="150">(</text>
<text x="315" y="150">a</text>
<text x="325" y="150">)</text>
<text x="345" y="150">∧</text>
<text x="365" y="150">f</text>
<text x="375" y="150">r</text>
<text x="385" y="150">e</text>
<text x="395" y="150">s</text>
<text x="405" y="150">h</text>
<text x="415" y="150">(</text>
<text x="425" y="150">a</text>
<text x="435" y="150">,</text>
<text x="455" y="150">p</text>
<text x="465" y="150">o</text>
<text x="475" y="150">l</text>
<text x="485" y="150">i</text>
<text x="495" y="150">c</text>
<text x="505" y="150">y</text>
<text x="515" y="150">)</text>
<text x="5" y="170">A</text>
<text x="15" y="170">5</text>
<text x="25" y="170">.</text>
<text x="45" y="170">E</text>
<text x="55" y="170">x</text>
<text x="65" y="170">p</text>
<text x="75" y="170">i</text>
<text x="85" y="170">r</text>
<text x="95" y="170">e</text>
<text x="105" y="170">d</text>
<text x="125" y="170">a</text>
<text x="135" y="170">t</text>
<text x="145" y="170">t</text>
<text x="155" y="170">e</text>
<text x="165" y="170">s</text>
<text x="175" y="170">t</text>
<text x="185" y="170">a</text>
<text x="195" y="170">t</text>
<text x="205" y="170">i</text>
<text x="215" y="170">o</text>
<text x="225" y="170">n</text>
<text x="235" y="170">s</text>
<text x="255" y="170">a</text>
<text x="265" y="170">r</text>
<text x="275" y="170">e</text>
<text x="295" y="170">i</text>
<text x="305" y="170">n</text>
<text x="315" y="170">v</text>
<text x="325" y="170">a</text>
<text x="335" y="170">l</text>
<text x="345" y="170">i</text>
<text x="355" y="170">d</text>
<text x="45" y="190">e</text>
<text x="55" y="190">x</text>
<text x="65" y="190">p</text>
<text x="75" y="190">i</text>
<text x="85" y="190">r</text>
<text x="95" y="190">e</text>
<text x="105" y="190">d</text>
<text x="115" y="190">(</text>
<text x="125" y="190">a</text>
<text x="135" y="190">)</text>
<text x="155" y="190">→</text>
<text x="175" y="190">¬</text>
<text x="185" y="190">v</text>
<text x="195" y="190">a</text>
<text x="205" y="190">l</text>
<text x="215" y="190">i</text>
<text x="225" y="190">d</text>
<text x="235" y="190">(</text>
<text x="245" y="190">a</text>
<text x="255" y="190">)</text>
</svg>
</div>
</section>
<section>
<h2>Quantum Resistance</h2>
<p>SHA-512 won't survive. Grover's algorithm halves the security - 256 bits becomes 128. For the wilderness of mirrors to endure, we need quantum-resistant Merkle trees.</p>
<p>The Path Forward:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 630 40" width="630" height="40" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<text x="5" y="10">C</text>
<text x="15" y="10">u</text>
<text x="25" y="10">r</text>
<text x="35" y="10">r</text>
<text x="45" y="10">e</text>
<text x="55" y="10">n</text>
<text x="65" y="10">t</text>
<text x="75" y="10">:</text>
<text x="135" y="10">s</text>
<text x="145" y="10">h</text>
<text x="155" y="10">a</text>
<text x="165" y="10">5</text>
<text x="175" y="10">1</text>
<text x="185" y="10">2</text>
<text x="195" y="10">(</text>
<text x="205" y="10">c</text>
<text x="215" y="10">o</text>
<text x="225" y="10">n</text>
<text x="235" y="10">t</text>
<text x="245" y="10">e</text>
<text x="255" y="10">n</text>
<text x="265" y="10">t</text>
<text x="275" y="10">)</text>
<text x="295" y="10">→</text>
<text x="315" y="10">o</text>
<text x="325" y="10">b</text>
<text x="335" y="10">j</text>
<text x="345" y="10">e</text>
<text x="355" y="10">c</text>
<text x="365" y="10">t</text>
<text x="385" y="10">i</text>
<text x="395" y="10">d</text>
<text x="405" y="10">e</text>
<text x="415" y="10">n</text>
<text x="425" y="10">t</text>
<text x="435" y="10">i</text>
<text x="445" y="10">t</text>
<text x="455" y="10">y</text>
<text x="5" y="30">F</text>
<text x="15" y="30">u</text>
<text x="25" y="30">t</text>
<text x="35" y="30">u</text>
<text x="45" y="30">r</text>
<text x="55" y="30">e</text>
<text x="65" y="30">:</text>
<text x="135" y="30">m</text>
<text x="145" y="30">e</text>
<text x="155" y="30">r</text>
<text x="165" y="30">k</text>
<text x="175" y="30">l</text>
<text x="185" y="30">e</text>
<text x="195" y="30">-</text>
<text x="205" y="30">r</text>
<text x="215" y="30">o</text>
<text x="225" y="30">o</text>
<text x="235" y="30">t</text>
<text x="245" y="30">(</text>
<text x="255" y="30">s</text>
<text x="265" y="30">h</text>
<text x="275" y="30">a</text>
<text x="285" y="30">k</text>
<text x="295" y="30">e</text>
<text x="305" y="30">2</text>
<text x="315" y="30">5</text>
<text x="325" y="30">6</text>
<text x="335" y="30">(</text>
<text x="345" y="30">c</text>
<text x="355" y="30">h</text>
<text x="365" y="30">u</text>
<text x="375" y="30">n</text>
<text x="385" y="30">k</text>
<text x="395" y="30">s</text>
<text x="405" y="30">.</text>
<text x="415" y="30">.</text>
<text x="425" y="30">.</text>
<text x="435" y="30">)</text>
<text x="445" y="30">)</text>
<text x="465" y="30">→</text>
<text x="485" y="30">o</text>
<text x="495" y="30">b</text>
<text x="505" y="30">j</text>
<text x="515" y="30">e</text>
<text x="525" y="30">c</text>
<text x="535" y="30">t</text>
<text x="555" y="30">i</text>
<text x="565" y="30">d</text>
<text x="575" y="30">e</text>
<text x="585" y="30">n</text>
<text x="595" y="30">t</text>
<text x="605" y="30">i</text>
<text x="615" y="30">t</text>
<text x="625" y="30">y</text>
</svg>
</div>
<p>Why Merkle trees: - Incremental updates without rehashing everything - Selective disclosure - prove a branch without revealing siblings - Tree structure means log(n) proof sizes - Quantum-resistant hash at each node</p>
<p>Candidate hash functions:</p>
<table>
<tr><th>Function </th><th>Output </th><th>Notes </th></tr>
<tr><td>SHAKE256 </td><td>Variable </td><td>SHA-3 family, NIST approved, used by SPHINCS+ </td></tr>
<tr><td>BLAKE3 </td><td>256-bit </td><td>Fast, tree-based internally, modern </td></tr>
<tr><td>SHA-3-512 </td><td>512-bit </td><td>Conservative choice, different construction than SHA-2 </td></tr>
</table>
<p>Migration:</p>
<p>Objects can carry both hashes during transition:</p>
<pre class="language-scheme">
(object
  (content-hash "sha512:abc123...")           ; Legacy
  (merkle-root "shake256:def456...")          ; Quantum-resistant
  (tree-depth 4)
  (chunk-size 4096))
</pre>
<p>The soup becomes a forest of Merkle trees. Each object a tree, each tree quantum-hardened. The wilderness of mirrors, built to outlast the quantum winter.</p>
<p>Ed25519 replacement: SPHINCS+ or CRYSTALS-Dilithium for signatures. That's a separate RFC.</p>
</section>
<section>
<h2>References</h2>
<ul>
<li>libsodium documentation - Password Hashing, Secret-key Encryption</li>
<li>Argon2 specification - https://github.com/P-H-C/phc-winner-argon2</li>
<li>Shamir's Secret Sharing - Shamir, A., "How to Share a Secret", 1979</li>
<li>Memo-008 - Threshold Governance</li>
<li>Memo-040 - Cyberspace Security Architecture</li>
</ul>
</section>
<section>
<h2>Changelog</h2>
<ul>
<li>2026-01-08</li>
<li>Initial draft</li>
</ul>
</section>
<script>
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
}
(function() {
  // Query param override (for REPL: ?theme=dark or ?theme=light)
  const params = new URLSearchParams(window.location.search);
  const param = params.get('theme');
  if (param === 'dark' || param === 'light') {
    document.documentElement.setAttribute('data-theme', param);
    localStorage.setItem('theme', param);
    return;
  }
  // localStorage preference
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
  } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', 'light');
  }
})();
</script>
</body>
</html>
