<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <title>Memo 0018: Lazy Clustering</title>
  <link rel="icon" id="favicon" href="data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27%230f0%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>">
  <script>
(function(){
  var h=new Date().getHours(),c;
  if(h>=4&&h<6)c='%23845EC2';       // brahma muhurta - violet
  else if(h>=6&&h<8)c='%23ffd700';  // dawn - gold
  else if(h>=8&&h<11)c='%2300d4aa'; // morning - teal
  else if(h>=11&&h<14)c='%230f0';   // midday - phosphor
  else if(h>=14&&h<17)c='%2339ff14';// afternoon - neon
  else if(h>=17&&h<19)c='%23ff6600';// sunset - orange
  else if(h>=19&&h<22)c='%23ff3366';// evening - coral
  else c='%2300ffff';               // night - cyan
  document.getElementById('favicon').href='data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27'+c+'%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>';
})();
</script>
  <link rel="stylesheet" href="memo.css">
</head>
<body>
<span class="theme-toggle" onclick="toggleTheme()" title="Toggle light/dark">[theme]</span>
<h1>Memo 0018: Lazy Clustering</h1>
<dl class="metadata">
</dl>
<hr>
<section>
<h2>Abstract</h2>
<p>This Memo specifies Lazy Clustering for Cyberspace federation: a relaxed synchronization model where nodes sync when convenient, not continuously. Optimized for the "loose confederacy of friends" model.</p>
</section>
<section>
<h2>Motivation</h2>
<p>Not every deployment needs Byzantine consensus:</p>
<ul>
<li>Friends trust friends: No active adversary</li>
<li>Bandwidth costs: Continuous sync is expensive</li>
<li>Offline operation: Internet isn't always available</li>
<li>Simplicity: Complex protocols have complex bugs</li>
</ul>
<p>Lazy Clustering provides:</p>
<p>1. Sync when ready: Push/pull at human pace 2. Offline-first: Work without network 3. Conflict detection: Know when divergence happens 4. Manual resolution: Humans resolve, not algorithms 5. Audit everything: Full history preserved</p>
<blockquote>
<p>The best protocol is the one you don't run.</p>
</blockquote>
</section>
<section>
<h2>Specification</h2>
<h3>Cluster Model</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 450 280" width="450" height="280" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<line x1="55" y1="10" x2="60" y2="10"/>
<line x1="55" y1="10" x2="55" y2="20"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="155" y2="10"/>
<line x1="155" y1="10" x2="155" y2="20"/>
<line x1="55" y1="20" x2="55" y2="40"/>
<text x="85" y="30">A</text>
<text x="95" y="30">l</text>
<text x="105" y="30">i</text>
<text x="115" y="30">c</text>
<text x="125" y="30">e</text>
<line x1="155" y1="20" x2="155" y2="40"/>
<line x1="55" y1="40" x2="55" y2="60"/>
<text x="75" y="50">(</text>
<text x="85" y="50">l</text>
<text x="95" y="50">a</text>
<text x="105" y="50">z</text>
<text x="115" y="50">y</text>
<text x="125" y="50">)</text>
<line x1="155" y1="40" x2="155" y2="60"/>
<line x1="55" y1="70" x2="60" y2="70"/>
<line x1="55" y1="60" x2="55" y2="70"/>
<line x1="60" y1="70" x2="70" y2="70"/>
<line x1="70" y1="70" x2="80" y2="70"/>
<line x1="80" y1="70" x2="90" y2="70"/>
<line x1="90" y1="70" x2="100" y2="70"/>
<line x1="100" y1="70" x2="110" y2="70"/>
<line x1="105" y1="70" x2="105" y2="80"/>
<line x1="110" y1="70" x2="120" y2="70"/>
<line x1="120" y1="70" x2="130" y2="70"/>
<line x1="130" y1="70" x2="140" y2="70"/>
<line x1="140" y1="70" x2="150" y2="70"/>
<line x1="150" y1="70" x2="155" y2="70"/>
<line x1="155" y1="60" x2="155" y2="70"/>
<line x1="105" y1="80" x2="105" y2="100"/>
<line x1="105" y1="100" x2="105" y2="120"/>
<text x="125" y="110">s</text>
<text x="135" y="110">y</text>
<text x="145" y="110">n</text>
<text x="155" y="110">c</text>
<text x="175" y="110">w</text>
<text x="185" y="110">h</text>
<text x="195" y="110">e</text>
<text x="205" y="110">n</text>
<text x="225" y="110">r</text>
<text x="235" y="110">e</text>
<text x="245" y="110">a</text>
<text x="255" y="110">d</text>
<text x="265" y="110">y</text>
<text x="285" y="110">@</text>
<text x="305" y="110">1</text>
<text x="315" y="110">0</text>
<text x="325" y="110">G</text>
<text x="335" y="110">b</text>
<text x="345" y="110">/</text>
<text x="355" y="110">s</text>
<line x1="105" y1="120" x2="105" y2="140"/>
<line x1="55" y1="150" x2="60" y2="150"/>
<line x1="55" y1="150" x2="55" y2="160"/>
<line x1="60" y1="150" x2="70" y2="150"/>
<line x1="70" y1="150" x2="80" y2="150"/>
<line x1="80" y1="150" x2="90" y2="150"/>
<line x1="90" y1="150" x2="100" y2="150"/>
<text x="105" y="150">↓</text>
<line x1="110" y1="150" x2="120" y2="150"/>
<line x1="120" y1="150" x2="130" y2="150"/>
<line x1="130" y1="150" x2="140" y2="150"/>
<line x1="140" y1="150" x2="150" y2="150"/>
<line x1="150" y1="150" x2="155" y2="150"/>
<line x1="155" y1="150" x2="155" y2="160"/>
<line x1="255" y1="150" x2="260" y2="150"/>
<line x1="255" y1="150" x2="255" y2="160"/>
<line x1="260" y1="150" x2="270" y2="150"/>
<line x1="270" y1="150" x2="280" y2="150"/>
<line x1="280" y1="150" x2="290" y2="150"/>
<line x1="290" y1="150" x2="300" y2="150"/>
<line x1="300" y1="150" x2="310" y2="150"/>
<line x1="310" y1="150" x2="320" y2="150"/>
<line x1="320" y1="150" x2="330" y2="150"/>
<line x1="330" y1="150" x2="340" y2="150"/>
<line x1="340" y1="150" x2="350" y2="150"/>
<line x1="350" y1="150" x2="355" y2="150"/>
<line x1="355" y1="150" x2="355" y2="160"/>
<line x1="55" y1="160" x2="55" y2="180"/>
<text x="95" y="170">B</text>
<text x="105" y="170">o</text>
<text x="115" y="170">b</text>
<line x1="155" y1="160" x2="155" y2="180"/>
<line x1="170" y1="170" x2="180" y2="170"/>
<line x1="180" y1="170" x2="190" y2="170"/>
<line x1="190" y1="170" x2="200" y2="170"/>
<line x1="200" y1="170" x2="210" y2="170"/>
<line x1="210" y1="170" x2="220" y2="170"/>
<line x1="220" y1="170" x2="230" y2="170"/>
<line x1="230" y1="170" x2="240" y2="170"/>
<text x="245" y="170">→</text>
<line x1="255" y1="160" x2="255" y2="180"/>
<text x="285" y="170">C</text>
<text x="295" y="170">a</text>
<text x="305" y="170">r</text>
<text x="315" y="170">o</text>
<text x="325" y="170">l</text>
<line x1="355" y1="160" x2="355" y2="180"/>
<line x1="55" y1="180" x2="55" y2="200"/>
<text x="75" y="190">(</text>
<text x="85" y="190">l</text>
<text x="95" y="190">a</text>
<text x="105" y="190">z</text>
<text x="115" y="190">y</text>
<text x="125" y="190">)</text>
<line x1="155" y1="180" x2="155" y2="200"/>
<text x="175" y="190">1</text>
<text x="185" y="190">0</text>
<text x="195" y="190">G</text>
<text x="205" y="190">b</text>
<text x="215" y="190">/</text>
<text x="225" y="190">s</text>
<line x1="255" y1="180" x2="255" y2="200"/>
<text x="275" y="190">(</text>
<text x="285" y="190">l</text>
<text x="295" y="190">a</text>
<text x="305" y="190">z</text>
<text x="315" y="190">y</text>
<text x="325" y="190">)</text>
<line x1="355" y1="180" x2="355" y2="200"/>
<line x1="55" y1="210" x2="60" y2="210"/>
<line x1="55" y1="200" x2="55" y2="210"/>
<line x1="60" y1="210" x2="70" y2="210"/>
<line x1="70" y1="210" x2="80" y2="210"/>
<line x1="80" y1="210" x2="90" y2="210"/>
<line x1="90" y1="210" x2="100" y2="210"/>
<line x1="100" y1="210" x2="110" y2="210"/>
<line x1="110" y1="210" x2="120" y2="210"/>
<line x1="120" y1="210" x2="130" y2="210"/>
<line x1="130" y1="210" x2="140" y2="210"/>
<line x1="140" y1="210" x2="150" y2="210"/>
<line x1="150" y1="210" x2="155" y2="210"/>
<line x1="155" y1="200" x2="155" y2="210"/>
<line x1="255" y1="210" x2="260" y2="210"/>
<line x1="255" y1="200" x2="255" y2="210"/>
<line x1="260" y1="210" x2="270" y2="210"/>
<line x1="270" y1="210" x2="280" y2="210"/>
<line x1="280" y1="210" x2="290" y2="210"/>
<line x1="290" y1="210" x2="300" y2="210"/>
<line x1="300" y1="210" x2="310" y2="210"/>
<line x1="310" y1="210" x2="320" y2="210"/>
<line x1="320" y1="210" x2="330" y2="210"/>
<line x1="330" y1="210" x2="340" y2="210"/>
<line x1="340" y1="210" x2="350" y2="210"/>
<line x1="350" y1="210" x2="355" y2="210"/>
<line x1="355" y1="200" x2="355" y2="210"/>
<text x="5" y="230">N</text>
<text x="15" y="230">o</text>
<text x="35" y="230">h</text>
<text x="45" y="230">e</text>
<text x="55" y="230">a</text>
<text x="65" y="230">r</text>
<text x="75" y="230">t</text>
<text x="85" y="230">b</text>
<text x="95" y="230">e</text>
<text x="105" y="230">a</text>
<text x="115" y="230">t</text>
<text x="125" y="230">s</text>
<text x="135" y="230">.</text>
<text x="155" y="230">N</text>
<text x="165" y="230">o</text>
<text x="185" y="230">l</text>
<text x="195" y="230">e</text>
<text x="205" y="230">a</text>
<text x="215" y="230">d</text>
<text x="225" y="230">e</text>
<text x="235" y="230">r</text>
<text x="255" y="230">e</text>
<text x="265" y="230">l</text>
<text x="275" y="230">e</text>
<text x="285" y="230">c</text>
<text x="295" y="230">t</text>
<text x="305" y="230">i</text>
<text x="315" y="230">o</text>
<text x="325" y="230">n</text>
<text x="335" y="230">.</text>
<text x="355" y="230">N</text>
<text x="365" y="230">o</text>
<text x="385" y="230">q</text>
<text x="395" y="230">u</text>
<text x="405" y="230">o</text>
<text x="415" y="230">r</text>
<text x="425" y="230">u</text>
<text x="435" y="230">m</text>
<text x="445" y="230">.</text>
<text x="5" y="250">J</text>
<text x="15" y="250">u</text>
<text x="25" y="250">s</text>
<text x="35" y="250">t</text>
<text x="55" y="250">f</text>
<text x="65" y="250">r</text>
<text x="75" y="250">i</text>
<text x="85" y="250">e</text>
<text x="95" y="250">n</text>
<text x="105" y="250">d</text>
<text x="115" y="250">s</text>
<text x="135" y="250">s</text>
<text x="145" y="250">h</text>
<text x="155" y="250">a</text>
<text x="165" y="250">r</text>
<text x="175" y="250">i</text>
<text x="185" y="250">n</text>
<text x="195" y="250">g</text>
<text x="215" y="250">w</text>
<text x="225" y="250">h</text>
<text x="235" y="250">e</text>
<text x="245" y="250">n</text>
<text x="265" y="250">t</text>
<text x="275" y="250">h</text>
<text x="285" y="250">e</text>
<text x="295" y="250">y</text>
<text x="305" y="250">'</text>
<text x="315" y="250">r</text>
<text x="325" y="250">e</text>
<text x="345" y="250">r</text>
<text x="355" y="250">e</text>
<text x="365" y="250">a</text>
<text x="375" y="250">d</text>
<text x="385" y="250">y</text>
<text x="395" y="250">.</text>
<text x="5" y="270">A</text>
<text x="15" y="270">t</text>
<text x="35" y="270">l</text>
<text x="45" y="270">i</text>
<text x="55" y="270">n</text>
<text x="65" y="270">e</text>
<text x="85" y="270">s</text>
<text x="95" y="270">p</text>
<text x="105" y="270">e</text>
<text x="115" y="270">e</text>
<text x="125" y="270">d</text>
<text x="145" y="270">w</text>
<text x="155" y="270">h</text>
<text x="165" y="270">e</text>
<text x="175" y="270">n</text>
<text x="195" y="270">t</text>
<text x="205" y="270">h</text>
<text x="215" y="270">e</text>
<text x="225" y="270">y</text>
<text x="245" y="270">d</text>
<text x="255" y="270">o</text>
<text x="265" y="270">.</text>
</svg>
</div>
<h3>Performance Model</h3>
<p>Lazy semantics, line speed execution.</p>
<pre>
Line speed (10 Gb/s):
  Typical release: 10 MB archive
  Transfer time:   8 ms
  Effective rate:  ~1000 releases/second

Starlink (100-200 Mb/s, 20-40ms latency):
  Typical release: 10 MB archive
  Transfer time:   400-800 ms
  Effective rate:  ~1-2 releases/second
  Optimized for:   Bursty, high-latency satellite links

Minimum bandwidth:
  Floor:           128 Kb/s (dual-ISDN)
  Target:          1 Mb/s (T1)
  Typical release: 10 MB archive
  Transfer time:   ~80 sec (T1), ~10 min (dual-ISDN)
  Strategy:        Delta sync, compressed archives
</pre>
<p>Crypto overhead (constant):</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 480 60" width="480" height="60" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<text x="5" y="10">S</text>
<text x="15" y="10">i</text>
<text x="25" y="10">g</text>
<text x="35" y="10">n</text>
<text x="45" y="10">a</text>
<text x="55" y="10">t</text>
<text x="65" y="10">u</text>
<text x="75" y="10">r</text>
<text x="85" y="10">e</text>
<text x="105" y="10">v</text>
<text x="115" y="10">e</text>
<text x="125" y="10">r</text>
<text x="135" y="10">i</text>
<text x="145" y="10">f</text>
<text x="155" y="10">y</text>
<text x="165" y="10">:</text>
<text x="185" y="10">~</text>
<text x="195" y="10">1</text>
<text x="205" y="10">0</text>
<text x="225" y="10">μ</text>
<text x="235" y="10">s</text>
<text x="255" y="10">(</text>
<text x="265" y="10">E</text>
<text x="275" y="10">d</text>
<text x="285" y="10">2</text>
<text x="295" y="10">5</text>
<text x="305" y="10">5</text>
<text x="315" y="10">1</text>
<text x="325" y="10">9</text>
<text x="335" y="10">)</text>
<text x="5" y="30">H</text>
<text x="15" y="30">a</text>
<text x="25" y="30">s</text>
<text x="35" y="30">h</text>
<text x="55" y="30">v</text>
<text x="65" y="30">e</text>
<text x="75" y="30">r</text>
<text x="85" y="30">i</text>
<text x="95" y="30">f</text>
<text x="105" y="30">y</text>
<text x="115" y="30">:</text>
<text x="185" y="30">~</text>
<text x="195" y="30">1</text>
<text x="215" y="30">m</text>
<text x="225" y="30">s</text>
<text x="245" y="30">(</text>
<text x="255" y="30">S</text>
<text x="265" y="30">H</text>
<text x="275" y="30">A</text>
<text x="285" y="30">-</text>
<text x="295" y="30">5</text>
<text x="305" y="30">1</text>
<text x="315" y="30">2</text>
<text x="325" y="30">,</text>
<text x="345" y="30">1</text>
<text x="355" y="30">0</text>
<text x="365" y="30">M</text>
<text x="375" y="30">B</text>
<text x="385" y="30">)</text>
<text x="5" y="50">T</text>
<text x="15" y="50">o</text>
<text x="25" y="50">t</text>
<text x="35" y="50">a</text>
<text x="45" y="50">l</text>
<text x="65" y="50">o</text>
<text x="75" y="50">v</text>
<text x="85" y="50">e</text>
<text x="95" y="50">r</text>
<text x="105" y="50">h</text>
<text x="115" y="50">e</text>
<text x="125" y="50">a</text>
<text x="135" y="50">d</text>
<text x="145" y="50">:</text>
<text x="185" y="50">~</text>
<text x="195" y="50">1</text>
<text x="215" y="50">m</text>
<text x="225" y="50">s</text>
<text x="245" y="50">(</text>
<text x="255" y="50">n</text>
<text x="265" y="50">e</text>
<text x="275" y="50">g</text>
<text x="285" y="50">l</text>
<text x="295" y="50">i</text>
<text x="305" y="50">g</text>
<text x="315" y="50">i</text>
<text x="325" y="50">b</text>
<text x="335" y="50">l</text>
<text x="345" y="50">e</text>
<text x="365" y="50">v</text>
<text x="375" y="50">s</text>
<text x="395" y="50">t</text>
<text x="405" y="50">r</text>
<text x="415" y="50">a</text>
<text x="425" y="50">n</text>
<text x="435" y="50">s</text>
<text x="445" y="50">f</text>
<text x="455" y="50">e</text>
<text x="465" y="50">r</text>
<text x="475" y="50">)</text>
</svg>
</div>
<p>"Lazy" means when, not how fast. When you sync, it saturates the pipe.</p>
<p>Design priorities: 1. Optimized for Starlink and satellite links 2. Tolerant of high latency (no chatty protocols) 3. Graceful degradation to minimum bandwidth 4. Bursty transfer patterns (sync then idle)</p>
<h3>Heartbeat and Timekeeping</h3>
<p>No mandatory heartbeat. That's the design.</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 600 40" width="600" height="40" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<text x="5" y="10">T</text>
<text x="15" y="10">r</text>
<text x="25" y="10">a</text>
<text x="35" y="10">d</text>
<text x="45" y="10">i</text>
<text x="55" y="10">t</text>
<text x="65" y="10">i</text>
<text x="75" y="10">o</text>
<text x="85" y="10">n</text>
<text x="95" y="10">a</text>
<text x="105" y="10">l</text>
<text x="125" y="10">c</text>
<text x="135" y="10">l</text>
<text x="145" y="10">u</text>
<text x="155" y="10">s</text>
<text x="165" y="10">t</text>
<text x="175" y="10">e</text>
<text x="185" y="10">r</text>
<text x="195" y="10">:</text>
<text x="225" y="10">p</text>
<text x="235" y="10">i</text>
<text x="245" y="10">n</text>
<text x="255" y="10">g</text>
<text x="275" y="10">→</text>
<text x="295" y="10">p</text>
<text x="305" y="10">o</text>
<text x="315" y="10">n</text>
<text x="325" y="10">g</text>
<text x="345" y="10">→</text>
<text x="365" y="10">p</text>
<text x="375" y="10">i</text>
<text x="385" y="10">n</text>
<text x="395" y="10">g</text>
<text x="415" y="10">→</text>
<text x="435" y="10">p</text>
<text x="445" y="10">o</text>
<text x="455" y="10">n</text>
<text x="465" y="10">g</text>
<text x="485" y="10">→</text>
<text x="505" y="10">.</text>
<text x="515" y="10">.</text>
<text x="525" y="10">.</text>
<text x="5" y="30">L</text>
<text x="15" y="30">a</text>
<text x="25" y="30">z</text>
<text x="35" y="30">y</text>
<text x="55" y="30">c</text>
<text x="65" y="30">l</text>
<text x="75" y="30">u</text>
<text x="85" y="30">s</text>
<text x="95" y="30">t</text>
<text x="105" y="30">e</text>
<text x="115" y="30">r</text>
<text x="125" y="30">:</text>
<text x="225" y="30">.</text>
<text x="235" y="30">.</text>
<text x="245" y="30">.</text>
<text x="265" y="30">s</text>
<text x="275" y="30">i</text>
<text x="285" y="30">l</text>
<text x="295" y="30">e</text>
<text x="305" y="30">n</text>
<text x="315" y="30">c</text>
<text x="325" y="30">e</text>
<text x="345" y="30">.</text>
<text x="355" y="30">.</text>
<text x="365" y="30">.</text>
<text x="385" y="30">(</text>
<text x="395" y="30">s</text>
<text x="405" y="30">y</text>
<text x="415" y="30">n</text>
<text x="425" y="30">c</text>
<text x="435" y="30">)</text>
<text x="455" y="30">.</text>
<text x="465" y="30">.</text>
<text x="475" y="30">.</text>
<text x="495" y="30">s</text>
<text x="505" y="30">i</text>
<text x="515" y="30">l</text>
<text x="525" y="30">e</text>
<text x="535" y="30">n</text>
<text x="545" y="30">c</text>
<text x="555" y="30">e</text>
<text x="575" y="30">.</text>
<text x="585" y="30">.</text>
<text x="595" y="30">.</text>
</svg>
</div>
<p>Timekeeping: Lamport clocks (Memo-012), not wall clocks. - Causality without synchronization - No NTP dependency - No GPS required - Works across time zones, planets</p>
<p>When you need consensus: Byzantine consensus (Memo-011) + Lamport clocks. - Lazy clustering for everyday sync - Byzantine consensus for critical decisions - Same Lamport clock across both modes</p>
<p>Optional presence beacon:</p>
<pre class="language-scheme">
(cluster-beacon
  (peer "alice")
  (lamport-time 4271)
  (last-release "2.1.0")
  (status available)
  (next-expected "when ready"))
</pre>
<p>Beacons are: - Pull-based (query, don't push) - Cached (no flood) - Stale-tolerant (hours/days old is fine) - Unsigned (advisory only)</p>
<h3>Sync Modes</h3>
<p>#### Push (I have something)</p>
<pre class="language-scheme">
(lazy-push peer)
;; Sends my new releases to peer
;; Non-blocking, fire-and-forget
</pre>
<p>#### Pull (What do you have?)</p>
<pre class="language-scheme">
(lazy-pull peer)
;; Fetches peer's new releases
;; Verifies signatures, stores locally
</pre>
<p>#### Sync (Bidirectional)</p>
<pre class="language-scheme">
(lazy-sync peer)
;; Push then pull
;; Returns conflict report if any
</pre>
<h3>Lazy Semantics</h3>
<p>No continuous connection. Nodes are offline by default.</p>
<p>No consistency guarantees. Nodes may diverge.</p>
<p>No automatic resolution. Conflicts flagged for humans.</p>
<p>No urgency. Sync happens when convenient.</p>
</section>
<section>
<h2>State Tracking</h2>
<h3>Version Vector</h3>
<p>Each node tracks what it knows about others:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 580 120" width="580" height="120" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<text x="5" y="10">(</text>
<text x="15" y="10">d</text>
<text x="25" y="10">e</text>
<text x="35" y="10">f</text>
<text x="45" y="10">i</text>
<text x="55" y="10">n</text>
<text x="65" y="10">e</text>
<text x="75" y="10">-</text>
<text x="85" y="10">r</text>
<text x="95" y="10">e</text>
<text x="105" y="10">c</text>
<text x="115" y="10">o</text>
<text x="125" y="10">r</text>
<text x="135" y="10">d</text>
<text x="145" y="10">-</text>
<text x="155" y="10">t</text>
<text x="165" y="10">y</text>
<text x="175" y="10">p</text>
<text x="185" y="10">e</text>
<text x="205" y="10">&lt;</text>
<text x="215" y="10">v</text>
<text x="225" y="10">e</text>
<text x="235" y="10">r</text>
<text x="245" y="10">s</text>
<text x="255" y="10">i</text>
<text x="265" y="10">o</text>
<text x="275" y="10">n</text>
<text x="285" y="10">-</text>
<text x="295" y="10">v</text>
<text x="305" y="10">e</text>
<text x="315" y="10">c</text>
<text x="325" y="10">t</text>
<text x="335" y="10">o</text>
<text x="345" y="10">r</text>
<text x="355" y="10">&gt;</text>
<text x="25" y="30">(</text>
<text x="35" y="30">m</text>
<text x="45" y="30">a</text>
<text x="55" y="30">k</text>
<text x="65" y="30">e</text>
<text x="75" y="30">-</text>
<text x="85" y="30">v</text>
<text x="95" y="30">e</text>
<text x="105" y="30">r</text>
<text x="115" y="30">s</text>
<text x="125" y="30">i</text>
<text x="135" y="30">o</text>
<text x="145" y="30">n</text>
<text x="155" y="30">-</text>
<text x="165" y="30">v</text>
<text x="175" y="30">e</text>
<text x="185" y="30">c</text>
<text x="195" y="30">t</text>
<text x="205" y="30">o</text>
<text x="215" y="30">r</text>
<text x="235" y="30">e</text>
<text x="245" y="30">n</text>
<text x="255" y="30">t</text>
<text x="265" y="30">r</text>
<text x="275" y="30">i</text>
<text x="285" y="30">e</text>
<text x="295" y="30">s</text>
<text x="305" y="30">)</text>
<text x="25" y="50">v</text>
<text x="35" y="50">e</text>
<text x="45" y="50">r</text>
<text x="55" y="50">s</text>
<text x="65" y="50">i</text>
<text x="75" y="50">o</text>
<text x="85" y="50">n</text>
<text x="95" y="50">-</text>
<text x="105" y="50">v</text>
<text x="115" y="50">e</text>
<text x="125" y="50">c</text>
<text x="135" y="50">t</text>
<text x="145" y="50">o</text>
<text x="155" y="50">r</text>
<text x="165" y="50">?</text>
<text x="25" y="70">(</text>
<text x="35" y="70">e</text>
<text x="45" y="70">n</text>
<text x="55" y="70">t</text>
<text x="65" y="70">r</text>
<text x="75" y="70">i</text>
<text x="85" y="70">e</text>
<text x="95" y="70">s</text>
<text x="115" y="70">v</text>
<text x="125" y="70">v</text>
<text x="135" y="70">-</text>
<text x="145" y="70">e</text>
<text x="155" y="70">n</text>
<text x="165" y="70">t</text>
<text x="175" y="70">r</text>
<text x="185" y="70">i</text>
<text x="195" y="70">e</text>
<text x="205" y="70">s</text>
<text x="215" y="70">)</text>
<text x="225" y="70">)</text>
<text x="255" y="70">;</text>
<text x="275" y="70">H</text>
<text x="285" y="70">a</text>
<text x="295" y="70">s</text>
<text x="305" y="70">h</text>
<text x="315" y="70">:</text>
<text x="335" y="70">n</text>
<text x="345" y="70">o</text>
<text x="355" y="70">d</text>
<text x="365" y="70">e</text>
<text x="375" y="70">-</text>
<text x="385" y="70">i</text>
<text x="395" y="70">d</text>
<text x="415" y="70">→</text>
<text x="435" y="70">l</text>
<text x="445" y="70">a</text>
<text x="455" y="70">t</text>
<text x="465" y="70">e</text>
<text x="475" y="70">s</text>
<text x="485" y="70">t</text>
<text x="495" y="70">-</text>
<text x="505" y="70">s</text>
<text x="515" y="70">e</text>
<text x="525" y="70">q</text>
<text x="535" y="70">u</text>
<text x="545" y="70">e</text>
<text x="555" y="70">n</text>
<text x="565" y="70">c</text>
<text x="575" y="70">e</text>
<text x="5" y="90">;</text>
<text x="15" y="90">;</text>
<text x="35" y="90">A</text>
<text x="45" y="90">l</text>
<text x="55" y="90">i</text>
<text x="65" y="90">c</text>
<text x="75" y="90">e</text>
<text x="85" y="90">'</text>
<text x="95" y="90">s</text>
<text x="115" y="90">v</text>
<text x="125" y="90">i</text>
<text x="135" y="90">e</text>
<text x="145" y="90">w</text>
<text x="155" y="90">:</text>
<text x="5" y="110">;</text>
<text x="15" y="110">;</text>
<text x="35" y="110">{</text>
<text x="55" y="110">a</text>
<text x="65" y="110">l</text>
<text x="75" y="110">i</text>
<text x="85" y="110">c</text>
<text x="95" y="110">e</text>
<text x="105" y="110">:</text>
<text x="125" y="110">4</text>
<text x="135" y="110">2</text>
<text x="145" y="110">,</text>
<text x="165" y="110">b</text>
<text x="175" y="110">o</text>
<text x="185" y="110">b</text>
<text x="195" y="110">:</text>
<text x="215" y="110">3</text>
<text x="225" y="110">7</text>
<text x="235" y="110">,</text>
<text x="255" y="110">c</text>
<text x="265" y="110">a</text>
<text x="275" y="110">r</text>
<text x="285" y="110">o</text>
<text x="295" y="110">l</text>
<text x="305" y="110">:</text>
<text x="325" y="110">2</text>
<text x="335" y="110">9</text>
<text x="355" y="110">}</text>
</svg>
</div>
<h3>Sync Calculation</h3>
<pre class="language-scheme">
(define (compute-sync-set local-vv remote-vv)
  "What to send/receive"
  (let ((to-send '())
        (to-receive '()))
    (for-each
      (lambda (node)
        (let ((local-seq (vv-get local-vv node))
              (remote-seq (vv-get remote-vv node)))
          (cond
            ((&gt; local-seq remote-seq)
             (push! to-send (releases-between node remote-seq local-seq)))
            ((&lt; local-seq remote-seq)
             (push! to-receive (list node remote-seq local-seq))))))
      (all-nodes local-vv remote-vv))
    (values to-send to-receive)))
</pre>
</section>
<section>
<h2>Conflict Detection</h2>
<h3>Divergence</h3>
<p>Same version, different content:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 460 160" width="460" height="160" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<text x="5" y="10">(</text>
<text x="15" y="10">l</text>
<text x="25" y="10">a</text>
<text x="35" y="10">z</text>
<text x="45" y="10">y</text>
<text x="55" y="10">-</text>
<text x="65" y="10">s</text>
<text x="75" y="10">y</text>
<text x="85" y="10">n</text>
<text x="95" y="10">c</text>
<text x="115" y="10">"</text>
<text x="125" y="10">b</text>
<text x="135" y="10">o</text>
<text x="145" y="10">b</text>
<text x="155" y="10">"</text>
<text x="165" y="10">)</text>
<text x="5" y="30">;</text>
<text x="15" y="30">;</text>
<text x="35" y="30">=</text>
<text x="45" y="30">&gt;</text>
<text x="5" y="50">;</text>
<text x="15" y="50">;</text>
<text x="35" y="50">⚠</text>
<text x="55" y="50">C</text>
<text x="65" y="50">o</text>
<text x="75" y="50">n</text>
<text x="85" y="50">f</text>
<text x="95" y="50">l</text>
<text x="105" y="50">i</text>
<text x="115" y="50">c</text>
<text x="125" y="50">t</text>
<text x="145" y="50">d</text>
<text x="155" y="50">e</text>
<text x="165" y="50">t</text>
<text x="175" y="50">e</text>
<text x="185" y="50">c</text>
<text x="195" y="50">t</text>
<text x="205" y="50">e</text>
<text x="215" y="50">d</text>
<text x="225" y="50">:</text>
<text x="5" y="70">;</text>
<text x="15" y="70">;</text>
<text x="55" y="70">V</text>
<text x="65" y="70">e</text>
<text x="75" y="70">r</text>
<text x="85" y="70">s</text>
<text x="95" y="70">i</text>
<text x="105" y="70">o</text>
<text x="115" y="70">n</text>
<text x="135" y="70">2</text>
<text x="145" y="70">.</text>
<text x="155" y="70">1</text>
<text x="165" y="70">.</text>
<text x="175" y="70">0</text>
<text x="5" y="90">;</text>
<text x="15" y="90">;</text>
<text x="55" y="90">L</text>
<text x="65" y="90">o</text>
<text x="75" y="90">c</text>
<text x="85" y="90">a</text>
<text x="95" y="90">l</text>
<text x="105" y="90">:</text>
<text x="135" y="90">s</text>
<text x="145" y="90">h</text>
<text x="155" y="90">a</text>
<text x="165" y="90">5</text>
<text x="175" y="90">1</text>
<text x="185" y="90">2</text>
<text x="195" y="90">:</text>
<text x="205" y="90">a</text>
<text x="215" y="90">b</text>
<text x="225" y="90">c</text>
<text x="235" y="90">1</text>
<text x="245" y="90">2</text>
<text x="255" y="90">3</text>
<text x="265" y="90">.</text>
<text x="275" y="90">.</text>
<text x="285" y="90">.</text>
<text x="5" y="110">;</text>
<text x="15" y="110">;</text>
<text x="55" y="110">R</text>
<text x="65" y="110">e</text>
<text x="75" y="110">m</text>
<text x="85" y="110">o</text>
<text x="95" y="110">t</text>
<text x="105" y="110">e</text>
<text x="115" y="110">:</text>
<text x="135" y="110">s</text>
<text x="145" y="110">h</text>
<text x="155" y="110">a</text>
<text x="165" y="110">5</text>
<text x="175" y="110">1</text>
<text x="185" y="110">2</text>
<text x="195" y="110">:</text>
<text x="205" y="110">d</text>
<text x="215" y="110">e</text>
<text x="225" y="110">f</text>
<text x="235" y="110">4</text>
<text x="245" y="110">5</text>
<text x="255" y="110">6</text>
<text x="265" y="110">.</text>
<text x="275" y="110">.</text>
<text x="285" y="110">.</text>
<text x="5" y="130">;</text>
<text x="15" y="130">;</text>
<text x="5" y="150">;</text>
<text x="15" y="150">;</text>
<text x="55" y="150">B</text>
<text x="65" y="150">o</text>
<text x="75" y="150">t</text>
<text x="85" y="150">h</text>
<text x="105" y="150">m</text>
<text x="115" y="150">o</text>
<text x="125" y="150">d</text>
<text x="135" y="150">i</text>
<text x="145" y="150">f</text>
<text x="155" y="150">i</text>
<text x="165" y="150">e</text>
<text x="175" y="150">d</text>
<text x="195" y="150">s</text>
<text x="205" y="150">i</text>
<text x="215" y="150">n</text>
<text x="225" y="150">c</text>
<text x="235" y="150">e</text>
<text x="255" y="150">c</text>
<text x="265" y="150">o</text>
<text x="275" y="150">m</text>
<text x="285" y="150">m</text>
<text x="295" y="150">o</text>
<text x="305" y="150">n</text>
<text x="325" y="150">a</text>
<text x="335" y="150">n</text>
<text x="345" y="150">c</text>
<text x="355" y="150">e</text>
<text x="365" y="150">s</text>
<text x="375" y="150">t</text>
<text x="385" y="150">o</text>
<text x="395" y="150">r</text>
<text x="415" y="150">2</text>
<text x="425" y="150">.</text>
<text x="435" y="150">0</text>
<text x="445" y="150">.</text>
<text x="455" y="150">0</text>
</svg>
</div>
<h3>Conflict Record</h3>
<pre class="language-scheme">
(conflict
  (version "2.1.0")
  (local-hash "sha512:abc123...")
  (remote-hash "sha512:def456...")
  (common-ancestor "2.0.0")
  (detected "2026-01-06T15:30:00Z")
  (status pending))  ; pending, resolved-local, resolved-remote, merged
</pre>
<h3>Resolution</h3>
<p>Manual resolution required:</p>
<pre class="language-scheme">
(lazy-resolve "2.1.0" prefer: 'local)
;; or
(lazy-resolve "2.1.0" prefer: 'remote)
;; or
(lazy-resolve "2.1.0" merged: "2.1.0-merged")
</pre>
</section>
<section>
<h2>Offline Operation</h2>
<h3>Work Offline</h3>
<pre class="language-scheme">
(seal-commit "Add feature")
(seal-release "2.2.0")
;; All local, no network required
</pre>
<h3>Queue for Sync</h3>
<pre class="language-scheme">
(lazy-queue)
;; =&gt;
;; Pending sync:
;;   2.1.1  (local, not pushed)
;;   2.2.0  (local, not pushed)
;;
;; To sync: (lazy-push "bob")
</pre>
<h3>Reconnect and Sync</h3>
<pre class="language-scheme">
(lazy-sync "bob")
;; Sends 2.1.1, 2.2.0
;; Receives bob's changes
;; Reports any conflicts
</pre>
</section>
<section>
<h2>Cluster Operations</h2>
<h3>Join Cluster</h3>
<pre class="language-scheme">
(lazy-join "bob"
  uri: "git@github.com:bob/vault.git"
  key: bob-public-key)
;; Registers peer, doesn't sync yet
</pre>
<h3>Initial Sync</h3>
<pre class="language-scheme">
(lazy-pull "bob")
;; Gets bob's full history
;; Verifies all signatures
</pre>
<h3>Leave Cluster</h3>
<pre class="language-scheme">
(lazy-leave "bob")
;; Removes peer from sync list
;; Keeps local copies of bob's releases
</pre>
<h3>Cluster Status</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 700 160" width="700" height="160" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<text x="5" y="10">(</text>
<text x="15" y="10">l</text>
<text x="25" y="10">a</text>
<text x="35" y="10">z</text>
<text x="45" y="10">y</text>
<text x="55" y="10">-</text>
<text x="65" y="10">s</text>
<text x="75" y="10">t</text>
<text x="85" y="10">a</text>
<text x="95" y="10">t</text>
<text x="105" y="10">u</text>
<text x="115" y="10">s</text>
<text x="125" y="10">)</text>
<text x="5" y="30">;</text>
<text x="15" y="30">;</text>
<text x="35" y="30">=</text>
<text x="45" y="30">&gt;</text>
<text x="5" y="50">;</text>
<text x="15" y="50">;</text>
<text x="35" y="50">C</text>
<text x="45" y="50">l</text>
<text x="55" y="50">u</text>
<text x="65" y="50">s</text>
<text x="75" y="50">t</text>
<text x="85" y="50">e</text>
<text x="95" y="50">r</text>
<text x="115" y="50">p</text>
<text x="125" y="50">e</text>
<text x="135" y="50">e</text>
<text x="145" y="50">r</text>
<text x="155" y="50">s</text>
<text x="165" y="50">:</text>
<text x="5" y="70">;</text>
<text x="15" y="70">;</text>
<text x="55" y="70">b</text>
<text x="65" y="70">o</text>
<text x="75" y="70">b</text>
<text x="125" y="70">l</text>
<text x="135" y="70">a</text>
<text x="145" y="70">s</text>
<text x="155" y="70">t</text>
<text x="165" y="70">-</text>
<text x="175" y="70">s</text>
<text x="185" y="70">y</text>
<text x="195" y="70">n</text>
<text x="205" y="70">c</text>
<text x="215" y="70">:</text>
<text x="235" y="70">2</text>
<text x="245" y="70">0</text>
<text x="255" y="70">2</text>
<text x="265" y="70">6</text>
<text x="275" y="70">-</text>
<text x="285" y="70">0</text>
<text x="295" y="70">1</text>
<text x="305" y="70">-</text>
<text x="315" y="70">0</text>
<text x="325" y="70">5</text>
<text x="355" y="70">v</text>
<text x="365" y="70">e</text>
<text x="375" y="70">r</text>
<text x="385" y="70">s</text>
<text x="395" y="70">i</text>
<text x="405" y="70">o</text>
<text x="415" y="70">n</text>
<text x="425" y="70">s</text>
<text x="435" y="70">:</text>
<text x="455" y="70">1</text>
<text x="465" y="70">.</text>
<text x="475" y="70">0</text>
<text x="485" y="70">.</text>
<text x="495" y="70">0</text>
<text x="505" y="70">-</text>
<text x="515" y="70">2</text>
<text x="525" y="70">.</text>
<text x="535" y="70">1</text>
<text x="545" y="70">.</text>
<text x="555" y="70">0</text>
<text x="585" y="70">✓</text>
<text x="5" y="90">;</text>
<text x="15" y="90">;</text>
<text x="55" y="90">c</text>
<text x="65" y="90">a</text>
<text x="75" y="90">r</text>
<text x="85" y="90">o</text>
<text x="95" y="90">l</text>
<text x="125" y="90">l</text>
<text x="135" y="90">a</text>
<text x="145" y="90">s</text>
<text x="155" y="90">t</text>
<text x="165" y="90">-</text>
<text x="175" y="90">s</text>
<text x="185" y="90">y</text>
<text x="195" y="90">n</text>
<text x="205" y="90">c</text>
<text x="215" y="90">:</text>
<text x="235" y="90">2</text>
<text x="245" y="90">0</text>
<text x="255" y="90">2</text>
<text x="265" y="90">6</text>
<text x="275" y="90">-</text>
<text x="285" y="90">0</text>
<text x="295" y="90">1</text>
<text x="305" y="90">-</text>
<text x="315" y="90">0</text>
<text x="325" y="90">3</text>
<text x="355" y="90">v</text>
<text x="365" y="90">e</text>
<text x="375" y="90">r</text>
<text x="385" y="90">s</text>
<text x="395" y="90">i</text>
<text x="405" y="90">o</text>
<text x="415" y="90">n</text>
<text x="425" y="90">s</text>
<text x="435" y="90">:</text>
<text x="455" y="90">1</text>
<text x="465" y="90">.</text>
<text x="475" y="90">0</text>
<text x="485" y="90">.</text>
<text x="495" y="90">0</text>
<text x="505" y="90">-</text>
<text x="515" y="90">2</text>
<text x="525" y="90">.</text>
<text x="535" y="90">0</text>
<text x="545" y="90">.</text>
<text x="555" y="90">0</text>
<text x="585" y="90">(</text>
<text x="595" y="90">2</text>
<text x="615" y="90">b</text>
<text x="625" y="90">e</text>
<text x="635" y="90">h</text>
<text x="645" y="90">i</text>
<text x="655" y="90">n</text>
<text x="665" y="90">d</text>
<text x="675" y="90">)</text>
<text x="5" y="110">;</text>
<text x="15" y="110">;</text>
<text x="55" y="110">d</text>
<text x="65" y="110">a</text>
<text x="75" y="110">v</text>
<text x="85" y="110">e</text>
<text x="125" y="110">l</text>
<text x="135" y="110">a</text>
<text x="145" y="110">s</text>
<text x="155" y="110">t</text>
<text x="165" y="110">-</text>
<text x="175" y="110">s</text>
<text x="185" y="110">y</text>
<text x="195" y="110">n</text>
<text x="205" y="110">c</text>
<text x="215" y="110">:</text>
<text x="235" y="110">n</text>
<text x="245" y="110">e</text>
<text x="255" y="110">v</text>
<text x="265" y="110">e</text>
<text x="275" y="110">r</text>
<text x="355" y="110">v</text>
<text x="365" y="110">e</text>
<text x="375" y="110">r</text>
<text x="385" y="110">s</text>
<text x="395" y="110">i</text>
<text x="405" y="110">o</text>
<text x="415" y="110">n</text>
<text x="425" y="110">s</text>
<text x="435" y="110">:</text>
<text x="455" y="110">n</text>
<text x="465" y="110">o</text>
<text x="475" y="110">n</text>
<text x="485" y="110">e</text>
<text x="585" y="110">(</text>
<text x="595" y="110">n</text>
<text x="605" y="110">o</text>
<text x="615" y="110">t</text>
<text x="635" y="110">s</text>
<text x="645" y="110">y</text>
<text x="655" y="110">n</text>
<text x="665" y="110">c</text>
<text x="675" y="110">e</text>
<text x="685" y="110">d</text>
<text x="695" y="110">)</text>
<text x="5" y="130">;</text>
<text x="15" y="130">;</text>
<text x="5" y="150">;</text>
<text x="15" y="150">;</text>
<text x="35" y="150">L</text>
<text x="45" y="150">o</text>
<text x="55" y="150">c</text>
<text x="65" y="150">a</text>
<text x="75" y="150">l</text>
<text x="85" y="150">:</text>
<text x="105" y="150">2</text>
<text x="115" y="150">.</text>
<text x="125" y="150">2</text>
<text x="135" y="150">.</text>
<text x="145" y="150">0</text>
<text x="165" y="150">(</text>
<text x="175" y="150">2</text>
<text x="195" y="150">a</text>
<text x="205" y="150">h</text>
<text x="215" y="150">e</text>
<text x="225" y="150">a</text>
<text x="235" y="150">d</text>
<text x="255" y="150">o</text>
<text x="265" y="150">f</text>
<text x="285" y="150">c</text>
<text x="295" y="150">l</text>
<text x="305" y="150">u</text>
<text x="315" y="150">s</text>
<text x="325" y="150">t</text>
<text x="335" y="150">e</text>
<text x="345" y="150">r</text>
<text x="355" y="150">)</text>
</svg>
</div>
</section>
<section>
<h2>Sync Strategies</h2>
<h3>Manual (Default)</h3>
<pre class="language-scheme">
(vault-config 'sync-strategy 'manual)
;; User explicitly calls lazy-sync
</pre>
<h3>Periodic</h3>
<pre class="language-scheme">
(vault-config 'sync-strategy 'periodic)
(vault-config 'sync-interval 3600)  ; hourly
;; Background sync when network available
</pre>
<h3>On-Commit</h3>
<pre class="language-scheme">
(vault-config 'sync-strategy 'on-commit)
;; Push after each seal-commit
;; Still lazy (non-blocking, best-effort)
</pre>
<h3>On-Release</h3>
<pre class="language-scheme">
(vault-config 'sync-strategy 'on-release)
;; Push only after seal-release
;; Most conservative
</pre>
</section>
<section>
<h2>Consistency Guarantees</h2>
<h3>What We Guarantee</h3>
<ul>
<li>Signature integrity: All releases verified</li>
<li>Causal ordering: Within single node</li>
<li>Conflict detection: Divergence detected</li>
<li>Audit preservation: Full history kept</li>
</ul>
<h3>What We Don't Guarantee</h3>
<ul>
<li>Global ordering: Nodes may see different orders</li>
<li>Consistency: Nodes may have different content</li>
<li>Availability: Offline nodes are offline</li>
<li>Automatic resolution: Humans must resolve</li>
</ul>
<h3>CAP Theorem Position</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 270 200" width="270" height="200" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<text x="65" y="10">C</text>
<text x="75" y="10">o</text>
<text x="85" y="10">n</text>
<text x="95" y="10">s</text>
<text x="105" y="10">i</text>
<text x="115" y="10">s</text>
<text x="125" y="10">t</text>
<text x="135" y="10">e</text>
<text x="145" y="10">n</text>
<text x="155" y="10">c</text>
<text x="165" y="10">y</text>
<text x="105" y="30">/</text>
<text x="115" y="30">\</text>
<text x="95" y="50">/</text>
<text x="125" y="50">\</text>
<text x="85" y="70">/</text>
<text x="135" y="70">\</text>
<text x="75" y="90">/</text>
<text x="95" y="90">L</text>
<text x="105" y="90">a</text>
<text x="115" y="90">z</text>
<text x="125" y="90">y</text>
<text x="145" y="90">\</text>
<text x="65" y="110">/</text>
<text x="85" y="110">C</text>
<text x="95" y="110">l</text>
<text x="105" y="110">u</text>
<text x="115" y="110">s</text>
<text x="125" y="110">t</text>
<text x="135" y="110">e</text>
<text x="145" y="110">r</text>
<text x="155" y="110">\</text>
<text x="55" y="130">/</text>
<text x="105" y="130">✓</text>
<text x="165" y="130">\</text>
<text x="45" y="150">/</text>
<text x="55" y="150">\</text>
<text x="5" y="170">A</text>
<text x="15" y="170">v</text>
<text x="25" y="170">a</text>
<text x="35" y="170">i</text>
<text x="45" y="170">l</text>
<text x="55" y="170">a</text>
<text x="65" y="170">b</text>
<text x="75" y="170">i</text>
<text x="85" y="170">l</text>
<text x="95" y="170">i</text>
<text x="105" y="170">t</text>
<text x="115" y="170">y</text>
<text x="165" y="170">P</text>
<text x="175" y="170">a</text>
<text x="185" y="170">r</text>
<text x="195" y="170">t</text>
<text x="205" y="170">i</text>
<text x="215" y="170">t</text>
<text x="225" y="170">i</text>
<text x="235" y="170">o</text>
<text x="245" y="170">n</text>
<text x="45" y="190">✓</text>
<text x="165" y="190">T</text>
<text x="175" y="190">o</text>
<text x="185" y="190">l</text>
<text x="195" y="190">e</text>
<text x="205" y="190">r</text>
<text x="215" y="190">a</text>
<text x="225" y="190">n</text>
<text x="235" y="190">c</text>
<text x="245" y="190">e</text>
<text x="265" y="190">✓</text>
</svg>
</div>
<p>We choose AP: Available and Partition-tolerant, eventually consistent.</p>
</section>
<section>
<h2>Comparison with Other Modes</h2>
<table>
<tr><th>Aspect </th><th>Lazy Cluster </th><th>Federation (Memo-010) </th><th>Byzantine (Memo-011) </th></tr>
<tr><td>Trust </td><td>Friends </td><td>Verified peers </td><td>Adversarial </td></tr>
<tr><td>Sync </td><td>Manual/periodic </td><td>Announcement-based </td><td>Consensus </td></tr>
<tr><td>Conflicts </td><td>Manual resolve </td><td>Detect + flag </td><td>Prevented </td></tr>
<tr><td>Offline </td><td>Full support </td><td>Partial </td><td>Requires quorum </td></tr>
<tr><td>Complexity </td><td>Minimal </td><td>Medium </td><td>High </td></tr>
<tr><td>Use case </td><td>Small groups </td><td>Organizations </td><td>Critical systems </td></tr>
</table>
</section>
<section>
<h2>Example Session</h2>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 520 280" width="520" height="280" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<text x="5" y="10">;</text>
<text x="15" y="10">;</text>
<text x="35" y="10">M</text>
<text x="45" y="10">o</text>
<text x="55" y="10">r</text>
<text x="65" y="10">n</text>
<text x="75" y="10">i</text>
<text x="85" y="10">n</text>
<text x="95" y="10">g</text>
<text x="105" y="10">:</text>
<text x="125" y="10">A</text>
<text x="135" y="10">l</text>
<text x="145" y="10">i</text>
<text x="155" y="10">c</text>
<text x="165" y="10">e</text>
<text x="185" y="10">w</text>
<text x="195" y="10">o</text>
<text x="205" y="10">r</text>
<text x="215" y="10">k</text>
<text x="225" y="10">s</text>
<text x="245" y="10">o</text>
<text x="255" y="10">f</text>
<text x="265" y="10">f</text>
<text x="275" y="10">l</text>
<text x="285" y="10">i</text>
<text x="295" y="10">n</text>
<text x="305" y="10">e</text>
<text x="5" y="30">(</text>
<text x="15" y="30">s</text>
<text x="25" y="30">e</text>
<text x="35" y="30">a</text>
<text x="45" y="30">l</text>
<text x="55" y="30">-</text>
<text x="65" y="30">c</text>
<text x="75" y="30">o</text>
<text x="85" y="30">m</text>
<text x="95" y="30">m</text>
<text x="105" y="30">i</text>
<text x="115" y="30">t</text>
<text x="135" y="30">"</text>
<text x="145" y="30">A</text>
<text x="155" y="30">d</text>
<text x="165" y="30">d</text>
<text x="185" y="30">a</text>
<text x="195" y="30">u</text>
<text x="205" y="30">t</text>
<text x="215" y="30">h</text>
<text x="225" y="30">e</text>
<text x="235" y="30">n</text>
<text x="245" y="30">t</text>
<text x="255" y="30">i</text>
<text x="265" y="30">c</text>
<text x="275" y="30">a</text>
<text x="285" y="30">t</text>
<text x="295" y="30">i</text>
<text x="305" y="30">o</text>
<text x="315" y="30">n</text>
<text x="325" y="30">"</text>
<text x="335" y="30">)</text>
<text x="5" y="50">(</text>
<text x="15" y="50">s</text>
<text x="25" y="50">e</text>
<text x="35" y="50">a</text>
<text x="45" y="50">l</text>
<text x="55" y="50">-</text>
<text x="65" y="50">c</text>
<text x="75" y="50">o</text>
<text x="85" y="50">m</text>
<text x="95" y="50">m</text>
<text x="105" y="50">i</text>
<text x="115" y="50">t</text>
<text x="135" y="50">"</text>
<text x="145" y="50">A</text>
<text x="155" y="50">d</text>
<text x="165" y="50">d</text>
<text x="185" y="50">a</text>
<text x="195" y="50">u</text>
<text x="205" y="50">t</text>
<text x="215" y="50">h</text>
<text x="225" y="50">o</text>
<text x="235" y="50">r</text>
<text x="245" y="50">i</text>
<text x="255" y="50">z</text>
<text x="265" y="50">a</text>
<text x="275" y="50">t</text>
<text x="285" y="50">i</text>
<text x="295" y="50">o</text>
<text x="305" y="50">n</text>
<text x="315" y="50">"</text>
<text x="325" y="50">)</text>
<text x="5" y="70">(</text>
<text x="15" y="70">s</text>
<text x="25" y="70">e</text>
<text x="35" y="70">a</text>
<text x="45" y="70">l</text>
<text x="55" y="70">-</text>
<text x="65" y="70">r</text>
<text x="75" y="70">e</text>
<text x="85" y="70">l</text>
<text x="95" y="70">e</text>
<text x="105" y="70">a</text>
<text x="115" y="70">s</text>
<text x="125" y="70">e</text>
<text x="145" y="70">"</text>
<text x="155" y="70">2</text>
<text x="165" y="70">.</text>
<text x="175" y="70">3</text>
<text x="185" y="70">.</text>
<text x="195" y="70">0</text>
<text x="205" y="70">"</text>
<text x="215" y="70">)</text>
<text x="5" y="90">;</text>
<text x="15" y="90">;</text>
<text x="35" y="90">L</text>
<text x="45" y="90">u</text>
<text x="55" y="90">n</text>
<text x="65" y="90">c</text>
<text x="75" y="90">h</text>
<text x="85" y="90">:</text>
<text x="105" y="90">A</text>
<text x="115" y="90">l</text>
<text x="125" y="90">i</text>
<text x="135" y="90">c</text>
<text x="145" y="90">e</text>
<text x="165" y="90">s</text>
<text x="175" y="90">y</text>
<text x="185" y="90">n</text>
<text x="195" y="90">c</text>
<text x="205" y="90">s</text>
<text x="225" y="90">w</text>
<text x="235" y="90">i</text>
<text x="245" y="90">t</text>
<text x="255" y="90">h</text>
<text x="275" y="90">B</text>
<text x="285" y="90">o</text>
<text x="295" y="90">b</text>
<text x="5" y="110">(</text>
<text x="15" y="110">l</text>
<text x="25" y="110">a</text>
<text x="35" y="110">z</text>
<text x="45" y="110">y</text>
<text x="55" y="110">-</text>
<text x="65" y="110">s</text>
<text x="75" y="110">y</text>
<text x="85" y="110">n</text>
<text x="95" y="110">c</text>
<text x="115" y="110">"</text>
<text x="125" y="110">b</text>
<text x="135" y="110">o</text>
<text x="145" y="110">b</text>
<text x="155" y="110">"</text>
<text x="165" y="110">)</text>
<text x="5" y="130">;</text>
<text x="15" y="130">;</text>
<text x="35" y="130">=</text>
<text x="45" y="130">&gt;</text>
<text x="65" y="130">P</text>
<text x="75" y="130">u</text>
<text x="85" y="130">s</text>
<text x="95" y="130">h</text>
<text x="105" y="130">e</text>
<text x="115" y="130">d</text>
<text x="135" y="130">2</text>
<text x="145" y="130">.</text>
<text x="155" y="130">3</text>
<text x="165" y="130">.</text>
<text x="175" y="130">0</text>
<text x="195" y="130">t</text>
<text x="205" y="130">o</text>
<text x="225" y="130">b</text>
<text x="235" y="130">o</text>
<text x="245" y="130">b</text>
<text x="5" y="150">;</text>
<text x="15" y="150">;</text>
<text x="35" y="150">=</text>
<text x="45" y="150">&gt;</text>
<text x="65" y="150">P</text>
<text x="75" y="150">u</text>
<text x="85" y="150">l</text>
<text x="95" y="150">l</text>
<text x="105" y="150">e</text>
<text x="115" y="150">d</text>
<text x="135" y="150">2</text>
<text x="145" y="150">.</text>
<text x="155" y="150">2</text>
<text x="165" y="150">.</text>
<text x="175" y="150">1</text>
<text x="195" y="150">f</text>
<text x="205" y="150">r</text>
<text x="215" y="150">o</text>
<text x="225" y="150">m</text>
<text x="245" y="150">b</text>
<text x="255" y="150">o</text>
<text x="265" y="150">b</text>
<text x="5" y="170">;</text>
<text x="15" y="170">;</text>
<text x="35" y="170">=</text>
<text x="45" y="170">&gt;</text>
<text x="65" y="170">N</text>
<text x="75" y="170">o</text>
<text x="95" y="170">c</text>
<text x="105" y="170">o</text>
<text x="115" y="170">n</text>
<text x="125" y="170">f</text>
<text x="135" y="170">l</text>
<text x="145" y="170">i</text>
<text x="155" y="170">c</text>
<text x="165" y="170">t</text>
<text x="175" y="170">s</text>
<text x="5" y="190">;</text>
<text x="15" y="190">;</text>
<text x="35" y="190">E</text>
<text x="45" y="190">v</text>
<text x="55" y="190">e</text>
<text x="65" y="190">n</text>
<text x="75" y="190">i</text>
<text x="85" y="190">n</text>
<text x="95" y="190">g</text>
<text x="105" y="190">:</text>
<text x="125" y="190">A</text>
<text x="135" y="190">l</text>
<text x="145" y="190">i</text>
<text x="155" y="190">c</text>
<text x="165" y="190">e</text>
<text x="185" y="190">s</text>
<text x="195" y="190">y</text>
<text x="205" y="190">n</text>
<text x="215" y="190">c</text>
<text x="225" y="190">s</text>
<text x="245" y="190">w</text>
<text x="255" y="190">i</text>
<text x="265" y="190">t</text>
<text x="275" y="190">h</text>
<text x="295" y="190">C</text>
<text x="305" y="190">a</text>
<text x="315" y="190">r</text>
<text x="325" y="190">o</text>
<text x="335" y="190">l</text>
<text x="5" y="210">(</text>
<text x="15" y="210">l</text>
<text x="25" y="210">a</text>
<text x="35" y="210">z</text>
<text x="45" y="210">y</text>
<text x="55" y="210">-</text>
<text x="65" y="210">s</text>
<text x="75" y="210">y</text>
<text x="85" y="210">n</text>
<text x="95" y="210">c</text>
<text x="115" y="210">"</text>
<text x="125" y="210">c</text>
<text x="135" y="210">a</text>
<text x="145" y="210">r</text>
<text x="155" y="210">o</text>
<text x="165" y="210">l</text>
<text x="175" y="210">"</text>
<text x="185" y="210">)</text>
<text x="5" y="230">;</text>
<text x="15" y="230">;</text>
<text x="35" y="230">=</text>
<text x="45" y="230">&gt;</text>
<text x="65" y="230">P</text>
<text x="75" y="230">u</text>
<text x="85" y="230">s</text>
<text x="95" y="230">h</text>
<text x="105" y="230">e</text>
<text x="115" y="230">d</text>
<text x="135" y="230">2</text>
<text x="145" y="230">.</text>
<text x="155" y="230">2</text>
<text x="165" y="230">.</text>
<text x="175" y="230">1</text>
<text x="185" y="230">,</text>
<text x="205" y="230">2</text>
<text x="215" y="230">.</text>
<text x="225" y="230">3</text>
<text x="235" y="230">.</text>
<text x="245" y="230">0</text>
<text x="265" y="230">t</text>
<text x="275" y="230">o</text>
<text x="295" y="230">c</text>
<text x="305" y="230">a</text>
<text x="315" y="230">r</text>
<text x="325" y="230">o</text>
<text x="335" y="230">l</text>
<text x="5" y="250">;</text>
<text x="15" y="250">;</text>
<text x="35" y="250">=</text>
<text x="45" y="250">&gt;</text>
<text x="65" y="250">P</text>
<text x="75" y="250">u</text>
<text x="85" y="250">l</text>
<text x="95" y="250">l</text>
<text x="105" y="250">e</text>
<text x="115" y="250">d</text>
<text x="135" y="250">n</text>
<text x="145" y="250">o</text>
<text x="155" y="250">t</text>
<text x="165" y="250">h</text>
<text x="175" y="250">i</text>
<text x="185" y="250">n</text>
<text x="195" y="250">g</text>
<text x="215" y="250">(</text>
<text x="225" y="250">c</text>
<text x="235" y="250">a</text>
<text x="245" y="250">r</text>
<text x="255" y="250">o</text>
<text x="265" y="250">l</text>
<text x="285" y="250">h</text>
<text x="295" y="250">a</text>
<text x="305" y="250">s</text>
<text x="315" y="250">n</text>
<text x="325" y="250">'</text>
<text x="335" y="250">t</text>
<text x="355" y="250">r</text>
<text x="365" y="250">e</text>
<text x="375" y="250">l</text>
<text x="385" y="250">e</text>
<text x="395" y="250">a</text>
<text x="405" y="250">s</text>
<text x="415" y="250">e</text>
<text x="425" y="250">d</text>
<text x="435" y="250">)</text>
<text x="5" y="270">;</text>
<text x="15" y="270">;</text>
<text x="35" y="270">=</text>
<text x="45" y="270">&gt;</text>
<text x="65" y="270">⚠</text>
<text x="85" y="270">C</text>
<text x="95" y="270">a</text>
<text x="105" y="270">r</text>
<text x="115" y="270">o</text>
<text x="125" y="270">l</text>
<text x="145" y="270">h</text>
<text x="155" y="270">a</text>
<text x="165" y="270">s</text>
<text x="185" y="270">u</text>
<text x="195" y="270">n</text>
<text x="205" y="270">s</text>
<text x="215" y="270">y</text>
<text x="225" y="270">n</text>
<text x="235" y="270">c</text>
<text x="245" y="270">e</text>
<text x="255" y="270">d</text>
<text x="275" y="270">c</text>
<text x="285" y="270">o</text>
<text x="295" y="270">m</text>
<text x="305" y="270">m</text>
<text x="315" y="270">i</text>
<text x="325" y="270">t</text>
<text x="335" y="270">s</text>
<text x="355" y="270">(</text>
<text x="365" y="270">n</text>
<text x="375" y="270">o</text>
<text x="385" y="270">t</text>
<text x="405" y="270">o</text>
<text x="415" y="270">u</text>
<text x="425" y="270">r</text>
<text x="445" y="270">c</text>
<text x="455" y="270">o</text>
<text x="465" y="270">n</text>
<text x="475" y="270">c</text>
<text x="485" y="270">e</text>
<text x="495" y="270">r</text>
<text x="505" y="270">n</text>
<text x="515" y="270">)</text>
</svg>
</div>
</section>
<section>
<h2>Security Considerations</h2>
<h3>Trust Model</h3>
<p>Lazy clustering assumes good-faith peers:</p>
<ul>
<li>Peers won't inject malicious releases</li>
<li>Peers won't withhold releases maliciously</li>
<li>Peers will eventually sync</li>
</ul>
<p>Not suitable for: Adversarial environments, high-value targets.</p>
<p>Suitable for: Research groups, open source projects, friend networks.</p>
<h3>Signature Verification</h3>
<p>All releases still verified:</p>
<pre class="language-scheme">
(lazy-pull "bob")
;; Each release:
;;   1. Verify Ed25519 signature
;;   2. Verify hash matches content
;;   3. Check against known bob public key
;;   4. Store only if valid
</pre>
<h3>Conflict Attacks</h3>
<p>Malicious peer creates conflicting release.</p>
<p>Mitigation: - Conflicts flagged, not auto-resolved - Full audit trail of conflict - Peer reputation tracking</p>
</section>
<section>
<h2>Implementation Notes</h2>
<h3>Dependencies</h3>
<ul>
<li>crypto-ffi</li>
<li>Signature verification - audit</li>
<li>Sync logging</li>
<li>Transport (git/HTTP/filesystem)</li>
</ul>
<h3>Storage</h3>
<pre>
.vault/
  lazy/
    peers.sexp        # Registered peers
    vectors.sexp      # Version vectors
    conflicts/        # Unresolved conflicts
    queue/            # Pending pushes
</pre>
</section>
<section>
<h2>References</h2>
<p>1. Saito, Y., &amp; Shapiro, M. (2005). Optimistic Replication. 2. Terry, D., et al. (1995). Managing Update Conflicts in Bayou. 3. DeCandia, G., et al. (2007). Dynamo: Amazon's Key-Value Store. 4. Memo-010: Federation Protocol 5. Memo-012: Lamport Logical Clocks</p>
</section>
<section>
<h2>Changelog</h2>
<ul>
<li>2026-01-06</li>
<li>Set minimum bandwidth: 128 Kb/s floor (dual-ISDN), 1 Mb/s target (T1) - 2026-01-06</li>
<li>Initial specification</li>
</ul>
</section>
<script>
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
}
(function() {
  // Query param override (for REPL: ?theme=dark or ?theme=light)
  const params = new URLSearchParams(window.location.search);
  const param = params.get('theme');
  if (param === 'dark' || param === 'light') {
    document.documentElement.setAttribute('data-theme', param);
    localStorage.setItem('theme', param);
    return;
  }
  // localStorage preference
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
  } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', 'light');
  }
})();
</script>
</body>
</html>
