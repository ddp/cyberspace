<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <title>Memo 0008: Threshold Signature Governance</title>
  <link rel="icon" id="favicon" href="data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27%230f0%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>">
  <script>
(function(){
  var h=new Date().getHours(),c;
  if(h>=4&&h<6)c='%23845EC2';       // brahma muhurta - violet
  else if(h>=6&&h<8)c='%23ffd700';  // dawn - gold
  else if(h>=8&&h<11)c='%2300d4aa'; // morning - teal
  else if(h>=11&&h<14)c='%230f0';   // midday - phosphor
  else if(h>=14&&h<17)c='%2339ff14';// afternoon - neon
  else if(h>=17&&h<19)c='%23ff6600';// sunset - orange
  else if(h>=19&&h<22)c='%23ff3366';// evening - coral
  else c='%2300ffff';               // night - cyan
  document.getElementById('favicon').href='data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27'+c+'%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>';
})();
</script>
  <link rel="stylesheet" href="memo.css">
</head>
<body>
<span class="theme-toggle" onclick="toggleTheme()" title="Toggle light/dark">[theme]</span>
<h1>Memo 0008: Threshold Signature Governance</h1>
<dl class="metadata">
</dl>
<hr>
<section>
<h2>Abstract</h2>
<p>This Memo specifies the threshold signature system for Cyberspace governance, enabling K-of-N multi-party authorization for critical operations. Democracy in code: no single point of failure, no rogue administrator.</p>
</section>
<section>
<h2>Motivation</h2>
<p>Critical operations require collective authorization:</p>
<ul>
<li>Release signing: Multiple maintainers must approve</li>
<li>Deployment: Operations team quorum required</li>
<li>Key ceremonies: Distributed trust for root keys</li>
<li>Emergency response: Prevent unilateral action</li>
</ul>
<p>Each scenario involves irreversible or high-impact actions where single-party authorization creates unacceptable risk.</p>
<p>Traditional approaches fail: - Shared passwords: Who has it? Who used it? - Sudo access: Root is root - Approval workflows: Soft controls, bypassable</p>
<p>Threshold signatures provide cryptographic enforcement:</p>
<blockquote>
<p>K valid signatures required. Not K-1. Not bypass. Mathematics.</p>
</blockquote>
</section>
<section>
<h2>Specification</h2>
<h3>Tiered Signing Model</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 630 160" width="630" height="160" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<line x1="5" y1="10" x2="10" y2="10"/>
<line x1="5" y1="10" x2="5" y2="21"/>
<line x1="10" y1="10" x2="20" y2="10"/>
<line x1="20" y1="10" x2="30" y2="10"/>
<line x1="30" y1="10" x2="40" y2="10"/>
<line x1="40" y1="10" x2="50" y2="10"/>
<line x1="50" y1="10" x2="60" y2="10"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="160" y2="10"/>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="180" y2="10"/>
<line x1="180" y1="10" x2="190" y2="10"/>
<line x1="190" y1="10" x2="200" y2="10"/>
<line x1="200" y1="10" x2="210" y2="10"/>
<line x1="210" y1="10" x2="220" y2="10"/>
<line x1="220" y1="10" x2="230" y2="10"/>
<line x1="230" y1="10" x2="240" y2="10"/>
<line x1="240" y1="10" x2="250" y2="10"/>
<line x1="250" y1="10" x2="260" y2="10"/>
<line x1="260" y1="10" x2="270" y2="10"/>
<line x1="270" y1="10" x2="280" y2="10"/>
<line x1="280" y1="10" x2="290" y2="10"/>
<line x1="290" y1="10" x2="300" y2="10"/>
<line x1="300" y1="10" x2="310" y2="10"/>
<line x1="310" y1="10" x2="320" y2="10"/>
<line x1="320" y1="10" x2="330" y2="10"/>
<line x1="330" y1="10" x2="340" y2="10"/>
<line x1="340" y1="10" x2="350" y2="10"/>
<line x1="350" y1="10" x2="360" y2="10"/>
<line x1="360" y1="10" x2="370" y2="10"/>
<line x1="370" y1="10" x2="380" y2="10"/>
<line x1="380" y1="10" x2="390" y2="10"/>
<line x1="390" y1="10" x2="400" y2="10"/>
<line x1="400" y1="10" x2="410" y2="10"/>
<line x1="410" y1="10" x2="420" y2="10"/>
<line x1="420" y1="10" x2="430" y2="10"/>
<line x1="430" y1="10" x2="440" y2="10"/>
<line x1="440" y1="10" x2="450" y2="10"/>
<line x1="450" y1="10" x2="460" y2="10"/>
<line x1="460" y1="10" x2="470" y2="10"/>
<line x1="470" y1="10" x2="480" y2="10"/>
<line x1="480" y1="10" x2="490" y2="10"/>
<line x1="490" y1="10" x2="500" y2="10"/>
<line x1="500" y1="10" x2="510" y2="10"/>
<line x1="510" y1="10" x2="520" y2="10"/>
<line x1="520" y1="10" x2="530" y2="10"/>
<line x1="530" y1="10" x2="540" y2="10"/>
<line x1="540" y1="10" x2="550" y2="10"/>
<line x1="550" y1="10" x2="560" y2="10"/>
<line x1="560" y1="10" x2="570" y2="10"/>
<line x1="570" y1="10" x2="580" y2="10"/>
<line x1="580" y1="10" x2="590" y2="10"/>
<line x1="590" y1="10" x2="600" y2="10"/>
<line x1="600" y1="10" x2="610" y2="10"/>
<line x1="610" y1="10" x2="620" y2="10"/>
<line x1="620" y1="10" x2="625" y2="10"/>
<line x1="625" y1="10" x2="625" y2="21"/>
<line x1="5" y1="19" x2="5" y2="41"/>
<text x="210" y="30">SIGNING</text>
<text x="290" y="30">TIERS</text>
<line x1="625" y1="19" x2="625" y2="41"/>
<line x1="5" y1="39" x2="5" y2="61"/>
<line x1="5" y1="50" x2="10" y2="50"/>
<line x1="10" y1="50" x2="20" y2="50"/>
<line x1="20" y1="50" x2="30" y2="50"/>
<line x1="30" y1="50" x2="40" y2="50"/>
<line x1="40" y1="50" x2="50" y2="50"/>
<line x1="50" y1="50" x2="60" y2="50"/>
<line x1="60" y1="50" x2="70" y2="50"/>
<line x1="70" y1="50" x2="80" y2="50"/>
<line x1="80" y1="50" x2="90" y2="50"/>
<line x1="90" y1="50" x2="100" y2="50"/>
<line x1="100" y1="50" x2="110" y2="50"/>
<line x1="110" y1="50" x2="120" y2="50"/>
<line x1="120" y1="50" x2="130" y2="50"/>
<line x1="130" y1="50" x2="140" y2="50"/>
<line x1="140" y1="50" x2="150" y2="50"/>
<line x1="150" y1="50" x2="160" y2="50"/>
<line x1="160" y1="50" x2="170" y2="50"/>
<line x1="170" y1="50" x2="180" y2="50"/>
<line x1="180" y1="50" x2="190" y2="50"/>
<line x1="190" y1="50" x2="200" y2="50"/>
<line x1="200" y1="50" x2="210" y2="50"/>
<line x1="210" y1="50" x2="220" y2="50"/>
<line x1="220" y1="50" x2="230" y2="50"/>
<line x1="230" y1="50" x2="240" y2="50"/>
<line x1="240" y1="50" x2="250" y2="50"/>
<line x1="250" y1="50" x2="260" y2="50"/>
<line x1="260" y1="50" x2="270" y2="50"/>
<line x1="270" y1="50" x2="280" y2="50"/>
<line x1="280" y1="50" x2="290" y2="50"/>
<line x1="290" y1="50" x2="300" y2="50"/>
<line x1="300" y1="50" x2="310" y2="50"/>
<line x1="310" y1="50" x2="320" y2="50"/>
<line x1="320" y1="50" x2="330" y2="50"/>
<line x1="330" y1="50" x2="340" y2="50"/>
<line x1="340" y1="50" x2="350" y2="50"/>
<line x1="350" y1="50" x2="360" y2="50"/>
<line x1="360" y1="50" x2="370" y2="50"/>
<line x1="370" y1="50" x2="380" y2="50"/>
<line x1="380" y1="50" x2="390" y2="50"/>
<line x1="390" y1="50" x2="400" y2="50"/>
<line x1="400" y1="50" x2="410" y2="50"/>
<line x1="410" y1="50" x2="420" y2="50"/>
<line x1="420" y1="50" x2="430" y2="50"/>
<line x1="430" y1="50" x2="440" y2="50"/>
<line x1="440" y1="50" x2="450" y2="50"/>
<line x1="450" y1="50" x2="460" y2="50"/>
<line x1="460" y1="50" x2="470" y2="50"/>
<line x1="470" y1="50" x2="480" y2="50"/>
<line x1="480" y1="50" x2="490" y2="50"/>
<line x1="490" y1="50" x2="500" y2="50"/>
<line x1="500" y1="50" x2="510" y2="50"/>
<line x1="510" y1="50" x2="520" y2="50"/>
<line x1="520" y1="50" x2="530" y2="50"/>
<line x1="530" y1="50" x2="540" y2="50"/>
<line x1="540" y1="50" x2="550" y2="50"/>
<line x1="550" y1="50" x2="560" y2="50"/>
<line x1="560" y1="50" x2="570" y2="50"/>
<line x1="570" y1="50" x2="580" y2="50"/>
<line x1="580" y1="50" x2="590" y2="50"/>
<line x1="590" y1="50" x2="600" y2="50"/>
<line x1="600" y1="50" x2="610" y2="50"/>
<line x1="610" y1="50" x2="620" y2="50"/>
<line x1="625" y1="39" x2="625" y2="61"/>
<line x1="620" y1="50" x2="625" y2="50"/>
<line x1="5" y1="59" x2="5" y2="81"/>
<text x="30" y="70">Development</text>
<text x="190" y="70">1-of-1</text>
<text x="290" y="70">Single</text>
<text x="360" y="70">developer</text>
<text x="460" y="70">can</text>
<text x="500" y="70">iterate</text>
<line x1="625" y1="59" x2="625" y2="81"/>
<line x1="5" y1="79" x2="5" y2="101"/>
<text x="30" y="90">Staging</text>
<text x="190" y="90">2-of-2</text>
<text x="290" y="90">Peer</text>
<text x="340" y="90">review</text>
<text x="410" y="90">required</text>
<line x1="625" y1="79" x2="625" y2="101"/>
<line x1="5" y1="99" x2="5" y2="121"/>
<text x="30" y="110">Production</text>
<text x="190" y="110">3-of-5</text>
<text x="290" y="110">Governance</text>
<text x="400" y="110">council</text>
<text x="480" y="110">quorum</text>
<line x1="625" y1="99" x2="625" y2="121"/>
<line x1="5" y1="119" x2="5" y2="141"/>
<text x="30" y="130">Emergency</text>
<text x="190" y="130">5-of-7</text>
<text x="290" y="130">Full</text>
<text x="340" y="130">council</text>
<text x="420" y="130">for</text>
<text x="460" y="130">critical</text>
<text x="550" y="130">ops</text>
<line x1="625" y1="119" x2="625" y2="141"/>
<line x1="5" y1="150" x2="10" y2="150"/>
<line x1="5" y1="139" x2="5" y2="150"/>
<line x1="10" y1="150" x2="20" y2="150"/>
<line x1="20" y1="150" x2="30" y2="150"/>
<line x1="30" y1="150" x2="40" y2="150"/>
<line x1="40" y1="150" x2="50" y2="150"/>
<line x1="50" y1="150" x2="60" y2="150"/>
<line x1="60" y1="150" x2="70" y2="150"/>
<line x1="70" y1="150" x2="80" y2="150"/>
<line x1="80" y1="150" x2="90" y2="150"/>
<line x1="90" y1="150" x2="100" y2="150"/>
<line x1="100" y1="150" x2="110" y2="150"/>
<line x1="110" y1="150" x2="120" y2="150"/>
<line x1="120" y1="150" x2="130" y2="150"/>
<line x1="130" y1="150" x2="140" y2="150"/>
<line x1="140" y1="150" x2="150" y2="150"/>
<line x1="150" y1="150" x2="160" y2="150"/>
<line x1="160" y1="150" x2="170" y2="150"/>
<line x1="170" y1="150" x2="180" y2="150"/>
<line x1="180" y1="150" x2="190" y2="150"/>
<line x1="190" y1="150" x2="200" y2="150"/>
<line x1="200" y1="150" x2="210" y2="150"/>
<line x1="210" y1="150" x2="220" y2="150"/>
<line x1="220" y1="150" x2="230" y2="150"/>
<line x1="230" y1="150" x2="240" y2="150"/>
<line x1="240" y1="150" x2="250" y2="150"/>
<line x1="250" y1="150" x2="260" y2="150"/>
<line x1="260" y1="150" x2="270" y2="150"/>
<line x1="270" y1="150" x2="280" y2="150"/>
<line x1="280" y1="150" x2="290" y2="150"/>
<line x1="290" y1="150" x2="300" y2="150"/>
<line x1="300" y1="150" x2="310" y2="150"/>
<line x1="310" y1="150" x2="320" y2="150"/>
<line x1="320" y1="150" x2="330" y2="150"/>
<line x1="330" y1="150" x2="340" y2="150"/>
<line x1="340" y1="150" x2="350" y2="150"/>
<line x1="350" y1="150" x2="360" y2="150"/>
<line x1="360" y1="150" x2="370" y2="150"/>
<line x1="370" y1="150" x2="380" y2="150"/>
<line x1="380" y1="150" x2="390" y2="150"/>
<line x1="390" y1="150" x2="400" y2="150"/>
<line x1="400" y1="150" x2="410" y2="150"/>
<line x1="410" y1="150" x2="420" y2="150"/>
<line x1="420" y1="150" x2="430" y2="150"/>
<line x1="430" y1="150" x2="440" y2="150"/>
<line x1="440" y1="150" x2="450" y2="150"/>
<line x1="450" y1="150" x2="460" y2="150"/>
<line x1="460" y1="150" x2="470" y2="150"/>
<line x1="470" y1="150" x2="480" y2="150"/>
<line x1="480" y1="150" x2="490" y2="150"/>
<line x1="490" y1="150" x2="500" y2="150"/>
<line x1="500" y1="150" x2="510" y2="150"/>
<line x1="510" y1="150" x2="520" y2="150"/>
<line x1="520" y1="150" x2="530" y2="150"/>
<line x1="530" y1="150" x2="540" y2="150"/>
<line x1="540" y1="150" x2="550" y2="150"/>
<line x1="550" y1="150" x2="560" y2="150"/>
<line x1="560" y1="150" x2="570" y2="150"/>
<line x1="570" y1="150" x2="580" y2="150"/>
<line x1="580" y1="150" x2="590" y2="150"/>
<line x1="590" y1="150" x2="600" y2="150"/>
<line x1="600" y1="150" x2="610" y2="150"/>
<line x1="610" y1="150" x2="620" y2="150"/>
<line x1="620" y1="150" x2="625" y2="150"/>
<line x1="625" y1="139" x2="625" y2="150"/>
</svg>
</div>
<h3>Script Signature Record</h3>
<pre class="language-scheme">
(define-record-type &lt;script-signature&gt;
  (make-script-signature signer signature timestamp)
  script-signature?
  (signer signature-signer)        ; Ed25519 public key (32 bytes)
  (signature signature-value)      ; Ed25519 signature (64 bytes)
  (timestamp signature-timestamp)) ; Unix epoch seconds
</pre>
<h3>Signing a Script</h3>
<pre class="language-scheme">
(define (sign-script script-content private-key #!optional public-key)
  "Sign script content with a private key"
  ...)
</pre>
<p>Process:</p>
<ul>
<li>Convert content to blob if string</li>
<li>Derive public key from private (if not provided)</li>
<li>Sign content with Ed25519</li>
<li>Record timestamp</li>
<li>Return script-signature record</li>
</ul>
<h3>Verifying Single Signature</h3>
<pre class="language-scheme">
(define (verify-script script-content signature-record)
  "Verify a script signature"
  (ed25519-verify (signature-signer signature-record)
                  content-blob
                  (signature-value signature-record)))
</pre>
<h3>Threshold Verification</h3>
<pre class="language-scheme">
(define (verify-threshold-script script-content signature-records threshold)
  "Verify threshold signatures on a script
   Returns: #t if at least K signatures are valid"
  (let* ((valid-sigs (filter (lambda (sig)
                               (verify-script script-content sig))
                             signature-records))
         (valid-count (length valid-sigs)))
    (&gt;= valid-count threshold)))
</pre>
</section>
<section>
<h2>Signature File Format</h2>
<pre class="language-scheme">
;; deploy.sig
((signature "hex-signature" "hex-pubkey" 1767685100)
 (signature "hex-signature" "hex-pubkey" 1767685200)
 (signature "hex-signature" "hex-pubkey" 1767685300))
</pre>
<p>Each entry contains: - Signature bytes (hex-encoded) - Signer public key (hex-encoded) - Timestamp (Unix epoch)</p>
</section>
<section>
<h2>CLI Interface</h2>
<h3>cyberspace verify</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 550 260" width="550" height="260" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">$</text>
<text x="20" y="10">cyberspace</text>
<text x="130" y="10">verify</text>
<text x="200" y="10">deploy.scm</text>
<text x="310" y="10">deploy.sig</text>
<text x="420" y="10">\</text>
<text x="40" y="30">--threshold</text>
<text x="160" y="30">3</text>
<text x="180" y="30">\</text>
<text x="40" y="50">--keys</text>
<text x="110" y="50">alice.pub</text>
<text x="210" y="50">bob.pub</text>
<text x="290" y="50">carol.pub</text>
<text x="390" y="50">dave.pub</text>
<text x="480" y="50">eve.pub</text>
<text x="0" y="70">===</text>
<text x="40" y="70">Cyberspace</text>
<text x="150" y="70">Script</text>
<text x="220" y="70">Verification</text>
<text x="350" y="70">===</text>
<text x="0" y="90">Script:</text>
<text x="120" y="90">deploy.scm</text>
<text x="0" y="110">Signatures:</text>
<text x="120" y="110">deploy.sig</text>
<text x="0" y="130">Threshold:</text>
<text x="120" y="130">3</text>
<text x="0" y="150">Keys:</text>
<text x="120" y="150">5</text>
<text x="140" y="150">provided</text>
<text x="0" y="170">Found</text>
<text x="60" y="170">3</text>
<text x="80" y="170">signature(s)</text>
<text x="210" y="170">in</text>
<text x="240" y="170">file</text>
<text x="20" y="190">Signature</text>
<text x="120" y="190">1:</text>
<text x="150" y="190">✓</text>
<text x="180" y="190">VALID</text>
<text x="240" y="190">(signer:</text>
<text x="330" y="190">cbc9b260da65f6a7...)</text>
<text x="20" y="210">Signature</text>
<text x="120" y="210">2:</text>
<text x="150" y="210">✓</text>
<text x="180" y="210">VALID</text>
<text x="240" y="210">(signer:</text>
<text x="330" y="210">a5f8c9e3d2b1f0e4...)</text>
<text x="20" y="230">Signature</text>
<text x="120" y="230">3:</text>
<text x="150" y="230">✓</text>
<text x="180" y="230">VALID</text>
<text x="240" y="230">(signer:</text>
<text x="330" y="230">7d3e8b2c1a0f5e4d...)</text>
<text x="0" y="250">✓</text>
<text x="30" y="250">SUCCESS:</text>
<text x="120" y="250">Script</text>
<text x="190" y="250">verified</text>
<text x="280" y="250">with</text>
<text x="330" y="250">3-of-3</text>
<text x="400" y="250">threshold</text>
</svg>
</div>
<h3>cyberspace run</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 550 200" width="550" height="200" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">$</text>
<text x="20" y="10">cyberspace</text>
<text x="130" y="10">run</text>
<text x="170" y="10">deploy.scm</text>
<text x="280" y="10">deploy.sig</text>
<text x="390" y="10">\</text>
<text x="40" y="30">--threshold</text>
<text x="160" y="30">3</text>
<text x="180" y="30">\</text>
<text x="40" y="50">--keys</text>
<text x="110" y="50">alice.pub</text>
<text x="210" y="50">bob.pub</text>
<text x="290" y="50">carol.pub</text>
<text x="390" y="50">dave.pub</text>
<text x="480" y="50">eve.pub</text>
<text x="0" y="70">===</text>
<text x="40" y="70">Cyberspace</text>
<text x="150" y="70">Script</text>
<text x="220" y="70">Verification</text>
<text x="350" y="70">===</text>
<text x="0" y="90">...</text>
<text x="0" y="110">✓</text>
<text x="30" y="110">SUCCESS:</text>
<text x="120" y="110">Script</text>
<text x="190" y="110">verified</text>
<text x="280" y="110">with</text>
<text x="330" y="110">3-of-5</text>
<text x="400" y="110">threshold</text>
<text x="0" y="130">===</text>
<text x="40" y="130">Executing</text>
<text x="140" y="130">Script</text>
<text x="210" y="130">===</text>
<text x="0" y="150">(seal-release</text>
<text x="140" y="150">"2.0.0"</text>
<text x="20" y="170">message:</text>
<text x="110" y="170">"Major</text>
<text x="180" y="170">release</text>
<text x="260" y="170">with</text>
<text x="310" y="170">new</text>
<text x="350" y="170">governance</text>
<text x="460" y="170">model"</text>
<text x="20" y="190">preserve:</text>
<text x="120" y="190">#t)</text>
</svg>
</div>
</section>
<section>
<h2>Governance Scenarios</h2>
<h3>Production Deployment (3-of-5)</h3>
<pre class="language-scheme">
;; Governance Council: Alice, Bob, Carol, Dave, Eve
;; Threshold: 3 signatures required

(define deployment-script
  "(seal-release \"2.0.0\"
    message: \"Major release\"
    preserve: #t)")

;; Alice signs
(define sig-alice
  (sign-script deployment-script alice-private alice-public))

;; Carol signs
(define sig-carol
  (sign-script deployment-script carol-private carol-public))

;; Dave signs
(define sig-dave
  (sign-script deployment-script dave-private dave-public))

;; Verify threshold
(verify-threshold-script deployment-script
                        (list sig-alice sig-carol sig-dave)
                        3)
;; =&gt; #t
</pre>
<h3>Insufficient Signatures</h3>
<pre class="language-scheme">
;; Only 2 signatures
(define insufficient-sigs
  (list sig-alice sig-carol))

(verify-threshold-script deployment-script insufficient-sigs 3)
;; =&gt; #f (rejected: need 3, got 2)
</pre>
<h3>Tampered Script Detection</h3>
<pre class="language-scheme">
;; Attacker modifies script
(define tampered-script
  "(seal-release \"2.0.0\"
    message: \"HACKED - deploying malware\"
    preserve: #t)")

(verify-threshold-script tampered-script sufficient-sigs 3)
;; =&gt; #f (signatures don't match modified content)
</pre>
</section>
<section>
<h2>Multi-Signature vs Shamir</h2>
<p>Two threshold approaches exist:</p>
<h3>Multi-Signature (This Memo)</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 380 80" width="380" height="80" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">Each</text>
<text x="50" y="10">party:</text>
<text x="120" y="10">own</text>
<text x="160" y="10">keypair</text>
<text x="0" y="30">Signing:</text>
<text x="120" y="30">each</text>
<text x="170" y="30">signs</text>
<text x="230" y="30">independently</text>
<text x="0" y="50">Verify:</text>
<text x="120" y="50">count</text>
<text x="180" y="50">valid</text>
<text x="240" y="50">signatures</text>
<text x="350" y="50">≥</text>
<text x="370" y="50">K</text>
<text x="0" y="70">Use</text>
<text x="40" y="70">case:</text>
<text x="120" y="70">governance,</text>
<text x="240" y="70">approvals</text>
</svg>
</div>
<p>Advantages: - Each party maintains own key - Clear audit trail (who signed) - Simple revocation (by key) - No key reconstruction</p>
<h3>Shamir Splitting (Memo-004)</h3>
<pre>
Single key: split into N shares
Signing:    K parties reconstruct, sign once
Verify:     single signature
Use case:   key backup, recovery
</pre>
<p>Advantages: - Single signature output - Key never fully assembled (in advanced schemes) - Smaller signature files</p>
<p>For governance, multi-signature is preferred: - Accountability (which individuals approved) - No reconstruction ceremony - Works asynchronously</p>
</section>
<section>
<h2>Security Considerations</h2>
<h3>Threat Model</h3>
<p>Protected against: - Single compromised key (need K) - Rogue administrator (need quorum) - Script tampering (signatures fail) - Replay of old scripts (timestamps, context)</p>
<p>Not protected against: - K compromised keys - All parties colluding - Side-channel on signing devices</p>
<h3>Key Management</h3>
<ul>
<li>Generation: Secure random via libsodium</li>
<li>Storage: Hardware tokens preferred, encrypted files acceptable</li>
<li>Distribution: Out-of-band verification of public keys</li>
<li>Rotation: New ceremony, revoke old keys</li>
</ul>
<p>Each party maintains their own key independently, ensuring no single compromise affects the system and providing clear accountability for each signature.</p>
<h3>Threshold Selection</h3>
<table>
<tr><th>Scenario </th><th>Threshold </th><th>Rationale </th></tr>
<tr><td>Development </td><td>1-of-1 </td><td>Fast iteration </td></tr>
<tr><td>Staging </td><td>2-of-2 </td><td>Peer review </td></tr>
<tr><td>Production </td><td>3-of-5 </td><td>Majority quorum </td></tr>
<tr><td>Root key </td><td>5-of-7 </td><td>Supermajority </td></tr>
<tr><td>Emergency </td><td>N-of-N </td><td>Full consensus </td></tr>
</table>
</section>
<section>
<h2>Audit Integration</h2>
<p>Every verified execution records:</p>
<pre class="language-scheme">
(audit-append
  actor: (threshold-verifier-list)
  action: (list 'script-execute script-hash)
  motivation: "Production deployment authorized"
  context: (list 'threshold 3 'signatures 3))
</pre>
<p>Audit trail shows: - Which signers authorized - What script was executed - When authorization occurred - Threshold requirements met</p>
</section>
<section>
<h2>Implementation Notes</h2>
<h3>Dependencies</h3>
<ul>
<li>crypto-ffi</li>
<li>Ed25519 operations - cert</li>
<li>SPKI integration - audit</li>
<li>Trail recording</li>
</ul>
<h3>Performance</h3>
<ul>
<li>Signature verification: ~10μs per Ed25519 verify</li>
<li>Threshold check: O(N) where N = signature count</li>
<li>No network round-trips (offline verification)</li>
</ul>
</section>
<section>
<h2>References</h2>
<ul>
<li>Boneh, D., et al. (2001). Short Signatures from the Weil Pairing.</li>
<li>Gennaro, R., et al. (2016). Threshold-optimal DSA/ECDSA signatures.</li>
<li>NIST SP 800-57. Recommendation for Key Management.</li>
<li>Memo-003: SPKI Authorization Integration</li>
</ul>
</section>
<section>
<h2>Changelog</h2>
<ul>
<li>2026-01-06</li>
<li>Initial specification</li>
</ul>
</section>
<script>
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
}
(function() {
  // Query param override (for REPL: ?theme=dark or ?theme=light)
  const params = new URLSearchParams(window.location.search);
  const param = params.get('theme');
  if (param === 'dark' || param === 'light') {
    document.documentElement.setAttribute('data-theme', param);
    localStorage.setItem('theme', param);
    return;
  }
  // localStorage preference
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
  } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', 'light');
  }
})();
</script>
</body>
</html>
