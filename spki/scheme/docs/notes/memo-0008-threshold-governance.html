<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <title>Memo 0008: Threshold Signature Governance</title>
  <link rel="icon" id="favicon" href="data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27%230f0%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>">
  <script>
(function(){
  var h=new Date().getHours(),c;
  if(h>=4&&h<6)c='%23845EC2';       // brahma muhurta - violet
  else if(h>=6&&h<8)c='%23ffd700';  // dawn - gold
  else if(h>=8&&h<11)c='%2300d4aa'; // morning - teal
  else if(h>=11&&h<14)c='%230f0';   // midday - phosphor
  else if(h>=14&&h<17)c='%2339ff14';// afternoon - neon
  else if(h>=17&&h<19)c='%23ff6600';// sunset - orange
  else if(h>=19&&h<22)c='%23ff3366';// evening - coral
  else c='%2300ffff';               // night - cyan
  document.getElementById('favicon').href='data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27'+c+'%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>';
})();
</script>
  <link rel="stylesheet" href="memo.css">
</head>
<body>
<span class="theme-toggle" onclick="toggleTheme()" title="Toggle light/dark">[theme]</span>
<p class="format-notice"><em>For pixel-perfect diagrams: <a href="memo-0008-threshold-governance.ps">PostScript</a> or <a href="memo-0008-threshold-governance.pdf">PDF</a></em></p>
<h1>Memo 0008: Threshold Signature Governance</h1>
<dl class="metadata">
</dl>
<hr>
<section>
<h2>Abstract</h2>
<p>This Memo specifies the threshold signature system for Cyberspace governance, enabling K-of-N multi-party authorization for critical operations. Democracy in code: no single point of failure, no rogue administrator.</p>
</section>
<section>
<h2>Motivation</h2>
<p>Critical operations require collective authorization:</p>
<ul>
<li>Release signing: Multiple maintainers must approve</li>
<li>Deployment: Operations team quorum required</li>
<li>Key ceremonies: Distributed trust for root keys</li>
<li>Emergency response: Prevent unilateral action</li>
</ul>
<p>Each scenario involves irreversible or high-impact actions where single-party authorization creates unacceptable risk.</p>
<p>Traditional approaches fail: - Shared passwords: Who has it? Who used it? - Sudo access: Root is root - Approval workflows: Soft controls, bypassable</p>
<p>Threshold signatures provide cryptographic enforcement:</p>
<blockquote>
<p>K valid signatures required. Not K-1. Not bypass. Mathematics.</p>
</blockquote>
</section>
<section>
<h2>Specification</h2>
<h3>Tiered Signing Model</h3>
<pre class="diagram">
┌─────────────────────────────────────────────────────────────┐
│                    SIGNING TIERS                            │
├─────────────────────────────────────────────────────────────┤
│  Development     1-of-1    Single developer can iterate    │
│  Staging         2-of-2    Peer review required             │
│  Production      3-of-5    Governance council quorum        │
│  Emergency       5-of-7    Full council for critical ops    │
└─────────────────────────────────────────────────────────────┘
</pre>
<h3>Script Signature Record</h3>
<pre class="language-scheme">
(define-record-type &lt;script-signature&gt;
  (make-script-signature signer signature timestamp)
  script-signature?
  (signer signature-signer)        ; Ed25519 public key (32 bytes)
  (signature signature-value)      ; Ed25519 signature (64 bytes)
  (timestamp signature-timestamp)) ; Unix epoch seconds
</pre>
<h3>Signing a Script</h3>
<pre class="language-scheme">
(define (sign-script script-content private-key #!optional public-key)
  "Sign script content with a private key"
  ...)
</pre>
<p>Process:</p>
<ul>
<li>Convert content to blob if string</li>
<li>Derive public key from private (if not provided)</li>
<li>Sign content with Ed25519</li>
<li>Record timestamp</li>
<li>Return script-signature record</li>
</ul>
<h3>Verifying Single Signature</h3>
<pre class="language-scheme">
(define (verify-script script-content signature-record)
  "Verify a script signature"
  (ed25519-verify (signature-signer signature-record)
                  content-blob
                  (signature-value signature-record)))
</pre>
<h3>Threshold Verification</h3>
<pre class="language-scheme">
(define (verify-threshold-script script-content signature-records threshold)
  "Verify threshold signatures on a script
   Returns: #t if at least K signatures are valid"
  (let* ((valid-sigs (filter (lambda (sig)
                               (verify-script script-content sig))
                             signature-records))
         (valid-count (length valid-sigs)))
    (&gt;= valid-count threshold)))
</pre>
</section>
<section>
<h2>Signature File Format</h2>
<pre class="language-scheme">
;; deploy.sig
((signature "hex-signature" "hex-pubkey" 1767685100)
 (signature "hex-signature" "hex-pubkey" 1767685200)
 (signature "hex-signature" "hex-pubkey" 1767685300))
</pre>
<p>Each entry contains: - Signature bytes (hex-encoded) - Signer public key (hex-encoded) - Timestamp (Unix epoch)</p>
</section>
<section>
<h2>CLI Interface</h2>
<h3>cyberspace verify</h3>
<pre class="diagram">
$ cyberspace verify deploy.scm deploy.sig \
    --threshold 3 \
    --keys alice.pub bob.pub carol.pub dave.pub eve.pub

=== Cyberspace Script Verification ===

Script:     deploy.scm
Signatures: deploy.sig
Threshold:  3
Keys:       5 provided

Found 3 signature(s) in file
  Signature 1: ✓ VALID (signer: cbc9b260da65f6a7...)
  Signature 2: ✓ VALID (signer: a5f8c9e3d2b1f0e4...)
  Signature 3: ✓ VALID (signer: 7d3e8b2c1a0f5e4d...)

✓ SUCCESS: Script verified with 3-of-3 threshold
</pre>
<h3>cyberspace run</h3>
<pre class="diagram">
$ cyberspace run deploy.scm deploy.sig \
    --threshold 3 \
    --keys alice.pub bob.pub carol.pub dave.pub eve.pub

=== Cyberspace Script Verification ===
...
✓ SUCCESS: Script verified with 3-of-5 threshold

=== Executing Script ===
(seal-release "2.0.0"
  message: "Major release with new governance model"
  preserve: #t)
</pre>
</section>
<section>
<h2>Governance Scenarios</h2>
<h3>Production Deployment (3-of-5)</h3>
<pre class="language-scheme">
;; Governance Council: Alice, Bob, Carol, Dave, Eve
;; Threshold: 3 signatures required

(define deployment-script
  "(seal-release \"2.0.0\"
    message: \"Major release\"
    preserve: #t)")

;; Alice signs
(define sig-alice
  (sign-script deployment-script alice-private alice-public))

;; Carol signs
(define sig-carol
  (sign-script deployment-script carol-private carol-public))

;; Dave signs
(define sig-dave
  (sign-script deployment-script dave-private dave-public))

;; Verify threshold
(verify-threshold-script deployment-script
                        (list sig-alice sig-carol sig-dave)
                        3)
;; =&gt; #t
</pre>
<h3>Insufficient Signatures</h3>
<pre class="language-scheme">
;; Only 2 signatures
(define insufficient-sigs
  (list sig-alice sig-carol))

(verify-threshold-script deployment-script insufficient-sigs 3)
;; =&gt; #f (rejected: need 3, got 2)
</pre>
<h3>Tampered Script Detection</h3>
<pre class="language-scheme">
;; Attacker modifies script
(define tampered-script
  "(seal-release \"2.0.0\"
    message: \"HACKED - deploying malware\"
    preserve: #t)")

(verify-threshold-script tampered-script sufficient-sigs 3)
;; =&gt; #f (signatures don't match modified content)
</pre>
</section>
<section>
<h2>Multi-Signature vs Shamir</h2>
<p>Two threshold approaches exist:</p>
<h3>Multi-Signature (This Memo)</h3>
<pre class="diagram">
Each party: own keypair
Signing:    each signs independently
Verify:     count valid signatures ≥ K
Use case:   governance, approvals
</pre>
<p>Advantages: - Each party maintains own key - Clear audit trail (who signed) - Simple revocation (by key) - No key reconstruction</p>
<h3>Shamir Splitting (Memo-004)</h3>
<pre>
Single key: split into N shares
Signing:    K parties reconstruct, sign once
Verify:     single signature
Use case:   key backup, recovery
</pre>
<p>Advantages: - Single signature output - Key never fully assembled (in advanced schemes) - Smaller signature files</p>
<p>For governance, multi-signature is preferred: - Accountability (which individuals approved) - No reconstruction ceremony - Works asynchronously</p>
</section>
<section>
<h2>Security Considerations</h2>
<h3>Threat Model</h3>
<p>Protected against: - Single compromised key (need K) - Rogue administrator (need quorum) - Script tampering (signatures fail) - Replay of old scripts (timestamps, context)</p>
<p>Not protected against: - K compromised keys - All parties colluding - Side-channel on signing devices</p>
<h3>Key Management</h3>
<ul>
<li>Generation: Secure random via libsodium</li>
<li>Storage: Hardware tokens preferred, encrypted files acceptable</li>
<li>Distribution: Out-of-band verification of public keys</li>
<li>Rotation: New ceremony, revoke old keys</li>
</ul>
<p>Each party maintains their own key independently, ensuring no single compromise affects the system and providing clear accountability for each signature.</p>
<h3>Threshold Selection</h3>
<table>
<tr><th>Scenario </th><th>Threshold </th><th>Rationale </th></tr>
<tr><td>Development </td><td>1-of-1 </td><td>Fast iteration </td></tr>
<tr><td>Staging </td><td>2-of-2 </td><td>Peer review </td></tr>
<tr><td>Production </td><td>3-of-5 </td><td>Majority quorum </td></tr>
<tr><td>Root key </td><td>5-of-7 </td><td>Supermajority </td></tr>
<tr><td>Emergency </td><td>N-of-N </td><td>Full consensus </td></tr>
</table>
</section>
<section>
<h2>Audit Integration</h2>
<p>Every verified execution records:</p>
<pre class="language-scheme">
(audit-append
  actor: (threshold-verifier-list)
  action: (list 'script-execute script-hash)
  motivation: "Production deployment authorized"
  context: (list 'threshold 3 'signatures 3))
</pre>
<p>Audit trail shows: - Which signers authorized - What script was executed - When authorization occurred - Threshold requirements met</p>
</section>
<section>
<h2>Implementation Notes</h2>
<h3>Dependencies</h3>
<ul>
<li>crypto-ffi</li>
<li>Ed25519 operations - cert</li>
<li>SPKI integration - audit</li>
<li>Trail recording</li>
</ul>
<h3>Performance</h3>
<ul>
<li>Signature verification: ~10μs per Ed25519 verify</li>
<li>Threshold check: O(N) where N = signature count</li>
<li>No network round-trips (offline verification)</li>
</ul>
</section>
<section>
<h2>References</h2>
<ul>
<li>Boneh, D., et al. (2001). Short Signatures from the Weil Pairing.</li>
<li>Gennaro, R., et al. (2016). Threshold-optimal DSA/ECDSA signatures.</li>
<li>NIST SP 800-57. Recommendation for Key Management.</li>
<li>Memo-003: SPKI Authorization Integration</li>
</ul>
</section>
<section>
<h2>Changelog</h2>
<ul>
<li>2026-01-06</li>
<li>Initial specification</li>
</ul>
</section>
<script>
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
}
(function() {
  // Query param override (for REPL: ?theme=dark or ?theme=light)
  const params = new URLSearchParams(window.location.search);
  const param = params.get('theme');
  if (param === 'dark' || param === 'light') {
    document.documentElement.setAttribute('data-theme', param);
    localStorage.setItem('theme', param);
    return;
  }
  // localStorage preference
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
  } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', 'light');
  }
})();
</script>
</body>
</html>
