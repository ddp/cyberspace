<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <title>Memo 0054: Federation Operational Security</title>
  <link rel="icon" id="favicon" href="data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27%230f0%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>">
  <script>
(function(){
  var h=new Date().getHours(),c;
  if(h>=4&&h<6)c='%23845EC2';       // brahma muhurta - violet
  else if(h>=6&&h<8)c='%23ffd700';  // dawn - gold
  else if(h>=8&&h<11)c='%2300d4aa'; // morning - teal
  else if(h>=11&&h<14)c='%230f0';   // midday - phosphor
  else if(h>=14&&h<17)c='%2339ff14';// afternoon - neon
  else if(h>=17&&h<19)c='%23ff6600';// sunset - orange
  else if(h>=19&&h<22)c='%23ff3366';// evening - coral
  else c='%2300ffff';               // night - cyan
  document.getElementById('favicon').href='data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27'+c+'%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>';
})();
</script>
  <link rel="stylesheet" href="memo.css">
</head>
<body>
<span class="theme-toggle" onclick="toggleTheme()" title="Toggle light/dark">[theme]</span>
<p class="format-notice"><em>For pixel-perfect diagrams: <a href="memo-0054-federation-opsec.ps">PostScript</a> or <a href="memo-0054-federation-opsec.pdf">PDF</a></em></p>
<h1>Memo 0054: Federation Operational Security</h1>
<dl class="metadata">
</dl>
<hr>
<section>
<h2>Abstract</h2>
<p>Federation (Memo-010) enables peer-to-peer synchronization between vaults. This Memo specifies operational security considerations for federation: what information flows between peers, how to minimize information leakage, and techniques for protecting node identity and capabilities from covert channel analysis.</p>
</section>
<section>
<h2>1. The Problem Space</h2>
<p>When vaults federate, they exchange more than just releases. Every message, timing pattern, and capability advertisement creates an information flow. An adversary observing federation traffic—or a malicious peer—can build a profile of your node.</p>
<pre class="diagram">
          ┌─────────────────────────────────────────┐
          │           FEDERATION TRAFFIC               │
          ├─────────────────────────────────────────────┤
          │  Explicit:                                  │
          │    • Release announcements                  │
          │    • Sync requests                          │
          │    • Public keys                            │
          │                                             │
          │  Implicit (covert channels):                │
          │    • Timing patterns                        │
          │    • Response latencies                     │
          │    • Capability advertisements (weave)      │
          │    • Connection frequencies                 │
          │    • Online/offline patterns                │
          └─────────────────────────────────────────────┘
</pre>
</section>
<section>
<h2>2. Threat Model</h2>
<h3>2.1 Adversary Capabilities</h3>
<ul>
<li>Passive observer: Can see federation traffic</li>
<li>Active participant: Can be a peer in your federation</li>
<li>Traffic analyst: Can correlate timing and volume</li>
<li>Long-term observer: Can build profiles over time</li>
</ul>
<p>Adversaries range from casual observers to nation-state actors. Each capability level requires corresponding countermeasures; defense must be proportional to the threat model.</p>
<h3>2.2 Information at Risk</h3>
<ul>
<li>Node identity: Hardware fingerprinting via benchmarks</li>
<li>Location: Timezone from activity patterns</li>
<li>Capabilities: Computational power from weave</li>
<li>Behavior: Usage patterns from sync timing</li>
<li>Network topology: Who talks to whom</li>
</ul>
<p>Every piece of leaked information constrains the adversary's search space. Combined over time, small leaks enable deanonymization.</p>
</section>
<section>
<h2>3. Weave as Covert Channel</h2>
<h3>3.1 The Weave Metric</h3>
<p>Weave measures cryptographic throughput: SHA-512 operations per millisecond. This correlates directly with:</p>
<ul>
<li>CPU architecture (ARM vs x86, Apple Silicon vs Intel)</li>
<li>Core count and frequency</li>
<li>Thermal state and power constraints</li>
<li>Competing workload</li>
</ul>
<p>A raw weave value is a fingerprint.</p>
<h3>3.2 Attack Scenario</h3>
<pre>
Attacker observes: weave = 1667 (your actual value)

Known profiles:
  Apple M4 (10-core):  1600-1700
  Apple M3 (8-core):   1200-1400
  Raspberry Pi 4:       150-200
  Cloud VM (shared):    400-600

Conclusion: You're running Apple M4 Silicon on macOS.
Cross-reference with other traffic: Likely a specific model.
</pre>
<h3>3.3 Quantized Weave Strata</h3>
<p>Never share raw weave values in federation. Use quantized strata:</p>
<pre class="language-scheme">
(define *weave-strata*
  '((constrained . 500)     ; IoT, embedded, RPi
    (standard    . 1000)    ; Laptops, desktops
    (capable     . 2000)    ; Workstations, servers
    (powerful    . 4000)))  ; HPC, GPU-accelerated

(define (weave-stratum weave)
  "Which stratum of the lattice does this weave occupy?"
  (cond
    ((&lt; weave 500)  'constrained)
    ((&lt; weave 1000) 'standard)
    ((&lt; weave 2000) 'capable)
    (else           'powerful)))
</pre>
<p>Federation messages advertise stratum, not value:</p>
<pre class="language-scheme">
(federation-message
  (type capability)
  (from #${my-pubkey})
  (payload
    (weave-stratum capable)   ; NOT: (weave 1667)
    (storage-tier large))
  (signature #${sig}))
</pre>
</section>
<section>
<h2>4. Timing Analysis</h2>
<h3>4.1 Response Timing</h3>
<p>Response latency reveals:</p>
<ul>
<li>Storage speed (SSD vs HDD vs network)</li>
<li>Vault size (query time scales with objects)</li>
<li>Current load</li>
</ul>
<p>Mitigation: Add random jitter to responses.</p>
<pre class="language-scheme">
(define (jittered-response response)
  "Add 50-500ms random delay to mask timing."
  (thread-sleep! (+ 0.05 (* 0.45 (random))))
  response)
</pre>
<h3>4.2 Sync Timing</h3>
<p>Regular sync patterns reveal:</p>
<ul>
<li>Timezone (sync at 'morning' = your morning)</li>
<li>Work patterns (gaps during meetings)</li>
<li>Geographic region</li>
</ul>
<p>Mitigation: Randomize sync intervals around configured period.</p>
<pre class="language-scheme">
(define (next-sync-time base-interval)
  "Randomize by +/- 20% to mask patterns."
  (let ((jitter (* base-interval 0.2 (- (* 2 (random)) 1))))
    (+ (current-seconds) base-interval jitter)))
</pre>
</section>
<section>
<h2>5. Metadata Minimization</h2>
<h3>5.1 Principle</h3>
<p>Share the minimum information needed for federation to work. Everything else is unnecessary exposure.</p>
<h3>5.2 Required Information</h3>
<ul>
<li>Public key: Identity (unavoidable)</li>
<li>Release hashes: Content verification</li>
<li>Timestamps: Ordering (can be coarsened)</li>
</ul>
<h3>5.3 Unnecessary Information</h3>
<ul>
<li>Hostname: Use pubkey hash instead</li>
<li>OS/version: Protocol version suffices</li>
<li>Raw benchmarks: Use capability strata</li>
<li>Vault statistics: Object counts, sizes</li>
<li>Uptime: Session duration</li>
</ul>
<h3>5.4 Minimal Federation Message</h3>
<pre class="language-scheme">
(federation-message
  (type announcement)
  (from #${pubkey-hash})        ; Not hostname
  (epoch 1767686400)            ; Coarsened to hour
  (payload
    (release "2.0.0")
    (hash "sha512:..."))
  (signature #${sig}))          ; No extras
</pre>
</section>
<section>
<h2>6. Network Topology Protection</h2>
<h3>6.1 Peer Enumeration</h3>
<p>A malicious peer can probe your federation graph:</p>
<pre>
1. Register as your peer
2. Announce fake releases
3. Observe which peers request them
4. Map your federation network
</pre>
<h3>6.2 Mitigation</h3>
<p>Do not automatically propagate announcements. Verify before forwarding.</p>
<pre class="language-scheme">
(define (should-propagate? announcement)
  "Only propagate releases we have verified."
  (and (release-in-vault? (announcement-release announcement))
       (signature-verified? announcement)))
</pre>
</section>
<section>
<h2>7. Node Identity Separation</h2>
<h3>7.1 Multiple Personas</h3>
<p>Consider separate identities for different federation contexts:</p>
<ul>
<li>Personal vault: Friends and family</li>
<li>Professional vault: Work colleagues</li>
<li>Public vault: Open source releases</li>
</ul>
<p>Cross-correlation between personas weakens privacy.</p>
<h3>7.2 Implementation</h3>
<pre class="language-scheme">
(federation-identity
  (persona personal
    (keypair personal-keys)
    (peers alice bob carol))
  (persona professional
    (keypair work-keys)
    (peers company-vault))
  (persona public
    (keypair oss-keys)
    (peers community-mirror)))
</pre>
</section>
<section>
<h2>8. Traffic Analysis Resistance</h2>
<h3>8.1 Constant-Rate Traffic</h3>
<p>Advanced: Maintain constant traffic rate regardless of actual activity.</p>
<pre class="language-scheme">
(define (constant-rate-sync interval)
  "Send traffic at fixed intervals, real or dummy."
  (if (have-pending-sync?)
      (do-real-sync)
      (send-dummy-heartbeat)))
</pre>
<h3>8.2 Transport Considerations</h3>
<ul>
<li>TLS: Minimum for transport encryption</li>
<li>Tor: For strong anonymity (adds latency)</li>
<li>I2P: Alternative anonymity network</li>
<li>VPN: Masks source IP (trust VPN provider)</li>
</ul>
</section>
<section>
<h2>9. Configuration</h2>
<pre class="language-scheme">
(federation-opsec-config
  ;; Capability advertisement
  (advertise-weave-stratum #t)  ; Quantized, not raw
  (advertise-storage-tier #t)   ; large/medium/small
  (advertise-raw-metrics #f)    ; NEVER

  ;; Timing
  (response-jitter-ms 50 500)   ; Min/max jitter
  (sync-jitter-percent 20)      ; +/- randomization

  ;; Metadata
  (coarsen-timestamps 3600)     ; Round to hour
  (use-pubkey-hash #t)          ; Not hostname
  (hide-vault-stats #t)         ; No object counts

  ;; Network
  (verify-before-propagate #t)
  (constant-rate-traffic #f)    ; Advanced, optional
  (transport tls))
</pre>
</section>
<section>
<h2>10. Audit Integration</h2>
<p>OPSEC events should be recorded locally but not shared:</p>
<pre class="language-scheme">
(federation-opsec-audit
  (event weave-query)           ; Someone asked our weave
  (peer #${peer-pubkey})
  (response stratum:capable)    ; What we sent
  (actual 1667)                 ; What we have (local only)
  (timestamp 1767686400))
</pre>
<p>This creates an audit trail of information disclosure without leaking it further.</p>
</section>
<section>
<h2>11. Checklist</h2>
<p>Federation OPSEC review:</p>
<ul>
<li>[ ] Weave shared as stratum, not raw value</li>
<li>[ ] Response timing has jitter</li>
<li>[ ] Sync intervals randomized</li>
<li>[ ] Timestamps coarsened appropriately</li>
<li>[ ] Hostname not in protocol messages</li>
<li>[ ] Vault statistics not exposed</li>
<li>[ ] Releases verified before propagation</li>
<li>[ ] Transport encrypted (TLS minimum)</li>
<li>[ ] Personas separated if needed</li>
</ul>
</section>
<section>
<h2>12. References</h2>
<ul>
<li>Memo-010 - Federation Protocol</li>
<li>Memo-024 - Network Protocol</li>
<li>Memo-046 - Security Architecture</li>
<li>Dingledine, R., et al. (2004). Tor: The Second-Generation Onion Router</li>
<li>Danezis, G., Diaz, C. (2008). A Survey of Anonymous Communication Channels</li>
</ul>
</section>
<section>
<h2>Changelog</h2>
<p>- 2026-01-13 — Purge OOP: class → stratum, storage-class → storage-tier</p>
<p>- 2026-01-13 — Initial specification</p>
</section>
<script>
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
}
(function() {
  // Query param override (for REPL: ?theme=dark or ?theme=light)
  const params = new URLSearchParams(window.location.search);
  const param = params.get('theme');
  if (param === 'dark' || param === 'light') {
    document.documentElement.setAttribute('data-theme', param);
    localStorage.setItem('theme', param);
    return;
  }
  // localStorage preference
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
  } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', 'light');
  }
})();
</script>
</body>
</html>
