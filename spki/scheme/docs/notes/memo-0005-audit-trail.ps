%!PS-Adobe-3.0
%%Title: memo-0005-audit-trail
%%Creator: Library of Cyberspace Memo Pipeline
%%Pages: (atend)
%%EndComments

/Courier findfont 10 scalefont setfont
/margin 72 def
/pagewidth 612 def
/pageheight 792 def
/leading 12 def
/topmargin pageheight margin sub def
/bottommargin margin def
/linewidth pagewidth margin 2 mul sub def
/ypos topmargin def
/pagenum 1 def

/newline {
  /ypos ypos leading sub def
  ypos bottommargin lt {
    showpage
    /pagenum pagenum 1 add def
    /ypos topmargin def
  } if
  margin ypos moveto
} def

margin topmargin moveto
(Memo 0005: Audit Trail) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
() show newline
(------------------------------------------------------------------------) show newline
(ABSTRACT) show newline
(------------------------------------------------------------------------) show newline
() show newline
(This Memo specifies the cryptographic audit trail system for the Library) show newline
(of Cyberspace, providing tamper-evident, hash-chained logging with) show newline
(Simple Public Key Infrastructure \(SPKI\) principal attribution and) show newline
(Ed25519 signatures.) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(MOTIVATION) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(    "The first principle is that you must not fool yourself—and you are the easiest person to fool. — Richard Feynman") show newline
() show newline
(Distributed systems require accountability. Who did what, when, and) show newline
(under whose authority? Without cryptographic audit trails, the answer is) show newline
(always "we think so" rather than "we can prove it.") show newline
() show newline
(Every security breach postmortem asks the same questions: What happened?) show newline
(When? Who had access? Could the logs have been tampered with?) show newline
(Traditional logging cannot answer these questions with certainty.) show newline
(Cyberspace audit trails can.) show newline
() show newline
() show newline
(Heritage) show newline
(--------) show newline
() show newline
(Inspired by VMS cluster-wide audit \(1993\). See Memo-0009 section 7.7 for) show newline
(design heritage.) show newline
() show newline
() show newline
(The Problem) show newline
(-----------) show newline
() show newline
(Traditional logging fails on all counts:) show newline
() show newline
(  * Tamperable: Text files can be edited after the fact) show newline
(  * Anonymous: No cryptographic identity binds actor to action) show newline
(  * Disconnected: No provable ordering between entries) show newline
(  * Unverifiable: No mathematical proof of integrity) show newline
() show newline
(Cyberspace audit trails provide:) show newline
() show newline
(  * Content-addressed entries - Tamper-evident by hash) show newline
(  * Hash-chained structure - Append-only ordering) show newline
(  * SPKI attribution - Cryptographic actor identity) show newline
(  * Ed25519 seals - Mathematical proof of authenticity) show newline
(  * Dual context - Human-readable motivation + machine-parseable environment) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(SPECIFICATION) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Entry Structure) show newline
(---------------) show newline
() show newline
() show newline
(    \(audit-entry) show newline
(      \(id "sha512:b14471cd57ea557f..."\)) show newline
(      \(timestamp "2026-01-05 23:38:20Z"\)) show newline
(      \(sequence 1\)) show newline
(      \(parent-id "sha512:previous..."\)) show newline
(      \(actor) show newline
(        \(principal #${public-key-blob}\)) show newline
(        \(authorization-chain\)\)) show newline
(      \(action) show newline
(        \(verb seal-publish\)) show newline
(        \(object "1.0.0"\)) show newline
(        \(parameters "/path/to/remote"\)\)) show newline
(      \(context) show newline
(        \(motivation "Published to filesystem"\)) show newline
(        \(language "en"\)\)) show newline
(      \(environment) show newline
(        \(platform "darwin"\)) show newline
(        \(timestamp 1767685100\)\)) show newline
(      \(seal) show newline
(        \(algorithm "ed25519-sha512"\)) show newline
(        \(content-hash "..."\)) show newline
(        \(signature "..."\)\)\)) show newline
() show newline
() show newline
(Core Fields) show newline
(-----------) show newline
() show newline
() show newline
(  Field         Type         Description                                            ) show newline
(  id            string       Content-addressed hash \(SHA-512, first 32 hex chars\)   ) show newline
(  timestamp     string       ISO 8601 UTC \(YYYY-MM-DD HH:MM:SSZ\)                    ) show newline
(  sequence      integer      Monotonic counter within audit trail                   ) show newline
(  parent-id     string/nil   ID of previous entry \(hash chain\)                      ) show newline
(  actor         record       SPKI principal who performed action                    ) show newline
(  action        record       What was done \(verb, object, parameters\)               ) show newline
(  context       record       Human-readable motivation                              ) show newline
(  environment   alist        Machine environment snapshot                           ) show newline
(  seal          record       Cryptographic signature                                ) show newline
() show newline
() show newline
(Actor Record) show newline
(------------) show newline
() show newline
(Every action has an actor. Not a username—a cryptographic identity) show newline
(that can be verified mathematically.) show newline
() show newline
() show newline
(    \(define-record-type <audit-actor>) show newline
(      \(make-audit-actor principal authorization-chain\)) show newline
(      audit-actor?) show newline
(      \(principal actor-principal\)              ; Public key blob) show newline
(      \(authorization-chain actor-authorization-chain\)\)  ; SPKI cert chain) show newline
() show newline
(The actor is identified by:) show newline
() show newline
(  * Principal: Ed25519 public key \(32 bytes\) - unforgeable identity) show newline
(  * Authorization chain: Optional SPKI certificate chain proving delegation) show newline
() show newline
(The authorization chain answers "under whose authority?" - crucial for) show newline
(auditing delegated actions.) show newline
() show newline
() show newline
(Action Record) show newline
(-------------) show newline
() show newline
(Actions are structured as verb-object-parameters, mirroring natural) show newline
(language: "Alice committed version 1.0 to the vault.") show newline
() show newline
() show newline
(    \(define-record-type <audit-action>) show newline
(      \(make-audit-action verb object parameters\)) show newline
(      audit-action?) show newline
(      \(verb action-verb\)        ; Symbol: seal-commit, seal-publish, etc.) show newline
(      \(object action-object\)    ; Primary target) show newline
(      \(parameters action-parameters\)\)  ; Additional arguments) show newline
() show newline
(Standard verbs:) show newline
() show newline
() show newline
(  Verb               Meaning                                 ) show newline
(  seal-commit        Version control commit to local vault   ) show newline
(  seal-publish       Release publication to remote           ) show newline
(  seal-subscribe     Subscription to remote feed             ) show newline
(  seal-synchronize   Bidirectional sync with peer            ) show newline
(  seal-release       Version tagging for distribution        ) show newline
() show newline
() show newline
(Context Record) show newline
(--------------) show newline
() show newline
(Machines record what happened. Humans need to know why. The context) show newline
(record captures motivation in natural language—the commit message, the) show newline
(reason for the release, the justification for the access.) show newline
() show newline
() show newline
(    \(define-record-type <audit-context>) show newline
(      \(make-audit-context motivation relates-to language\)) show newline
(      audit-context?) show newline
(      \(motivation context-motivation\)    ; Human explanation) show newline
(      \(relates-to context-relates-to\)    ; Related entries) show newline
(      \(language context-language\)\)       ; ISO 639-1 code) show newline
() show newline
(Context provides:) show newline
() show newline
(  * Motivation: Why the action was taken, in the actor's own words) show newline
(  * Relates-to: Cross-references to related audit entries) show newline
(  * Language: ISO 639-1 code for internationalization) show newline
() show newline
(Six months later, "Fixed the bug" means nothing. "Fixed CVE-2026-1234) show newline
(buffer overflow in certificate parser" means everything.) show newline
() show newline
() show newline
(Seal Record) show newline
(-----------) show newline
() show newline
() show newline
(    \(define-record-type <audit-seal>) show newline
(      \(make-audit-seal algorithm content-hash signature\)) show newline
(      audit-seal?) show newline
(      \(algorithm seal-algorithm\)        ; "ed25519-sha512") show newline
(      \(content-hash seal-content-hash\)  ; SHA-512 of unsealed entry) show newline
(      \(signature seal-signature\)\)       ; Ed25519 signature) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(OPERATIONS) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(audit-init) show newline
(----------) show newline
() show newline
(Initialize audit trail for a vault.) show newline
() show newline
() show newline
(    \(audit-init signing-key: key audit-dir: ".vault/audit"\)) show newline
() show newline
() show newline
(audit-append) show newline
(------------) show newline
() show newline
(Create and sign a new audit entry.) show newline
() show newline
() show newline
(    \(audit-append) show newline
(      actor: public-key-blob) show newline
(      action: '\(seal-commit "hash123"\)) show newline
(      motivation: "Added new feature") show newline
(      signing-key: private-key-blob\)) show newline
() show newline
(Process:) show newline
() show newline
(  * Increment sequence counter) show newline
(  * Get parent entry ID \(hash chain link\)) show newline
(  * Build unsealed entry structure) show newline
(  * Compute SHA-512 hash of canonical S-expression) show newline
(  * Sign hash with Ed25519) show newline
(  * Create seal record) show newline
(  * Save entry to disk) show newline
() show newline
() show newline
(audit-verify) show newline
(------------) show newline
() show newline
(Verify cryptographic seal on an entry.) show newline
() show newline
() show newline
(    \(audit-verify entry public-key: key\)) show newline
() show newline
(Verification steps:) show newline
() show newline
(  * Reconstruct unsealed entry) show newline
(  * Compute SHA-512 hash) show newline
(  * Compare with stored content-hash) show newline
(  * Verify Ed25519 signature) show newline
() show newline
() show newline
(audit-chain) show newline
(-----------) show newline
() show newline
(Verify the entire audit chain from genesis to present. One broken link) show newline
(invalidates everything after it.) show newline
() show newline
() show newline
(    \(audit-chain verify-key: public-key\)) show newline
() show newline
(Verifies:) show newline
() show newline
(  * Each entry's signature is valid) show newline
(  * Parent-id references form unbroken chain) show newline
(  * Sequence numbers are strictly monotonic) show newline
() show newline
(A valid chain proves no entries were inserted, deleted, or modified) show newline
(after signing.) show newline
() show newline
() show newline
(audit-read) show newline
(----------) show newline
() show newline
(Read specific audit entry.) show newline
() show newline
() show newline
(    \(audit-read sequence: 42\)) show newline
(    \(audit-read id: "sha512:..."\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(STORAGE FORMAT) show newline
(------------------------------------------------------------------------) show newline
() show newline
(Simplicity over cleverness. Entries are individual S-expression files,) show newline
(one per action, named by sequence number.) show newline
() show newline
() show newline
(    .vault/audit/) show newline
(      1.sexp) show newline
(      2.sexp) show newline
(      3.sexp) show newline
(      ...) show newline
() show newline
(This format trades storage density for operational simplicity:) show newline
() show newline
(  * Sequential reads: cat the files in order) show newline
(  * Range queries: list files between N and M) show newline
(  * Latest entry: highest-numbered file) show newline
(  * Debugging: read any entry with a text editor) show newline
() show newline
(No database. No binary format. No special tools required to inspect the) show newline
(audit trail.) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(SECURITY CONSIDERATIONS) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Threat Model) show newline
(------------) show newline
() show newline
(We trust as little as possible.) show newline
() show newline
(Trusted:) show newline
() show newline
(  * Local filesystem during operation \(not after\)) show newline
(  * Ed25519 implementation \(libsodium, audited\)) show newline
(  * Private keys \(your responsibility\)) show newline
() show newline
(Untrusted:) show newline
() show newline
(  * Storage medium after entry creation) show newline
(  * Network transport between nodes) show newline
(  * Other actors, including administrators) show newline
() show newline
(This threat model assumes a hostile environment where storage can be) show newline
(tampered with and network traffic can be intercepted. The cryptography) show newline
(protects the audit trail even when everything else is compromised.) show newline
() show newline
() show newline
(Attack Mitigations) show newline
(------------------) show newline
() show newline
() show newline
(  Attack                Mitigation                           ) show newline
(  Entry modification    SHA-512 hash detects tampering       ) show newline
(  Entry deletion        Chain breaks are detectable          ) show newline
(  Entry insertion       Hash chain prevents backdating       ) show newline
(  Actor impersonation   Ed25519 signatures verify identity   ) show newline
(  Replay attacks        Sequence numbers detect duplicates   ) show newline
() show newline
() show newline
(Non-Repudiation) show newline
(---------------) show newline
() show newline
(Once an entry is signed and published, the actor cannot credibly deny) show newline
(it. This is non-repudiation: mathematical proof of authorship.) show newline
() show newline
(  * Actor cannot deny performing the action—their key signed it) show newline
(  * Timestamp cannot be backdated—hash chain enforces ordering) show newline
(  * Content cannot be altered—hash would change) show newline
(  * Signature mathematically proves authorship—no "someone else used my account") show newline
() show newline
(In court, in audits, in incident response: cryptographic proof beats) show newline
(testimony.) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(INTEGRATION POINTS) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Vault Operations) show newline
(----------------) show newline
() show newline
(All vault operations record audit entries:) show newline
() show newline
() show newline
(    \(seal-commit "message"\)     > \(action \(verb seal-commit\) ...\)) show newline
(    \(seal-publish "1.0.0" ...\)  > \(action \(verb seal-publish\) ...\)) show newline
(    \(seal-subscribe remote ...\) > \(action \(verb seal-subscribe\) ...\)) show newline
() show newline
() show newline
(SPKI Authorization) show newline
(------------------) show newline
() show newline
(Audit entries can include authorization chains:) show newline
() show newline
() show newline
(    \(actor) show newline
(      \(principal #${bob-public-key}\)) show newline
(      \(authorization-chain) show newline
(        \(signed-cert ...\)   ; Alice delegated to Bob) show newline
(        \(signed-cert ...\)\)\) ; Root delegated to Alice) show newline
() show newline
(This proves not just who acted, but under whose authority.) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(EXPORT FORMATS) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(S-expression Export) show newline
(-------------------) show newline
() show newline
() show newline
(    \(audit-export-sexp output: "audit-export.sexp"\)) show newline
() show newline
(Produces:) show newline
() show newline
() show newline
(    \(audit-trail) show newline
(      \(audit-entry ...\)) show newline
(      \(audit-entry ...\)) show newline
(      ...\)) show newline
() show newline
() show newline
(Human-readable Export) show newline
(---------------------) show newline
() show newline
() show newline
(    \(audit-export-human output: "audit-export.txt"\)) show newline
() show newline
(Produces:) show newline
() show newline
() show newline
(    AUDIT TRAIL - Library of Cyberspace) show newline
(    ===================================) show newline
(    Entry #1) show newline
(      ID: sha512:b14471cd57ea557f...) show newline
(      Time: 2026-01-05 23:38:20Z) show newline
(      Action: seal-publish) show newline
(      Why: Published release to filesystem) show newline
(    Entry #2) show newline
(      ...) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(IMPLEMENTATION NOTES) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Dependencies) show newline
(------------) show newline
() show newline
(  * crypto-ffi: Ed25519 signatures, SHA-512 hashing) show newline
(  * srfi-1: List utilities) show newline
(  * srfi-4: u8vectors for binary data) show newline
(  * srfi-13: String utilities) show newline
() show newline
() show newline
(Performance Considerations) show newline
(--------------------------) show newline
() show newline
(  * Content-addressed IDs enable O\(1\) lookup by hash) show newline
(  * Sequential file naming enables efficient range queries) show newline
(  * Lazy verification: verify on read, not on load) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(REFERENCES) show newline
(------------------------------------------------------------------------) show newline
() show newline
(  * Haber, S., & Stornetta, W. S. \(1991\). How to time-stamp a digital document.) show newline
(  * Merkle, R. C. \(1987\). A digital signature based on a conventional encryption function.) show newline
(  * Bernstein, D. J. \(2006\). Curve25519: new Diffie-Hellman speed records.) show newline
(  * SDSI/SPKI - RFC 2693, RFC 2692) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(CHANGELOG) show newline
(------------------------------------------------------------------------) show newline
() show newline
(2026-01-19 - Expanded narrative and rationale) show newline
() show newline
(2026-01-06 - Initial specification) show newline
() show newline
(------------------------------------------------------------------------) show newline

showpage
%%Trailer
%%Pages: pagenum
%%EOF
