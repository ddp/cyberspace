%!PS-Adobe-3.0
%%Title: memo-0003-audit-trail
%%Creator: Library of Cyberspace Memo Pipeline
%%Pages: (atend)
%%EndComments

/Courier findfont 10 scalefont setfont
/margin 72 def
/pagewidth 612 def
/pageheight 792 def
/leading 12 def
/topmargin pageheight margin sub def
/bottommargin margin def
/linewidth pagewidth margin 2 mul sub def
/ypos topmargin def
/pagenum 1 def

/newline {
  /ypos ypos leading sub def
  ypos bottommargin lt {
    showpage
    /pagenum pagenum 1 add def
    /ypos topmargin def
  } if
  margin ypos moveto
} def

margin topmargin moveto
(Memo 0003: Cryptographic Audit Trail) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
() show newline
(------------------------------------------------------------------------) show newline
(ABSTRACT) show newline
(------------------------------------------------------------------------) show newline
() show newline
(This Memo specifies the cryptographic audit trail system for the Library) show newline
(of Cyberspace, providing tamper-evident, hash-chained logging with SPKI) show newline
(principal attribution and Ed25519 signatures.) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(MOTIVATION) show newline
(------------------------------------------------------------------------) show newline
() show newline
(Distributed systems require accountability. Who did what, when, and) show newline
(under whose authority?) show newline
() show newline
() show newline
(Heritage: VMS Cluster-Wide Audit) show newline
(--------------------------------) show newline
() show newline
(This audit trail descends from VMS SECURITY.AUDIT$JOURNAL and the) show newline
(cluster-wide security infrastructure of VMS 6.0 \(1993\). That system) show newline
(introduced:) show newline
() show newline
(  * SECURITYPOLICY bit 7 propagation) show newline
(  * Intrusion detection state replicated cluster-wide) show newline
(  * Cluster-wide intrusion detection) show newline
(  * Breakin attempts detected across all nodes as one) show newline
(  * TLV-encoded object store) show newline
(  * The [000000]SECURITY.SYS file in ODS5 stored SECURITYCLASS records) show newline
() show newline
(The design principle then, as now: cluster nodes behave identically. N) show newline
(nodes, one security domain. Every significant action audited, every) show newline
(audit record signed.) show newline
() show newline
(Cyberspace audit trails apply the same principle at IPv6 scale.) show newline
() show newline
() show newline
(The Problem) show newline
(-----------) show newline
() show newline
(Traditional logging fails on all counts: - Tamperable: Text files can be) show newline
(edited - Anonymous: No cryptographic identity - Disconnected: No) show newline
(provable ordering - Unverifiable: No mathematical proof of integrity) show newline
() show newline
(Cyberspace audit trails provide: 1. Content-addressed entries -) show newline
(Tamper-evident by hash 2. Hash-chained structure - Append-only ordering) show newline
(3. SPKI attribution - Cryptographic actor identity 4. Ed25519 seals -) show newline
(Mathematical proof of authenticity 5. Dual context - Human-readable) show newline
(motivation + machine-parseable environment) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(SPECIFICATION) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Entry Structure) show newline
(---------------) show newline
() show newline
() show newline
(    \(audit-entry) show newline
(      \(id "sha512:b14471cd57ea557f..."\)) show newline
(      \(timestamp "2026-01-05 23:38:20Z"\)) show newline
(      \(sequence 1\)) show newline
(      \(parent-id "sha512:previous..."\)) show newline
(      \(actor) show newline
(        \(principal #${public-key-blob}\)) show newline
(        \(authorization-chain\)\)) show newline
(      \(action) show newline
(        \(verb seal-publish\)) show newline
(        \(object "1.0.0"\)) show newline
(        \(parameters "/path/to/remote"\)\)) show newline
(      \(context) show newline
(        \(motivation "Published to filesystem"\)) show newline
(        \(language "en"\)\)) show newline
(      \(environment) show newline
(        \(platform "darwin"\)) show newline
(        \(timestamp 1767685100\)\)) show newline
(      \(seal) show newline
(        \(algorithm "ed25519-sha512"\)) show newline
(        \(content-hash "..."\)) show newline
(        \(signature "..."\)\)\)) show newline
() show newline
() show newline
(Core Fields) show newline
(-----------) show newline
() show newline
() show newline
(  Field         Type         Description                                            ) show newline
(  id            string       Content-addressed hash \(SHA-512, first 32 hex chars\)   ) show newline
(  timestamp     string       ISO 8601 UTC \(YYYY-MM-DD HH:MM:SSZ\)                    ) show newline
(  sequence      integer      Monotonic counter within audit trail                   ) show newline
(  parent-id     string/nil   ID of previous entry \(hash chain\)                      ) show newline
(  actor         record       SPKI principal who performed action                    ) show newline
(  action        record       What was done \(verb, object, parameters\)               ) show newline
(  context       record       Human-readable motivation                              ) show newline
(  environment   alist        Machine environment snapshot                           ) show newline
(  seal          record       Cryptographic signature                                ) show newline
() show newline
() show newline
(Actor Record) show newline
(------------) show newline
() show newline
() show newline
(    \(define-record-type <audit-actor>) show newline
(      \(make-audit-actor principal authorization-chain\)) show newline
(      audit-actor?) show newline
(      \(principal actor-principal\)              ; Public key blob) show newline
(      \(authorization-chain actor-authorization-chain\)\)  ; SPKI cert chain) show newline
() show newline
(The actor is identified by: - Principal: Ed25519 public key \(32 bytes\) -) show newline
(Authorization chain: Optional SPKI certificate chain proving delegation) show newline
() show newline
() show newline
(Action Record) show newline
(-------------) show newline
() show newline
() show newline
(    \(define-record-type <audit-action>) show newline
(      \(make-audit-action verb object parameters\)) show newline
(      audit-action?) show newline
(      \(verb action-verb\)        ; Symbol: seal-commit, seal-publish, etc.) show newline
(      \(object action-object\)    ; Primary target) show newline
(      \(parameters action-parameters\)\)  ; Additional arguments) show newline
() show newline
(Standard verbs: - seal-commit - Version control commit - seal-publish -) show newline
(Release publication - seal-subscribe - Subscription to remote -) show newline
(seal-synchronize - Bidirectional sync - seal-release - Version tagging) show newline
() show newline
() show newline
(Context Record) show newline
(--------------) show newline
() show newline
() show newline
(    \(define-record-type <audit-context>) show newline
(      \(make-audit-context motivation relates-to language\)) show newline
(      audit-context?) show newline
(      \(motivation context-motivation\)    ; Human explanation) show newline
(      \(relates-to context-relates-to\)    ; Related entries) show newline
(      \(language context-language\)\)       ; ISO 639-1 code) show newline
() show newline
(Context provides: - Motivation: Why the action was taken) show newline
(\(human-readable\) - Relates-to: Cross-references to related audit entries) show newline
(- Language: For internationalization) show newline
() show newline
() show newline
(Seal Record) show newline
(-----------) show newline
() show newline
() show newline
(    \(define-record-type <audit-seal>) show newline
(      \(make-audit-seal algorithm content-hash signature\)) show newline
(      audit-seal?) show newline
(      \(algorithm seal-algorithm\)        ; "ed25519-sha512") show newline
(      \(content-hash seal-content-hash\)  ; SHA-512 of unsealed entry) show newline
(      \(signature seal-signature\)\)       ; Ed25519 signature) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(OPERATIONS) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(audit-init) show newline
(----------) show newline
() show newline
(Initialize audit trail for a vault.) show newline
() show newline
() show newline
(    \(audit-init signing-key: key audit-dir: ".vault/audit"\)) show newline
() show newline
() show newline
(audit-append) show newline
(------------) show newline
() show newline
(Create and sign a new audit entry.) show newline
() show newline
() show newline
(    \(audit-append) show newline
(      actor: public-key-blob) show newline
(      action: '\(seal-commit "hash123"\)) show newline
(      motivation: "Added new feature") show newline
(      signing-key: private-key-blob\)) show newline
() show newline
(Process: 1. Increment sequence counter 2. Get parent entry ID \(hash) show newline
(chain link\) 3. Build unsealed entry structure 4. Compute SHA-512 hash of) show newline
(canonical S-expression 5. Sign hash with Ed25519 6. Create seal record) show newline
(7. Save entry to disk) show newline
() show newline
() show newline
(audit-verify) show newline
(------------) show newline
() show newline
(Verify cryptographic seal on an entry.) show newline
() show newline
() show newline
(    \(audit-verify entry public-key: key\)) show newline
() show newline
(Verification steps: 1. Reconstruct unsealed entry 2. Compute SHA-512) show newline
(hash 3. Compare with stored content-hash 4. Verify Ed25519 signature) show newline
() show newline
() show newline
(audit-chain) show newline
(-----------) show newline
() show newline
(Verify entire audit chain.) show newline
() show newline
() show newline
(    \(audit-chain verify-key: public-key\)) show newline
() show newline
(Verifies: - Each entry's signature is valid - Parent-id references form) show newline
(valid chain - Sequence numbers are monotonic) show newline
() show newline
() show newline
(audit-read) show newline
(----------) show newline
() show newline
(Read specific audit entry.) show newline
() show newline
() show newline
(    \(audit-read sequence: 42\)) show newline
(    \(audit-read id: "sha512:..."\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(STORAGE FORMAT) show newline
(------------------------------------------------------------------------) show newline
() show newline
(Entries stored as individual S-expression files:) show newline
() show newline
() show newline
(    .vault/audit/) show newline
(      1.sexp) show newline
(      2.sexp) show newline
(      3.sexp) show newline
(      ...) show newline
() show newline
(File naming by sequence number enables efficient: - Sequential reads -) show newline
(Range queries - Latest entry lookup) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(SECURITY CONSIDERATIONS) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Threat Model) show newline
(------------) show newline
() show newline
(Trusted: - Local filesystem \(during operation\) - Ed25519 implementation) show newline
(\(libsodium\) - Private keys) show newline
() show newline
(Untrusted: - Storage medium \(after creation\) - Network transport - Other) show newline
(actors) show newline
() show newline
() show newline
(Attack Mitigations) show newline
(------------------) show newline
() show newline
() show newline
(  Attack                Mitigation                           ) show newline
(  Entry modification    SHA-512 hash detects tampering       ) show newline
(  Entry deletion        Chain breaks are detectable          ) show newline
(  Entry insertion       Hash chain prevents backdating       ) show newline
(  Actor impersonation   Ed25519 signatures verify identity   ) show newline
(  Replay attacks        Sequence numbers detect duplicates   ) show newline
() show newline
() show newline
(Non-Repudiation) show newline
(---------------) show newline
() show newline
(Once an entry is signed and published: - Actor cannot deny performing) show newline
(the action - Timestamp cannot be backdated - Content cannot be altered -) show newline
(Signature mathematically proves authorship) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(INTEGRATION POINTS) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Vault Operations) show newline
(----------------) show newline
() show newline
(All vault operations record audit entries:) show newline
() show newline
() show newline
(    \(seal-commit "message"\)     > \(action \(verb seal-commit\) ...\)) show newline
(    \(seal-publish "1.0.0" ...\)  > \(action \(verb seal-publish\) ...\)) show newline
(    \(seal-subscribe remote ...\) > \(action \(verb seal-subscribe\) ...\)) show newline
() show newline
() show newline
(SPKI Authorization) show newline
(------------------) show newline
() show newline
(Audit entries can include authorization chains:) show newline
() show newline
() show newline
(    \(actor) show newline
(      \(principal #${bob-public-key}\)) show newline
(      \(authorization-chain) show newline
(        \(signed-cert ...\)   ; Alice delegated to Bob) show newline
(        \(signed-cert ...\)\)\) ; Root delegated to Alice) show newline
() show newline
(This proves not just who acted, but under whose authority.) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(EXPORT FORMATS) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(S-expression Export) show newline
(-------------------) show newline
() show newline
() show newline
(    \(audit-export-sexp output: "audit-export.sexp"\)) show newline
() show newline
(Produces:) show newline
() show newline
() show newline
(    \(audit-trail) show newline
(      \(audit-entry ...\)) show newline
(      \(audit-entry ...\)) show newline
(      ...\)) show newline
() show newline
() show newline
(Human-readable Export) show newline
(---------------------) show newline
() show newline
() show newline
(    \(audit-export-human output: "audit-export.txt"\)) show newline
() show newline
(Produces:) show newline
() show newline
() show newline
(    AUDIT TRAIL - Library of Cyberspace) show newline
(    ===================================) show newline
(    Entry #1) show newline
(      ID: sha512:b14471cd57ea557f...) show newline
(      Time: 2026-01-05 23:38:20Z) show newline
(      Action: seal-publish) show newline
(      Why: Published release to filesystem) show newline
(    Entry #2) show newline
(      ...) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(IMPLEMENTATION NOTES) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Dependencies) show newline
(------------) show newline
() show newline
(  * crypto-ffi) show newline
(  * Ed25519 signatures, SHA-512 hashing - srfi-1) show newline
(  * List utilities - srfi-4 - u8vectors for binary data - srfi-13) show newline
(  * String utilities) show newline
() show newline
() show newline
(Performance Considerations) show newline
(--------------------------) show newline
() show newline
(  * Content-addressed IDs enable O\(1\) lookup by hash) show newline
(  * Sequential file naming enables efficient range queries) show newline
(  * Lazy verification: verify on read, not on load) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(REFERENCES) show newline
(------------------------------------------------------------------------) show newline
() show newline
(1. Haber, S., & Stornetta, W. S. \(1991\). How to time-stamp a digital) show newline
(document. 2. Merkle, R. C. \(1987\). A digital signature based on a) show newline
(conventional encryption function. 3. Bernstein, D. J. \(2006\).) show newline
(Curve25519: new Diffie-Hellman speed records. 4. SPKI/SDSI - RFC 2693,) show newline
(RFC 2692) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(CHANGELOG) show newline
(------------------------------------------------------------------------) show newline
() show newline
(  * 2026-01-06) show newline
(  * Initial specification) show newline
() show newline
(------------------------------------------------------------------------) show newline

showpage
%%Trailer
%%Pages: pagenum
%%EOF
