<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <title>Memo 0038: Quorum Protocol with Homomorphic Voting</title>
  <link rel="icon" id="favicon" href="data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27%230f0%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>">
  <script>
(function(){
  var h=new Date().getHours(),c;
  if(h>=4&&h<6)c='%23845EC2';       // brahma muhurta - violet
  else if(h>=6&&h<8)c='%23ffd700';  // dawn - gold
  else if(h>=8&&h<11)c='%2300d4aa'; // morning - teal
  else if(h>=11&&h<14)c='%230f0';   // midday - phosphor
  else if(h>=14&&h<17)c='%2339ff14';// afternoon - neon
  else if(h>=17&&h<19)c='%23ff6600';// sunset - orange
  else if(h>=19&&h<22)c='%23ff3366';// evening - coral
  else c='%2300ffff';               // night - cyan
  document.getElementById('favicon').href='data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27'+c+'%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>';
})();
</script>
  <link rel="stylesheet" href="memo.css">
</head>
<body>
<span class="theme-toggle" onclick="toggleTheme()" title="Toggle light/dark">[theme]</span>
<h1>Memo 0038: Quorum Protocol with Homomorphic Voting</h1>
<dl class="metadata">
</dl>
<hr>
<section>
<h2>Abstract</h2>
<p>This Memo specifies the quorum protocol for the Library of Cyberspace: how principals reach collective decisions through homomorphic encryption-based voting, enabling private ballot tallying without revealing individual votes. Quorum integrates with threshold governance (Memo-008) and Byzantine consensus (Memo-011).</p>
</section>
<section>
<h2>Motivation</h2>
<p>Collective decisions require:</p>
<ul>
<li>Privacy</li>
<li>Voters shouldn't know how others voted</li>
<li>Verifiability</li>
<li>Results must be provably correct</li>
<li>Coercion resistance</li>
<li>Can't prove how you voted to others</li>
<li>Availability</li>
<li>Voting continues despite failures</li>
</ul>
<p>Traditional approaches fail:</p>
<ul>
<li>Open ballot</li>
<li>No privacy, enables coercion</li>
<li>Trusted tallier</li>
<li>Single point of compromise</li>
<li>Secure multi-party computation</li>
<li>Complex, high communication overhead</li>
</ul>
<p>Homomorphic encryption provides:</p>
<ul>
<li>Vote on encrypted ballots</li>
<li>Sum without decryption</li>
<li>Decrypt only the final tally</li>
<li>Mathematical proof of correctness</li>
</ul>
</section>
<section>
<h2>Cryptographic Foundation</h2>
<h3>Homomorphic Encryption Schemes</h3>
<table>
<tr><th>Scheme </th><th>Operations </th><th>Performance </th><th>Use Case </th></tr>
<tr><td>Paillier </td><td>Addition </td><td>Fast </td><td>Vote tallying </td></tr>
<tr><td>BFV/BGV </td><td>Add + Multiply </td><td>Medium </td><td>Complex predicates </td></tr>
<tr><td>TFHE </td><td>Arbitrary </td><td>Slow </td><td>General computation </td></tr>
</table>
<p>For quorum voting, Paillier suffices - we only need addition.</p>
<h3>Paillier Properties</h3>
<pre class="language-scheme">
;; Additive homomorphism
(= (decrypt (he-add (encrypt a) (encrypt b)))
   (+ a b))

;; Scalar multiplication via repeated addition
(= (decrypt (he-scalar-mult (encrypt a) k))
   (* a k))

;; Semantic security - ciphertexts indistinguishable
(not (distinguishable? (encrypt 0) (encrypt 1)))
</pre>
<h3>Key Generation</h3>
<pre class="language-scheme">
(define-record-type &lt;quorum-keys&gt;
  (make-quorum-keys public private threshold shares)
  quorum-keys?
  (public qk-public)           ; Public encryption key
  (private qk-private)         ; Private decryption key (or #f if distributed)
  (threshold qk-threshold)     ; M-of-N threshold
  (shares qk-shares))          ; Distributed key shares

(define (generate-quorum-keys bit-length threshold trustees)
  "Generate threshold Paillier keys"
  (let* ((keys (paillier-keygen bit-length))
         (shares (shamir-split (paillier-private keys)
                               threshold
                               (length trustees))))
    (make-quorum-keys
      (paillier-public keys)
      #f  ; No single party holds private key
      threshold
      (map cons trustees shares))))
</pre>
</section>
<section>
<h2>Ballot Structure</h2>
<h3>Ballot Definition</h3>
<pre class="language-scheme">
(define-record-type &lt;ballot&gt;
  (make-ballot id question options threshold deadline)
  ballot?
  (id ballot-id)                 ; Content hash
  (question ballot-question)     ; Human-readable question
  (options ballot-options)       ; List of choices
  (threshold ballot-threshold)   ; Votes needed to pass
  (deadline ballot-deadline))    ; Voting closes

;; Example ballot
(make-ballot
  id: "sha256:ballot..."
  question: "Accept Memo-042 into standard?"
  options: '(accept reject abstain)
  threshold: '(majority members)  ; &gt;50% of members
  deadline: 1767786000)
</pre>
<h3>Encrypted Vote</h3>
<pre class="language-scheme">
(define-record-type &lt;encrypted-vote&gt;
  (make-encrypted-vote ballot-id voter ciphertext proof timestamp signature)
  encrypted-vote?
  (ballot-id vote-ballot-id)     ; Which ballot
  (voter vote-voter)             ; Voter's public key (or anonymous token)
  (ciphertext vote-ciphertext)   ; HE-encrypted choice
  (proof vote-proof)             ; Zero-knowledge proof of validity
  (timestamp vote-timestamp)
  (signature vote-signature))
</pre>
<h3>Vote Encoding</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 550 300" width="550" height="300" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<text x="5" y="10">;</text>
<text x="15" y="10">;</text>
<text x="35" y="10">O</text>
<text x="45" y="10">n</text>
<text x="55" y="10">e</text>
<text x="65" y="10">-</text>
<text x="75" y="10">h</text>
<text x="85" y="10">o</text>
<text x="95" y="10">t</text>
<text x="115" y="10">e</text>
<text x="125" y="10">n</text>
<text x="135" y="10">c</text>
<text x="145" y="10">o</text>
<text x="155" y="10">d</text>
<text x="165" y="10">i</text>
<text x="175" y="10">n</text>
<text x="185" y="10">g</text>
<text x="205" y="10">f</text>
<text x="215" y="10">o</text>
<text x="225" y="10">r</text>
<text x="245" y="10">m</text>
<text x="255" y="10">u</text>
<text x="265" y="10">l</text>
<text x="275" y="10">t</text>
<text x="285" y="10">i</text>
<text x="295" y="10">p</text>
<text x="305" y="10">l</text>
<text x="315" y="10">e</text>
<text x="335" y="10">c</text>
<text x="345" y="10">h</text>
<text x="355" y="10">o</text>
<text x="365" y="10">i</text>
<text x="375" y="10">c</text>
<text x="385" y="10">e</text>
<text x="395" y="10">s</text>
<text x="5" y="30">;</text>
<text x="15" y="30">;</text>
<text x="35" y="30">a</text>
<text x="45" y="30">c</text>
<text x="55" y="30">c</text>
<text x="65" y="30">e</text>
<text x="75" y="30">p</text>
<text x="85" y="30">t</text>
<text x="95" y="30">=</text>
<text x="105" y="30">1</text>
<text x="115" y="30">,</text>
<text x="135" y="30">r</text>
<text x="145" y="30">e</text>
<text x="155" y="30">j</text>
<text x="165" y="30">e</text>
<text x="175" y="30">c</text>
<text x="185" y="30">t</text>
<text x="195" y="30">=</text>
<text x="205" y="30">0</text>
<text x="215" y="30">,</text>
<text x="235" y="30">a</text>
<text x="245" y="30">b</text>
<text x="255" y="30">s</text>
<text x="265" y="30">t</text>
<text x="275" y="30">a</text>
<text x="285" y="30">i</text>
<text x="295" y="30">n</text>
<text x="305" y="30">=</text>
<text x="315" y="30">0</text>
<text x="335" y="30">→</text>
<text x="355" y="30">(</text>
<text x="365" y="30">1</text>
<text x="375" y="30">,</text>
<text x="395" y="30">0</text>
<text x="405" y="30">,</text>
<text x="425" y="30">0</text>
<text x="435" y="30">)</text>
<text x="5" y="50">(</text>
<text x="15" y="50">d</text>
<text x="25" y="50">e</text>
<text x="35" y="50">f</text>
<text x="45" y="50">i</text>
<text x="55" y="50">n</text>
<text x="65" y="50">e</text>
<text x="85" y="50">(</text>
<text x="95" y="50">e</text>
<text x="105" y="50">n</text>
<text x="115" y="50">c</text>
<text x="125" y="50">o</text>
<text x="135" y="50">d</text>
<text x="145" y="50">e</text>
<text x="155" y="50">-</text>
<text x="165" y="50">v</text>
<text x="175" y="50">o</text>
<text x="185" y="50">t</text>
<text x="195" y="50">e</text>
<text x="215" y="50">c</text>
<text x="225" y="50">h</text>
<text x="235" y="50">o</text>
<text x="245" y="50">i</text>
<text x="255" y="50">c</text>
<text x="265" y="50">e</text>
<text x="285" y="50">o</text>
<text x="295" y="50">p</text>
<text x="305" y="50">t</text>
<text x="315" y="50">i</text>
<text x="325" y="50">o</text>
<text x="335" y="50">n</text>
<text x="345" y="50">s</text>
<text x="355" y="50">)</text>
<text x="25" y="70">"</text>
<text x="35" y="70">E</text>
<text x="45" y="70">n</text>
<text x="55" y="70">c</text>
<text x="65" y="70">o</text>
<text x="75" y="70">d</text>
<text x="85" y="70">e</text>
<text x="105" y="70">c</text>
<text x="115" y="70">h</text>
<text x="125" y="70">o</text>
<text x="135" y="70">i</text>
<text x="145" y="70">c</text>
<text x="155" y="70">e</text>
<text x="175" y="70">a</text>
<text x="185" y="70">s</text>
<text x="205" y="70">o</text>
<text x="215" y="70">n</text>
<text x="225" y="70">e</text>
<text x="235" y="70">-</text>
<text x="245" y="70">h</text>
<text x="255" y="70">o</text>
<text x="265" y="70">t</text>
<text x="285" y="70">v</text>
<text x="295" y="70">e</text>
<text x="305" y="70">c</text>
<text x="315" y="70">t</text>
<text x="325" y="70">o</text>
<text x="335" y="70">r</text>
<text x="345" y="70">"</text>
<text x="25" y="90">(</text>
<text x="35" y="90">m</text>
<text x="45" y="90">a</text>
<text x="55" y="90">p</text>
<text x="75" y="90">(</text>
<text x="85" y="90">l</text>
<text x="95" y="90">a</text>
<text x="105" y="90">m</text>
<text x="115" y="90">b</text>
<text x="125" y="90">d</text>
<text x="135" y="90">a</text>
<text x="155" y="90">(</text>
<text x="165" y="90">o</text>
<text x="175" y="90">p</text>
<text x="185" y="90">t</text>
<text x="195" y="90">)</text>
<text x="95" y="110">(</text>
<text x="105" y="110">i</text>
<text x="115" y="110">f</text>
<text x="135" y="110">(</text>
<text x="145" y="110">e</text>
<text x="155" y="110">q</text>
<text x="165" y="110">?</text>
<text x="185" y="110">o</text>
<text x="195" y="110">p</text>
<text x="205" y="110">t</text>
<text x="225" y="110">c</text>
<text x="235" y="110">h</text>
<text x="245" y="110">o</text>
<text x="255" y="110">i</text>
<text x="265" y="110">c</text>
<text x="275" y="110">e</text>
<text x="285" y="110">)</text>
<text x="305" y="110">1</text>
<text x="325" y="110">0</text>
<text x="335" y="110">)</text>
<text x="345" y="110">)</text>
<text x="75" y="130">o</text>
<text x="85" y="130">p</text>
<text x="95" y="130">t</text>
<text x="105" y="130">i</text>
<text x="115" y="130">o</text>
<text x="125" y="130">n</text>
<text x="135" y="130">s</text>
<text x="145" y="130">)</text>
<text x="155" y="130">)</text>
<text x="5" y="150">(</text>
<text x="15" y="150">d</text>
<text x="25" y="150">e</text>
<text x="35" y="150">f</text>
<text x="45" y="150">i</text>
<text x="55" y="150">n</text>
<text x="65" y="150">e</text>
<text x="85" y="150">(</text>
<text x="95" y="150">e</text>
<text x="105" y="150">n</text>
<text x="115" y="150">c</text>
<text x="125" y="150">r</text>
<text x="135" y="150">y</text>
<text x="145" y="150">p</text>
<text x="155" y="150">t</text>
<text x="165" y="150">-</text>
<text x="175" y="150">v</text>
<text x="185" y="150">o</text>
<text x="195" y="150">t</text>
<text x="205" y="150">e</text>
<text x="225" y="150">c</text>
<text x="235" y="150">h</text>
<text x="245" y="150">o</text>
<text x="255" y="150">i</text>
<text x="265" y="150">c</text>
<text x="275" y="150">e</text>
<text x="295" y="150">o</text>
<text x="305" y="150">p</text>
<text x="315" y="150">t</text>
<text x="325" y="150">i</text>
<text x="335" y="150">o</text>
<text x="345" y="150">n</text>
<text x="355" y="150">s</text>
<text x="375" y="150">p</text>
<text x="385" y="150">u</text>
<text x="395" y="150">b</text>
<text x="405" y="150">l</text>
<text x="415" y="150">i</text>
<text x="425" y="150">c</text>
<text x="435" y="150">-</text>
<text x="445" y="150">k</text>
<text x="455" y="150">e</text>
<text x="465" y="150">y</text>
<text x="475" y="150">)</text>
<text x="25" y="170">"</text>
<text x="35" y="170">E</text>
<text x="45" y="170">n</text>
<text x="55" y="170">c</text>
<text x="65" y="170">r</text>
<text x="75" y="170">y</text>
<text x="85" y="170">p</text>
<text x="95" y="170">t</text>
<text x="115" y="170">o</text>
<text x="125" y="170">n</text>
<text x="135" y="170">e</text>
<text x="145" y="170">-</text>
<text x="155" y="170">h</text>
<text x="165" y="170">o</text>
<text x="175" y="170">t</text>
<text x="195" y="170">e</text>
<text x="205" y="170">n</text>
<text x="215" y="170">c</text>
<text x="225" y="170">o</text>
<text x="235" y="170">d</text>
<text x="245" y="170">e</text>
<text x="255" y="170">d</text>
<text x="275" y="170">v</text>
<text x="285" y="170">o</text>
<text x="295" y="170">t</text>
<text x="305" y="170">e</text>
<text x="315" y="170">"</text>
<text x="25" y="190">(</text>
<text x="35" y="190">m</text>
<text x="45" y="190">a</text>
<text x="55" y="190">p</text>
<text x="75" y="190">(</text>
<text x="85" y="190">l</text>
<text x="95" y="190">a</text>
<text x="105" y="190">m</text>
<text x="115" y="190">b</text>
<text x="125" y="190">d</text>
<text x="135" y="190">a</text>
<text x="155" y="190">(</text>
<text x="165" y="190">v</text>
<text x="175" y="190">)</text>
<text x="95" y="210">(</text>
<text x="105" y="210">p</text>
<text x="115" y="210">a</text>
<text x="125" y="210">i</text>
<text x="135" y="210">l</text>
<text x="145" y="210">l</text>
<text x="155" y="210">i</text>
<text x="165" y="210">e</text>
<text x="175" y="210">r</text>
<text x="185" y="210">-</text>
<text x="195" y="210">e</text>
<text x="205" y="210">n</text>
<text x="215" y="210">c</text>
<text x="225" y="210">r</text>
<text x="235" y="210">y</text>
<text x="245" y="210">p</text>
<text x="255" y="210">t</text>
<text x="275" y="210">p</text>
<text x="285" y="210">u</text>
<text x="295" y="210">b</text>
<text x="305" y="210">l</text>
<text x="315" y="210">i</text>
<text x="325" y="210">c</text>
<text x="335" y="210">-</text>
<text x="345" y="210">k</text>
<text x="355" y="210">e</text>
<text x="365" y="210">y</text>
<text x="385" y="210">v</text>
<text x="395" y="210">)</text>
<text x="405" y="210">)</text>
<text x="75" y="230">(</text>
<text x="85" y="230">e</text>
<text x="95" y="230">n</text>
<text x="105" y="230">c</text>
<text x="115" y="230">o</text>
<text x="125" y="230">d</text>
<text x="135" y="230">e</text>
<text x="145" y="230">-</text>
<text x="155" y="230">v</text>
<text x="165" y="230">o</text>
<text x="175" y="230">t</text>
<text x="185" y="230">e</text>
<text x="205" y="230">c</text>
<text x="215" y="230">h</text>
<text x="225" y="230">o</text>
<text x="235" y="230">i</text>
<text x="245" y="230">c</text>
<text x="255" y="230">e</text>
<text x="275" y="230">o</text>
<text x="285" y="230">p</text>
<text x="295" y="230">t</text>
<text x="305" y="230">i</text>
<text x="315" y="230">o</text>
<text x="325" y="230">n</text>
<text x="335" y="230">s</text>
<text x="345" y="230">)</text>
<text x="355" y="230">)</text>
<text x="365" y="230">)</text>
<text x="5" y="250">;</text>
<text x="15" y="250">;</text>
<text x="35" y="250">V</text>
<text x="45" y="250">o</text>
<text x="55" y="250">t</text>
<text x="65" y="250">e</text>
<text x="85" y="250">f</text>
<text x="95" y="250">o</text>
<text x="105" y="250">r</text>
<text x="125" y="250">"</text>
<text x="135" y="250">a</text>
<text x="145" y="250">c</text>
<text x="155" y="250">c</text>
<text x="165" y="250">e</text>
<text x="175" y="250">p</text>
<text x="185" y="250">t</text>
<text x="195" y="250">"</text>
<text x="5" y="270">(</text>
<text x="15" y="270">e</text>
<text x="25" y="270">n</text>
<text x="35" y="270">c</text>
<text x="45" y="270">r</text>
<text x="55" y="270">y</text>
<text x="65" y="270">p</text>
<text x="75" y="270">t</text>
<text x="85" y="270">-</text>
<text x="95" y="270">v</text>
<text x="105" y="270">o</text>
<text x="115" y="270">t</text>
<text x="125" y="270">e</text>
<text x="145" y="270">'</text>
<text x="155" y="270">a</text>
<text x="165" y="270">c</text>
<text x="175" y="270">c</text>
<text x="185" y="270">e</text>
<text x="195" y="270">p</text>
<text x="205" y="270">t</text>
<text x="225" y="270">'</text>
<text x="235" y="270">(</text>
<text x="245" y="270">a</text>
<text x="255" y="270">c</text>
<text x="265" y="270">c</text>
<text x="275" y="270">e</text>
<text x="285" y="270">p</text>
<text x="295" y="270">t</text>
<text x="315" y="270">r</text>
<text x="325" y="270">e</text>
<text x="335" y="270">j</text>
<text x="345" y="270">e</text>
<text x="355" y="270">c</text>
<text x="365" y="270">t</text>
<text x="385" y="270">a</text>
<text x="395" y="270">b</text>
<text x="405" y="270">s</text>
<text x="415" y="270">t</text>
<text x="425" y="270">a</text>
<text x="435" y="270">i</text>
<text x="445" y="270">n</text>
<text x="455" y="270">)</text>
<text x="475" y="270">p</text>
<text x="485" y="270">u</text>
<text x="495" y="270">b</text>
<text x="505" y="270">-</text>
<text x="515" y="270">k</text>
<text x="525" y="270">e</text>
<text x="535" y="270">y</text>
<text x="545" y="270">)</text>
<text x="5" y="290">;</text>
<text x="15" y="290">;</text>
<text x="35" y="290">=</text>
<text x="45" y="290">&gt;</text>
<text x="65" y="290">(</text>
<text x="75" y="290">E</text>
<text x="85" y="290">n</text>
<text x="95" y="290">c</text>
<text x="105" y="290">(</text>
<text x="115" y="290">1</text>
<text x="125" y="290">)</text>
<text x="135" y="290">,</text>
<text x="155" y="290">E</text>
<text x="165" y="290">n</text>
<text x="175" y="290">c</text>
<text x="185" y="290">(</text>
<text x="195" y="290">0</text>
<text x="205" y="290">)</text>
<text x="215" y="290">,</text>
<text x="235" y="290">E</text>
<text x="245" y="290">n</text>
<text x="255" y="290">c</text>
<text x="265" y="290">(</text>
<text x="275" y="290">0</text>
<text x="285" y="290">)</text>
<text x="295" y="290">)</text>
</svg>
</div>
</section>
<section>
<h2>Voting Protocol</h2>
<h3>Phase 1: Ballot Creation</h3>
<pre class="language-scheme">
(define (create-ballot question options threshold deadline trustees)
  "Create new ballot with threshold decryption"
  (let* ((keys (generate-quorum-keys 2048
                                     (ceiling (/ (length trustees) 2))
                                     trustees))
         (ballot (make-ballot
                   question: question
                   options: options
                   threshold: threshold
                   deadline: deadline)))
    ;; Distribute key shares to trustees
    (for-each (lambda (trustee share)
                (secure-send trustee
                  `(key-share
                    (ballot-id ,(ballot-id ballot))
                    (share ,share))))
              trustees
              (qk-shares keys))
    ;; Publish ballot
    (soup-put ballot type: 'ballot)
    (audit-append action: 'ballot-created
                  ballot: (ballot-id ballot))
    ballot))
</pre>
<h3>Phase 2: Vote Casting</h3>
<pre class="language-scheme">
(define (cast-vote ballot choice voter-key)
  "Cast encrypted vote with validity proof"
  (let* ((pub-key (ballot-public-key ballot))
         (encrypted (encrypt-vote choice (ballot-options ballot) pub-key))
         (proof (generate-validity-proof encrypted choice pub-key))
         (vote (make-encrypted-vote
                 ballot-id: (ballot-id ballot)
                 voter: (key-&gt;principal voter-key)
                 ciphertext: encrypted
                 proof: proof
                 timestamp: (current-time))))
    ;; Sign the vote
    (set-encrypted-vote-signature! vote
      (sign-vote voter-key vote))
    ;; Submit
    (submit-vote vote)
    vote))

(define (submit-vote vote)
  "Submit vote to ballot coordinator"
  ;; Verify eligibility
  (unless (eligible-voter? (vote-voter vote) (vote-ballot-id vote))
    (error 'not-eligible))
  ;; Verify validity proof
  (unless (verify-validity-proof vote)
    (error 'invalid-vote-proof))
  ;; Verify not already voted
  (when (already-voted? (vote-voter vote) (vote-ballot-id vote))
    (error 'already-voted))
  ;; Record vote
  (soup-put vote type: 'encrypted-vote)
  (audit-append action: 'vote-cast
                ballot: (vote-ballot-id vote)
                voter: (vote-voter vote)))
</pre>
<h3>Phase 3: Homomorphic Tallying</h3>
<pre class="language-scheme">
(define (tally-votes ballot)
  "Homomorphically sum all votes"
  (let* ((votes (soup-query type: 'encrypted-vote
                            ballot-id: (ballot-id ballot)))
         (num-options (length (ballot-options ballot)))
         (zero-tally (make-list num-options (paillier-encrypt-zero))))
    ;; Sum encrypted votes
    (fold (lambda (vote tally)
            (map paillier-add
                 (vote-ciphertext vote)
                 tally))
          zero-tally
          votes)))

;; After tallying 100 votes:
;; (Enc(47), Enc(41), Enc(12))
;; Still encrypted - no one knows the result yet
</pre>
<h3>Phase 4: Threshold Decryption</h3>
<pre class="language-scheme">
(define (decrypt-tally ballot encrypted-tally)
  "Threshold decrypt the tally"
  (let* ((trustees (ballot-trustees ballot))
         (threshold (ballot-key-threshold ballot))
         (shares '()))
    ;; Collect decryption shares
    (for-each (lambda (trustee)
                (let ((share (request-decryption-share trustee
                               (ballot-id ballot)
                               encrypted-tally)))
                  (when share
                    (set! shares (cons share shares)))))
              trustees)
    ;; Need threshold shares
    (unless (&gt;= (length shares) threshold)
      (error 'insufficient-decryption-shares))
    ;; Combine shares to decrypt
    (let ((plaintext-tally
           (map (lambda (ct)
                  (threshold-decrypt ct shares))
                encrypted-tally)))
      ;; Publish result
      (publish-result ballot plaintext-tally)
      plaintext-tally)))

(define (request-decryption-share trustee ballot-id encrypted-tally)
  "Request trustee's decryption share"
  (let ((response (tunnel trustee
                    `(decryption-share-request
                      (ballot-id ,ballot-id)
                      (tally ,encrypted-tally)))))
    (and (valid-share? response)
         response)))
</pre>
<h3>Phase 5: Result Publication</h3>
<pre class="language-scheme">
(define (publish-result ballot tally)
  "Publish verified result"
  (let* ((options (ballot-options ballot))
         (result (map cons options tally))
         (winner (determine-winner result (ballot-threshold ballot))))
    (soup-put
      `(ballot-result
        (ballot-id ,(ballot-id ballot))
        (tally ,result)
        (winner ,winner)
        (timestamp ,(current-time))
        (total-votes ,(apply + tally)))
      type: 'ballot-result)
    (audit-append action: 'ballot-result
                  ballot: (ballot-id ballot)
                  result: result
                  winner: winner)))
</pre>
</section>
<section>
<h2>Zero-Knowledge Proofs</h2>
<h3>Vote Validity Proof</h3>
<p>Prove vote is valid (exactly one 1, rest 0s) without revealing which:</p>
<pre class="language-scheme">
(define (generate-validity-proof encrypted-vote choice public-key)
  "ZK proof that vote encodes valid choice"
  ;; Disjunctive proof: prove one of N possibilities
  ;; Without revealing which
  (let ((n (length encrypted-vote)))
    (make-or-proof
      (map (lambda (i)
             (if (= i (choice-index choice))
                 ;; Real proof for actual choice
                 (make-encryption-proof (list-ref encrypted-vote i) 1 public-key)
                 ;; Simulated proof for other choices
                 (simulate-encryption-proof (list-ref encrypted-vote i) 1 public-key)))
           (iota n)))))

(define (verify-validity-proof vote)
  "Verify vote validity without learning choice"
  (let ((proof (vote-proof vote))
        (ciphertext (vote-ciphertext vote))
        (pub-key (ballot-public-key (vote-ballot-id vote))))
    ;; Verify OR proof
    (and (verify-or-proof proof ciphertext pub-key)
         ;; Verify sum of encrypted values equals Enc(1)
         (verify-sum-equals-one ciphertext pub-key))))
</pre>
<h3>Decryption Share Proof</h3>
<p>Prove decryption share is correct:</p>
<pre class="language-scheme">
(define (generate-share-proof share ciphertext trustee-key)
  "ZK proof that decryption share is correct"
  (make-dlog-proof
    (share-value share)
    trustee-key
    ciphertext))

(define (verify-share-proof share ciphertext trustee-pubkey)
  "Verify decryption share correctness"
  (verify-dlog-proof
    (share-proof share)
    (share-value share)
    trustee-pubkey
    ciphertext))
</pre>
</section>
<section>
<h2>Voter Privacy</h2>
<h3>Anonymous Voting Tokens</h3>
<pre class="language-scheme">
(define (issue-voting-token voter-key ballot-id issuer-key)
  "Issue blind voting token"
  ;; Voter blinds their key
  (let* ((blinding-factor (random-scalar))
         (blinded-key (blind-key voter-key blinding-factor)))
    ;; Issuer signs blinded key
    (let ((blind-signature (sign issuer-key blinded-key)))
      ;; Voter unblinds signature
      (let ((token (unblind-signature blind-signature blinding-factor)))
        ;; Token proves eligibility without linking to voter
        (make-voting-token
          ballot-id: ballot-id
          token: token
          ;; Cannot be linked to voter-key
          )))))

(define (vote-anonymously ballot choice token)
  "Cast vote using anonymous token"
  (let ((vote (cast-vote ballot choice token)))
    ;; Vote linked to token, not voter identity
    vote))
</pre>
<h3>Receipt-Freeness</h3>
<p>Voters cannot prove how they voted (prevents vote buying/coercion):</p>
<pre class="language-scheme">
;; Re-encryption mixnet for receipt-freeness
(define (submit-through-mixnet vote mixnet-nodes)
  "Submit vote through re-encryption mixnet"
  (fold (lambda (node encrypted-vote)
          ;; Each node re-encrypts
          (let ((re-encrypted (paillier-rerandomize encrypted-vote)))
            ;; Shuffle with other votes
            (mixnet-shuffle node re-encrypted)))
        vote
        mixnet-nodes))
</pre>
</section>
<section>
<h2>Quorum Types</h2>
<h3>Simple Majority</h3>
<pre class="language-scheme">
(define (simple-majority tally total-eligible)
  "More than half of voters"
  (let ((total-votes (apply + tally))
        (winning-votes (apply max tally)))
    (&gt; winning-votes (/ total-votes 2))))
</pre>
<h3>Supermajority</h3>
<pre class="language-scheme">
(define (supermajority tally fraction)
  "Require fraction (e.g., 2/3) agreement"
  (let ((total-votes (apply + tally))
        (winning-votes (apply max tally)))
    (&gt;= winning-votes (* fraction total-votes))))
</pre>
<h3>Threshold of Eligible</h3>
<pre class="language-scheme">
(define (threshold-of-eligible tally total-eligible threshold)
  "Require threshold of all eligible voters"
  (let ((winning-votes (apply max tally)))
    (&gt;= winning-votes (* threshold total-eligible))))
</pre>
<h3>Weighted Voting</h3>
<pre class="language-scheme">
(define (weighted-vote voter-key weight choice ballot)
  "Cast vote with weight"
  ;; Encode weight in vote
  (let ((encoded (map (lambda (v) (* v weight))
                      (encode-vote choice (ballot-options ballot)))))
    (encrypt-vote-vector encoded (ballot-public-key ballot))))
</pre>
</section>
<section>
<h2>Integration with Governance</h2>
<h3>Memo-008 Threshold Governance</h3>
<pre class="language-scheme">
;; Quorum voting for threshold operations
(define (threshold-operation-vote operation trustees)
  "Vote on threshold operation"
  (let ((ballot (create-ballot
                  question: (format "Approve ~a?" operation)
                  options: '(approve reject)
                  threshold: '(supermajority 2/3)
                  deadline: (+ (current-time) 86400)
                  trustees: trustees)))
    ;; Wait for voting
    (await-ballot-result ballot)))
</pre>
<h3>Memo-011 Byzantine Consensus</h3>
<pre class="language-scheme">
;; Use quorum voting within Byzantine protocol
(define (byzantine-propose-vote proposal validators)
  "Propose via encrypted voting"
  (let ((ballot (create-ballot
                  question: proposal
                  options: '(commit abort)
                  threshold: '(byzantine-quorum (length validators))
                  trustees: validators)))
    ballot))

(define (byzantine-quorum n)
  "2f+1 for n=3f+1 validators"
  (+ (* 2 (floor (/ (- n 1) 3))) 1))
</pre>
<h3>Key Ceremony Voting</h3>
<pre class="language-scheme">
;; Vote to approve key ceremony
(define (key-ceremony-approval ceremony guardians)
  "Guardians vote to approve ceremony"
  (let ((ballot (create-ballot
                  question: (format "Approve key ceremony ~a?" (ceremony-id ceremony))
                  options: '(approve reject)
                  threshold: '(unanimous)
                  deadline: (+ (current-time) 3600)
                  trustees: guardians)))
    (let ((result (await-ballot-result ballot)))
      (if (eq? (result-winner result) 'approve)
          (proceed-ceremony ceremony)
          (abort-ceremony ceremony)))))
</pre>
</section>
<section>
<h2>Security Considerations</h2>
<h3>Cryptographic Assumptions</h3>
<table>
<tr><th>Assumption </th><th>Primitive </th><th>Consequence if Broken </th></tr>
<tr><td>Decisional Composite Residuosity </td><td>Paillier </td><td>Vote privacy lost </td></tr>
<tr><td>Discrete Log </td><td>ZK proofs </td><td>Validity unverifiable </td></tr>
<tr><td>Random Oracle </td><td>Hash functions </td><td>Proof forgery </td></tr>
</table>
<h3>Attack Mitigations</h3>
<table>
<tr><th>Attack </th><th>Mitigation </th></tr>
<tr><td>Vote buying </td><td>Receipt-freeness via re-encryption </td></tr>
<tr><td>Coercion </td><td>Deniable voting tokens </td></tr>
<tr><td>Ballot stuffing </td><td>Eligibility proofs, audit trail </td></tr>
<tr><td>Tally manipulation </td><td>Threshold decryption, ZK proofs </td></tr>
<tr><td>Denial of service </td><td>Rate limiting, deadlines </td></tr>
</table>
<h3>Audit Trail</h3>
<pre class="language-scheme">
;; All voting actions audited
(audit-append action: 'ballot-created ...)
(audit-append action: 'vote-cast ...)      ; Voter ID, not choice
(audit-append action: 'tally-computed ...)
(audit-append action: 'share-provided ...)
(audit-append action: 'result-published ...)
</pre>
</section>
<section>
<h2>Performance Considerations</h2>
<h3>Paillier Costs</h3>
<table>
<tr><th>Operation </th><th>Time (2048-bit) </th></tr>
<tr><td>Key generation </td><td>~100ms </td></tr>
<tr><td>Encrypt </td><td>~5ms </td></tr>
<tr><td>Homomorphic add </td><td>~0.1ms </td></tr>
<tr><td>Decrypt </td><td>~5ms </td></tr>
<tr><td>Threshold decrypt </td><td>~10ms per share </td></tr>
</table>
<h3>Scalability</h3>
<pre class="language-scheme">
;; For N voters, M options:
;; - Encryption: O(N  M) operations
;; - Tallying: O(N  M) additions (fast)
;; - Decryption: O(M * threshold) operations

;; 10,000 voters, 3 options, 5 trustees:
;; ~50,000 encryptions (parallel)
;; ~30,000 additions (&lt;1 second)
;; ~15 decryptions (~150ms)
</pre>
</section>
<section>
<h2>Implementation Notes</h2>
<h3>Dependencies</h3>
<ul>
<li>paillier</li>
<li>Paillier cryptosystem - shamir</li>
<li>Secret sharing for threshold keys - zkp</li>
<li>Zero-knowledge proof primitives - srfi-27</li>
<li>Random number generation</li>
</ul>
<h3>Libraries</h3>
<p>Recommended implementations: - OpenFHE (C++) - Full HE library - python-paillier - Reference implementation - threshold-paillier - Distributed key generation</p>
</section>
<section>
<h2>References</h2>
<p>1. Paillier, P. (1999). Public-Key Cryptosystems Based on Composite Degree Residuosity Classes 2. Benaloh, J. (1994). Dense Probabilistic Encryption 3. Cramer, R., Gennaro, R., Schoenmakers, B. (1997). A Secure and Optimally Efficient Multi-Authority Election Scheme 4. Memo-008: Threshold Signature Governance 5. Memo-011: Byzantine Consensus 6. Memo-022: Key Ceremony Protocol</p>
</section>
<section>
<h2>Changelog</h2>
<ul>
<li>2026-01-07</li>
<li>Initial draft</li>
</ul>
</section>
<script>
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
}
(function() {
  // Query param override (for REPL: ?theme=dark or ?theme=light)
  const params = new URLSearchParams(window.location.search);
  const param = params.get('theme');
  if (param === 'dark' || param === 'light') {
    document.documentElement.setAttribute('data-theme', param);
    localStorage.setItem('theme', param);
    return;
  }
  // localStorage preference
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
  } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', 'light');
  }
})();
</script>
</body>
</html>
