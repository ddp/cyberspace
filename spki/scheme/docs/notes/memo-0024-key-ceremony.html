<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <title>Memo 0024: Key Ceremony Protocol</title>
  <link rel="icon" id="favicon" href="data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27%230f0%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>">
  <script>
(function(){
  var h=new Date().getHours(),c;
  if(h>=4&&h<6)c='%23845EC2';       // brahma muhurta - violet
  else if(h>=6&&h<8)c='%23ffd700';  // dawn - gold
  else if(h>=8&&h<11)c='%2300d4aa'; // morning - teal
  else if(h>=11&&h<14)c='%230f0';   // midday - phosphor
  else if(h>=14&&h<17)c='%2339ff14';// afternoon - neon
  else if(h>=17&&h<19)c='%23ff6600';// sunset - orange
  else if(h>=19&&h<22)c='%23ff3366';// evening - coral
  else c='%2300ffff';               // night - cyan
  document.getElementById('favicon').href='data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27'+c+'%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>';
})();
</script>
  <link rel="stylesheet" href="memo.css">
</head>
<body>
<span class="theme-toggle" onclick="toggleTheme()" title="Toggle light/dark">[theme]</span>
<h1>Memo 0024: Key Ceremony Protocol</h1>
<dl class="metadata">
</dl>
<hr>
<section>
<h2>Abstract</h2>
<p>This Memo specifies key ceremony protocols for the Library of Cyberspace: the ritualized generation, distribution, and activation of cryptographic keys with witnessed verification. Key ceremonies establish roots of trust through transparent, auditable, multi-party processes.</p>
</section>
<section>
<h2>Motivation</h2>
<p>Keys are the foundation of all cryptographic trust:</p>
<ul>
<li>Generate wrong</li>
<li>Everything built on them fails</li>
<li>Store wrong</li>
<li>Compromise propagates everywhere</li>
<li>Distribute wrong</li>
<li>Man-in-the-middle forever</li>
<li>No witnesses</li>
<li>No one believes you did it right</li>
</ul>
<p>Key ceremonies solve this through:</p>
<ul>
<li>Witnessed generation</li>
<li>Multiple parties verify randomness</li>
<li>Split custody</li>
<li>No single point of compromise</li>
<li>Documented process</li>
<li>Reproducible and auditable</li>
<li>Air-gapped execution</li>
<li>Network isolation during critical operations</li>
</ul>
<p>The Library requires key ceremonies for:</p>
<ul>
<li>Vault master keys</li>
<li>Threshold signing keys</li>
<li>Root certificates</li>
<li>Recovery keys</li>
</ul>
</section>
<section>
<h2>Ceremony Types</h2>
<h3>Type 1: Single Key Generation</h3>
<p>For individual vault keys:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 430 140" width="430" height="140" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<line x1="5" y1="10" x2="10" y2="10"/>
<line x1="5" y1="10" x2="5" y2="20"/>
<line x1="10" y1="10" x2="20" y2="10"/>
<line x1="20" y1="10" x2="30" y2="10"/>
<line x1="30" y1="10" x2="40" y2="10"/>
<line x1="40" y1="10" x2="50" y2="10"/>
<line x1="50" y1="10" x2="60" y2="10"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="160" y2="10"/>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="180" y2="10"/>
<line x1="180" y1="10" x2="190" y2="10"/>
<line x1="190" y1="10" x2="200" y2="10"/>
<line x1="200" y1="10" x2="210" y2="10"/>
<line x1="210" y1="10" x2="220" y2="10"/>
<line x1="220" y1="10" x2="230" y2="10"/>
<line x1="230" y1="10" x2="240" y2="10"/>
<line x1="240" y1="10" x2="250" y2="10"/>
<line x1="250" y1="10" x2="260" y2="10"/>
<line x1="260" y1="10" x2="270" y2="10"/>
<line x1="270" y1="10" x2="280" y2="10"/>
<line x1="280" y1="10" x2="290" y2="10"/>
<line x1="290" y1="10" x2="300" y2="10"/>
<line x1="300" y1="10" x2="310" y2="10"/>
<line x1="310" y1="10" x2="320" y2="10"/>
<line x1="320" y1="10" x2="330" y2="10"/>
<line x1="330" y1="10" x2="340" y2="10"/>
<line x1="340" y1="10" x2="350" y2="10"/>
<line x1="350" y1="10" x2="360" y2="10"/>
<line x1="360" y1="10" x2="370" y2="10"/>
<line x1="370" y1="10" x2="380" y2="10"/>
<line x1="380" y1="10" x2="390" y2="10"/>
<line x1="390" y1="10" x2="400" y2="10"/>
<line x1="400" y1="10" x2="410" y2="10"/>
<line x1="410" y1="10" x2="420" y2="10"/>
<line x1="420" y1="10" x2="425" y2="10"/>
<line x1="425" y1="10" x2="425" y2="20"/>
<line x1="5" y1="20" x2="5" y2="40"/>
<text x="115" y="30">S</text>
<text x="125" y="30">I</text>
<text x="135" y="30">N</text>
<text x="145" y="30">G</text>
<text x="155" y="30">L</text>
<text x="165" y="30">E</text>
<text x="185" y="30">K</text>
<text x="195" y="30">E</text>
<text x="205" y="30">Y</text>
<text x="225" y="30">C</text>
<text x="235" y="30">E</text>
<text x="245" y="30">R</text>
<text x="255" y="30">E</text>
<text x="265" y="30">M</text>
<text x="275" y="30">O</text>
<text x="285" y="30">N</text>
<text x="295" y="30">Y</text>
<line x1="425" y1="20" x2="425" y2="40"/>
<line x1="5" y1="40" x2="5" y2="60"/>
<line x1="5" y1="50" x2="10" y2="50"/>
<line x1="10" y1="50" x2="20" y2="50"/>
<line x1="20" y1="50" x2="30" y2="50"/>
<line x1="30" y1="50" x2="40" y2="50"/>
<line x1="40" y1="50" x2="50" y2="50"/>
<line x1="50" y1="50" x2="60" y2="50"/>
<line x1="60" y1="50" x2="70" y2="50"/>
<line x1="70" y1="50" x2="80" y2="50"/>
<line x1="80" y1="50" x2="90" y2="50"/>
<line x1="90" y1="50" x2="100" y2="50"/>
<line x1="100" y1="50" x2="110" y2="50"/>
<line x1="110" y1="50" x2="120" y2="50"/>
<line x1="120" y1="50" x2="130" y2="50"/>
<line x1="130" y1="50" x2="140" y2="50"/>
<line x1="140" y1="50" x2="150" y2="50"/>
<line x1="150" y1="50" x2="160" y2="50"/>
<line x1="160" y1="50" x2="170" y2="50"/>
<line x1="170" y1="50" x2="180" y2="50"/>
<line x1="180" y1="50" x2="190" y2="50"/>
<line x1="190" y1="50" x2="200" y2="50"/>
<line x1="200" y1="50" x2="210" y2="50"/>
<line x1="210" y1="50" x2="220" y2="50"/>
<line x1="220" y1="50" x2="230" y2="50"/>
<line x1="230" y1="50" x2="240" y2="50"/>
<line x1="240" y1="50" x2="250" y2="50"/>
<line x1="250" y1="50" x2="260" y2="50"/>
<line x1="260" y1="50" x2="270" y2="50"/>
<line x1="270" y1="50" x2="280" y2="50"/>
<line x1="280" y1="50" x2="290" y2="50"/>
<line x1="290" y1="50" x2="300" y2="50"/>
<line x1="300" y1="50" x2="310" y2="50"/>
<line x1="310" y1="50" x2="320" y2="50"/>
<line x1="320" y1="50" x2="330" y2="50"/>
<line x1="330" y1="50" x2="340" y2="50"/>
<line x1="340" y1="50" x2="350" y2="50"/>
<line x1="350" y1="50" x2="360" y2="50"/>
<line x1="360" y1="50" x2="370" y2="50"/>
<line x1="370" y1="50" x2="380" y2="50"/>
<line x1="380" y1="50" x2="390" y2="50"/>
<line x1="390" y1="50" x2="400" y2="50"/>
<line x1="400" y1="50" x2="410" y2="50"/>
<line x1="410" y1="50" x2="420" y2="50"/>
<line x1="425" y1="40" x2="425" y2="60"/>
<line x1="420" y1="50" x2="425" y2="50"/>
<line x1="5" y1="60" x2="5" y2="80"/>
<text x="25" y="70">P</text>
<text x="35" y="70">a</text>
<text x="45" y="70">r</text>
<text x="55" y="70">t</text>
<text x="65" y="70">i</text>
<text x="75" y="70">c</text>
<text x="85" y="70">i</text>
<text x="95" y="70">p</text>
<text x="105" y="70">a</text>
<text x="115" y="70">n</text>
<text x="125" y="70">t</text>
<text x="135" y="70">s</text>
<text x="145" y="70">:</text>
<text x="165" y="70">1</text>
<text x="185" y="70">g</text>
<text x="195" y="70">e</text>
<text x="205" y="70">n</text>
<text x="215" y="70">e</text>
<text x="225" y="70">r</text>
<text x="235" y="70">a</text>
<text x="245" y="70">t</text>
<text x="255" y="70">o</text>
<text x="265" y="70">r</text>
<text x="275" y="70">,</text>
<text x="295" y="70">2</text>
<text x="305" y="70">+</text>
<text x="325" y="70">w</text>
<text x="335" y="70">i</text>
<text x="345" y="70">t</text>
<text x="355" y="70">n</text>
<text x="365" y="70">e</text>
<text x="375" y="70">s</text>
<text x="385" y="70">s</text>
<text x="395" y="70">e</text>
<text x="405" y="70">s</text>
<line x1="425" y1="60" x2="425" y2="80"/>
<line x1="5" y1="80" x2="5" y2="100"/>
<text x="25" y="90">D</text>
<text x="35" y="90">u</text>
<text x="45" y="90">r</text>
<text x="55" y="90">a</text>
<text x="65" y="90">t</text>
<text x="75" y="90">i</text>
<text x="85" y="90">o</text>
<text x="95" y="90">n</text>
<text x="105" y="90">:</text>
<text x="125" y="90">~</text>
<text x="135" y="90">3</text>
<text x="145" y="90">0</text>
<text x="165" y="90">m</text>
<text x="175" y="90">i</text>
<text x="185" y="90">n</text>
<text x="195" y="90">u</text>
<text x="205" y="90">t</text>
<text x="215" y="90">e</text>
<text x="225" y="90">s</text>
<line x1="425" y1="80" x2="425" y2="100"/>
<line x1="5" y1="100" x2="5" y2="120"/>
<text x="25" y="110">O</text>
<text x="35" y="110">u</text>
<text x="45" y="110">t</text>
<text x="55" y="110">p</text>
<text x="65" y="110">u</text>
<text x="75" y="110">t</text>
<text x="85" y="110">:</text>
<text x="105" y="110">1</text>
<text x="125" y="110">k</text>
<text x="135" y="110">e</text>
<text x="145" y="110">y</text>
<text x="155" y="110">p</text>
<text x="165" y="110">a</text>
<text x="175" y="110">i</text>
<text x="185" y="110">r</text>
<line x1="425" y1="100" x2="425" y2="120"/>
<line x1="5" y1="130" x2="10" y2="130"/>
<line x1="5" y1="120" x2="5" y2="130"/>
<line x1="10" y1="130" x2="20" y2="130"/>
<line x1="20" y1="130" x2="30" y2="130"/>
<line x1="30" y1="130" x2="40" y2="130"/>
<line x1="40" y1="130" x2="50" y2="130"/>
<line x1="50" y1="130" x2="60" y2="130"/>
<line x1="60" y1="130" x2="70" y2="130"/>
<line x1="70" y1="130" x2="80" y2="130"/>
<line x1="80" y1="130" x2="90" y2="130"/>
<line x1="90" y1="130" x2="100" y2="130"/>
<line x1="100" y1="130" x2="110" y2="130"/>
<line x1="110" y1="130" x2="120" y2="130"/>
<line x1="120" y1="130" x2="130" y2="130"/>
<line x1="130" y1="130" x2="140" y2="130"/>
<line x1="140" y1="130" x2="150" y2="130"/>
<line x1="150" y1="130" x2="160" y2="130"/>
<line x1="160" y1="130" x2="170" y2="130"/>
<line x1="170" y1="130" x2="180" y2="130"/>
<line x1="180" y1="130" x2="190" y2="130"/>
<line x1="190" y1="130" x2="200" y2="130"/>
<line x1="200" y1="130" x2="210" y2="130"/>
<line x1="210" y1="130" x2="220" y2="130"/>
<line x1="220" y1="130" x2="230" y2="130"/>
<line x1="230" y1="130" x2="240" y2="130"/>
<line x1="240" y1="130" x2="250" y2="130"/>
<line x1="250" y1="130" x2="260" y2="130"/>
<line x1="260" y1="130" x2="270" y2="130"/>
<line x1="270" y1="130" x2="280" y2="130"/>
<line x1="280" y1="130" x2="290" y2="130"/>
<line x1="290" y1="130" x2="300" y2="130"/>
<line x1="300" y1="130" x2="310" y2="130"/>
<line x1="310" y1="130" x2="320" y2="130"/>
<line x1="320" y1="130" x2="330" y2="130"/>
<line x1="330" y1="130" x2="340" y2="130"/>
<line x1="340" y1="130" x2="350" y2="130"/>
<line x1="350" y1="130" x2="360" y2="130"/>
<line x1="360" y1="130" x2="370" y2="130"/>
<line x1="370" y1="130" x2="380" y2="130"/>
<line x1="380" y1="130" x2="390" y2="130"/>
<line x1="390" y1="130" x2="400" y2="130"/>
<line x1="400" y1="130" x2="410" y2="130"/>
<line x1="410" y1="130" x2="420" y2="130"/>
<line x1="420" y1="130" x2="425" y2="130"/>
<line x1="425" y1="120" x2="425" y2="130"/>
</svg>
</div>
<h3>Type 2: Threshold Key Generation</h3>
<p>For M-of-N shared keys (Memo-008, Memo-007):</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 460 140" width="460" height="140" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<line x1="5" y1="10" x2="10" y2="10"/>
<line x1="5" y1="10" x2="5" y2="20"/>
<line x1="10" y1="10" x2="20" y2="10"/>
<line x1="20" y1="10" x2="30" y2="10"/>
<line x1="30" y1="10" x2="40" y2="10"/>
<line x1="40" y1="10" x2="50" y2="10"/>
<line x1="50" y1="10" x2="60" y2="10"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="160" y2="10"/>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="180" y2="10"/>
<line x1="180" y1="10" x2="190" y2="10"/>
<line x1="190" y1="10" x2="200" y2="10"/>
<line x1="200" y1="10" x2="210" y2="10"/>
<line x1="210" y1="10" x2="220" y2="10"/>
<line x1="220" y1="10" x2="230" y2="10"/>
<line x1="230" y1="10" x2="240" y2="10"/>
<line x1="240" y1="10" x2="250" y2="10"/>
<line x1="250" y1="10" x2="260" y2="10"/>
<line x1="260" y1="10" x2="270" y2="10"/>
<line x1="270" y1="10" x2="280" y2="10"/>
<line x1="280" y1="10" x2="290" y2="10"/>
<line x1="290" y1="10" x2="300" y2="10"/>
<line x1="300" y1="10" x2="310" y2="10"/>
<line x1="310" y1="10" x2="320" y2="10"/>
<line x1="320" y1="10" x2="330" y2="10"/>
<line x1="330" y1="10" x2="340" y2="10"/>
<line x1="340" y1="10" x2="350" y2="10"/>
<line x1="350" y1="10" x2="360" y2="10"/>
<line x1="360" y1="10" x2="370" y2="10"/>
<line x1="370" y1="10" x2="380" y2="10"/>
<line x1="380" y1="10" x2="390" y2="10"/>
<line x1="390" y1="10" x2="400" y2="10"/>
<line x1="400" y1="10" x2="410" y2="10"/>
<line x1="410" y1="10" x2="420" y2="10"/>
<line x1="420" y1="10" x2="425" y2="10"/>
<line x1="425" y1="10" x2="425" y2="20"/>
<line x1="5" y1="20" x2="5" y2="40"/>
<text x="95" y="30">T</text>
<text x="105" y="30">H</text>
<text x="115" y="30">R</text>
<text x="125" y="30">E</text>
<text x="135" y="30">S</text>
<text x="145" y="30">H</text>
<text x="155" y="30">O</text>
<text x="165" y="30">L</text>
<text x="175" y="30">D</text>
<text x="195" y="30">K</text>
<text x="205" y="30">E</text>
<text x="215" y="30">Y</text>
<text x="235" y="30">C</text>
<text x="245" y="30">E</text>
<text x="255" y="30">R</text>
<text x="265" y="30">E</text>
<text x="275" y="30">M</text>
<text x="285" y="30">O</text>
<text x="295" y="30">N</text>
<text x="305" y="30">Y</text>
<line x1="425" y1="20" x2="425" y2="40"/>
<line x1="5" y1="40" x2="5" y2="60"/>
<line x1="5" y1="50" x2="10" y2="50"/>
<line x1="10" y1="50" x2="20" y2="50"/>
<line x1="20" y1="50" x2="30" y2="50"/>
<line x1="30" y1="50" x2="40" y2="50"/>
<line x1="40" y1="50" x2="50" y2="50"/>
<line x1="50" y1="50" x2="60" y2="50"/>
<line x1="60" y1="50" x2="70" y2="50"/>
<line x1="70" y1="50" x2="80" y2="50"/>
<line x1="80" y1="50" x2="90" y2="50"/>
<line x1="90" y1="50" x2="100" y2="50"/>
<line x1="100" y1="50" x2="110" y2="50"/>
<line x1="110" y1="50" x2="120" y2="50"/>
<line x1="120" y1="50" x2="130" y2="50"/>
<line x1="130" y1="50" x2="140" y2="50"/>
<line x1="140" y1="50" x2="150" y2="50"/>
<line x1="150" y1="50" x2="160" y2="50"/>
<line x1="160" y1="50" x2="170" y2="50"/>
<line x1="170" y1="50" x2="180" y2="50"/>
<line x1="180" y1="50" x2="190" y2="50"/>
<line x1="190" y1="50" x2="200" y2="50"/>
<line x1="200" y1="50" x2="210" y2="50"/>
<line x1="210" y1="50" x2="220" y2="50"/>
<line x1="220" y1="50" x2="230" y2="50"/>
<line x1="230" y1="50" x2="240" y2="50"/>
<line x1="240" y1="50" x2="250" y2="50"/>
<line x1="250" y1="50" x2="260" y2="50"/>
<line x1="260" y1="50" x2="270" y2="50"/>
<line x1="270" y1="50" x2="280" y2="50"/>
<line x1="280" y1="50" x2="290" y2="50"/>
<line x1="290" y1="50" x2="300" y2="50"/>
<line x1="300" y1="50" x2="310" y2="50"/>
<line x1="310" y1="50" x2="320" y2="50"/>
<line x1="320" y1="50" x2="330" y2="50"/>
<line x1="330" y1="50" x2="340" y2="50"/>
<line x1="340" y1="50" x2="350" y2="50"/>
<line x1="350" y1="50" x2="360" y2="50"/>
<line x1="360" y1="50" x2="370" y2="50"/>
<line x1="370" y1="50" x2="380" y2="50"/>
<line x1="380" y1="50" x2="390" y2="50"/>
<line x1="390" y1="50" x2="400" y2="50"/>
<line x1="400" y1="50" x2="410" y2="50"/>
<line x1="410" y1="50" x2="420" y2="50"/>
<line x1="425" y1="40" x2="425" y2="60"/>
<line x1="420" y1="50" x2="425" y2="50"/>
<line x1="5" y1="60" x2="5" y2="80"/>
<text x="25" y="70">P</text>
<text x="35" y="70">a</text>
<text x="45" y="70">r</text>
<text x="55" y="70">t</text>
<text x="65" y="70">i</text>
<text x="75" y="70">c</text>
<text x="85" y="70">i</text>
<text x="95" y="70">p</text>
<text x="105" y="70">a</text>
<text x="115" y="70">n</text>
<text x="125" y="70">t</text>
<text x="135" y="70">s</text>
<text x="145" y="70">:</text>
<text x="165" y="70">N</text>
<text x="185" y="70">s</text>
<text x="195" y="70">h</text>
<text x="205" y="70">a</text>
<text x="215" y="70">r</text>
<text x="225" y="70">e</text>
<text x="235" y="70">h</text>
<text x="245" y="70">o</text>
<text x="255" y="70">l</text>
<text x="265" y="70">d</text>
<text x="275" y="70">e</text>
<text x="285" y="70">r</text>
<text x="295" y="70">s</text>
<text x="305" y="70">,</text>
<text x="325" y="70">2</text>
<text x="335" y="70">+</text>
<text x="355" y="70">w</text>
<text x="365" y="70">i</text>
<text x="375" y="70">t</text>
<text x="385" y="70">n</text>
<text x="395" y="70">e</text>
<text x="405" y="70">s</text>
<text x="415" y="70">s</text>
<text x="425" y="70">e</text>
<text x="435" y="70">s</text>
<line x1="455" y1="60" x2="455" y2="80"/>
<line x1="5" y1="80" x2="5" y2="100"/>
<text x="25" y="90">D</text>
<text x="35" y="90">u</text>
<text x="45" y="90">r</text>
<text x="55" y="90">a</text>
<text x="65" y="90">t</text>
<text x="75" y="90">i</text>
<text x="85" y="90">o</text>
<text x="95" y="90">n</text>
<text x="105" y="90">:</text>
<text x="125" y="90">~</text>
<text x="135" y="90">2</text>
<text x="155" y="90">h</text>
<text x="165" y="90">o</text>
<text x="175" y="90">u</text>
<text x="185" y="90">r</text>
<text x="195" y="90">s</text>
<line x1="425" y1="80" x2="425" y2="100"/>
<line x1="5" y1="100" x2="5" y2="120"/>
<text x="25" y="110">O</text>
<text x="35" y="110">u</text>
<text x="45" y="110">t</text>
<text x="55" y="110">p</text>
<text x="65" y="110">u</text>
<text x="75" y="110">t</text>
<text x="85" y="110">:</text>
<text x="105" y="110">N</text>
<text x="125" y="110">s</text>
<text x="135" y="110">h</text>
<text x="145" y="110">a</text>
<text x="155" y="110">r</text>
<text x="165" y="110">e</text>
<text x="175" y="110">s</text>
<text x="185" y="110">,</text>
<text x="205" y="110">1</text>
<text x="225" y="110">p</text>
<text x="235" y="110">u</text>
<text x="245" y="110">b</text>
<text x="255" y="110">l</text>
<text x="265" y="110">i</text>
<text x="275" y="110">c</text>
<text x="295" y="110">k</text>
<text x="305" y="110">e</text>
<text x="315" y="110">y</text>
<line x1="425" y1="100" x2="425" y2="120"/>
<line x1="5" y1="130" x2="10" y2="130"/>
<line x1="5" y1="120" x2="5" y2="130"/>
<line x1="10" y1="130" x2="20" y2="130"/>
<line x1="20" y1="130" x2="30" y2="130"/>
<line x1="30" y1="130" x2="40" y2="130"/>
<line x1="40" y1="130" x2="50" y2="130"/>
<line x1="50" y1="130" x2="60" y2="130"/>
<line x1="60" y1="130" x2="70" y2="130"/>
<line x1="70" y1="130" x2="80" y2="130"/>
<line x1="80" y1="130" x2="90" y2="130"/>
<line x1="90" y1="130" x2="100" y2="130"/>
<line x1="100" y1="130" x2="110" y2="130"/>
<line x1="110" y1="130" x2="120" y2="130"/>
<line x1="120" y1="130" x2="130" y2="130"/>
<line x1="130" y1="130" x2="140" y2="130"/>
<line x1="140" y1="130" x2="150" y2="130"/>
<line x1="150" y1="130" x2="160" y2="130"/>
<line x1="160" y1="130" x2="170" y2="130"/>
<line x1="170" y1="130" x2="180" y2="130"/>
<line x1="180" y1="130" x2="190" y2="130"/>
<line x1="190" y1="130" x2="200" y2="130"/>
<line x1="200" y1="130" x2="210" y2="130"/>
<line x1="210" y1="130" x2="220" y2="130"/>
<line x1="220" y1="130" x2="230" y2="130"/>
<line x1="230" y1="130" x2="240" y2="130"/>
<line x1="240" y1="130" x2="250" y2="130"/>
<line x1="250" y1="130" x2="260" y2="130"/>
<line x1="260" y1="130" x2="270" y2="130"/>
<line x1="270" y1="130" x2="280" y2="130"/>
<line x1="280" y1="130" x2="290" y2="130"/>
<line x1="290" y1="130" x2="300" y2="130"/>
<line x1="300" y1="130" x2="310" y2="130"/>
<line x1="310" y1="130" x2="320" y2="130"/>
<line x1="320" y1="130" x2="330" y2="130"/>
<line x1="330" y1="130" x2="340" y2="130"/>
<line x1="340" y1="130" x2="350" y2="130"/>
<line x1="350" y1="130" x2="360" y2="130"/>
<line x1="360" y1="130" x2="370" y2="130"/>
<line x1="370" y1="130" x2="380" y2="130"/>
<line x1="380" y1="130" x2="390" y2="130"/>
<line x1="390" y1="130" x2="400" y2="130"/>
<line x1="400" y1="130" x2="410" y2="130"/>
<line x1="410" y1="130" x2="420" y2="130"/>
<line x1="420" y1="130" x2="425" y2="130"/>
<line x1="425" y1="120" x2="425" y2="130"/>
</svg>
</div>
<h3>Type 3: Root Certificate Ceremony</h3>
<p>For establishing certificate authority:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 430 140" width="430" height="140" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<line x1="5" y1="10" x2="10" y2="10"/>
<line x1="5" y1="10" x2="5" y2="20"/>
<line x1="10" y1="10" x2="20" y2="10"/>
<line x1="20" y1="10" x2="30" y2="10"/>
<line x1="30" y1="10" x2="40" y2="10"/>
<line x1="40" y1="10" x2="50" y2="10"/>
<line x1="50" y1="10" x2="60" y2="10"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="160" y2="10"/>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="180" y2="10"/>
<line x1="180" y1="10" x2="190" y2="10"/>
<line x1="190" y1="10" x2="200" y2="10"/>
<line x1="200" y1="10" x2="210" y2="10"/>
<line x1="210" y1="10" x2="220" y2="10"/>
<line x1="220" y1="10" x2="230" y2="10"/>
<line x1="230" y1="10" x2="240" y2="10"/>
<line x1="240" y1="10" x2="250" y2="10"/>
<line x1="250" y1="10" x2="260" y2="10"/>
<line x1="260" y1="10" x2="270" y2="10"/>
<line x1="270" y1="10" x2="280" y2="10"/>
<line x1="280" y1="10" x2="290" y2="10"/>
<line x1="290" y1="10" x2="300" y2="10"/>
<line x1="300" y1="10" x2="310" y2="10"/>
<line x1="310" y1="10" x2="320" y2="10"/>
<line x1="320" y1="10" x2="330" y2="10"/>
<line x1="330" y1="10" x2="340" y2="10"/>
<line x1="340" y1="10" x2="350" y2="10"/>
<line x1="350" y1="10" x2="360" y2="10"/>
<line x1="360" y1="10" x2="370" y2="10"/>
<line x1="370" y1="10" x2="380" y2="10"/>
<line x1="380" y1="10" x2="390" y2="10"/>
<line x1="390" y1="10" x2="400" y2="10"/>
<line x1="400" y1="10" x2="410" y2="10"/>
<line x1="410" y1="10" x2="420" y2="10"/>
<line x1="420" y1="10" x2="425" y2="10"/>
<line x1="425" y1="10" x2="425" y2="20"/>
<line x1="5" y1="20" x2="5" y2="40"/>
<text x="85" y="30">R</text>
<text x="95" y="30">O</text>
<text x="105" y="30">O</text>
<text x="115" y="30">T</text>
<text x="135" y="30">C</text>
<text x="145" y="30">E</text>
<text x="155" y="30">R</text>
<text x="165" y="30">T</text>
<text x="175" y="30">I</text>
<text x="185" y="30">F</text>
<text x="195" y="30">I</text>
<text x="205" y="30">C</text>
<text x="215" y="30">A</text>
<text x="225" y="30">T</text>
<text x="235" y="30">E</text>
<text x="255" y="30">C</text>
<text x="265" y="30">E</text>
<text x="275" y="30">R</text>
<text x="285" y="30">E</text>
<text x="295" y="30">M</text>
<text x="305" y="30">O</text>
<text x="315" y="30">N</text>
<text x="325" y="30">Y</text>
<line x1="425" y1="20" x2="425" y2="40"/>
<line x1="5" y1="40" x2="5" y2="60"/>
<line x1="5" y1="50" x2="10" y2="50"/>
<line x1="10" y1="50" x2="20" y2="50"/>
<line x1="20" y1="50" x2="30" y2="50"/>
<line x1="30" y1="50" x2="40" y2="50"/>
<line x1="40" y1="50" x2="50" y2="50"/>
<line x1="50" y1="50" x2="60" y2="50"/>
<line x1="60" y1="50" x2="70" y2="50"/>
<line x1="70" y1="50" x2="80" y2="50"/>
<line x1="80" y1="50" x2="90" y2="50"/>
<line x1="90" y1="50" x2="100" y2="50"/>
<line x1="100" y1="50" x2="110" y2="50"/>
<line x1="110" y1="50" x2="120" y2="50"/>
<line x1="120" y1="50" x2="130" y2="50"/>
<line x1="130" y1="50" x2="140" y2="50"/>
<line x1="140" y1="50" x2="150" y2="50"/>
<line x1="150" y1="50" x2="160" y2="50"/>
<line x1="160" y1="50" x2="170" y2="50"/>
<line x1="170" y1="50" x2="180" y2="50"/>
<line x1="180" y1="50" x2="190" y2="50"/>
<line x1="190" y1="50" x2="200" y2="50"/>
<line x1="200" y1="50" x2="210" y2="50"/>
<line x1="210" y1="50" x2="220" y2="50"/>
<line x1="220" y1="50" x2="230" y2="50"/>
<line x1="230" y1="50" x2="240" y2="50"/>
<line x1="240" y1="50" x2="250" y2="50"/>
<line x1="250" y1="50" x2="260" y2="50"/>
<line x1="260" y1="50" x2="270" y2="50"/>
<line x1="270" y1="50" x2="280" y2="50"/>
<line x1="280" y1="50" x2="290" y2="50"/>
<line x1="290" y1="50" x2="300" y2="50"/>
<line x1="300" y1="50" x2="310" y2="50"/>
<line x1="310" y1="50" x2="320" y2="50"/>
<line x1="320" y1="50" x2="330" y2="50"/>
<line x1="330" y1="50" x2="340" y2="50"/>
<line x1="340" y1="50" x2="350" y2="50"/>
<line x1="350" y1="50" x2="360" y2="50"/>
<line x1="360" y1="50" x2="370" y2="50"/>
<line x1="370" y1="50" x2="380" y2="50"/>
<line x1="380" y1="50" x2="390" y2="50"/>
<line x1="390" y1="50" x2="400" y2="50"/>
<line x1="400" y1="50" x2="410" y2="50"/>
<line x1="410" y1="50" x2="420" y2="50"/>
<line x1="425" y1="40" x2="425" y2="60"/>
<line x1="420" y1="50" x2="425" y2="50"/>
<line x1="5" y1="60" x2="5" y2="80"/>
<text x="25" y="70">P</text>
<text x="35" y="70">a</text>
<text x="45" y="70">r</text>
<text x="55" y="70">t</text>
<text x="65" y="70">i</text>
<text x="75" y="70">c</text>
<text x="85" y="70">i</text>
<text x="95" y="70">p</text>
<text x="105" y="70">a</text>
<text x="115" y="70">n</text>
<text x="125" y="70">t</text>
<text x="135" y="70">s</text>
<text x="145" y="70">:</text>
<text x="165" y="70">3</text>
<text x="175" y="70">-</text>
<text x="185" y="70">5</text>
<text x="205" y="70">o</text>
<text x="215" y="70">f</text>
<text x="225" y="70">f</text>
<text x="235" y="70">i</text>
<text x="245" y="70">c</text>
<text x="255" y="70">e</text>
<text x="265" y="70">r</text>
<text x="275" y="70">s</text>
<text x="285" y="70">,</text>
<text x="305" y="70">a</text>
<text x="315" y="70">u</text>
<text x="325" y="70">d</text>
<text x="335" y="70">i</text>
<text x="345" y="70">t</text>
<text x="355" y="70">o</text>
<text x="365" y="70">r</text>
<line x1="425" y1="60" x2="425" y2="80"/>
<line x1="5" y1="80" x2="5" y2="100"/>
<text x="25" y="90">D</text>
<text x="35" y="90">u</text>
<text x="45" y="90">r</text>
<text x="55" y="90">a</text>
<text x="65" y="90">t</text>
<text x="75" y="90">i</text>
<text x="85" y="90">o</text>
<text x="95" y="90">n</text>
<text x="105" y="90">:</text>
<text x="125" y="90">~</text>
<text x="135" y="90">4</text>
<text x="155" y="90">h</text>
<text x="165" y="90">o</text>
<text x="175" y="90">u</text>
<text x="185" y="90">r</text>
<text x="195" y="90">s</text>
<line x1="425" y1="80" x2="425" y2="100"/>
<line x1="5" y1="100" x2="5" y2="120"/>
<text x="25" y="110">O</text>
<text x="35" y="110">u</text>
<text x="45" y="110">t</text>
<text x="55" y="110">p</text>
<text x="65" y="110">u</text>
<text x="75" y="110">t</text>
<text x="85" y="110">:</text>
<text x="105" y="110">R</text>
<text x="115" y="110">o</text>
<text x="125" y="110">o</text>
<text x="135" y="110">t</text>
<text x="155" y="110">c</text>
<text x="165" y="110">e</text>
<text x="175" y="110">r</text>
<text x="185" y="110">t</text>
<text x="195" y="110">,</text>
<text x="215" y="110">s</text>
<text x="225" y="110">u</text>
<text x="235" y="110">b</text>
<text x="245" y="110">o</text>
<text x="255" y="110">r</text>
<text x="265" y="110">d</text>
<text x="275" y="110">i</text>
<text x="285" y="110">n</text>
<text x="295" y="110">a</text>
<text x="305" y="110">t</text>
<text x="315" y="110">e</text>
<text x="335" y="110">c</text>
<text x="345" y="110">e</text>
<text x="355" y="110">r</text>
<text x="365" y="110">t</text>
<text x="375" y="110">s</text>
<line x1="425" y1="100" x2="425" y2="120"/>
<line x1="5" y1="130" x2="10" y2="130"/>
<line x1="5" y1="120" x2="5" y2="130"/>
<line x1="10" y1="130" x2="20" y2="130"/>
<line x1="20" y1="130" x2="30" y2="130"/>
<line x1="30" y1="130" x2="40" y2="130"/>
<line x1="40" y1="130" x2="50" y2="130"/>
<line x1="50" y1="130" x2="60" y2="130"/>
<line x1="60" y1="130" x2="70" y2="130"/>
<line x1="70" y1="130" x2="80" y2="130"/>
<line x1="80" y1="130" x2="90" y2="130"/>
<line x1="90" y1="130" x2="100" y2="130"/>
<line x1="100" y1="130" x2="110" y2="130"/>
<line x1="110" y1="130" x2="120" y2="130"/>
<line x1="120" y1="130" x2="130" y2="130"/>
<line x1="130" y1="130" x2="140" y2="130"/>
<line x1="140" y1="130" x2="150" y2="130"/>
<line x1="150" y1="130" x2="160" y2="130"/>
<line x1="160" y1="130" x2="170" y2="130"/>
<line x1="170" y1="130" x2="180" y2="130"/>
<line x1="180" y1="130" x2="190" y2="130"/>
<line x1="190" y1="130" x2="200" y2="130"/>
<line x1="200" y1="130" x2="210" y2="130"/>
<line x1="210" y1="130" x2="220" y2="130"/>
<line x1="220" y1="130" x2="230" y2="130"/>
<line x1="230" y1="130" x2="240" y2="130"/>
<line x1="240" y1="130" x2="250" y2="130"/>
<line x1="250" y1="130" x2="260" y2="130"/>
<line x1="260" y1="130" x2="270" y2="130"/>
<line x1="270" y1="130" x2="280" y2="130"/>
<line x1="280" y1="130" x2="290" y2="130"/>
<line x1="290" y1="130" x2="300" y2="130"/>
<line x1="300" y1="130" x2="310" y2="130"/>
<line x1="310" y1="130" x2="320" y2="130"/>
<line x1="320" y1="130" x2="330" y2="130"/>
<line x1="330" y1="130" x2="340" y2="130"/>
<line x1="340" y1="130" x2="350" y2="130"/>
<line x1="350" y1="130" x2="360" y2="130"/>
<line x1="360" y1="130" x2="370" y2="130"/>
<line x1="370" y1="130" x2="380" y2="130"/>
<line x1="380" y1="130" x2="390" y2="130"/>
<line x1="390" y1="130" x2="400" y2="130"/>
<line x1="400" y1="130" x2="410" y2="130"/>
<line x1="410" y1="130" x2="420" y2="130"/>
<line x1="420" y1="130" x2="425" y2="130"/>
<line x1="425" y1="120" x2="425" y2="130"/>
</svg>
</div>
<h3>Type 4: Recovery Key Ceremony</h3>
<p>For generating disaster recovery keys:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 430 140" width="430" height="140" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<line x1="5" y1="10" x2="10" y2="10"/>
<line x1="5" y1="10" x2="5" y2="20"/>
<line x1="10" y1="10" x2="20" y2="10"/>
<line x1="20" y1="10" x2="30" y2="10"/>
<line x1="30" y1="10" x2="40" y2="10"/>
<line x1="40" y1="10" x2="50" y2="10"/>
<line x1="50" y1="10" x2="60" y2="10"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="160" y2="10"/>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="180" y2="10"/>
<line x1="180" y1="10" x2="190" y2="10"/>
<line x1="190" y1="10" x2="200" y2="10"/>
<line x1="200" y1="10" x2="210" y2="10"/>
<line x1="210" y1="10" x2="220" y2="10"/>
<line x1="220" y1="10" x2="230" y2="10"/>
<line x1="230" y1="10" x2="240" y2="10"/>
<line x1="240" y1="10" x2="250" y2="10"/>
<line x1="250" y1="10" x2="260" y2="10"/>
<line x1="260" y1="10" x2="270" y2="10"/>
<line x1="270" y1="10" x2="280" y2="10"/>
<line x1="280" y1="10" x2="290" y2="10"/>
<line x1="290" y1="10" x2="300" y2="10"/>
<line x1="300" y1="10" x2="310" y2="10"/>
<line x1="310" y1="10" x2="320" y2="10"/>
<line x1="320" y1="10" x2="330" y2="10"/>
<line x1="330" y1="10" x2="340" y2="10"/>
<line x1="340" y1="10" x2="350" y2="10"/>
<line x1="350" y1="10" x2="360" y2="10"/>
<line x1="360" y1="10" x2="370" y2="10"/>
<line x1="370" y1="10" x2="380" y2="10"/>
<line x1="380" y1="10" x2="390" y2="10"/>
<line x1="390" y1="10" x2="400" y2="10"/>
<line x1="400" y1="10" x2="410" y2="10"/>
<line x1="410" y1="10" x2="420" y2="10"/>
<line x1="420" y1="10" x2="425" y2="10"/>
<line x1="425" y1="10" x2="425" y2="20"/>
<line x1="5" y1="20" x2="5" y2="40"/>
<text x="95" y="30">R</text>
<text x="105" y="30">E</text>
<text x="115" y="30">C</text>
<text x="125" y="30">O</text>
<text x="135" y="30">V</text>
<text x="145" y="30">E</text>
<text x="155" y="30">R</text>
<text x="165" y="30">Y</text>
<text x="185" y="30">K</text>
<text x="195" y="30">E</text>
<text x="205" y="30">Y</text>
<text x="225" y="30">C</text>
<text x="235" y="30">E</text>
<text x="245" y="30">R</text>
<text x="255" y="30">E</text>
<text x="265" y="30">M</text>
<text x="275" y="30">O</text>
<text x="285" y="30">N</text>
<text x="295" y="30">Y</text>
<line x1="425" y1="20" x2="425" y2="40"/>
<line x1="5" y1="40" x2="5" y2="60"/>
<line x1="5" y1="50" x2="10" y2="50"/>
<line x1="10" y1="50" x2="20" y2="50"/>
<line x1="20" y1="50" x2="30" y2="50"/>
<line x1="30" y1="50" x2="40" y2="50"/>
<line x1="40" y1="50" x2="50" y2="50"/>
<line x1="50" y1="50" x2="60" y2="50"/>
<line x1="60" y1="50" x2="70" y2="50"/>
<line x1="70" y1="50" x2="80" y2="50"/>
<line x1="80" y1="50" x2="90" y2="50"/>
<line x1="90" y1="50" x2="100" y2="50"/>
<line x1="100" y1="50" x2="110" y2="50"/>
<line x1="110" y1="50" x2="120" y2="50"/>
<line x1="120" y1="50" x2="130" y2="50"/>
<line x1="130" y1="50" x2="140" y2="50"/>
<line x1="140" y1="50" x2="150" y2="50"/>
<line x1="150" y1="50" x2="160" y2="50"/>
<line x1="160" y1="50" x2="170" y2="50"/>
<line x1="170" y1="50" x2="180" y2="50"/>
<line x1="180" y1="50" x2="190" y2="50"/>
<line x1="190" y1="50" x2="200" y2="50"/>
<line x1="200" y1="50" x2="210" y2="50"/>
<line x1="210" y1="50" x2="220" y2="50"/>
<line x1="220" y1="50" x2="230" y2="50"/>
<line x1="230" y1="50" x2="240" y2="50"/>
<line x1="240" y1="50" x2="250" y2="50"/>
<line x1="250" y1="50" x2="260" y2="50"/>
<line x1="260" y1="50" x2="270" y2="50"/>
<line x1="270" y1="50" x2="280" y2="50"/>
<line x1="280" y1="50" x2="290" y2="50"/>
<line x1="290" y1="50" x2="300" y2="50"/>
<line x1="300" y1="50" x2="310" y2="50"/>
<line x1="310" y1="50" x2="320" y2="50"/>
<line x1="320" y1="50" x2="330" y2="50"/>
<line x1="330" y1="50" x2="340" y2="50"/>
<line x1="340" y1="50" x2="350" y2="50"/>
<line x1="350" y1="50" x2="360" y2="50"/>
<line x1="360" y1="50" x2="370" y2="50"/>
<line x1="370" y1="50" x2="380" y2="50"/>
<line x1="380" y1="50" x2="390" y2="50"/>
<line x1="390" y1="50" x2="400" y2="50"/>
<line x1="400" y1="50" x2="410" y2="50"/>
<line x1="410" y1="50" x2="420" y2="50"/>
<line x1="425" y1="40" x2="425" y2="60"/>
<line x1="420" y1="50" x2="425" y2="50"/>
<line x1="5" y1="60" x2="5" y2="80"/>
<text x="25" y="70">P</text>
<text x="35" y="70">a</text>
<text x="45" y="70">r</text>
<text x="55" y="70">t</text>
<text x="65" y="70">i</text>
<text x="75" y="70">c</text>
<text x="85" y="70">i</text>
<text x="95" y="70">p</text>
<text x="105" y="70">a</text>
<text x="115" y="70">n</text>
<text x="125" y="70">t</text>
<text x="135" y="70">s</text>
<text x="145" y="70">:</text>
<text x="165" y="70">B</text>
<text x="175" y="70">o</text>
<text x="185" y="70">a</text>
<text x="195" y="70">r</text>
<text x="205" y="70">d</text>
<text x="225" y="70">m</text>
<text x="235" y="70">e</text>
<text x="245" y="70">m</text>
<text x="255" y="70">b</text>
<text x="265" y="70">e</text>
<text x="275" y="70">r</text>
<text x="285" y="70">s</text>
<text x="295" y="70">,</text>
<text x="315" y="70">e</text>
<text x="325" y="70">s</text>
<text x="335" y="70">c</text>
<text x="345" y="70">r</text>
<text x="355" y="70">o</text>
<text x="365" y="70">w</text>
<line x1="425" y1="60" x2="425" y2="80"/>
<line x1="5" y1="80" x2="5" y2="100"/>
<text x="25" y="90">D</text>
<text x="35" y="90">u</text>
<text x="45" y="90">r</text>
<text x="55" y="90">a</text>
<text x="65" y="90">t</text>
<text x="75" y="90">i</text>
<text x="85" y="90">o</text>
<text x="95" y="90">n</text>
<text x="105" y="90">:</text>
<text x="125" y="90">~</text>
<text x="135" y="90">3</text>
<text x="155" y="90">h</text>
<text x="165" y="90">o</text>
<text x="175" y="90">u</text>
<text x="185" y="90">r</text>
<text x="195" y="90">s</text>
<line x1="425" y1="80" x2="425" y2="100"/>
<line x1="5" y1="100" x2="5" y2="120"/>
<text x="25" y="110">O</text>
<text x="35" y="110">u</text>
<text x="45" y="110">t</text>
<text x="55" y="110">p</text>
<text x="65" y="110">u</text>
<text x="75" y="110">t</text>
<text x="85" y="110">:</text>
<text x="105" y="110">R</text>
<text x="115" y="110">e</text>
<text x="125" y="110">c</text>
<text x="135" y="110">o</text>
<text x="145" y="110">v</text>
<text x="155" y="110">e</text>
<text x="165" y="110">r</text>
<text x="175" y="110">y</text>
<text x="195" y="110">s</text>
<text x="205" y="110">h</text>
<text x="215" y="110">a</text>
<text x="225" y="110">r</text>
<text x="235" y="110">e</text>
<text x="245" y="110">s</text>
<text x="265" y="110">i</text>
<text x="275" y="110">n</text>
<text x="295" y="110">e</text>
<text x="305" y="110">s</text>
<text x="315" y="110">c</text>
<text x="325" y="110">r</text>
<text x="335" y="110">o</text>
<text x="345" y="110">w</text>
<line x1="425" y1="100" x2="425" y2="120"/>
<line x1="5" y1="130" x2="10" y2="130"/>
<line x1="5" y1="120" x2="5" y2="130"/>
<line x1="10" y1="130" x2="20" y2="130"/>
<line x1="20" y1="130" x2="30" y2="130"/>
<line x1="30" y1="130" x2="40" y2="130"/>
<line x1="40" y1="130" x2="50" y2="130"/>
<line x1="50" y1="130" x2="60" y2="130"/>
<line x1="60" y1="130" x2="70" y2="130"/>
<line x1="70" y1="130" x2="80" y2="130"/>
<line x1="80" y1="130" x2="90" y2="130"/>
<line x1="90" y1="130" x2="100" y2="130"/>
<line x1="100" y1="130" x2="110" y2="130"/>
<line x1="110" y1="130" x2="120" y2="130"/>
<line x1="120" y1="130" x2="130" y2="130"/>
<line x1="130" y1="130" x2="140" y2="130"/>
<line x1="140" y1="130" x2="150" y2="130"/>
<line x1="150" y1="130" x2="160" y2="130"/>
<line x1="160" y1="130" x2="170" y2="130"/>
<line x1="170" y1="130" x2="180" y2="130"/>
<line x1="180" y1="130" x2="190" y2="130"/>
<line x1="190" y1="130" x2="200" y2="130"/>
<line x1="200" y1="130" x2="210" y2="130"/>
<line x1="210" y1="130" x2="220" y2="130"/>
<line x1="220" y1="130" x2="230" y2="130"/>
<line x1="230" y1="130" x2="240" y2="130"/>
<line x1="240" y1="130" x2="250" y2="130"/>
<line x1="250" y1="130" x2="260" y2="130"/>
<line x1="260" y1="130" x2="270" y2="130"/>
<line x1="270" y1="130" x2="280" y2="130"/>
<line x1="280" y1="130" x2="290" y2="130"/>
<line x1="290" y1="130" x2="300" y2="130"/>
<line x1="300" y1="130" x2="310" y2="130"/>
<line x1="310" y1="130" x2="320" y2="130"/>
<line x1="320" y1="130" x2="330" y2="130"/>
<line x1="330" y1="130" x2="340" y2="130"/>
<line x1="340" y1="130" x2="350" y2="130"/>
<line x1="350" y1="130" x2="360" y2="130"/>
<line x1="360" y1="130" x2="370" y2="130"/>
<line x1="370" y1="130" x2="380" y2="130"/>
<line x1="380" y1="130" x2="390" y2="130"/>
<line x1="390" y1="130" x2="400" y2="130"/>
<line x1="400" y1="130" x2="410" y2="130"/>
<line x1="410" y1="130" x2="420" y2="130"/>
<line x1="420" y1="130" x2="425" y2="130"/>
<line x1="425" y1="120" x2="425" y2="130"/>
</svg>
</div>
</section>
<section>
<h2>Ceremony Environment</h2>
<h3>Physical Requirements</h3>
<pre>
SECURE ROOM CHECKLIST:
[ ] No network connectivity
[ ] No wireless devices
[ ] Faraday shielding (ideal)
[ ] Physical access control
[ ] Video recording (optional)
[ ] Tamper-evident bags for media
[ ] Multiple witnesses present
</pre>
<h3>Equipment</h3>
<pre class="language-scheme">
(ceremony-equipment
  (primary
    (air-gapped-computer "dedicated ceremony machine")
    (hardware-rng "dice, hardware token, or both")
    (secure-storage "HSM or encrypted USB drives")
    (printer "for paper backup"))
  (verification
    (independent-computer "verify signatures")
    (hash-calculator "verify digests"))
  (documentation
    (camera "photograph key steps")
    (ceremony-log "paper record")
    (witness-signatures "attestation forms")))
</pre>
<h3>Software</h3>
<pre class="language-scheme">
(ceremony-software
  (os "minimal Linux, verified hash")
  (key-generator "library keygen or gpg")
  (shamir-split "ssss or library implementation")
  (hash-tool "sha256sum")
  (encryption "age for share protection"))
</pre>
</section>
<section>
<h2>Single Key Ceremony</h2>
<h3>Pre-Ceremony</h3>
<pre class="language-scheme">
(define (pre-ceremony-checklist ceremony-id)
  '((verify-room "Secure room confirmed")
    (verify-equipment "All equipment present and functional")
    (verify-participants "All participants identified")
    (verify-software "Software hashes match expected")
    (document-start "Record ceremony start time")
    (collect-devices "All phones/devices collected")))
</pre>
<h3>Entropy Generation</h3>
<pre class="language-scheme">
(define (generate-entropy witnesses)
  "Generate verifiable randomness"
  (let* (;; Hardware RNG contribution
         (hw-entropy (read-hardware-rng 32))

         ;; Dice rolls - each witness rolls
         (dice-entropy
          (apply bytes-append
                 (map (lambda (w)
                        (let ((rolls (witness-dice-rolls w 20)))
                          (sha256 (rolls-&gt;bytes rolls))))
                      witnesses)))

         ;; Timestamp contribution
         (time-entropy (sha256 (timestamp-&gt;bytes (current-time))))

         ;; Combine all sources
         (combined (bytes-append hw-entropy dice-entropy time-entropy)))

    ;; Final mixing
    (sha256 combined)))

(define (witness-dice-rolls witness count)
  "Witness rolls dice, records each result"
  (let loop ((i 0) (rolls '()))
    (if (= i count)
        (reverse rolls)
        (let ((roll (read-dice-roll witness)))
          (announce (format "Witness ~a roll ~a: ~a" witness i roll))
          (loop (+ i 1) (cons roll rolls))))))
</pre>
<h3>Key Generation</h3>
<pre class="language-scheme">
(define (generate-ceremony-key entropy purpose)
  "Generate key from ceremony entropy"
  (let* (;; Derive key material
         (key-material (hkdf entropy
                             salt: (string-&gt;bytes purpose)
                             info: "ceremony-key"
                             length: 32))

         ;; Generate Ed25519 keypair
         (keypair (ed25519-keypair-from-seed key-material))
         (public-key (keypair-public keypair))
         (secret-key (keypair-secret keypair)))

    ;; Announce public key
    (announce "Public key generated:")
    (announce (bytes-&gt;hex public-key))

    ;; Return both (secret handled carefully)
    keypair))
</pre>
<h3>Verification</h3>
<pre class="language-scheme">
(define (verify-key-generation keypair witnesses)
  "Witnesses verify key was generated correctly"

  ;; Sign test message
  (let* ((test-message "ceremony verification test")
         (signature (ed25519-sign (keypair-secret keypair) test-message)))

    ;; Each witness verifies on independent machine
    (for-each
      (lambda (witness)
        (let ((verified (witness-verify witness
                                        (keypair-public keypair)
                                        test-message
                                        signature)))
          (announce (format "Witness ~a verification: ~a"
                           witness
                           (if verified "PASS" "FAIL")))
          (unless verified
            (error "Verification failed - abort ceremony"))))
      witnesses)))
</pre>
<h3>Key Storage</h3>
<pre class="language-scheme">
(define (store-ceremony-key keypair ceremony-id storage-method)
  "Securely store generated key"
  (case storage-method
    ((hsm)
     ;; Store in hardware security module
     (hsm-store ceremony-id (keypair-secret keypair)))

    ((encrypted-usb)
     ;; Encrypt to USB drive
     (let ((passphrase (generate-passphrase 6)))
       (announce "Passphrase for USB backup:")
       (announce passphrase)
       (write-encrypted-usb ceremony-id
                           (keypair-secret keypair)
                           passphrase)))

    ((paper)
     ;; Print paper backup
     (print-paper-backup ceremony-id
                        (keypair-secret keypair)
                        (keypair-public keypair)))

    ((shamir)
     ;; Split into shares (see threshold ceremony)
     (shamir-split-key keypair ceremony-id))))
</pre>
<h3>Ceremony Record</h3>
<pre class="language-scheme">
(define (create-ceremony-record ceremony-id keypair witnesses)
  "Create signed ceremony record"
  (let ((record
         (key-ceremony
           (id ,ceremony-id)
           (type single-key)
           (timestamp ,(current-time))
           (public-key ,(bytes-&gt;hex (keypair-public keypair)))
           (algorithm ed25519)
           (witnesses
            ,(map (lambda (w)
                    (witness
                      (name ,(witness-name w))
                      (public-key ,(witness-pubkey w))
                      (attestation "I witnessed this key ceremony")))
                  witnesses))
           (entropy-sources (hardware-rng dice timestamps))
           (storage-method ,(storage-method)))))

    ;; Sign by ceremony officer
    (let ((signed (sign-ceremony-record record)))
      ;; Counter-sign by witnesses
      (for-each
        (lambda (w)
          (witness-countersign signed w))
        witnesses)

      ;; Store in audit trail
      (audit-append
        action: `(key-ceremony ,ceremony-id)
        motivation: "Key generation ceremony completed")

      signed)))
</pre>
</section>
<section>
<h2>Threshold Key Ceremony</h2>
<h3>Share Distribution</h3>
<pre class="language-scheme">
(define (threshold-ceremony n k ceremony-id)
  "Generate threshold key with N shares, K required"

  ;; Generate master entropy (same as single key)
  (let* ((entropy (generate-entropy witnesses))
         (keypair (generate-ceremony-key entropy ceremony-id))

         ;; Split secret into shares
         (shares (shamir-split (keypair-secret keypair) n k)))

    ;; Distribute shares to shareholders
    (for-each
      (lambda (i share shareholder)
        (announce (format "Distributing share ~a to ~a" i shareholder))
        (distribute-share share shareholder ceremony-id))
      (iota n)
      shares
      shareholders)

    ;; Verify reconstruction (with K volunteers)
    (verify-threshold-reconstruction shares k keypair)

    ;; Create ceremony record
    (create-threshold-ceremony-record ceremony-id
                                      keypair
                                      n k
                                      shareholders
                                      witnesses)))
</pre>
<h3>Share Protection</h3>
<pre class="language-scheme">
(define (distribute-share share shareholder ceremony-id)
  "Encrypt share for specific shareholder"
  (let* (;; Encrypt share to shareholder's key
         (encrypted (age-encrypt share (shareholder-pubkey shareholder)))

         ;; Create share package
         (package
          `(share-package
            (ceremony-id ,ceremony-id)
            (shareholder ,(shareholder-id shareholder))
            (share-number ,(share-index share))
            (encrypted-share ,(bytes-&gt;base64 encrypted))
            (verification-hash ,(sha256 share)))))

    ;; Print or store
    (deliver-share-package package shareholder)))
</pre>
<h3>Reconstruction Test</h3>
<pre class="language-scheme">
(define (verify-threshold-reconstruction shares k expected-keypair)
  "Verify shares reconstruct correctly"

  ;; Select K volunteers
  (let* ((volunteers (take (shuffle shareholders) k))
         (volunteer-shares (map get-share-from-volunteer volunteers))

         ;; Reconstruct secret
         (reconstructed (shamir-reconstruct volunteer-shares))

         ;; Verify matches
         (matches (equal? reconstructed (keypair-secret expected-keypair))))

    (announce (format "Reconstruction test with ~a shareholders: ~a"
                     k
                     (if matches "PASS" "FAIL")))

    (unless matches
      (error "Reconstruction failed - shares may be corrupted"))

    ;; Securely clear reconstructed secret from memory
    (secure-clear reconstructed)))
</pre>
</section>
<section>
<h2>Root Certificate Ceremony</h2>
<h3>Certificate Generation</h3>
<pre class="language-scheme">
(define (root-certificate-ceremony ceremony-id validity-years)
  "Generate root certificate authority"

  (let (;; Generate root keypair
         (root-keypair (ceremony-generate-key "root-ca"))

         ;; Create self-signed root certificate
         (root-cert
          `(spki-cert
            (issuer ,(keypair-public root-keypair))
            (subject ,(keypair-public root-keypair))
            (capability (action sign-certificates))
            (validity
              (not-before ,(current-time))
              (not-after ,(+ (current-time)
                            ( validity-years 365 24 3600))))
            (extensions
              (basic-constraints (ca #t) (path-length 2))
              (key-usage (cert-sign crl-sign)))))

         ;; Sign root certificate
         (signed-root (sign-cert root-keypair root-cert)))

    ;; Witnesses verify root certificate
    (verify-root-certificate signed-root witnesses)

    ;; Generate subordinate CA certificates
    (let ((subordinates (generate-subordinate-certs root-keypair)))

      ;; Create ceremony record
      (create-root-ceremony-record ceremony-id
                                  signed-root
                                  subordinates
                                  witnesses))))
</pre>
<h3>Trust Anchor Publication</h3>
<pre class="language-scheme">
(define (publish-trust-anchor root-cert ceremony-record)
  "Publish root certificate as trust anchor"

  ;; Multiple publication channels
  (publish-to-vault root-cert ceremony-record)
  (publish-to-website root-cert ceremony-record)
  (publish-to-transparency-log root-cert ceremony-record)

  ;; Generate human-readable fingerprint
  (let ((fingerprint (cert-fingerprint root-cert)))
    (announce "Root certificate fingerprint:")
    (announce (fingerprint-&gt;words fingerprint))
    (announce (fingerprint-&gt;hex fingerprint))))
</pre>
</section>
<section>
<h2>Recovery Key Ceremony</h2>
<h3>Escrow Protocol</h3>
<pre class="language-scheme">
(define (recovery-key-ceremony n k escrow-agents)
  "Generate recovery keys with escrow"

  (let* (;; Generate recovery keypair
         (recovery-keypair (ceremony-generate-key "recovery"))

         ;; Split into shares
         (shares (shamir-split (keypair-secret recovery-keypair) n k))

         ;; Encrypt each share to escrow agent
         (escrowed-shares
          (map (lambda (share agent)
                 (escrow-share share agent))
               shares
               escrow-agents)))

    ;; Store escrow metadata (not shares)
    (create-escrow-record recovery-keypair escrowed-shares)

    ;; Test recovery (with k agents)
    (test-recovery-process escrowed-shares k recovery-keypair)))

(define (escrow-share share agent)
  "Encrypt share for escrow agent"
  `(escrowed-share
    (agent ,(agent-id agent))
    (encrypted ,(age-encrypt share (agent-pubkey agent)))
    (verification ,(sha256 share))
    (escrow-date ,(current-time))))
</pre>
<h3>Recovery Execution</h3>
<pre class="language-scheme">
(define (execute-recovery escrowed-shares agents)
  "Execute recovery using escrowed shares"

  ;; Verify quorum present
  (unless (&gt;= (length agents) recovery-threshold)
    (error "Insufficient agents for recovery"))

  ;; Each agent decrypts their share
  (let* ((decrypted-shares
          (map (lambda (agent escrowed)
                 (agent-decrypt-share agent escrowed))
               agents
               (filter-by-agent escrowed-shares agents)))

         ;; Verify share hashes
         (_ (verify-share-hashes decrypted-shares escrowed-shares))

         ;; Reconstruct
         (recovered-secret (shamir-reconstruct decrypted-shares)))

    ;; Audit recovery event
    (audit-append
      action: '(recovery-executed)
      motivation: "Disaster recovery initiated"
      priority: 'critical)

    recovered-secret))
</pre>
</section>
<section>
<h2>Ceremony Audit Trail</h2>
<h3>Ceremony Log Format</h3>
<pre class="language-scheme">
(ceremony-log
  (ceremony-id "KC-2026-001")
  (type root-certificate)
  (date "2026-01-07")
  (location "Secure facility, Building A, Room 101")

  (participants
    (officer "Alice Smith" (role ceremony-officer))
    (officer "Bob Jones" (role key-custodian))
    (witness "Carol White" (role witness))
    (witness "David Brown" (role witness))
    (auditor "Eve Green" (role auditor)))

  (timeline
    (event "09:00" "Room secured, equipment verified")
    (event "09:15" "Participants identified, devices collected")
    (event "09:30" "Software verification complete")
    (event "09:45" "Entropy generation started")
    (event "10:00" "Dice rolls complete, 100 rolls recorded")
    (event "10:15" "Key generation complete")
    (event "10:30" "Share distribution complete")
    (event "10:45" "Reconstruction test PASSED")
    (event "11:00" "Ceremony concluded"))

  (artifacts
    (public-key "sha256:abc123...")
    (ceremony-record "sha256:def456...")
    (video-hash "sha256:789xyz..."))

  (attestations
    (signed-by "Alice Smith" "sha256:sig1...")
    (signed-by "Bob Jones" "sha256:sig2...")
    (signed-by "Carol White" "sha256:sig3...")
    (signed-by "David Brown" "sha256:sig4...")
    (signed-by "Eve Green" "sha256:sig5...")))
</pre>
<h3>Soup Integration</h3>
<pre class="language-scheme">
(soup-object
  (name "ceremony/KC-2026-001")
  (type key-ceremony)
  (size "4.2KB")
  (crypto (ed25519 sha256 "ceremony-hash..."))
  (ceremony-type root-certificate)
  (participants 5)
  (date "2026-01-07")
  (status completed)
  (public-key "sha256:abc123..."))
</pre>
</section>
<section>
<h2>Security Considerations</h2>
<h3>Entropy Quality</h3>
<pre class="language-scheme">
;; Multiple entropy sources required
(define (verify-entropy-quality entropy-sources)
  (unless (&gt;= (length entropy-sources) 3)
    (error "Insufficient entropy sources"))
  (unless (member 'hardware-rng entropy-sources)
    (warn "No hardware RNG - ceremony quality reduced"))
  (unless (member 'dice entropy-sources)
    (warn "No dice rolls - verifiability reduced")))
</pre>
<h3>Side Channel Protection</h3>
<pre class="language-scheme">
;; Constant-time operations during key generation
(define (secure-key-operations)
  '((constant-time-comparison "for all secret comparisons")
    (memory-clearing "zero secrets after use")
    (no-branching-on-secrets "avoid timing leaks")
    (power-analysis-resistance "for HSM operations")))
</pre>
<h3>Witness Collusion</h3>
<pre class="language-scheme">
;; Mitigations for witness collusion
(define witness-requirements
  '((minimum-witnesses 2)
    (independent-verification "each witness verifies independently")
    (no-communication "witnesses cannot confer during ceremony")
    (video-recording "optional but recommended")
    (external-auditor "for high-value ceremonies")))
</pre>
<h3>Ceremony Compromise Recovery</h3>
<pre class="language-scheme">
(define (ceremony-compromise-response ceremony-id)
  "Response if ceremony is compromised"
  (let ((cert (get-ceremony-certificate ceremony-id)))
    ;; Immediate revocation
    (emergency-revoke cert "Ceremony compromise suspected")

    ;; Notify all relying parties
    (broadcast-revocation cert)

    ;; Schedule new ceremony
    (schedule-replacement-ceremony ceremony-id)

    ;; Forensic preservation
    (preserve-ceremony-artifacts ceremony-id)))
</pre>
</section>
<section>
<h2>Implementation</h2>
<h3>Ceremony Script</h3>
<pre class="language-scheme">
(define (run-ceremony type)
  "Main ceremony execution script"
  (let ((ceremony-id (generate-ceremony-id)))
    (display-banner ceremony-id type)

    ;; Pre-ceremony
    (run-checklist (pre-ceremony-checklist ceremony-id))

    ;; Main ceremony
    (case type
      ((single-key)
       (single-key-ceremony ceremony-id))
      ((threshold)
       (threshold-ceremony (prompt "N?") (prompt "K?") ceremony-id))
      ((root-cert)
       (root-certificate-ceremony ceremony-id (prompt "Validity years?")))
      ((recovery)
       (recovery-key-ceremony (prompt "N?") (prompt "K?")
                              (collect-escrow-agents))))

    ;; Post-ceremony
    (run-checklist (post-ceremony-checklist ceremony-id))

    (announce "Ceremony complete.")
    ceremony-id))
</pre>
<h3>Offline Tool</h3>
<pre class="language-bash">
# Ceremony tool - runs air-gapped
$ seal-ceremony --type threshold --shares 5 --threshold 3

Library of Cyberspace - Key Ceremony Tool
=========================================

Ceremony ID: KC-2026-001
Type: Threshold (5-of-3)

Pre-ceremony checklist:
[x] Network disabled
[x] Wireless disabled
[x] Software verified
[x] Witnesses present (3)

Generating entropy...
  Hardware RNG: 32 bytes collected
  Dice rolls: Witness 1, roll 1: _
</pre>
</section>
<section>
<h2>References</h2>
<p>1. [DNSSEC Root Key Ceremony](https://www.iana.org/dnssec/ceremonies) 2. [RFC 2693 - SPKI Certificate Theory](https://tools.ietf.org/html/rfc2693) 3. [Memo-008: Threshold Signature Governance](memo-007-threshold-governance.html) 4. [Memo-007: Shamir Secret Sharing](memo-008-shamir-sharing.html) 5. [Memo-021: Capability Delegation](memo-021-capability-delegation.html) 6. [Key Ceremony Best Practices - NIST SP 800-57](https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final)</p>
</section>
<section>
<h2>Changelog</h2>
<ul>
<li>2026-01-07</li>
<li>Initial draft</li>
</ul>
</section>
<script>
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
}
(function() {
  // Query param override (for REPL: ?theme=dark or ?theme=light)
  const params = new URLSearchParams(window.location.search);
  const param = params.get('theme');
  if (param === 'dark' || param === 'light') {
    document.documentElement.setAttribute('data-theme', param);
    localStorage.setItem('theme', param);
    return;
  }
  // localStorage preference
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
  } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', 'light');
  }
})();
</script>
</body>
</html>
