%!PS-Adobe-3.0
%%Title: memo-0006-vault-architecture
%%Creator: Library of Cyberspace Memo Pipeline
%%Pages: (atend)
%%EndComments

/Courier findfont 10 scalefont setfont
/margin 72 def
/pagewidth 612 def
/pageheight 792 def
/leading 12 def
/topmargin pageheight margin sub def
/bottommargin margin def
/linewidth pagewidth margin 2 mul sub def
/ypos topmargin def
/pagenum 1 def

/newline {
  /ypos ypos leading sub def
  ypos bottommargin lt {
    showpage
    /pagenum pagenum 1 add def
    /ypos topmargin def
  } if
  margin ypos moveto
} def

margin topmargin moveto
(Memo 0006: Vault Architecture) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
() show newline
(------------------------------------------------------------------------) show newline
(ABSTRACT) show newline
(------------------------------------------------------------------------) show newline
() show newline
(This Memo specifies the Vault system for the Library of Cyberspace:) show newline
(cryptographically sealed version control with Simple Public Key) show newline
(Infrastructure \(SPKI\) authorization, progressive metadata, archival) show newline
(support, and integrated audit trails.) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(MOTIVATION) show newline
(------------------------------------------------------------------------) show newline
() show newline
(Git is powerful but lacks:) show newline
() show newline
(  * Cryptographic sealing - GPG signing is optional and awkward) show newline
(  * Authorization model - Anyone with access can commit) show newline
(  * Archival features - No first-class backup/restore) show newline
(  * Audit integration - History is mutable) show newline
() show newline
(These gaps leave security as an afterthought rather than a foundation,) show newline
(requiring external tools and manual discipline to achieve what should be) show newline
(built-in.) show newline
() show newline
(The Vault wraps Git with:) show newline
() show newline
(  * seal- commands that cryptographically sign operations) show newline
(  * SPKI certificates for authorization) show newline
(  * Three archive formats for different use cases) show newline
(  * Integrated audit trail for non-repudiation) show newline
() show newline
(The seal- prefix makes cryptographic operations explicit; security is) show newline
(not hidden behind flags or configuration but part of the command) show newline
(vocabulary.) show newline
() show newline
() show newline
(                        ╭────────────────────────────────╮) show newline
(                        │         CYBERSPACE VAULT       │) show newline
(                        ├────────────────────────────────┤) show newline
(                        │  seal-commit    seal-release   │) show newline
(                        │  seal-archive   seal-publish   │) show newline
(                        │  seal-verify    seal-subscribe │) show newline
(                        ├────────────────────────────────┤) show newline
(                        │         Audit Trail            │) show newline
(                        ├────────────────────────────────┤) show newline
(                        │         SPKI Certs             │) show newline
(                        ├────────────────────────────────┤) show newline
(                        │            Git                 │) show newline
(                        ╰────────────────────────────────╯) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(CORE OPERATIONS) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(seal-commit) show newline
(-----------) show newline
() show newline
(Stage and commit changes in one operation.) show newline
() show newline
() show newline
(    \(seal-commit message) show newline
(      #!key files catalog subjects keywords description preserve\)) show newline
() show newline
(Parameters: - message - Commit message \(required\) - files - Specific) show newline
(files to stage \(optional\) - catalog - Enable catalog metadata - subjects) show newline
(- Subject headings - keywords - Search keywords - description - Extended) show newline
(description - preserve - Enable preservation metadata) show newline
() show newline
(Process:) show newline
() show newline
(  * Stage specified files \(or all modified\)) show newline
(  * Create git commit) show newline
(  * Save metadata \(if catalog or preserve\)) show newline
(  * Record in audit trail \(if signing key configured\)) show newline
() show newline
(Example:) show newline
() show newline
() show newline
(    \(seal-commit "Add authentication module") show newline
(      files: '\("auth.scm" "auth-test.scm"\)) show newline
(      catalog: #t) show newline
(      subjects: '\("security" "authentication"\)) show newline
(      keywords: '\("login" "oauth"\)\)) show newline
() show newline
() show newline
(seal-update) show newline
(-----------) show newline
() show newline
(Pull latest changes from remote.) show newline
() show newline
() show newline
(    \(seal-update #!key branch\)) show newline
() show newline
(Like svn update - fetches and fast-forwards.) show newline
() show newline
() show newline
(seal-undo) show newline
(---------) show newline
() show newline
(Undo changes.) show newline
() show newline
() show newline
(    \(seal-undo #!key file hard\)) show newline
() show newline
(  * file) show newline
(  * Restore specific file - hard) show newline
(  * Discard all uncommitted changes) show newline
() show newline
() show newline
(seal-history) show newline
(------------) show newline
() show newline
(Show commit history.) show newline
() show newline
() show newline
(    \(seal-history #!key count\)) show newline
() show newline
(Displays decorated graph log.) show newline
() show newline
() show newline
(seal-branch / seal-merge) show newline
(------------------------) show newline
() show newline
(Branch and merge operations.) show newline
() show newline
() show newline
(    \(seal-branch "feature-auth" #!key from\)) show newline
(    \(seal-merge "feature-auth" #!key strategy\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(VERSION MANAGEMENT) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(seal-release) show newline
(------------) show newline
() show newline
(Create cryptographically sealed release.) show newline
() show newline
() show newline
(    \(seal-release version #!key message migrate-from\)) show newline
() show newline
(Parameters: - version - Semantic version \(X.Y.Z required\) - message -) show newline
(Release notes - migrate-from - Previous version for migration tracking) show newline
() show newline
(Process:) show newline
() show newline
(  * Validate semantic version format) show newline
(  * Get current commit hash) show newline
(  * Create annotated git tag) show newline
(  * Sign with SPKI \(if configured\)) show newline
(  * Create migration marker \(if migrate-from specified\)) show newline
() show newline
(Signature Storage:) show newline
() show newline
() show newline
(    ;; .vault/releases/1.0.0.sig) show newline
(    \(signature) show newline
(      \(version "1.0.0"\)) show newline
(      \(hash "abc123..."\)) show newline
(      \(manifest "\(release \\"1.0.0\\" \\"abc123\\" 1767685100\)"\)) show newline
(      \(signature #${ed25519-signature}\)\)) show newline
() show newline
() show newline
(seal-verify) show newline
(-----------) show newline
() show newline
(Verify release signature.) show newline
() show newline
() show newline
(    \(seal-verify version #!key verify-key\)) show newline
() show newline
(Process:) show newline
() show newline
(  * Load signature file) show newline
(  * Recompute manifest hash) show newline
(  * Verify Ed25519 signature) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(ARCHIVAL SYSTEM) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(seal-archive) show newline
(------------) show newline
() show newline
(Create sealed archive of a version.) show newline
() show newline
() show newline
(    \(seal-archive version #!key format output\)) show newline
() show newline
(Formats:) show newline
() show newline
(#### Tarball \(default\)) show newline
() show newline
() show newline
(    \(seal-archive "1.0.0" format: 'tarball\)) show newline
() show newline
(  * Standard gzipped tarball) show newline
(  * No history included) show newline
(  * Smallest size) show newline
() show newline
(#### Git Bundle) show newline
() show newline
() show newline
(    \(seal-archive "1.0.0" format: 'bundle\)) show newline
() show newline
(  * Full git history) show newline
(  * Can clone directly) show newline
(  * Medium size) show newline
() show newline
(#### Cryptographic \(legacy\)) show newline
() show newline
() show newline
(    \(seal-archive "1.0.0" format: 'cryptographic\)) show newline
() show newline
(  * Tarball + SHA-512 hash + Ed25519 signature) show newline
(  * Tamper-evident) show newline
(  * Manifest for verification) show newline
() show newline
(#### Zstd+Age \(preferred\)) show newline
() show newline
() show newline
(    \(seal-archive "1.0.0" format: 'zstd-age\)) show newline
() show newline
(  * Zstd compression \(faster, better ratio than gzip\)) show newline
(  * Age encryption \(X25519/Ed25519 compatible\)) show newline
(  * SHA-512 hash + Ed25519 signature) show newline
(  * Encrypted at rest) show newline
() show newline
(Cryptographic Archive Structure:) show newline
() show newline
() show newline
(    vault-1.0.0.archive        # Manifest) show newline
(    vault-1.0.0.archive.tar.gz # Tarball \(cryptographic\)) show newline
() show newline
(Zstd+Age Archive Structure:) show newline
() show newline
() show newline
(    vault-1.0.0.archive            # Manifest) show newline
(    vault-1.0.0.archive.tar.zst.age # Encrypted archive) show newline
() show newline
(Manifest \(cryptographic\):) show newline
() show newline
() show newline
(    \(sealed-archive) show newline
(      \(version "1.0.0"\)) show newline
(      \(format cryptographic\)) show newline
(      \(tarball "vault-1.0.0.archive.tar.gz"\)) show newline
(      \(hash "sha512:..."\)) show newline
(      \(signature "ed25519:..."\)\)) show newline
() show newline
(Manifest \(zstd-age\):) show newline
() show newline
() show newline
(    \(sealed-archive) show newline
(      \(version "1.0.0"\)) show newline
(      \(format zstd-age\)) show newline
(      \(archive "vault-1.0.0.archive.tar.zst.age"\)) show newline
(      \(compression zstd\)) show newline
(      \(encryption age\)) show newline
(      \(recipients \("age1..."\)\)) show newline
(      \(hash "sha512:..."\)) show newline
(      \(signature "ed25519:..."\)\)) show newline
() show newline
(------------------------------------------------------------------------) show newline

showpage
%%Trailer
%%Pages: pagenum
%%EOF
