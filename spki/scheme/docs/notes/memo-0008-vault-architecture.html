<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <title>Memo 0008: Vault Architecture</title>
  <link rel="icon" id="favicon" href="data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27%230f0%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>">
  <script>
(function(){
  var h=new Date().getHours(),c;
  if(h>=4&&h<6)c='%23845EC2';       // brahma muhurta - violet
  else if(h>=6&&h<8)c='%23ffd700';  // dawn - gold
  else if(h>=8&&h<11)c='%2300d4aa'; // morning - teal
  else if(h>=11&&h<14)c='%230f0';   // midday - phosphor
  else if(h>=14&&h<17)c='%2339ff14';// afternoon - neon
  else if(h>=17&&h<19)c='%23ff6600';// sunset - orange
  else if(h>=19&&h<22)c='%23ff3366';// evening - coral
  else c='%2300ffff';               // night - cyan
  document.getElementById('favicon').href='data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27'+c+'%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>';
})();
</script>
  <link rel="stylesheet" href="memo.css">
</head>
<body>
<span class="theme-toggle" onclick="toggleTheme()" title="Toggle light/dark">[theme]</span>
<h1>Memo 0008: Vault Architecture</h1>
<dl class="metadata">
</dl>
<hr>
<section>
<h2>Abstract</h2>
<p>This Memo specifies the Vault system for the Library of Cyberspace: cryptographically sealed version control with Simple Public Key Infrastructure (SPKI) authorization, progressive metadata, archival support, and integrated audit trails.</p>
</section>
<section>
<h2>Motivation</h2>
<p>Git is powerful but lacks:</p>
<p>1. Cryptographic sealing - GPG signing is optional and awkward 2. Authorization model - Anyone with access can commit 3. Archival features - No first-class backup/restore 4. Audit integration - History is mutable</p>
<p>The Vault wraps Git with:</p>
<ul>
<li>seal- commands that cryptographically sign operations</li>
<li>SPKI certificates for authorization</li>
<li>Three archive formats for different use cases</li>
<li>Integrated audit trail for non-repudiation</li>
</ul>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 540 260" width="540" height="260" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: monospace; font-size: 14px; fill: currentColor; text-anchor: middle; dominant-baseline: central; }
</style>
<line x1="205" y1="10" x2="210" y2="10"/>
<line x1="205" y1="10" x2="205" y2="20"/>
<line x1="210" y1="10" x2="220" y2="10"/>
<line x1="220" y1="10" x2="230" y2="10"/>
<line x1="230" y1="10" x2="240" y2="10"/>
<line x1="240" y1="10" x2="250" y2="10"/>
<line x1="250" y1="10" x2="260" y2="10"/>
<line x1="260" y1="10" x2="270" y2="10"/>
<line x1="270" y1="10" x2="280" y2="10"/>
<line x1="280" y1="10" x2="290" y2="10"/>
<line x1="290" y1="10" x2="300" y2="10"/>
<line x1="300" y1="10" x2="310" y2="10"/>
<line x1="310" y1="10" x2="320" y2="10"/>
<line x1="320" y1="10" x2="330" y2="10"/>
<line x1="330" y1="10" x2="340" y2="10"/>
<line x1="340" y1="10" x2="350" y2="10"/>
<line x1="350" y1="10" x2="360" y2="10"/>
<line x1="360" y1="10" x2="370" y2="10"/>
<line x1="370" y1="10" x2="380" y2="10"/>
<line x1="380" y1="10" x2="390" y2="10"/>
<line x1="390" y1="10" x2="400" y2="10"/>
<line x1="400" y1="10" x2="410" y2="10"/>
<line x1="410" y1="10" x2="420" y2="10"/>
<line x1="420" y1="10" x2="430" y2="10"/>
<line x1="430" y1="10" x2="440" y2="10"/>
<line x1="440" y1="10" x2="450" y2="10"/>
<line x1="450" y1="10" x2="460" y2="10"/>
<line x1="460" y1="10" x2="470" y2="10"/>
<line x1="470" y1="10" x2="480" y2="10"/>
<line x1="480" y1="10" x2="490" y2="10"/>
<line x1="490" y1="10" x2="500" y2="10"/>
<line x1="500" y1="10" x2="510" y2="10"/>
<line x1="510" y1="10" x2="520" y2="10"/>
<line x1="520" y1="10" x2="530" y2="10"/>
<line x1="530" y1="10" x2="535" y2="10"/>
<line x1="535" y1="10" x2="535" y2="20"/>
<line x1="205" y1="20" x2="205" y2="40"/>
<text x="305" y="30">C</text>
<text x="315" y="30">Y</text>
<text x="325" y="30">B</text>
<text x="335" y="30">E</text>
<text x="345" y="30">R</text>
<text x="355" y="30">S</text>
<text x="365" y="30">P</text>
<text x="375" y="30">A</text>
<text x="385" y="30">C</text>
<text x="395" y="30">E</text>
<text x="415" y="30">V</text>
<text x="425" y="30">A</text>
<text x="435" y="30">U</text>
<text x="445" y="30">L</text>
<text x="455" y="30">T</text>
<line x1="535" y1="20" x2="535" y2="40"/>
<line x1="205" y1="40" x2="205" y2="60"/>
<line x1="205" y1="50" x2="210" y2="50"/>
<line x1="210" y1="50" x2="220" y2="50"/>
<line x1="220" y1="50" x2="230" y2="50"/>
<line x1="230" y1="50" x2="240" y2="50"/>
<line x1="240" y1="50" x2="250" y2="50"/>
<line x1="250" y1="50" x2="260" y2="50"/>
<line x1="260" y1="50" x2="270" y2="50"/>
<line x1="270" y1="50" x2="280" y2="50"/>
<line x1="280" y1="50" x2="290" y2="50"/>
<line x1="290" y1="50" x2="300" y2="50"/>
<line x1="300" y1="50" x2="310" y2="50"/>
<line x1="310" y1="50" x2="320" y2="50"/>
<line x1="320" y1="50" x2="330" y2="50"/>
<line x1="330" y1="50" x2="340" y2="50"/>
<line x1="340" y1="50" x2="350" y2="50"/>
<line x1="350" y1="50" x2="360" y2="50"/>
<line x1="360" y1="50" x2="370" y2="50"/>
<line x1="370" y1="50" x2="380" y2="50"/>
<line x1="380" y1="50" x2="390" y2="50"/>
<line x1="390" y1="50" x2="400" y2="50"/>
<line x1="400" y1="50" x2="410" y2="50"/>
<line x1="410" y1="50" x2="420" y2="50"/>
<line x1="420" y1="50" x2="430" y2="50"/>
<line x1="430" y1="50" x2="440" y2="50"/>
<line x1="440" y1="50" x2="450" y2="50"/>
<line x1="450" y1="50" x2="460" y2="50"/>
<line x1="460" y1="50" x2="470" y2="50"/>
<line x1="470" y1="50" x2="480" y2="50"/>
<line x1="480" y1="50" x2="490" y2="50"/>
<line x1="490" y1="50" x2="500" y2="50"/>
<line x1="500" y1="50" x2="510" y2="50"/>
<line x1="510" y1="50" x2="520" y2="50"/>
<line x1="520" y1="50" x2="530" y2="50"/>
<line x1="535" y1="40" x2="535" y2="60"/>
<line x1="530" y1="50" x2="535" y2="50"/>
<line x1="205" y1="60" x2="205" y2="80"/>
<text x="235" y="70">s</text>
<text x="245" y="70">e</text>
<text x="255" y="70">a</text>
<text x="265" y="70">l</text>
<text x="275" y="70">-</text>
<text x="285" y="70">c</text>
<text x="295" y="70">o</text>
<text x="305" y="70">m</text>
<text x="315" y="70">m</text>
<text x="325" y="70">i</text>
<text x="335" y="70">t</text>
<text x="385" y="70">s</text>
<text x="395" y="70">e</text>
<text x="405" y="70">a</text>
<text x="415" y="70">l</text>
<text x="425" y="70">-</text>
<text x="435" y="70">r</text>
<text x="445" y="70">e</text>
<text x="455" y="70">l</text>
<text x="465" y="70">e</text>
<text x="475" y="70">a</text>
<text x="485" y="70">s</text>
<text x="495" y="70">e</text>
<line x1="535" y1="60" x2="535" y2="80"/>
<line x1="205" y1="80" x2="205" y2="100"/>
<text x="235" y="90">s</text>
<text x="245" y="90">e</text>
<text x="255" y="90">a</text>
<text x="265" y="90">l</text>
<text x="275" y="90">-</text>
<text x="285" y="90">a</text>
<text x="295" y="90">r</text>
<text x="305" y="90">c</text>
<text x="315" y="90">h</text>
<text x="325" y="90">i</text>
<text x="335" y="90">v</text>
<text x="345" y="90">e</text>
<text x="385" y="90">s</text>
<text x="395" y="90">e</text>
<text x="405" y="90">a</text>
<text x="415" y="90">l</text>
<text x="425" y="90">-</text>
<text x="435" y="90">p</text>
<text x="445" y="90">u</text>
<text x="455" y="90">b</text>
<text x="465" y="90">l</text>
<text x="475" y="90">i</text>
<text x="485" y="90">s</text>
<text x="495" y="90">h</text>
<line x1="535" y1="80" x2="535" y2="100"/>
<line x1="205" y1="100" x2="205" y2="120"/>
<text x="235" y="110">s</text>
<text x="245" y="110">e</text>
<text x="255" y="110">a</text>
<text x="265" y="110">l</text>
<text x="275" y="110">-</text>
<text x="285" y="110">v</text>
<text x="295" y="110">e</text>
<text x="305" y="110">r</text>
<text x="315" y="110">i</text>
<text x="325" y="110">f</text>
<text x="335" y="110">y</text>
<text x="385" y="110">s</text>
<text x="395" y="110">e</text>
<text x="405" y="110">a</text>
<text x="415" y="110">l</text>
<text x="425" y="110">-</text>
<text x="435" y="110">s</text>
<text x="445" y="110">u</text>
<text x="455" y="110">b</text>
<text x="465" y="110">s</text>
<text x="475" y="110">c</text>
<text x="485" y="110">r</text>
<text x="495" y="110">i</text>
<text x="505" y="110">b</text>
<text x="515" y="110">e</text>
<line x1="535" y1="100" x2="535" y2="120"/>
<line x1="205" y1="120" x2="205" y2="140"/>
<line x1="205" y1="130" x2="210" y2="130"/>
<line x1="210" y1="130" x2="220" y2="130"/>
<line x1="220" y1="130" x2="230" y2="130"/>
<line x1="230" y1="130" x2="240" y2="130"/>
<line x1="240" y1="130" x2="250" y2="130"/>
<line x1="250" y1="130" x2="260" y2="130"/>
<line x1="260" y1="130" x2="270" y2="130"/>
<line x1="270" y1="130" x2="280" y2="130"/>
<line x1="280" y1="130" x2="290" y2="130"/>
<line x1="290" y1="130" x2="300" y2="130"/>
<line x1="300" y1="130" x2="310" y2="130"/>
<line x1="310" y1="130" x2="320" y2="130"/>
<line x1="320" y1="130" x2="330" y2="130"/>
<line x1="330" y1="130" x2="340" y2="130"/>
<line x1="340" y1="130" x2="350" y2="130"/>
<line x1="350" y1="130" x2="360" y2="130"/>
<line x1="360" y1="130" x2="370" y2="130"/>
<line x1="370" y1="130" x2="380" y2="130"/>
<line x1="380" y1="130" x2="390" y2="130"/>
<line x1="390" y1="130" x2="400" y2="130"/>
<line x1="400" y1="130" x2="410" y2="130"/>
<line x1="410" y1="130" x2="420" y2="130"/>
<line x1="420" y1="130" x2="430" y2="130"/>
<line x1="430" y1="130" x2="440" y2="130"/>
<line x1="440" y1="130" x2="450" y2="130"/>
<line x1="450" y1="130" x2="460" y2="130"/>
<line x1="460" y1="130" x2="470" y2="130"/>
<line x1="470" y1="130" x2="480" y2="130"/>
<line x1="480" y1="130" x2="490" y2="130"/>
<line x1="490" y1="130" x2="500" y2="130"/>
<line x1="500" y1="130" x2="510" y2="130"/>
<line x1="510" y1="130" x2="520" y2="130"/>
<line x1="520" y1="130" x2="530" y2="130"/>
<line x1="535" y1="120" x2="535" y2="140"/>
<line x1="530" y1="130" x2="535" y2="130"/>
<line x1="205" y1="140" x2="205" y2="160"/>
<text x="305" y="150">A</text>
<text x="315" y="150">u</text>
<text x="325" y="150">d</text>
<text x="335" y="150">i</text>
<text x="345" y="150">t</text>
<text x="365" y="150">T</text>
<text x="375" y="150">r</text>
<text x="385" y="150">a</text>
<text x="395" y="150">i</text>
<text x="405" y="150">l</text>
<line x1="535" y1="140" x2="535" y2="160"/>
<line x1="205" y1="160" x2="205" y2="180"/>
<line x1="205" y1="170" x2="210" y2="170"/>
<line x1="210" y1="170" x2="220" y2="170"/>
<line x1="220" y1="170" x2="230" y2="170"/>
<line x1="230" y1="170" x2="240" y2="170"/>
<line x1="240" y1="170" x2="250" y2="170"/>
<line x1="250" y1="170" x2="260" y2="170"/>
<line x1="260" y1="170" x2="270" y2="170"/>
<line x1="270" y1="170" x2="280" y2="170"/>
<line x1="280" y1="170" x2="290" y2="170"/>
<line x1="290" y1="170" x2="300" y2="170"/>
<line x1="300" y1="170" x2="310" y2="170"/>
<line x1="310" y1="170" x2="320" y2="170"/>
<line x1="320" y1="170" x2="330" y2="170"/>
<line x1="330" y1="170" x2="340" y2="170"/>
<line x1="340" y1="170" x2="350" y2="170"/>
<line x1="350" y1="170" x2="360" y2="170"/>
<line x1="360" y1="170" x2="370" y2="170"/>
<line x1="370" y1="170" x2="380" y2="170"/>
<line x1="380" y1="170" x2="390" y2="170"/>
<line x1="390" y1="170" x2="400" y2="170"/>
<line x1="400" y1="170" x2="410" y2="170"/>
<line x1="410" y1="170" x2="420" y2="170"/>
<line x1="420" y1="170" x2="430" y2="170"/>
<line x1="430" y1="170" x2="440" y2="170"/>
<line x1="440" y1="170" x2="450" y2="170"/>
<line x1="450" y1="170" x2="460" y2="170"/>
<line x1="460" y1="170" x2="470" y2="170"/>
<line x1="470" y1="170" x2="480" y2="170"/>
<line x1="480" y1="170" x2="490" y2="170"/>
<line x1="490" y1="170" x2="500" y2="170"/>
<line x1="500" y1="170" x2="510" y2="170"/>
<line x1="510" y1="170" x2="520" y2="170"/>
<line x1="520" y1="170" x2="530" y2="170"/>
<line x1="535" y1="160" x2="535" y2="180"/>
<line x1="530" y1="170" x2="535" y2="170"/>
<line x1="205" y1="180" x2="205" y2="200"/>
<text x="305" y="190">S</text>
<text x="315" y="190">P</text>
<text x="325" y="190">K</text>
<text x="335" y="190">I</text>
<text x="355" y="190">C</text>
<text x="365" y="190">e</text>
<text x="375" y="190">r</text>
<text x="385" y="190">t</text>
<text x="395" y="190">s</text>
<line x1="535" y1="180" x2="535" y2="200"/>
<line x1="205" y1="200" x2="205" y2="220"/>
<line x1="205" y1="210" x2="210" y2="210"/>
<line x1="210" y1="210" x2="220" y2="210"/>
<line x1="220" y1="210" x2="230" y2="210"/>
<line x1="230" y1="210" x2="240" y2="210"/>
<line x1="240" y1="210" x2="250" y2="210"/>
<line x1="250" y1="210" x2="260" y2="210"/>
<line x1="260" y1="210" x2="270" y2="210"/>
<line x1="270" y1="210" x2="280" y2="210"/>
<line x1="280" y1="210" x2="290" y2="210"/>
<line x1="290" y1="210" x2="300" y2="210"/>
<line x1="300" y1="210" x2="310" y2="210"/>
<line x1="310" y1="210" x2="320" y2="210"/>
<line x1="320" y1="210" x2="330" y2="210"/>
<line x1="330" y1="210" x2="340" y2="210"/>
<line x1="340" y1="210" x2="350" y2="210"/>
<line x1="350" y1="210" x2="360" y2="210"/>
<line x1="360" y1="210" x2="370" y2="210"/>
<line x1="370" y1="210" x2="380" y2="210"/>
<line x1="380" y1="210" x2="390" y2="210"/>
<line x1="390" y1="210" x2="400" y2="210"/>
<line x1="400" y1="210" x2="410" y2="210"/>
<line x1="410" y1="210" x2="420" y2="210"/>
<line x1="420" y1="210" x2="430" y2="210"/>
<line x1="430" y1="210" x2="440" y2="210"/>
<line x1="440" y1="210" x2="450" y2="210"/>
<line x1="450" y1="210" x2="460" y2="210"/>
<line x1="460" y1="210" x2="470" y2="210"/>
<line x1="470" y1="210" x2="480" y2="210"/>
<line x1="480" y1="210" x2="490" y2="210"/>
<line x1="490" y1="210" x2="500" y2="210"/>
<line x1="500" y1="210" x2="510" y2="210"/>
<line x1="510" y1="210" x2="520" y2="210"/>
<line x1="520" y1="210" x2="530" y2="210"/>
<line x1="535" y1="200" x2="535" y2="220"/>
<line x1="530" y1="210" x2="535" y2="210"/>
<line x1="205" y1="220" x2="205" y2="240"/>
<text x="335" y="230">G</text>
<text x="345" y="230">i</text>
<text x="355" y="230">t</text>
<line x1="535" y1="220" x2="535" y2="240"/>
<line x1="205" y1="250" x2="210" y2="250"/>
<line x1="205" y1="240" x2="205" y2="250"/>
<line x1="210" y1="250" x2="220" y2="250"/>
<line x1="220" y1="250" x2="230" y2="250"/>
<line x1="230" y1="250" x2="240" y2="250"/>
<line x1="240" y1="250" x2="250" y2="250"/>
<line x1="250" y1="250" x2="260" y2="250"/>
<line x1="260" y1="250" x2="270" y2="250"/>
<line x1="270" y1="250" x2="280" y2="250"/>
<line x1="280" y1="250" x2="290" y2="250"/>
<line x1="290" y1="250" x2="300" y2="250"/>
<line x1="300" y1="250" x2="310" y2="250"/>
<line x1="310" y1="250" x2="320" y2="250"/>
<line x1="320" y1="250" x2="330" y2="250"/>
<line x1="330" y1="250" x2="340" y2="250"/>
<line x1="340" y1="250" x2="350" y2="250"/>
<line x1="350" y1="250" x2="360" y2="250"/>
<line x1="360" y1="250" x2="370" y2="250"/>
<line x1="370" y1="250" x2="380" y2="250"/>
<line x1="380" y1="250" x2="390" y2="250"/>
<line x1="390" y1="250" x2="400" y2="250"/>
<line x1="400" y1="250" x2="410" y2="250"/>
<line x1="410" y1="250" x2="420" y2="250"/>
<line x1="420" y1="250" x2="430" y2="250"/>
<line x1="430" y1="250" x2="440" y2="250"/>
<line x1="440" y1="250" x2="450" y2="250"/>
<line x1="450" y1="250" x2="460" y2="250"/>
<line x1="460" y1="250" x2="470" y2="250"/>
<line x1="470" y1="250" x2="480" y2="250"/>
<line x1="480" y1="250" x2="490" y2="250"/>
<line x1="490" y1="250" x2="500" y2="250"/>
<line x1="500" y1="250" x2="510" y2="250"/>
<line x1="510" y1="250" x2="520" y2="250"/>
<line x1="520" y1="250" x2="530" y2="250"/>
<line x1="530" y1="250" x2="535" y2="250"/>
<line x1="535" y1="240" x2="535" y2="250"/>
</svg>
</div>
</section>
<section>
<h2>Core Operations</h2>
<h3>seal-commit</h3>
<p>Stage and commit changes in one operation.</p>
<pre class="language-scheme">
(seal-commit message
  #!key files catalog subjects keywords description preserve)
</pre>
<p>Parameters: - message - Commit message (required) - files - Specific files to stage (optional) - catalog - Enable catalog metadata - subjects - Subject headings - keywords - Search keywords - description - Extended description - preserve - Enable preservation metadata</p>
<p>Process: 1. Stage specified files (or all modified) 2. Create git commit 3. Save metadata (if catalog or preserve) 4. Record in audit trail (if signing key configured)</p>
<p>Example:</p>
<pre class="language-scheme">
(seal-commit "Add authentication module"
  files: '("auth.scm" "auth-test.scm")
  catalog: #t
  subjects: '("security" "authentication")
  keywords: '("login" "oauth"))
</pre>
<h3>seal-update</h3>
<p>Pull latest changes from remote.</p>
<pre class="language-scheme">
(seal-update #!key branch)
</pre>
<p>Like svn update - fetches and fast-forwards.</p>
<h3>seal-undo</h3>
<p>Undo changes.</p>
<pre class="language-scheme">
(seal-undo #!key file hard)
</pre>
<ul>
<li>file</li>
<li>Restore specific file - hard</li>
<li>Discard all uncommitted changes</li>
</ul>
<h3>seal-history</h3>
<p>Show commit history.</p>
<pre class="language-scheme">
(seal-history #!key count)
</pre>
<p>Displays decorated graph log.</p>
<h3>seal-branch / seal-merge</h3>
<p>Branch and merge operations.</p>
<pre class="language-scheme">
(seal-branch "feature-auth" #!key from)
(seal-merge "feature-auth" #!key strategy)
</pre>
</section>
<section>
<h2>Version Management</h2>
<h3>seal-release</h3>
<p>Create cryptographically sealed release.</p>
<pre class="language-scheme">
(seal-release version #!key message migrate-from)
</pre>
<p>Parameters: - version - Semantic version (X.Y.Z required) - message - Release notes - migrate-from - Previous version for migration tracking</p>
<p>Process: 1. Validate semantic version format 2. Get current commit hash 3. Create annotated git tag 4. Sign with SPKI (if configured) 5. Create migration marker (if migrate-from specified)</p>
<p>Signature Storage:</p>
<pre class="language-scheme">
;; .vault/releases/1.0.0.sig
(signature
  (version "1.0.0")
  (hash "abc123...")
  (manifest "(release \"1.0.0\" \"abc123\" 1767685100)")
  (signature #${ed25519-signature}))
</pre>
<h3>seal-verify</h3>
<p>Verify release signature.</p>
<pre class="language-scheme">
(seal-verify version #!key verify-key)
</pre>
<p>Process: 1. Load signature file 2. Recompute manifest hash 3. Verify Ed25519 signature</p>
</section>
<section>
<h2>Archival System</h2>
<h3>seal-archive</h3>
<p>Create sealed archive of a version.</p>
<pre class="language-scheme">
(seal-archive version #!key format output)
</pre>
<p>Formats:</p>
<p>#### Tarball (default)</p>
<pre class="language-scheme">
(seal-archive "1.0.0" format: 'tarball)
</pre>
<ul>
<li>Standard gzipped tarball</li>
<li>No history included</li>
<li>Smallest size</li>
</ul>
<p>#### Git Bundle</p>
<pre class="language-scheme">
(seal-archive "1.0.0" format: 'bundle)
</pre>
<ul>
<li>Full git history</li>
<li>Can clone directly</li>
<li>Medium size</li>
</ul>
<p>#### Cryptographic (legacy)</p>
<pre class="language-scheme">
(seal-archive "1.0.0" format: 'cryptographic)
</pre>
<ul>
<li>Tarball + SHA-512 hash + Ed25519 signature</li>
<li>Tamper-evident</li>
<li>Manifest for verification</li>
</ul>
<p>#### Zstd+Age (preferred)</p>
<pre class="language-scheme">
(seal-archive "1.0.0" format: 'zstd-age)
</pre>
<ul>
<li>Zstd compression (faster, better ratio than gzip)</li>
<li>Age encryption (X25519/Ed25519 compatible)</li>
<li>SHA-512 hash + Ed25519 signature</li>
<li>Encrypted at rest</li>
</ul>
<p>Cryptographic Archive Structure:</p>
<pre>
vault-1.0.0.archive        # Manifest
vault-1.0.0.archive.tar.gz # Tarball (cryptographic)
</pre>
<p>Zstd+Age Archive Structure:</p>
<pre>
vault-1.0.0.archive            # Manifest
vault-1.0.0.archive.tar.zst.age # Encrypted archive
</pre>
<p>Manifest (cryptographic):</p>
<pre class="language-scheme">
(sealed-archive
  (version "1.0.0")
  (format cryptographic)
  (tarball "vault-1.0.0.archive.tar.gz")
  (hash "sha512:...")
  (signature "ed25519:..."))
</pre>
<p>Manifest (zstd-age):</p>
<pre class="language-scheme">
(sealed-archive
  (version "1.0.0")
  (format zstd-age)
  (archive "vault-1.0.0.archive.tar.zst.age")
  (compression zstd)
  (encryption age)
  (recipients ("age1..."))
  (hash "sha512:...")
  (signature "ed25519:..."))
</pre>
</section>
<script>
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
}
(function() {
  // Query param override (for REPL: ?theme=dark or ?theme=light)
  const params = new URLSearchParams(window.location.search);
  const param = params.get('theme');
  if (param === 'dark' || param === 'light') {
    document.documentElement.setAttribute('data-theme', param);
    localStorage.setItem('theme', param);
    return;
  }
  // localStorage preference
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
  } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', 'light');
  }
})();
</script>
</body>
</html>
