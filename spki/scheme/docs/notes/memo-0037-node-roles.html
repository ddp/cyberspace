<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <title>Memo 0037: Node Roles and Capabilities</title>
  <link rel="icon" id="favicon" href="data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27%230f0%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>">
  <script>
(function(){
  var h=new Date().getHours(),c;
  if(h>=4&&h<6)c='%23845EC2';       // brahma muhurta - violet
  else if(h>=6&&h<8)c='%23ffd700';  // dawn - gold
  else if(h>=8&&h<11)c='%2300d4aa'; // morning - teal
  else if(h>=11&&h<14)c='%230f0';   // midday - phosphor
  else if(h>=14&&h<17)c='%2339ff14';// afternoon - neon
  else if(h>=17&&h<19)c='%23ff6600';// sunset - orange
  else if(h>=19&&h<22)c='%23ff3366';// evening - coral
  else c='%2300ffff';               // night - cyan
  document.getElementById('favicon').href='data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27'+c+'%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>';
})();
</script>
  <link rel="stylesheet" href="memo.css">
</head>
<body>
<span class="theme-toggle" onclick="toggleTheme()" title="Toggle light/dark">[theme]</span>
<h1>Memo 0037: Node Roles and Capabilities</h1>
<dl class="metadata">
</dl>
<hr>
<section>
<h2>Abstract</h2>
<p>This Memo defines functional roles for nodes in a Library of Cyberspace confederation based on compute, storage, network, and security capabilities. Roles determine what operations a node can perform and how it participates in the distributed system.</p>
</section>
<section>
<h2>Terminology</h2>
<p>Realm: A node's place in cyberspace. A realm encompasses: - The node's vault (local content-addressed object store) - The node's principal (Ed25519 identity) - The node's capabilities (hardware, network, security) - The node's objects (what it stores and serves)</p>
<p>A realm is local-first and sovereign. The node controls what to share, who to trust, what to replicate. When nodes federate, their realms overlap - objects flow between them according to trust relationships.</p>
<p>The hardware manifest stored at .vault/node-hardware declares what kind of place this realm occupies in cyberspace.</p>
</section>
<section>
<h2>Motivation</h2>
<p>Memo-010 (Federation Protocol) defines trust relationships between peers (publisher, subscriber, peer). However, it does not address functional capabilities - what operations each node can actually perform based on its hardware and network constraints.</p>
<p>A Raspberry Pi on a solar-powered satellite uplink has different capabilities than a rack-mounted server in a datacenter. The system should:</p>
<p>1. Self-assess - Nodes should know their own capabilities 2. Declare - Nodes should advertise their role to peers 3. Adapt - Operations should degrade gracefully based on available roles 4. Persist - Role assignments should survive restarts</p>
</section>
<section>
<h2>Node Roles</h2>
<h3>Role Hierarchy</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 720.0 307.2" width="720.0" height="307.2" xmlns="http://www.w3.org/2000/svg">
<style>
  line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: round; }
  text { font-family: 'Hack', 'SF Mono', monospace; font-size: 14px; fill: currentColor; }
</style>
<line x1="196.8" y1="9.6" x2="201.6" y2="9.6"/>
<line x1="196.8" y1="9.6" x2="196.8" y2="19.2"/>
<line x1="201.6" y1="9.6" x2="211.2" y2="9.6"/>
<line x1="211.2" y1="9.6" x2="220.8" y2="9.6"/>
<line x1="220.8" y1="9.6" x2="230.4" y2="9.6"/>
<line x1="230.4" y1="9.6" x2="240.0" y2="9.6"/>
<line x1="240.0" y1="9.6" x2="249.6" y2="9.6"/>
<line x1="249.6" y1="9.6" x2="259.2" y2="9.6"/>
<line x1="259.2" y1="9.6" x2="268.8" y2="9.6"/>
<line x1="268.8" y1="9.6" x2="278.4" y2="9.6"/>
<line x1="278.4" y1="9.6" x2="288.0" y2="9.6"/>
<line x1="288.0" y1="9.6" x2="297.6" y2="9.6"/>
<line x1="297.6" y1="9.6" x2="307.2" y2="9.6"/>
<line x1="307.2" y1="9.6" x2="316.8" y2="9.6"/>
<line x1="316.8" y1="9.6" x2="326.4" y2="9.6"/>
<line x1="326.4" y1="9.6" x2="331.2" y2="9.6"/>
<line x1="331.2" y1="9.6" x2="331.2" y2="19.2"/>
<line x1="196.8" y1="19.2" x2="196.8" y2="38.4"/>
<line x1="331.2" y1="19.2" x2="331.2" y2="38.4"/>
<line x1="196.8" y1="38.4" x2="196.8" y2="57.6"/>
<line x1="331.2" y1="38.4" x2="331.2" y2="57.6"/>
<line x1="196.8" y1="67.2" x2="201.6" y2="67.2"/>
<line x1="196.8" y1="57.6" x2="196.8" y2="67.2"/>
<line x1="201.6" y1="67.2" x2="211.2" y2="67.2"/>
<line x1="211.2" y1="67.2" x2="220.8" y2="67.2"/>
<line x1="220.8" y1="67.2" x2="230.4" y2="67.2"/>
<line x1="230.4" y1="67.2" x2="240.0" y2="67.2"/>
<line x1="240.0" y1="67.2" x2="249.6" y2="67.2"/>
<line x1="249.6" y1="67.2" x2="259.2" y2="67.2"/>
<line x1="259.2" y1="67.2" x2="268.8" y2="67.2"/>
<line x1="264.0" y1="67.2" x2="264.0" y2="76.8"/>
<line x1="268.8" y1="67.2" x2="278.4" y2="67.2"/>
<line x1="278.4" y1="67.2" x2="288.0" y2="67.2"/>
<line x1="288.0" y1="67.2" x2="297.6" y2="67.2"/>
<line x1="297.6" y1="67.2" x2="307.2" y2="67.2"/>
<line x1="307.2" y1="67.2" x2="316.8" y2="67.2"/>
<line x1="316.8" y1="67.2" x2="326.4" y2="67.2"/>
<line x1="326.4" y1="67.2" x2="331.2" y2="67.2"/>
<line x1="331.2" y1="57.6" x2="331.2" y2="67.2"/>
<line x1="264.0" y1="76.8" x2="264.0" y2="96.0"/>
<line x1="139.2" y1="105.6" x2="144.0" y2="105.6"/>
<line x1="139.2" y1="105.6" x2="139.2" y2="115.2"/>
<line x1="144.0" y1="105.6" x2="153.6" y2="105.6"/>
<line x1="153.6" y1="105.6" x2="163.2" y2="105.6"/>
<line x1="163.2" y1="105.6" x2="172.8" y2="105.6"/>
<line x1="172.8" y1="105.6" x2="182.4" y2="105.6"/>
<line x1="182.4" y1="105.6" x2="192.0" y2="105.6"/>
<line x1="192.0" y1="105.6" x2="201.6" y2="105.6"/>
<line x1="201.6" y1="105.6" x2="211.2" y2="105.6"/>
<line x1="211.2" y1="105.6" x2="220.8" y2="105.6"/>
<line x1="220.8" y1="105.6" x2="230.4" y2="105.6"/>
<line x1="230.4" y1="105.6" x2="240.0" y2="105.6"/>
<line x1="240.0" y1="105.6" x2="249.6" y2="105.6"/>
<line x1="249.6" y1="105.6" x2="259.2" y2="105.6"/>
<line x1="259.2" y1="105.6" x2="268.8" y2="105.6"/>
<line x1="264.0" y1="96.0" x2="264.0" y2="115.2"/>
<line x1="268.8" y1="105.6" x2="278.4" y2="105.6"/>
<line x1="278.4" y1="105.6" x2="288.0" y2="105.6"/>
<line x1="288.0" y1="105.6" x2="297.6" y2="105.6"/>
<line x1="297.6" y1="105.6" x2="307.2" y2="105.6"/>
<line x1="307.2" y1="105.6" x2="316.8" y2="105.6"/>
<line x1="316.8" y1="105.6" x2="326.4" y2="105.6"/>
<line x1="326.4" y1="105.6" x2="336.0" y2="105.6"/>
<line x1="336.0" y1="105.6" x2="345.6" y2="105.6"/>
<line x1="345.6" y1="105.6" x2="355.2" y2="105.6"/>
<line x1="355.2" y1="105.6" x2="364.8" y2="105.6"/>
<line x1="364.8" y1="105.6" x2="374.4" y2="105.6"/>
<line x1="374.4" y1="105.6" x2="384.0" y2="105.6"/>
<line x1="384.0" y1="105.6" x2="388.8" y2="105.6"/>
<line x1="388.8" y1="105.6" x2="388.8" y2="115.2"/>
<line x1="72.0" y1="144.0" x2="76.8" y2="144.0"/>
<line x1="72.0" y1="144.0" x2="72.0" y2="153.6"/>
<line x1="76.8" y1="144.0" x2="86.4" y2="144.0"/>
<line x1="86.4" y1="144.0" x2="96.0" y2="144.0"/>
<line x1="96.0" y1="144.0" x2="105.6" y2="144.0"/>
<line x1="105.6" y1="144.0" x2="115.2" y2="144.0"/>
<line x1="115.2" y1="144.0" x2="124.8" y2="144.0"/>
<line x1="124.8" y1="144.0" x2="134.4" y2="144.0"/>
<line x1="134.4" y1="144.0" x2="144.0" y2="144.0"/>
<line x1="144.0" y1="144.0" x2="153.6" y2="144.0"/>
<line x1="153.6" y1="144.0" x2="163.2" y2="144.0"/>
<line x1="163.2" y1="144.0" x2="172.8" y2="144.0"/>
<line x1="172.8" y1="144.0" x2="182.4" y2="144.0"/>
<line x1="182.4" y1="144.0" x2="187.2" y2="144.0"/>
<line x1="187.2" y1="144.0" x2="187.2" y2="153.6"/>
<line x1="206.4" y1="144.0" x2="211.2" y2="144.0"/>
<line x1="206.4" y1="144.0" x2="206.4" y2="153.6"/>
<line x1="211.2" y1="144.0" x2="220.8" y2="144.0"/>
<line x1="220.8" y1="144.0" x2="230.4" y2="144.0"/>
<line x1="230.4" y1="144.0" x2="240.0" y2="144.0"/>
<line x1="240.0" y1="144.0" x2="249.6" y2="144.0"/>
<line x1="249.6" y1="144.0" x2="259.2" y2="144.0"/>
<line x1="259.2" y1="144.0" x2="268.8" y2="144.0"/>
<line x1="268.8" y1="144.0" x2="278.4" y2="144.0"/>
<line x1="278.4" y1="144.0" x2="288.0" y2="144.0"/>
<line x1="288.0" y1="144.0" x2="297.6" y2="144.0"/>
<line x1="297.6" y1="144.0" x2="307.2" y2="144.0"/>
<line x1="307.2" y1="144.0" x2="316.8" y2="144.0"/>
<line x1="316.8" y1="144.0" x2="321.6" y2="144.0"/>
<line x1="321.6" y1="144.0" x2="321.6" y2="153.6"/>
<line x1="340.8" y1="144.0" x2="345.6" y2="144.0"/>
<line x1="340.8" y1="144.0" x2="340.8" y2="153.6"/>
<line x1="345.6" y1="144.0" x2="355.2" y2="144.0"/>
<line x1="355.2" y1="144.0" x2="364.8" y2="144.0"/>
<line x1="364.8" y1="144.0" x2="374.4" y2="144.0"/>
<line x1="374.4" y1="144.0" x2="384.0" y2="144.0"/>
<line x1="384.0" y1="144.0" x2="393.6" y2="144.0"/>
<line x1="393.6" y1="144.0" x2="403.2" y2="144.0"/>
<line x1="403.2" y1="144.0" x2="412.8" y2="144.0"/>
<line x1="412.8" y1="144.0" x2="422.4" y2="144.0"/>
<line x1="422.4" y1="144.0" x2="432.0" y2="144.0"/>
<line x1="432.0" y1="144.0" x2="441.6" y2="144.0"/>
<line x1="441.6" y1="144.0" x2="451.2" y2="144.0"/>
<line x1="451.2" y1="144.0" x2="456.0" y2="144.0"/>
<line x1="456.0" y1="144.0" x2="456.0" y2="153.6"/>
<line x1="72.0" y1="153.6" x2="72.0" y2="172.8"/>
<line x1="187.2" y1="153.6" x2="187.2" y2="172.8"/>
<line x1="206.4" y1="153.6" x2="206.4" y2="172.8"/>
<line x1="321.6" y1="153.6" x2="321.6" y2="172.8"/>
<line x1="340.8" y1="153.6" x2="340.8" y2="172.8"/>
<line x1="456.0" y1="153.6" x2="456.0" y2="172.8"/>
<line x1="72.0" y1="172.8" x2="72.0" y2="192.0"/>
<line x1="187.2" y1="172.8" x2="187.2" y2="192.0"/>
<line x1="206.4" y1="172.8" x2="206.4" y2="192.0"/>
<line x1="321.6" y1="172.8" x2="321.6" y2="192.0"/>
<line x1="340.8" y1="172.8" x2="340.8" y2="192.0"/>
<line x1="456.0" y1="172.8" x2="456.0" y2="192.0"/>
<line x1="72.0" y1="201.6" x2="76.8" y2="201.6"/>
<line x1="72.0" y1="192.0" x2="72.0" y2="201.6"/>
<line x1="76.8" y1="201.6" x2="86.4" y2="201.6"/>
<line x1="86.4" y1="201.6" x2="96.0" y2="201.6"/>
<line x1="96.0" y1="201.6" x2="105.6" y2="201.6"/>
<line x1="105.6" y1="201.6" x2="115.2" y2="201.6"/>
<line x1="115.2" y1="201.6" x2="124.8" y2="201.6"/>
<line x1="124.8" y1="201.6" x2="134.4" y2="201.6"/>
<line x1="129.6" y1="201.6" x2="129.6" y2="211.2"/>
<line x1="134.4" y1="201.6" x2="144.0" y2="201.6"/>
<line x1="144.0" y1="201.6" x2="153.6" y2="201.6"/>
<line x1="153.6" y1="201.6" x2="163.2" y2="201.6"/>
<line x1="163.2" y1="201.6" x2="172.8" y2="201.6"/>
<line x1="172.8" y1="201.6" x2="182.4" y2="201.6"/>
<line x1="182.4" y1="201.6" x2="187.2" y2="201.6"/>
<line x1="187.2" y1="192.0" x2="187.2" y2="201.6"/>
<line x1="206.4" y1="201.6" x2="211.2" y2="201.6"/>
<line x1="206.4" y1="192.0" x2="206.4" y2="201.6"/>
<line x1="211.2" y1="201.6" x2="220.8" y2="201.6"/>
<line x1="220.8" y1="201.6" x2="230.4" y2="201.6"/>
<line x1="230.4" y1="201.6" x2="240.0" y2="201.6"/>
<line x1="240.0" y1="201.6" x2="249.6" y2="201.6"/>
<line x1="249.6" y1="201.6" x2="259.2" y2="201.6"/>
<line x1="259.2" y1="201.6" x2="268.8" y2="201.6"/>
<line x1="268.8" y1="201.6" x2="278.4" y2="201.6"/>
<line x1="278.4" y1="201.6" x2="288.0" y2="201.6"/>
<line x1="288.0" y1="201.6" x2="297.6" y2="201.6"/>
<line x1="297.6" y1="201.6" x2="307.2" y2="201.6"/>
<line x1="307.2" y1="201.6" x2="316.8" y2="201.6"/>
<line x1="316.8" y1="201.6" x2="321.6" y2="201.6"/>
<line x1="321.6" y1="192.0" x2="321.6" y2="201.6"/>
<line x1="340.8" y1="201.6" x2="345.6" y2="201.6"/>
<line x1="340.8" y1="192.0" x2="340.8" y2="201.6"/>
<line x1="345.6" y1="201.6" x2="355.2" y2="201.6"/>
<line x1="355.2" y1="201.6" x2="364.8" y2="201.6"/>
<line x1="364.8" y1="201.6" x2="374.4" y2="201.6"/>
<line x1="374.4" y1="201.6" x2="384.0" y2="201.6"/>
<line x1="384.0" y1="201.6" x2="393.6" y2="201.6"/>
<line x1="393.6" y1="201.6" x2="403.2" y2="201.6"/>
<line x1="403.2" y1="201.6" x2="412.8" y2="201.6"/>
<line x1="412.8" y1="201.6" x2="422.4" y2="201.6"/>
<line x1="422.4" y1="201.6" x2="432.0" y2="201.6"/>
<line x1="432.0" y1="201.6" x2="441.6" y2="201.6"/>
<line x1="441.6" y1="201.6" x2="451.2" y2="201.6"/>
<line x1="451.2" y1="201.6" x2="456.0" y2="201.6"/>
<line x1="456.0" y1="192.0" x2="456.0" y2="201.6"/>
<line x1="129.6" y1="211.2" x2="129.6" y2="230.4"/>
<line x1="72.0" y1="259.2" x2="76.8" y2="259.2"/>
<line x1="72.0" y1="259.2" x2="72.0" y2="268.8"/>
<line x1="76.8" y1="259.2" x2="86.4" y2="259.2"/>
<line x1="86.4" y1="259.2" x2="96.0" y2="259.2"/>
<line x1="96.0" y1="259.2" x2="105.6" y2="259.2"/>
<line x1="105.6" y1="259.2" x2="115.2" y2="259.2"/>
<line x1="115.2" y1="259.2" x2="124.8" y2="259.2"/>
<line x1="124.8" y1="259.2" x2="134.4" y2="259.2"/>
<line x1="134.4" y1="259.2" x2="144.0" y2="259.2"/>
<line x1="144.0" y1="259.2" x2="153.6" y2="259.2"/>
<line x1="153.6" y1="259.2" x2="163.2" y2="259.2"/>
<line x1="163.2" y1="259.2" x2="172.8" y2="259.2"/>
<line x1="172.8" y1="259.2" x2="182.4" y2="259.2"/>
<line x1="182.4" y1="259.2" x2="187.2" y2="259.2"/>
<line x1="187.2" y1="259.2" x2="187.2" y2="268.8"/>
<line x1="72.0" y1="268.8" x2="72.0" y2="288.0"/>
<line x1="187.2" y1="268.8" x2="187.2" y2="288.0"/>
<line x1="72.0" y1="297.6" x2="76.8" y2="297.6"/>
<line x1="72.0" y1="288.0" x2="72.0" y2="297.6"/>
<line x1="76.8" y1="297.6" x2="86.4" y2="297.6"/>
<line x1="86.4" y1="297.6" x2="96.0" y2="297.6"/>
<line x1="96.0" y1="297.6" x2="105.6" y2="297.6"/>
<line x1="105.6" y1="297.6" x2="115.2" y2="297.6"/>
<line x1="115.2" y1="297.6" x2="124.8" y2="297.6"/>
<line x1="124.8" y1="297.6" x2="134.4" y2="297.6"/>
<line x1="134.4" y1="297.6" x2="144.0" y2="297.6"/>
<line x1="144.0" y1="297.6" x2="153.6" y2="297.6"/>
<line x1="153.6" y1="297.6" x2="163.2" y2="297.6"/>
<line x1="163.2" y1="297.6" x2="172.8" y2="297.6"/>
<line x1="172.8" y1="297.6" x2="182.4" y2="297.6"/>
<line x1="182.4" y1="297.6" x2="187.2" y2="297.6"/>
<line x1="187.2" y1="288.0" x2="187.2" y2="297.6"/>
<text x="216.0" y="28.8" text-anchor="middle" dominant-baseline="central">C</text>
<text x="225.6" y="28.8" text-anchor="middle" dominant-baseline="central">O</text>
<text x="235.2" y="28.8" text-anchor="middle" dominant-baseline="central">O</text>
<text x="244.8" y="28.8" text-anchor="middle" dominant-baseline="central">R</text>
<text x="254.4" y="28.8" text-anchor="middle" dominant-baseline="central">D</text>
<text x="264.0" y="28.8" text-anchor="middle" dominant-baseline="central">I</text>
<text x="273.6" y="28.8" text-anchor="middle" dominant-baseline="central">N</text>
<text x="283.2" y="28.8" text-anchor="middle" dominant-baseline="central">A</text>
<text x="292.8" y="28.8" text-anchor="middle" dominant-baseline="central">T</text>
<text x="302.4" y="28.8" text-anchor="middle" dominant-baseline="central">O</text>
<text x="312.0" y="28.8" text-anchor="middle" dominant-baseline="central">R</text>
<text x="360.0" y="28.8" text-anchor="middle" dominant-baseline="central">B</text>
<text x="369.6" y="28.8" text-anchor="middle" dominant-baseline="central">y</text>
<text x="379.2" y="28.8" text-anchor="middle" dominant-baseline="central">z</text>
<text x="388.8" y="28.8" text-anchor="middle" dominant-baseline="central">a</text>
<text x="398.4" y="28.8" text-anchor="middle" dominant-baseline="central">n</text>
<text x="408.0" y="28.8" text-anchor="middle" dominant-baseline="central">t</text>
<text x="417.6" y="28.8" text-anchor="middle" dominant-baseline="central">i</text>
<text x="427.2" y="28.8" text-anchor="middle" dominant-baseline="central">n</text>
<text x="436.8" y="28.8" text-anchor="middle" dominant-baseline="central">e</text>
<text x="456.0" y="28.8" text-anchor="middle" dominant-baseline="central">c</text>
<text x="465.6" y="28.8" text-anchor="middle" dominant-baseline="central">o</text>
<text x="475.2" y="28.8" text-anchor="middle" dominant-baseline="central">n</text>
<text x="484.8" y="28.8" text-anchor="middle" dominant-baseline="central">s</text>
<text x="494.4" y="28.8" text-anchor="middle" dominant-baseline="central">e</text>
<text x="504.0" y="28.8" text-anchor="middle" dominant-baseline="central">n</text>
<text x="513.6" y="28.8" text-anchor="middle" dominant-baseline="central">s</text>
<text x="523.2" y="28.8" text-anchor="middle" dominant-baseline="central">u</text>
<text x="532.8" y="28.8" text-anchor="middle" dominant-baseline="central">s</text>
<text x="542.4" y="28.8" text-anchor="middle" dominant-baseline="central">,</text>
<text x="561.6" y="28.8" text-anchor="middle" dominant-baseline="central">t</text>
<text x="571.2" y="28.8" text-anchor="middle" dominant-baseline="central">h</text>
<text x="580.8" y="28.8" text-anchor="middle" dominant-baseline="central">r</text>
<text x="590.4" y="28.8" text-anchor="middle" dominant-baseline="central">e</text>
<text x="600.0" y="28.8" text-anchor="middle" dominant-baseline="central">s</text>
<text x="609.6" y="28.8" text-anchor="middle" dominant-baseline="central">h</text>
<text x="619.2" y="28.8" text-anchor="middle" dominant-baseline="central">o</text>
<text x="628.8" y="28.8" text-anchor="middle" dominant-baseline="central">l</text>
<text x="638.4" y="28.8" text-anchor="middle" dominant-baseline="central">d</text>
<text x="657.6" y="28.8" text-anchor="middle" dominant-baseline="central">s</text>
<text x="667.2" y="28.8" text-anchor="middle" dominant-baseline="central">i</text>
<text x="676.8" y="28.8" text-anchor="middle" dominant-baseline="central">g</text>
<text x="686.4" y="28.8" text-anchor="middle" dominant-baseline="central">n</text>
<text x="696.0" y="28.8" text-anchor="middle" dominant-baseline="central">i</text>
<text x="705.6" y="28.8" text-anchor="middle" dominant-baseline="central">n</text>
<text x="715.2" y="28.8" text-anchor="middle" dominant-baseline="central">g</text>
<text x="235.2" y="48.0" text-anchor="middle" dominant-baseline="central">(</text>
<text x="244.8" y="48.0" text-anchor="middle" dominant-baseline="central">r</text>
<text x="254.4" y="48.0" text-anchor="middle" dominant-baseline="central">a</text>
<text x="264.0" y="48.0" text-anchor="middle" dominant-baseline="central">r</text>
<text x="273.6" y="48.0" text-anchor="middle" dominant-baseline="central">e</text>
<text x="283.2" y="48.0" text-anchor="middle" dominant-baseline="central">)</text>
<text x="360.0" y="48.0" text-anchor="middle" dominant-baseline="central">A</text>
<text x="369.6" y="48.0" text-anchor="middle" dominant-baseline="central">l</text>
<text x="379.2" y="48.0" text-anchor="middle" dominant-baseline="central">w</text>
<text x="388.8" y="48.0" text-anchor="middle" dominant-baseline="central">a</text>
<text x="398.4" y="48.0" text-anchor="middle" dominant-baseline="central">y</text>
<text x="408.0" y="48.0" text-anchor="middle" dominant-baseline="central">s</text>
<text x="417.6" y="48.0" text-anchor="middle" dominant-baseline="central">-</text>
<text x="427.2" y="48.0" text-anchor="middle" dominant-baseline="central">o</text>
<text x="436.8" y="48.0" text-anchor="middle" dominant-baseline="central">n</text>
<text x="446.4" y="48.0" text-anchor="middle" dominant-baseline="central">,</text>
<text x="465.6" y="48.0" text-anchor="middle" dominant-baseline="central">h</text>
<text x="475.2" y="48.0" text-anchor="middle" dominant-baseline="central">i</text>
<text x="484.8" y="48.0" text-anchor="middle" dominant-baseline="central">g</text>
<text x="494.4" y="48.0" text-anchor="middle" dominant-baseline="central">h</text>
<text x="513.6" y="48.0" text-anchor="middle" dominant-baseline="central">c</text>
<text x="523.2" y="48.0" text-anchor="middle" dominant-baseline="central">o</text>
<text x="532.8" y="48.0" text-anchor="middle" dominant-baseline="central">m</text>
<text x="542.4" y="48.0" text-anchor="middle" dominant-baseline="central">p</text>
<text x="552.0" y="48.0" text-anchor="middle" dominant-baseline="central">u</text>
<text x="561.6" y="48.0" text-anchor="middle" dominant-baseline="central">t</text>
<text x="571.2" y="48.0" text-anchor="middle" dominant-baseline="central">e</text>
<text x="139.2" y="124.8" text-anchor="middle" dominant-baseline="central">↓</text>
<text x="264.0" y="124.8" text-anchor="middle" dominant-baseline="central">↓</text>
<text x="388.8" y="124.8" text-anchor="middle" dominant-baseline="central">↓</text>
<text x="110.4" y="163.2" text-anchor="middle" dominant-baseline="central">F</text>
<text x="120.0" y="163.2" text-anchor="middle" dominant-baseline="central">U</text>
<text x="129.6" y="163.2" text-anchor="middle" dominant-baseline="central">L</text>
<text x="139.2" y="163.2" text-anchor="middle" dominant-baseline="central">L</text>
<text x="235.2" y="163.2" text-anchor="middle" dominant-baseline="central">W</text>
<text x="244.8" y="163.2" text-anchor="middle" dominant-baseline="central">I</text>
<text x="254.4" y="163.2" text-anchor="middle" dominant-baseline="central">T</text>
<text x="264.0" y="163.2" text-anchor="middle" dominant-baseline="central">N</text>
<text x="273.6" y="163.2" text-anchor="middle" dominant-baseline="central">E</text>
<text x="283.2" y="163.2" text-anchor="middle" dominant-baseline="central">S</text>
<text x="292.8" y="163.2" text-anchor="middle" dominant-baseline="central">S</text>
<text x="360.0" y="163.2" text-anchor="middle" dominant-baseline="central">A</text>
<text x="369.6" y="163.2" text-anchor="middle" dominant-baseline="central">R</text>
<text x="379.2" y="163.2" text-anchor="middle" dominant-baseline="central">C</text>
<text x="388.8" y="163.2" text-anchor="middle" dominant-baseline="central">H</text>
<text x="398.4" y="163.2" text-anchor="middle" dominant-baseline="central">I</text>
<text x="408.0" y="163.2" text-anchor="middle" dominant-baseline="central">V</text>
<text x="417.6" y="163.2" text-anchor="middle" dominant-baseline="central">E</text>
<text x="427.2" y="163.2" text-anchor="middle" dominant-baseline="central">R</text>
<text x="110.4" y="182.4" text-anchor="middle" dominant-baseline="central">N</text>
<text x="120.0" y="182.4" text-anchor="middle" dominant-baseline="central">O</text>
<text x="129.6" y="182.4" text-anchor="middle" dominant-baseline="central">D</text>
<text x="139.2" y="182.4" text-anchor="middle" dominant-baseline="central">E</text>
<text x="129.6" y="240.0" text-anchor="middle" dominant-baseline="central">↓</text>
<text x="110.4" y="278.4" text-anchor="middle" dominant-baseline="central">E</text>
<text x="120.0" y="278.4" text-anchor="middle" dominant-baseline="central">D</text>
<text x="129.6" y="278.4" text-anchor="middle" dominant-baseline="central">G</text>
<text x="139.2" y="278.4" text-anchor="middle" dominant-baseline="central">E</text>
<text x="216.0" y="278.4" text-anchor="middle" dominant-baseline="central">R</text>
<text x="225.6" y="278.4" text-anchor="middle" dominant-baseline="central">e</text>
<text x="235.2" y="278.4" text-anchor="middle" dominant-baseline="central">a</text>
<text x="244.8" y="278.4" text-anchor="middle" dominant-baseline="central">d</text>
<text x="254.4" y="278.4" text-anchor="middle" dominant-baseline="central">-</text>
<text x="264.0" y="278.4" text-anchor="middle" dominant-baseline="central">o</text>
<text x="273.6" y="278.4" text-anchor="middle" dominant-baseline="central">n</text>
<text x="283.2" y="278.4" text-anchor="middle" dominant-baseline="central">l</text>
<text x="292.8" y="278.4" text-anchor="middle" dominant-baseline="central">y</text>
<text x="302.4" y="278.4" text-anchor="middle" dominant-baseline="central">,</text>
<text x="321.6" y="278.4" text-anchor="middle" dominant-baseline="central">m</text>
<text x="331.2" y="278.4" text-anchor="middle" dominant-baseline="central">o</text>
<text x="340.8" y="278.4" text-anchor="middle" dominant-baseline="central">b</text>
<text x="350.4" y="278.4" text-anchor="middle" dominant-baseline="central">i</text>
<text x="360.0" y="278.4" text-anchor="middle" dominant-baseline="central">l</text>
<text x="369.6" y="278.4" text-anchor="middle" dominant-baseline="central">e</text>
<text x="379.2" y="278.4" text-anchor="middle" dominant-baseline="central">,</text>
<text x="398.4" y="278.4" text-anchor="middle" dominant-baseline="central">i</text>
<text x="408.0" y="278.4" text-anchor="middle" dominant-baseline="central">n</text>
<text x="417.6" y="278.4" text-anchor="middle" dominant-baseline="central">t</text>
<text x="427.2" y="278.4" text-anchor="middle" dominant-baseline="central">e</text>
<text x="436.8" y="278.4" text-anchor="middle" dominant-baseline="central">r</text>
<text x="446.4" y="278.4" text-anchor="middle" dominant-baseline="central">m</text>
<text x="456.0" y="278.4" text-anchor="middle" dominant-baseline="central">i</text>
<text x="465.6" y="278.4" text-anchor="middle" dominant-baseline="central">t</text>
<text x="475.2" y="278.4" text-anchor="middle" dominant-baseline="central">t</text>
<text x="484.8" y="278.4" text-anchor="middle" dominant-baseline="central">e</text>
<text x="494.4" y="278.4" text-anchor="middle" dominant-baseline="central">n</text>
<text x="504.0" y="278.4" text-anchor="middle" dominant-baseline="central">t</text>
</svg>
</div>
<h3>Role Definitions</h3>
<table>
<tr><th>Role </th><th>Compute </th><th>Storage </th><th>Network </th><th>Operations </th></tr>
<tr><td>coordinator </td><td>High </td><td>Medium </td><td>Always-on </td><td>Byzantine consensus, threshold signing, key ceremony </td></tr>
<tr><td>full </td><td>Medium </td><td>High </td><td>Reliable </td><td>All vault operations, replication origin </td></tr>
<tr><td>witness </td><td>Low </td><td>High </td><td>Intermittent </td><td>Passive storage, hash verification, audit </td></tr>
<tr><td>archiver </td><td>Low </td><td>Maximum </td><td>Batch </td><td>Cold storage, offline preservation </td></tr>
<tr><td>edge </td><td>Minimal </td><td>Minimal </td><td>Sporadic </td><td>Read-only sync, mobile access </td></tr>
</table>
<h3>Capability Requirements</h3>
<pre class="language-scheme">
(node-role-capabilities
  (coordinator
    (compute    (min-cores 4) (min-ram-gb 8))
    (storage    (min-gb 100) (type ssd))
    (network    (uptime 0.99) (latency-ms 50))
    (security   (hsm optional) (secure-enclave optional)))

  (full
    (compute    (min-cores 2) (min-ram-gb 4))
    (storage    (min-gb 500) (type any))
    (network    (uptime 0.95) (latency-ms 200))
    (security   (signing-key required)))

  (witness
    (compute    (min-cores 1) (min-ram-gb 1))
    (storage    (min-gb 100) (type any))
    (network    (uptime 0.50) (latency-ms 1000))
    (security   (verify-key required)))

  (archiver
    (compute    (min-cores 1) (min-ram-gb 512mb))
    (storage    (min-gb 1000) (type cold))
    (network    (uptime 0.10) (batch-ok #t))
    (security   (verify-key required) (offline-ok #t)))

  (edge
    (compute    (min-cores 1) (min-ram-gb 256mb))
    (storage    (min-gb 1) (type any))
    (network    (uptime 0.01) (latency-ms 5000))
    (security   (read-only #t))))
</pre>
</section>
<section>
<h2>Role Detection</h2>
<h3>Automatic Probing</h3>
<pre class="language-scheme">
(define (node-probe-capabilities)
  "Probe local system capabilities"
  `((compute
     (cores ,(get-cpu-cores))
     (ram-gb ,(get-ram-gb))
     (load-avg ,(get-load-average)))
    (storage
     (available-gb ,(get-available-storage))
     (type ,(detect-storage-type)))
    (network
     (latency-ms ,(probe-network-latency))
     (bandwidth-mbps ,(estimate-bandwidth))
     (type ,(detect-network-type)))  ; ethernet, wifi, cellular, satellite
    (security
     (signing-key ,(has-signing-key?))
     (verify-key ,(has-verify-key?))
     (hsm ,(has-hsm?)))))
</pre>
<h3>Role Assignment</h3>
<pre class="language-scheme">
(define (node-assign-role capabilities)
  "Assign role based on probed capabilities"
  (let ((compute (assq 'compute capabilities))
        (storage (assq 'storage capabilities))
        (network (assq 'network capabilities)))
    (cond
     ;; Coordinator: high everything
     ((and (&gt;= (get-cores compute) 4)
           (&gt;= (get-ram compute) 8)
           (&lt;= (get-latency network) 50))
      'coordinator)

     ;; Full node: medium compute, high storage
     ((and (&gt;= (get-cores compute) 2)
           (&gt;= (get-storage storage) 500))
      'full)

     ;; Archiver: low compute, massive storage, batch network
     ((and (&gt;= (get-storage storage) 1000)
           (eq? (get-network-type network) 'batch))
      'archiver)

     ;; Witness: low compute, decent storage
     ((&gt;= (get-storage storage) 100)
      'witness)

     ;; Edge: everything else
     (else 'edge))))
</pre>
</section>
<section>
<h2>Role Declaration</h2>
<h3>Local Configuration</h3>
<pre class="language-scheme">
;; ~/.cyberspace/node-role
(node-config
  (role witness)                    ; Declared role
  (auto-detect #f)                  ; Don't override with probed
  (capabilities                     ; Known constraints
    (network (type satellite)
             (latency-ms 600)
             (bandwidth-mbps 100))))
</pre>
<h3>Role Announcement</h3>
<pre class="language-scheme">
(define (node-announce-role)
  "Announce role to federation peers"
  (let ((role (node-current-role))
        (caps (node-probe-capabilities))
        (key (vault-config 'signing-key)))
    (when key
      (let ((announcement
             `(node-role-announcement
               (principal ,(get-vault-principal key))
               (role ,role)
               (capabilities ,caps)
               (timestamp ,(current-seconds)))))
        ;; Sign and broadcast
        (federation-broadcast
         (sign-announcement announcement key))))))
</pre>
</section>
<section>
<h2>Role-Based Operation Constraints</h2>
<h3>Operation Matrix</h3>
<table>
<tr><th>Operation </th><th>coordinator </th><th>full </th><th>witness </th><th>archiver </th><th>edge </th></tr>
<tr><td>seal-commit </td></tr>
<tr><td>seal-release </td></tr>
<tr><td>seal-archive </td></tr>
<tr><td>seal-restore </td></tr>
<tr><td>seal-publish </td></tr>
<tr><td>seal-subscribe </td></tr>
<tr><td>seal-synchronize </td></tr>
<tr><td>seal-verify </td></tr>
<tr><td>threshold-sign </td></tr>
<tr><td>byzantine-vote </td></tr>
<tr><td>key-ceremony </td></tr>
<tr><td>audit-append </td></tr>
<tr><td>audit-verify </td></tr>
</table>
<h3>Graceful Degradation</h3>
<pre class="language-scheme">
(define (node-can-perform? operation)
  "Check if current role permits operation"
  (let ((role (node-current-role))
        (required (operation-required-role operation)))
    (role-permits? role required)))

(define (role-permits? actual required)
  "Check role hierarchy"
  (let ((hierarchy '(coordinator full witness archiver edge)))
    (&lt;= (list-index hierarchy actual)
        (list-index hierarchy required))))
</pre>
</section>
<section>
<h2>Starlink Considerations</h2>
<p>Per Memo-016, the system is optimized for satellite links:</p>
<pre class="language-scheme">
(node-config
  (role witness)
  (network
    (type satellite)
    (provider starlink)
    (characteristics
      (latency-ms 20-40)           ; Low-earth orbit
      (bandwidth-mbps 100-200)     ; Bursty
      (jitter high)                ; Variable
      (uptime 0.95)                ; Weather dependent
      (data-cap none))))           ; Unlimited for now

;; Satellite-optimized behavior
(define satellite-mode
  '((batch-sync #t)                ; Aggregate operations
    (lazy-pull #t)                 ; Don't fetch eagerly
    (compress-always #t)           ; Minimize transfer
    (retry-aggressive #t)          ; Handle drops
    (heartbeat-interval 300)))     ; 5 min, not seconds
</pre>
<h3>Role Implications for Satellite Nodes</h3>
<p>- coordinator: Generally NOT suitable for satellite (latency too variable for consensus) - full: Marginal (can work with lazy clustering) - witness: IDEAL (passive, tolerates latency) - archiver: IDEAL (batch operations) - edge: IDEAL (intermittent by design)</p>
</section>
<section>
<h2>Implementation</h2>
<h3>REPL Commands</h3>
<pre class="language-scheme">
;; Probe and display capabilities
(node-probe)

;; Show current role
(node-role)

;; Set role explicitly
(node-role 'witness)

;; Check if operation permitted
(node-can? 'threshold-sign)

;; Announce role to peers
(node-announce)
</pre>
<h3>Persistence</h3>
<p>Role configuration stored in the realm:</p>
<pre>
~/.cyberspace/node-role      ; User override (global)
.vault/node-role             ; Realm-specific role
.vault/node-hardware         ; Hardware manifest (auto-refreshed)
</pre>
<p>The hardware manifest is automatically updated on REPL startup, declaring the realm's capabilities to federated peers.</p>
<h3>Audit Trail</h3>
<p>Role changes are auditable events:</p>
<pre class="language-scheme">
(audit-entry
  (type node-role-change)
  (timestamp 1736280000)
  (from edge)
  (to witness)
  (reason "Storage expanded")
  (actor #${principal}))
</pre>
</section>
<section>
<h2>Security Considerations</h2>
<h3>Role Spoofing</h3>
<p>A node could claim a higher role than its capabilities warrant. Mitigations:</p>
<p>1. Capability proofs: Require benchmark results 2. Peer validation: Other nodes can challenge claims 3. Reputation: Track role fulfillment history 4. Threshold trust: Multiple witnesses needed</p>
<h3>Role Downgrade Attacks</h3>
<p>An attacker could force nodes to operate at lower roles:</p>
<p>1. Signed role declarations: Can't forge 2. Local override: Node controls own role 3. Audit trail: Role changes are logged</p>
</section>
<section>
<h2>References</h2>
<p>1. Memo-010: Federation Protocol 2. Memo-011: Byzantine Consensus 3. Memo-016: Lazy Clustering 4. Memo-017: Security Considerations</p>
</section>
<section>
<h2>Changelog</h2>
<ul>
<li>2026-01-07</li>
<li>Initial draft</li>
</ul>
</section>
<script>
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
}
(function() {
  // Query param override (for REPL: ?theme=dark or ?theme=light)
  const params = new URLSearchParams(window.location.search);
  const param = params.get('theme');
  if (param === 'dark' || param === 'light') {
    document.documentElement.setAttribute('data-theme', param);
    localStorage.setItem('theme', param);
    return;
  }
  // localStorage preference
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
  } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', 'light');
  }
})();
</script>
</body>
</html>
