<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <title>Memo 0045: Security Architecture</title>
  <link rel="icon" id="favicon" href="data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27%230f0%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>">
  <script>
(function(){
  var h=new Date().getHours(),c;
  if(h>=4&&h<6)c='%23845EC2';       // brahma muhurta - violet
  else if(h>=6&&h<8)c='%23ffd700';  // dawn - gold
  else if(h>=8&&h<11)c='%2300d4aa'; // morning - teal
  else if(h>=11&&h<14)c='%230f0';   // midday - phosphor
  else if(h>=14&&h<17)c='%2339ff14';// afternoon - neon
  else if(h>=17&&h<19)c='%23ff6600';// sunset - orange
  else if(h>=19&&h<22)c='%23ff3366';// evening - coral
  else c='%2300ffff';               // night - cyan
  document.getElementById('favicon').href='data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27'+c+'%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>';
})();
</script>
  <link rel="stylesheet" href="memo.css">
</head>
<body>
<span class="theme-toggle" onclick="toggleTheme()" title="Toggle light/dark">[theme]</span>
<h1>Memo 0045: Security Architecture</h1>
<dl class="metadata">
</dl>
<hr>
<section>
<h2>Abstract</h2>
<p>This document defines how cyberspace protects itself. The model is simple: capabilities all the way down. Objects are content. Authorization flows through signed certificates. No labels, no ACLs, no ambient authority. You hold a capability or you don't.</p>
<p>We use the rigor of TCSEC B2 as a lens - particularly for covert channel analysis - but cyberspace is its own thing. This is our security architecture, in our language.</p>
</section>
<section>
<h2>The Manifesto</h2>
<blockquote>
<p>Authorized capability set with auditing. No central authority.</p>
</blockquote>
<p>You can have a central authority if you want one. That's up to you. But you don't need one. The architecture doesn't require it. Trust flows from keys you choose to trust, not from a hierarchy imposed upon you.</p>
<p>These principles were proven in VAXcluster security (1984-1994), proposed in SDSI at IETF 29 Seattle (1994), and implemented partially in products that didn't survive their parent companies. Cyberspace completes what was started.</p>
<h3>Design Lineage</h3>
<table>
<tr><th>Era </th><th>System </th><th>Contribution </th></tr>
<tr><td>1984 </td><td>VAXcluster </td><td>"Behave as one" - N nodes, one security domain </td></tr>
<tr><td>1985 </td><td>VMS C2 </td><td>Audit trails, access control, TCSEC security primitives </td></tr>
<tr><td>1990 </td><td>DigiCash </td><td>Blind signatures, unlinkable credentials (Chaum) </td></tr>
<tr><td>1993 </td><td>VMS 6.0 </td><td>Cluster-wide intrusion detection, TLV object store </td></tr>
<tr><td>1994 </td><td>SDSI </td><td>Self-certifying keys, local names (Rivest, IETF 29) </td></tr>
<tr><td>1999 </td><td>SPKI </td><td>Authorization certificates, capability delegation (Ellison, RFC 2693) </td></tr>
<tr><td>2026 </td><td>Cyberspace </td><td>Synthesis: SPKI + Chaum + audit + IPv6 mesh + no central authority </td></tr>
</table>
<p>DECnet Phase IV had 24-bit addressing—fatal for internet scale. Cyberspace is designed for IPv6: 128-bit addresses, global mesh, same security principles.</p>
</section>
<section>
<h2>Security Object Types</h2>
<p>Every first-class object in cyberspace. Names as defined.</p>
<p>Table 0: Security Object Registry</p>
<table>
<tr><th>Object </th><th>Defining RFC </th><th>Description </th></tr>
<tr><td>Identity </td></tr>
<tr><td>principal </td><td>Memo-004 </td><td>Cryptographic identity (ed25519 key or hash) </td></tr>
<tr><td>key </td><td>Memo-022 </td><td>Keypair with ceremony provenance </td></tr>
<tr><td>attestation </td><td>Memo-041 </td><td>Signed claim about identity or state </td></tr>
<tr><td>Authorization </td></tr>
<tr><td>certificate </td><td>Memo-004 </td><td>SPKI capability grant (registered) </td></tr>
<tr><td>bearer-capability </td><td>Memo-045 </td><td>Blind-signed anonymous capability </td></tr>
<tr><td>tag </td><td>Memo-004 </td><td>Authorization scope (read, write, etc.) </td></tr>
<tr><td>signature </td><td>Memo-004 </td><td>Ed25519 attestation </td></tr>
<tr><td>share </td><td>Memo-007 </td><td>Shamir secret fragment </td></tr>
<tr><td>quorum </td><td>Memo-036 </td><td>Voting threshold specification </td></tr>
<tr><td>Storage </td></tr>
<tr><td>vault </td><td>Memo-006 </td><td>Sovereign storage realm </td></tr>
<tr><td>object </td><td>Memo-020 </td><td>Content-addressed immutable data </td></tr>
<tr><td>archive </td><td>Memo-018 </td><td>Sealed, encrypted content package </td></tr>
<tr><td>schema </td><td>Memo-033 </td><td>Structure definition </td></tr>
<tr><td>Boundaries </td></tr>
<tr><td>realm </td><td>Memo-040 </td><td>Trust and sovereignty boundary </td></tr>
<tr><td>wormhole </td><td>Memo-041 </td><td>FUSE mount portal to filesystem </td></tr>
<tr><td>federation </td><td>Memo-010 </td><td>Peer network of realms </td></tr>
<tr><td>node </td><td>Memo-037 </td><td>Network participant with role </td></tr>
<tr><td>Execution </td></tr>
<tr><td>agent </td><td>Memo-023 </td><td>Sandboxed daemon </td></tr>
<tr><td>topic </td><td>Memo-035 </td><td>Pub/sub channel </td></tr>
<tr><td>tunnel </td><td>Memo-035 </td><td>Agent communication path </td></tr>
<tr><td>lock </td><td>Memo-035 </td><td>Distributed mutex </td></tr>
<tr><td>Observability </td></tr>
<tr><td>audit-entry </td><td>Memo-003 </td><td>Immutable log record </td></tr>
<tr><td>lamport-clock </td><td>Memo-012 </td><td>Causal ordering timestamp </td></tr>
<tr><td>query </td><td>Memo-025 </td><td>Search expression </td></tr>
<tr><td>Documentation </td></tr>
<tr><td>memo </td><td>Memo-043 </td><td>Scoped documentation unit </td></tr>
<tr><td>soup </td><td>Memo-040 </td><td>The auditable collection of all things </td></tr>
</table>
<h3>Object Properties</h3>
<p>All security objects share:</p>
<pre>
1. Content-addressed identity (SHA-512 hash)
2. Cryptographic signature (Ed25519)
3. Audit trail integration (Memo-003)
4. Capability-gated access (Memo-004)
5. State: chaotic | quiescent
</pre>
<h3>Object State</h3>
<p>All things in cyberspace exist in two states:</p>
<table>
<tr><th>State </th><th>Meaning </th><th>Properties </th></tr>
<tr><td>chaotic </td><td>In flux, being modified </td><td>Mutable, uncommitted, local </td></tr>
<tr><td>quiescent </td><td>At rest, stable </td><td>Immutable, signed, replicable </td></tr>
</table>
<p>Transitions:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 290 80" width="290" height="80" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">chaotic</text>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<text x="100" y="10">commit</text>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="180" y2="10"/>
<text x="200" y="10">quiescent</text>
<line x1="245" y1="19" x2="245" y2="41"/>
<line x1="45" y1="39" x2="45" y2="61"/>
<line x1="245" y1="39" x2="245" y2="61"/>
<line x1="45" y1="70" x2="50" y2="70"/>
<line x1="45" y1="59" x2="45" y2="70"/>
<line x1="50" y1="70" x2="60" y2="70"/>
<line x1="60" y1="70" x2="70" y2="70"/>
<line x1="70" y1="70" x2="80" y2="70"/>
<line x1="80" y1="70" x2="90" y2="70"/>
<line x1="90" y1="70" x2="100" y2="70"/>
<text x="110" y="70">fork</text>
<line x1="160" y1="70" x2="170" y2="70"/>
<line x1="170" y1="70" x2="180" y2="70"/>
<line x1="180" y1="70" x2="190" y2="70"/>
<line x1="190" y1="70" x2="200" y2="70"/>
<line x1="200" y1="70" x2="210" y2="70"/>
<line x1="210" y1="70" x2="220" y2="70"/>
<line x1="220" y1="70" x2="230" y2="70"/>
<line x1="230" y1="70" x2="240" y2="70"/>
<line x1="240" y1="70" x2="245" y2="70"/>
<line x1="245" y1="59" x2="245" y2="70"/>
</svg>
</div>
<p>Only quiescent objects: - Have stable content hashes - Can be signed - Can be replicated - Can be delegated</p>
<p>Chaotic things: - Exist only in the realm's store - Have provisional identity - Cannot be shared - Must settle before federation - Cannot be cached</p>
<h3>Caching Implications</h3>
<p>State controls caching:</p>
<table>
<tr><th>State </th><th>Cacheable </th><th>Reason </th></tr>
<tr><td>quiescent </td><td>Forever </td><td>Hash is identity; immutable </td></tr>
<tr><td>chaotic </td><td>Never </td><td>Content may change; no stable hash </td></tr>
</table>
<p>Quiescent things cache by content hash. Cache hit = identical content, guaranteed. Chaotic things bypass cache entirely. Every access reads current state.</p>
<h3>Persistence</h3>
<p>Persistence is the guarantee of migration to the vault.</p>
<table>
<tr><th>Durability </th><th>Meaning </th></tr>
<tr><td>persistent </td><td>Guaranteed to migrate to vault </td></tr>
<tr><td>ephemeral </td><td>May vanish; no durability promise </td></tr>
</table>
<p>State and durability are orthogonal:</p>
<table>
<tr><th>Ephemeral </th><th>Persistent </th></tr>
<tr><td>Chaotic </td><td>Scratch work </td><td>Draft being saved </td></tr>
<tr><td>Quiescent </td><td>Cached result </td><td>Archived thing </td></tr>
</table>
<p>Persistent things survive restart. Ephemeral things don't.</p>
<p>Vault takes cataloging and effort. Not all things need persistence. Ephemeral is not failure—it's deliberate economy. Cache results, scratch work, intermediate computations: let them vanish.</p>
<p>Marking a thing persistent schedules vault migration.</p>
<pre class="language-scheme">
(persist thing)    ; guarantee vault migration
(ephemeral thing)  ; no durability promise
</pre>
<h3>Object Relationships</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 510 200" width="510" height="200" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">principal</text>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<text x="120" y="10">creates</text>
<line x1="190" y1="10" x2="200" y2="10"/>
<line x1="200" y1="10" x2="210" y2="10"/>
<text x="230" y="10">certificate</text>
<line x1="350" y1="10" x2="360" y2="10"/>
<line x1="360" y1="10" x2="370" y2="10"/>
<text x="370" y="10">grants</text>
<line x1="430" y1="10" x2="440" y2="10"/>
<line x1="440" y1="10" x2="450" y2="10"/>
<text x="470" y="10">tag</text>
<line x1="45" y1="19" x2="45" y2="41"/>
<line x1="275" y1="19" x2="275" y2="41"/>
<line x1="45" y1="39" x2="45" y2="61"/>
<line x1="45" y1="59" x2="45" y2="81"/>
<text x="240" y="70">object</text>
<line x1="320" y1="70" x2="330" y2="70"/>
<line x1="330" y1="70" x2="340" y2="70"/>
<text x="340" y="70">stores</text>
<line x1="400" y1="70" x2="410" y2="70"/>
<line x1="410" y1="70" x2="420" y2="70"/>
<text x="430" y="70">vault</text>
<line x1="45" y1="79" x2="45" y2="101"/>
<line x1="275" y1="79" x2="275" y2="101"/>
<text x="20" y="130">agent</text>
<line x1="80" y1="130" x2="90" y2="130"/>
<line x1="90" y1="130" x2="100" y2="130"/>
<text x="100" y="130">operates</text>
<line x1="180" y1="130" x2="190" y2="130"/>
<line x1="190" y1="130" x2="200" y2="130"/>
<text x="220" y="130">wormhole</text>
<line x1="310" y1="130" x2="320" y2="130"/>
<line x1="320" y1="130" x2="330" y2="130"/>
<text x="330" y="130">bridges</text>
<line x1="400" y1="130" x2="410" y2="130"/>
<line x1="410" y1="130" x2="420" y2="130"/>
<text x="440" y="130">realm</text>
<line x1="45" y1="139" x2="45" y2="161"/>
<line x1="465" y1="139" x2="465" y2="161"/>
<line x1="45" y1="159" x2="45" y2="181"/>
<line x1="45" y1="190" x2="50" y2="190"/>
<line x1="45" y1="179" x2="45" y2="190"/>
<line x1="50" y1="190" x2="60" y2="190"/>
<line x1="60" y1="190" x2="70" y2="190"/>
<line x1="70" y1="190" x2="80" y2="190"/>
<line x1="80" y1="190" x2="90" y2="190"/>
<line x1="90" y1="190" x2="100" y2="190"/>
<line x1="100" y1="190" x2="110" y2="190"/>
<line x1="110" y1="190" x2="120" y2="190"/>
<line x1="120" y1="190" x2="130" y2="190"/>
<line x1="130" y1="190" x2="140" y2="190"/>
<line x1="140" y1="190" x2="150" y2="190"/>
<line x1="150" y1="190" x2="160" y2="190"/>
<line x1="160" y1="190" x2="170" y2="190"/>
<line x1="170" y1="190" x2="180" y2="190"/>
<line x1="180" y1="190" x2="190" y2="190"/>
<line x1="190" y1="190" x2="200" y2="190"/>
<line x1="200" y1="190" x2="210" y2="190"/>
<line x1="210" y1="190" x2="220" y2="190"/>
<line x1="220" y1="190" x2="230" y2="190"/>
<line x1="230" y1="190" x2="240" y2="190"/>
<line x1="240" y1="190" x2="250" y2="190"/>
<line x1="250" y1="190" x2="260" y2="190"/>
<line x1="260" y1="190" x2="270" y2="190"/>
<line x1="270" y1="190" x2="280" y2="190"/>
<line x1="280" y1="190" x2="290" y2="190"/>
<line x1="290" y1="190" x2="300" y2="190"/>
<line x1="300" y1="190" x2="310" y2="190"/>
<line x1="310" y1="190" x2="320" y2="190"/>
<line x1="320" y1="190" x2="330" y2="190"/>
<line x1="330" y1="190" x2="340" y2="190"/>
<line x1="340" y1="190" x2="350" y2="190"/>
<line x1="350" y1="190" x2="360" y2="190"/>
<line x1="360" y1="190" x2="370" y2="190"/>
<line x1="370" y1="190" x2="380" y2="190"/>
<line x1="380" y1="190" x2="390" y2="190"/>
<text x="410" y="190">federation</text>
</svg>
</div>
</section>
<section>
<h2>The Axioms</h2>
<pre>
A1. No Ambient Authority
    You have nothing until someone gives you something.
    Every access requires presenting a capability.

A2. Capabilities Are Unforgeable
    Ed25519 signatures. No exceptions.
    Create by origin or delegation. No other path.

A3. Capabilities Only Attenuate
    Delegation can reduce rights, never amplify.
    What you give cannot exceed what you hold.

A4. Objects Are Immutable Content
    SHA-512 hash IS identity.
    No metadata. No labels. No ACLs.
    Objects don't know who can access them.
</pre>
</section>
<section>
<h2>The Realm</h2>
<p>A realm is your place in cyberspace. It is sovereign.</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 630 300" width="630" height="300" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<line x1="5" y1="10" x2="10" y2="10"/>
<line x1="5" y1="10" x2="5" y2="21"/>
<line x1="10" y1="10" x2="20" y2="10"/>
<line x1="20" y1="10" x2="30" y2="10"/>
<line x1="30" y1="10" x2="40" y2="10"/>
<line x1="40" y1="10" x2="50" y2="10"/>
<line x1="50" y1="10" x2="60" y2="10"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="160" y2="10"/>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="180" y2="10"/>
<line x1="180" y1="10" x2="190" y2="10"/>
<line x1="190" y1="10" x2="200" y2="10"/>
<line x1="200" y1="10" x2="210" y2="10"/>
<line x1="210" y1="10" x2="220" y2="10"/>
<line x1="220" y1="10" x2="230" y2="10"/>
<line x1="230" y1="10" x2="240" y2="10"/>
<line x1="240" y1="10" x2="250" y2="10"/>
<line x1="250" y1="10" x2="260" y2="10"/>
<line x1="260" y1="10" x2="270" y2="10"/>
<line x1="270" y1="10" x2="280" y2="10"/>
<line x1="280" y1="10" x2="290" y2="10"/>
<line x1="290" y1="10" x2="300" y2="10"/>
<line x1="300" y1="10" x2="310" y2="10"/>
<line x1="310" y1="10" x2="320" y2="10"/>
<line x1="320" y1="10" x2="330" y2="10"/>
<line x1="330" y1="10" x2="340" y2="10"/>
<line x1="340" y1="10" x2="350" y2="10"/>
<line x1="350" y1="10" x2="360" y2="10"/>
<line x1="360" y1="10" x2="370" y2="10"/>
<line x1="370" y1="10" x2="380" y2="10"/>
<line x1="380" y1="10" x2="390" y2="10"/>
<line x1="390" y1="10" x2="400" y2="10"/>
<line x1="400" y1="10" x2="410" y2="10"/>
<line x1="410" y1="10" x2="420" y2="10"/>
<line x1="420" y1="10" x2="430" y2="10"/>
<line x1="430" y1="10" x2="440" y2="10"/>
<line x1="440" y1="10" x2="450" y2="10"/>
<line x1="450" y1="10" x2="460" y2="10"/>
<line x1="460" y1="10" x2="470" y2="10"/>
<line x1="470" y1="10" x2="480" y2="10"/>
<line x1="480" y1="10" x2="490" y2="10"/>
<line x1="490" y1="10" x2="500" y2="10"/>
<line x1="500" y1="10" x2="510" y2="10"/>
<line x1="510" y1="10" x2="520" y2="10"/>
<line x1="520" y1="10" x2="530" y2="10"/>
<line x1="530" y1="10" x2="540" y2="10"/>
<line x1="540" y1="10" x2="550" y2="10"/>
<line x1="550" y1="10" x2="560" y2="10"/>
<line x1="560" y1="10" x2="570" y2="10"/>
<line x1="570" y1="10" x2="580" y2="10"/>
<line x1="580" y1="10" x2="590" y2="10"/>
<line x1="590" y1="10" x2="600" y2="10"/>
<line x1="600" y1="10" x2="610" y2="10"/>
<line x1="610" y1="10" x2="620" y2="10"/>
<line x1="620" y1="10" x2="625" y2="10"/>
<line x1="625" y1="10" x2="625" y2="21"/>
<line x1="5" y1="19" x2="5" y2="41"/>
<text x="250" y="30">YOUR</text>
<text x="300" y="30">REALM</text>
<line x1="625" y1="19" x2="625" y2="41"/>
<line x1="5" y1="39" x2="5" y2="61"/>
<line x1="625" y1="39" x2="625" y2="61"/>
<line x1="5" y1="59" x2="5" y2="81"/>
<text x="40" y="70">Principal:</text>
<text x="150" y="70">ed25519:a1b2c3...</text>
<text x="340" y="70">(this</text>
<text x="400" y="70">is</text>
<text x="430" y="70">you)</text>
<line x1="625" y1="59" x2="625" y2="81"/>
<line x1="5" y1="79" x2="5" y2="101"/>
<line x1="625" y1="79" x2="625" y2="101"/>
<line x1="5" y1="99" x2="5" y2="121"/>
<line x1="45" y1="110" x2="50" y2="110"/>
<line x1="45" y1="110" x2="45" y2="121"/>
<line x1="50" y1="110" x2="60" y2="110"/>
<line x1="60" y1="110" x2="70" y2="110"/>
<line x1="70" y1="110" x2="80" y2="110"/>
<line x1="80" y1="110" x2="90" y2="110"/>
<line x1="90" y1="110" x2="100" y2="110"/>
<line x1="100" y1="110" x2="110" y2="110"/>
<line x1="110" y1="110" x2="120" y2="110"/>
<line x1="120" y1="110" x2="130" y2="110"/>
<line x1="130" y1="110" x2="140" y2="110"/>
<line x1="140" y1="110" x2="150" y2="110"/>
<line x1="150" y1="110" x2="160" y2="110"/>
<line x1="160" y1="110" x2="170" y2="110"/>
<line x1="170" y1="110" x2="180" y2="110"/>
<line x1="180" y1="110" x2="190" y2="110"/>
<line x1="190" y1="110" x2="200" y2="110"/>
<line x1="200" y1="110" x2="210" y2="110"/>
<line x1="210" y1="110" x2="220" y2="110"/>
<line x1="220" y1="110" x2="230" y2="110"/>
<line x1="230" y1="110" x2="240" y2="110"/>
<line x1="240" y1="110" x2="250" y2="110"/>
<line x1="250" y1="110" x2="260" y2="110"/>
<line x1="260" y1="110" x2="270" y2="110"/>
<line x1="270" y1="110" x2="280" y2="110"/>
<line x1="280" y1="110" x2="290" y2="110"/>
<line x1="290" y1="110" x2="300" y2="110"/>
<line x1="300" y1="110" x2="310" y2="110"/>
<line x1="310" y1="110" x2="320" y2="110"/>
<line x1="320" y1="110" x2="330" y2="110"/>
<line x1="330" y1="110" x2="340" y2="110"/>
<line x1="340" y1="110" x2="350" y2="110"/>
<line x1="350" y1="110" x2="360" y2="110"/>
<line x1="360" y1="110" x2="370" y2="110"/>
<line x1="370" y1="110" x2="380" y2="110"/>
<line x1="380" y1="110" x2="390" y2="110"/>
<line x1="390" y1="110" x2="400" y2="110"/>
<line x1="400" y1="110" x2="410" y2="110"/>
<line x1="410" y1="110" x2="420" y2="110"/>
<line x1="420" y1="110" x2="430" y2="110"/>
<line x1="430" y1="110" x2="440" y2="110"/>
<line x1="440" y1="110" x2="450" y2="110"/>
<line x1="450" y1="110" x2="460" y2="110"/>
<line x1="460" y1="110" x2="470" y2="110"/>
<line x1="470" y1="110" x2="480" y2="110"/>
<line x1="480" y1="110" x2="490" y2="110"/>
<line x1="490" y1="110" x2="500" y2="110"/>
<line x1="500" y1="110" x2="510" y2="110"/>
<line x1="510" y1="110" x2="520" y2="110"/>
<line x1="520" y1="110" x2="530" y2="110"/>
<line x1="530" y1="110" x2="540" y2="110"/>
<line x1="540" y1="110" x2="550" y2="110"/>
<line x1="550" y1="110" x2="560" y2="110"/>
<line x1="560" y1="110" x2="570" y2="110"/>
<line x1="570" y1="110" x2="580" y2="110"/>
<line x1="580" y1="110" x2="590" y2="110"/>
<line x1="590" y1="110" x2="595" y2="110"/>
<line x1="595" y1="110" x2="595" y2="121"/>
<line x1="625" y1="99" x2="625" y2="121"/>
<line x1="5" y1="119" x2="5" y2="141"/>
<line x1="45" y1="119" x2="45" y2="141"/>
<text x="270" y="130">VAULT</text>
<line x1="595" y1="119" x2="595" y2="141"/>
<line x1="625" y1="119" x2="625" y2="141"/>
<line x1="5" y1="139" x2="5" y2="161"/>
<line x1="45" y1="139" x2="45" y2="161"/>
<text x="70" y="150">Objects:</text>
<text x="200" y="150">content-addressed,</text>
<text x="390" y="150">signed</text>
<line x1="595" y1="139" x2="595" y2="161"/>
<line x1="625" y1="139" x2="625" y2="161"/>
<line x1="5" y1="159" x2="5" y2="181"/>
<line x1="45" y1="159" x2="45" y2="181"/>
<text x="70" y="170">Capabilities:</text>
<text x="210" y="170">certificates</text>
<text x="340" y="170">you</text>
<text x="380" y="170">hold</text>
<line x1="595" y1="159" x2="595" y2="181"/>
<line x1="625" y1="159" x2="625" y2="181"/>
<line x1="5" y1="179" x2="5" y2="201"/>
<line x1="45" y1="179" x2="45" y2="201"/>
<text x="70" y="190">Audit:</text>
<text x="200" y="190">what</text>
<text x="250" y="190">happened</text>
<text x="340" y="190">here</text>
<line x1="595" y1="179" x2="595" y2="201"/>
<line x1="625" y1="179" x2="625" y2="201"/>
<line x1="5" y1="199" x2="5" y2="221"/>
<line x1="45" y1="210" x2="50" y2="210"/>
<line x1="45" y1="199" x2="45" y2="210"/>
<line x1="50" y1="210" x2="60" y2="210"/>
<line x1="60" y1="210" x2="70" y2="210"/>
<line x1="70" y1="210" x2="80" y2="210"/>
<line x1="80" y1="210" x2="90" y2="210"/>
<line x1="90" y1="210" x2="100" y2="210"/>
<line x1="100" y1="210" x2="110" y2="210"/>
<line x1="110" y1="210" x2="120" y2="210"/>
<line x1="120" y1="210" x2="130" y2="210"/>
<line x1="130" y1="210" x2="140" y2="210"/>
<line x1="140" y1="210" x2="150" y2="210"/>
<line x1="150" y1="210" x2="160" y2="210"/>
<line x1="160" y1="210" x2="170" y2="210"/>
<line x1="170" y1="210" x2="180" y2="210"/>
<line x1="180" y1="210" x2="190" y2="210"/>
<line x1="190" y1="210" x2="200" y2="210"/>
<line x1="200" y1="210" x2="210" y2="210"/>
<line x1="210" y1="210" x2="220" y2="210"/>
<line x1="220" y1="210" x2="230" y2="210"/>
<line x1="230" y1="210" x2="240" y2="210"/>
<line x1="240" y1="210" x2="250" y2="210"/>
<line x1="250" y1="210" x2="260" y2="210"/>
<line x1="260" y1="210" x2="270" y2="210"/>
<line x1="270" y1="210" x2="280" y2="210"/>
<line x1="280" y1="210" x2="290" y2="210"/>
<line x1="290" y1="210" x2="300" y2="210"/>
<line x1="300" y1="210" x2="310" y2="210"/>
<line x1="310" y1="210" x2="320" y2="210"/>
<line x1="320" y1="210" x2="330" y2="210"/>
<line x1="330" y1="210" x2="340" y2="210"/>
<line x1="340" y1="210" x2="350" y2="210"/>
<line x1="350" y1="210" x2="360" y2="210"/>
<line x1="360" y1="210" x2="370" y2="210"/>
<line x1="370" y1="210" x2="380" y2="210"/>
<line x1="380" y1="210" x2="390" y2="210"/>
<line x1="390" y1="210" x2="400" y2="210"/>
<line x1="400" y1="210" x2="410" y2="210"/>
<line x1="410" y1="210" x2="420" y2="210"/>
<line x1="420" y1="210" x2="430" y2="210"/>
<line x1="430" y1="210" x2="440" y2="210"/>
<line x1="440" y1="210" x2="450" y2="210"/>
<line x1="450" y1="210" x2="460" y2="210"/>
<line x1="460" y1="210" x2="470" y2="210"/>
<line x1="470" y1="210" x2="480" y2="210"/>
<line x1="480" y1="210" x2="490" y2="210"/>
<line x1="490" y1="210" x2="500" y2="210"/>
<line x1="500" y1="210" x2="510" y2="210"/>
<line x1="510" y1="210" x2="520" y2="210"/>
<line x1="520" y1="210" x2="530" y2="210"/>
<line x1="530" y1="210" x2="540" y2="210"/>
<line x1="540" y1="210" x2="550" y2="210"/>
<line x1="550" y1="210" x2="560" y2="210"/>
<line x1="560" y1="210" x2="570" y2="210"/>
<line x1="570" y1="210" x2="580" y2="210"/>
<line x1="580" y1="210" x2="590" y2="210"/>
<line x1="590" y1="210" x2="595" y2="210"/>
<line x1="595" y1="199" x2="595" y2="210"/>
<line x1="625" y1="199" x2="625" y2="221"/>
<line x1="5" y1="219" x2="5" y2="241"/>
<line x1="625" y1="219" x2="625" y2="241"/>
<line x1="5" y1="239" x2="5" y2="261"/>
<text x="40" y="250">Trust</text>
<text x="100" y="250">boundary:</text>
<text x="200" y="250">your</text>
<text x="250" y="250">signing</text>
<text x="330" y="250">key</text>
<line x1="625" y1="239" x2="625" y2="261"/>
<line x1="5" y1="259" x2="5" y2="281"/>
<text x="40" y="270">You</text>
<text x="80" y="270">decide:</text>
<text x="160" y="270">what</text>
<text x="210" y="270">to</text>
<text x="240" y="270">store,</text>
<text x="310" y="270">who</text>
<text x="350" y="270">to</text>
<text x="380" y="270">trust,</text>
<text x="450" y="270">what</text>
<text x="500" y="270">to</text>
<text x="530" y="270">share</text>
<line x1="625" y1="259" x2="625" y2="281"/>
<line x1="5" y1="290" x2="10" y2="290"/>
<line x1="5" y1="279" x2="5" y2="290"/>
<line x1="10" y1="290" x2="20" y2="290"/>
<line x1="20" y1="290" x2="30" y2="290"/>
<line x1="30" y1="290" x2="40" y2="290"/>
<line x1="40" y1="290" x2="50" y2="290"/>
<line x1="50" y1="290" x2="60" y2="290"/>
<line x1="60" y1="290" x2="70" y2="290"/>
<line x1="70" y1="290" x2="80" y2="290"/>
<line x1="80" y1="290" x2="90" y2="290"/>
<line x1="90" y1="290" x2="100" y2="290"/>
<line x1="100" y1="290" x2="110" y2="290"/>
<line x1="110" y1="290" x2="120" y2="290"/>
<line x1="120" y1="290" x2="130" y2="290"/>
<line x1="130" y1="290" x2="140" y2="290"/>
<line x1="140" y1="290" x2="150" y2="290"/>
<line x1="150" y1="290" x2="160" y2="290"/>
<line x1="160" y1="290" x2="170" y2="290"/>
<line x1="170" y1="290" x2="180" y2="290"/>
<line x1="180" y1="290" x2="190" y2="290"/>
<line x1="190" y1="290" x2="200" y2="290"/>
<line x1="200" y1="290" x2="210" y2="290"/>
<line x1="210" y1="290" x2="220" y2="290"/>
<line x1="220" y1="290" x2="230" y2="290"/>
<line x1="230" y1="290" x2="240" y2="290"/>
<line x1="240" y1="290" x2="250" y2="290"/>
<line x1="250" y1="290" x2="260" y2="290"/>
<line x1="260" y1="290" x2="270" y2="290"/>
<line x1="270" y1="290" x2="280" y2="290"/>
<line x1="280" y1="290" x2="290" y2="290"/>
<line x1="290" y1="290" x2="300" y2="290"/>
<line x1="300" y1="290" x2="310" y2="290"/>
<line x1="310" y1="290" x2="320" y2="290"/>
<line x1="320" y1="290" x2="330" y2="290"/>
<line x1="330" y1="290" x2="340" y2="290"/>
<line x1="340" y1="290" x2="350" y2="290"/>
<line x1="350" y1="290" x2="360" y2="290"/>
<line x1="360" y1="290" x2="370" y2="290"/>
<line x1="370" y1="290" x2="380" y2="290"/>
<line x1="380" y1="290" x2="390" y2="290"/>
<line x1="390" y1="290" x2="400" y2="290"/>
<line x1="400" y1="290" x2="410" y2="290"/>
<line x1="410" y1="290" x2="420" y2="290"/>
<line x1="420" y1="290" x2="430" y2="290"/>
<line x1="430" y1="290" x2="440" y2="290"/>
<line x1="440" y1="290" x2="450" y2="290"/>
<line x1="450" y1="290" x2="460" y2="290"/>
<line x1="460" y1="290" x2="470" y2="290"/>
<line x1="470" y1="290" x2="480" y2="290"/>
<line x1="480" y1="290" x2="490" y2="290"/>
<line x1="490" y1="290" x2="500" y2="290"/>
<line x1="500" y1="290" x2="510" y2="290"/>
<line x1="510" y1="290" x2="520" y2="290"/>
<line x1="520" y1="290" x2="530" y2="290"/>
<line x1="530" y1="290" x2="540" y2="290"/>
<line x1="540" y1="290" x2="550" y2="290"/>
<line x1="550" y1="290" x2="560" y2="290"/>
<line x1="560" y1="290" x2="570" y2="290"/>
<line x1="570" y1="290" x2="580" y2="290"/>
<line x1="580" y1="290" x2="590" y2="290"/>
<line x1="590" y1="290" x2="600" y2="290"/>
<line x1="600" y1="290" x2="610" y2="290"/>
<line x1="610" y1="290" x2="620" y2="290"/>
<line x1="620" y1="290" x2="625" y2="290"/>
<line x1="625" y1="279" x2="625" y2="290"/>
</svg>
</div>
<p>Your realm is local-first. Federation is optional. When you federate, realms overlap - objects flow according to capability chains. But your realm remains yours.</p>
</section>
<section>
<h2>Capabilities</h2>
<h3>The Certificate</h3>
<pre class="language-scheme">
(spki-cert
  (issuer "ed25519:alice...")        ; Who grants
  (subject "ed25519:bob...")         ; Who receives
  (tag (read "sha512:doc..."))       ; What: read this object
  (valid (not-after 1736400000))     ; When: expires in 24h
  (propagate #f)                     ; Bob cannot delegate
  (signature "ed25519:..."))         ; Alice's signature
</pre>
<h3>Access Check</h3>
<pre>
Can Bob read sha512:doc?

1. Does Bob hold a cert granting (read "sha512:doc")?
2. Is the signature valid?
3. Is it expired?
4. Is it revoked?
5. Does the chain trace to someone who could grant it?

All yes? Access granted.
Any no?  Access denied.
</pre>
<h3>Delegation</h3>
<p>Alice can give Bob read access:</p>
<pre class="language-scheme">
(spki-cert
  (issuer "ed25519:alice...")
  (subject "ed25519:bob...")
  (tag (read "sha512:doc..."))
  (propagate #t))                    ; Bob CAN delegate
</pre>
<p>Bob can give Carol read access (because Alice allowed propagation):</p>
<pre class="language-scheme">
(spki-cert
  (issuer "ed25519:bob...")
  (subject "ed25519:carol...")
  (tag (read "sha512:doc..."))
  (propagate #f))                    ; Carol cannot delegate further
</pre>
<p>Carol cannot give anyone else access. The chain stops.</p>
</section>
<section>
<h2>Classification Without Labels</h2>
<p>Traditional MAC puts labels on objects: UNCLASSIFIED, SECRET, TOP SECRET.</p>
<p>In cyberspace, classification is a capability you hold:</p>
<pre class="language-scheme">
;; Security officer grants SECRET clearance
(spki-cert
  (issuer "ed25519:security-officer...")
  (subject "ed25519:analyst...")
  (tag (clearance secret))
  (valid (not-after 1767225600)))    ; Annual renewal

;; Program manager grants compartment access
(spki-cert
  (issuer "ed25519:program-manager...")
  (subject "ed25519:engineer...")
  (tag (compartment "project-atlas")))
</pre>
<p>Access to a classified object requires: 1. Capability to read the object itself 2. Appropriate clearance capability 3. All required compartment capabilities</p>
<p>The object has no labels. The policy lives in the certificates.</p>
</section>
<section>
<h2>Information Flow</h2>
<p>The mathematics of multilevel security, expressed in capabilities.</p>
<h3>The Properties</h3>
<p>Traditional formulations speak of "read up" and "write down" with respect to classification labels. We preserve the mathematics but speak differently:</p>
<table>
<tr><th>Traditional </th><th>Cyberspace </th><th>Formal Statement </th></tr>
<tr><td>"No read up" </td><td>Read requires capability </td><td>∀ read(P,O): P ∈ holders(cap_read(O)) </td></tr>
<tr><td>"No write down" </td><td>Write requires capability </td><td>∀ write(P,O): P ∈ holders(cap_write(O)) </td></tr>
<tr><td>"No read down" </td><td>Integrity via provenance </td><td>∀ accept(P,O): verify(signature(O)) </td></tr>
<tr><td>"No write up" </td><td>Attenuation only </td><td>∀ delegate(P₁,P₂,C): C ⊆ capabilities(P₁) </td></tr>
</table>
<p>The capability graph IS the lattice. Delegation flows down. Authority cannot flow up.</p>
<h3>Beyond Bell-LaPadula and Biba</h3>
<p>Bell-LaPadula (1973) and Biba (1977) formalized information flow as lattice properties enforced by a central reference monitor. Both require:</p>
<ul>
<li>Security labels attached to subjects and objects</li>
<li>A trusted reference monitor that mediates all access</li>
<li>Hierarchical classification (UNCLASSIFIED &lt; SECRET &lt; TOP SECRET)</li>
</ul>
<p>Cyberspace inverts this architecture:</p>
<table>
<tr><th>Traditional MAC </th><th>Capability-Based Flow </th></tr>
<tr><td>Labels on objects </td><td>No labels—objects are just content </td></tr>
<tr><td>Central reference monitor </td><td>Decentralized verification </td></tr>
<tr><td>Policy in the monitor </td><td>Policy in the certificates </td></tr>
<tr><td>Lattice of security levels </td><td>Graph of capability delegation </td></tr>
<tr><td>Clearance assigned by authority </td><td>Capability granted by delegation </td></tr>
</table>
<p>The key insight: information flow is measurable. Every channel has bandwidth—bits per second, bytes per second. Shannon's information theory applies. If you can measure the flow, you can reason about where information leaks.</p>
<p>In capability systems, the flow is explicit: you hold a capability or you don't. The audit trail records every exercise. Covert channels remain (timing, storage), but the overt channels are precisely the capability graph. No hidden ambient authority. No implicit flows through the reference monitor's state.</p>
<p>This is not weaker than MAC—it's differently shaped. Bell-LaPadula prevents "read up" by checking labels; capabilities prevent it by requiring possession. The math is equivalent; the architecture is decentralized.</p>
<h3>Confidentiality</h3>
<p>Information flows only through capabilities:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 410 60" width="410" height="60" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">∀</text>
<text x="20" y="10">read(P,O):</text>
<text x="130" y="10">P</text>
<text x="150" y="10">∈</text>
<text x="170" y="10">holders(capread(O))</text>
<text x="0" y="30">∀</text>
<text x="20" y="30">write(P,O):</text>
<text x="140" y="30">P</text>
<text x="160" y="30">∈</text>
<text x="180" y="30">holders(capwrite(O))</text>
<text x="0" y="50">∀</text>
<text x="20" y="50">delegate(P₁,P₂,C):</text>
<text x="210" y="50">C</text>
<text x="230" y="50">⊆</text>
<text x="250" y="50">capabilities(P₁)</text>
</svg>
</div>
<p>A principal without read capability cannot observe content. A principal without write capability cannot exfiltrate via storage. Delegation cannot grant what you don't hold.</p>
<h3>Integrity</h3>
<p>Modification flows only through capabilities:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 500 60" width="500" height="60" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">∀</text>
<text x="20" y="10">modify(P,O):</text>
<text x="150" y="10">P</text>
<text x="170" y="10">∈</text>
<text x="190" y="10">holders(capwrite(O))</text>
<text x="0" y="30">∀</text>
<text x="20" y="30">delegate(P₁,P₂,C'):</text>
<text x="220" y="30">integrity(C')</text>
<text x="360" y="30">≤</text>
<text x="380" y="30">integrity(C)</text>
<text x="0" y="50">∀</text>
<text x="20" y="50">capability</text>
<text x="130" y="50">C:</text>
<text x="160" y="50">provenance(C)</text>
<text x="300" y="50">⊆</text>
<text x="320" y="50">audittrail</text>
</svg>
</div>
<p>Objects cannot be corrupted without write capability. Delegated capabilities cannot exceed held capabilities. All grants are traceable.</p>
<h3>Confinement</h3>
<p>The capability discipline eliminates ambient authority:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 530 60" width="530" height="60" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">∀</text>
<text x="20" y="10">access(P,O):</text>
<text x="150" y="10">∃</text>
<text x="170" y="10">C</text>
<text x="190" y="10">∈</text>
<text x="210" y="10">capabilities(P):</text>
<text x="380" y="10">authorizes(C,O)</text>
<text x="0" y="30">∀</text>
<text x="20" y="30">C:</text>
<text x="50" y="30">unforgeable(C)</text>
<text x="0" y="50">∀</text>
<text x="20" y="50">acquire(P,C):</text>
<text x="160" y="50">∃</text>
<text x="180" y="50">P':</text>
<text x="220" y="50">delegate(P',P,C)</text>
<text x="390" y="50">∨</text>
<text x="410" y="50">create(P,O)</text>
</svg>
</div>
<p>No access without explicit capability. Capabilities cannot be manufactured. The only paths: receive via delegation, or create the object.</p>
<h3>Wormhole Enforcement</h3>
<p>Wormholes (Memo-041) are channel boundaries. Information flow is enforced at every crossing:</p>
<pre class="language-scheme">
(wormhole-flow-guard wormhole operation object)
  ;; Checks:
  ;; 1. wormhole has capabilities (no ambient authority)
  ;; 2. operation permitted by held capabilities
  ;; 3. audit entry created
</pre>
<table>
<tr><th>Operation </th><th>Required Capability </th><th>Violation Type </th></tr>
<tr><td>read, stat, readdir </td><td>read </td><td>confidentiality </td></tr>
<tr><td>write, create, chmod </td><td>write </td><td>integrity </td></tr>
<tr><td>delete, unlink </td><td>delete </td><td>integrity </td></tr>
<tr><td>delegate </td><td>delegate </td><td>amplification </td></tr>
</table>
<p>Denied operations raise typed errors: - no-ambient-authority — wormhole has no capabilities - read-denied — missing read capability - write-denied — missing write capability - capability-amplification — delegation exceeds held</p>
<h3>The Lattice</h3>
<p>Capabilities form a partial order. The lattice:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 240 220" width="240" height="220" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="80" y="10">full</text>
<line x1="105" y1="19" x2="105" y2="41"/>
<line x1="45" y1="50" x2="50" y2="50"/>
<line x1="45" y1="50" x2="45" y2="61"/>
<line x1="50" y1="50" x2="60" y2="50"/>
<line x1="60" y1="50" x2="70" y2="50"/>
<line x1="70" y1="50" x2="80" y2="50"/>
<line x1="80" y1="50" x2="90" y2="50"/>
<line x1="90" y1="50" x2="100" y2="50"/>
<line x1="100" y1="50" x2="110" y2="50"/>
<line x1="105" y1="39" x2="105" y2="61"/>
<line x1="110" y1="50" x2="120" y2="50"/>
<line x1="120" y1="50" x2="130" y2="50"/>
<line x1="130" y1="50" x2="140" y2="50"/>
<line x1="140" y1="50" x2="150" y2="50"/>
<line x1="150" y1="50" x2="160" y2="50"/>
<line x1="160" y1="50" x2="165" y2="50"/>
<line x1="165" y1="50" x2="165" y2="61"/>
<line x1="45" y1="59" x2="45" y2="81"/>
<line x1="105" y1="59" x2="105" y2="81"/>
<line x1="165" y1="59" x2="165" y2="81"/>
<text x="20" y="90">admin</text>
<text x="80" y="90">synch</text>
<text x="140" y="90">read-write</text>
<line x1="45" y1="99" x2="45" y2="121"/>
<line x1="105" y1="99" x2="105" y2="121"/>
<line x1="165" y1="99" x2="165" y2="121"/>
<line x1="45" y1="130" x2="50" y2="130"/>
<line x1="45" y1="119" x2="45" y2="130"/>
<line x1="50" y1="130" x2="60" y2="130"/>
<line x1="60" y1="130" x2="70" y2="130"/>
<line x1="70" y1="130" x2="80" y2="130"/>
<line x1="80" y1="130" x2="90" y2="130"/>
<line x1="90" y1="130" x2="100" y2="130"/>
<line x1="100" y1="130" x2="110" y2="130"/>
<line x1="105" y1="119" x2="105" y2="141"/>
<line x1="110" y1="130" x2="120" y2="130"/>
<line x1="120" y1="130" x2="130" y2="130"/>
<line x1="130" y1="130" x2="140" y2="130"/>
<line x1="140" y1="130" x2="150" y2="130"/>
<line x1="150" y1="130" x2="160" y2="130"/>
<line x1="160" y1="130" x2="165" y2="130"/>
<line x1="165" y1="119" x2="165" y2="130"/>
<line x1="105" y1="139" x2="105" y2="161"/>
<text x="60" y="170">read-only</text>
<line x1="105" y1="179" x2="105" y2="201"/>
<text x="80" y="210">none</text>
</svg>
</div>
<p>Delegation can only move DOWN the lattice. This is attenuation. You cannot delegate admin if you hold read-only. You cannot grant write if you hold read.</p>
<p>The math is sound. We just speak it in capabilities.</p>
</section>
<section>
<h2>Unlinkability</h2>
<p>Chaum's insight (1983): you can prove authorization without revealing identity. Blind signatures create credentials that are verifiable but unlinkable - the issuer cannot connect the credential to the presentation.</p>
<p>This creates architectural tension with audit trails. Cyberspace values both accountability and privacy. The resolution: capabilities come in two forms.</p>
<h3>Registered vs Bearer Capabilities</h3>
<table>
<tr><th>Property </th><th>Registered (SPKI) </th><th>Bearer (Blinded) </th></tr>
<tr><td>Subject field </td><td>Principal identified </td><td>Anonymous holder </td></tr>
<tr><td>Audit trail </td><td>Who did what </td><td>What was done </td></tr>
<tr><td>Revocation </td><td>By subject </td><td>By capability hash </td></tr>
<tr><td>Delegation </td><td>To named principals </td><td>Not delegable </td></tr>
<tr><td>Use case </td><td>Accountability </td><td>Privacy </td></tr>
</table>
<p>Registered capabilities are checks - they name the bearer. Bearer capabilities are cash - whoever holds them can spend them.</p>
<h3>Blind Signature Protocol</h3>
<p>Alice wants to exercise a capability without revealing she's Alice:</p>
<pre>
1. Alice proves to Issuer she holds capability C
2. Alice generates random blinding factor r
3. Alice computes blinded = blind(token, r)
4. Issuer signs: sig = sign(blinded)
5. Alice unblinds: bearer_sig = unblind(sig, r)
6. Alice presents (token, bearer_sig) anonymously
7. Verifier confirms Issuer's signature without learning Alice's identity
</pre>
<p>The Issuer knows Alice was authorized (step 1) but cannot link the bearer credential (step 6) to Alice. Unlinkability is mathematical, not policy.</p>
<h3>Cyberspace Integration</h3>
<pre class="language-scheme">
;; Request blinded capability (proves eligibility, gets blind-signed token)
(define (capability-blind issuer tag)
  "Get bearer capability for tag, unlinkable to principal"
  (let* ((token (random-bytes 32))
         (r (blind-factor-generate))
         (blinded (blind token r)))
    ;; Prove we hold registered capability for this tag
    ;; Issuer signs blinded token
    (let ((blind-sig (issuer-sign-blinded issuer blinded tag)))
      ;; Unblind locally
      (make-bearer-capability
        token: token
        signature: (unblind blind-sig r)
        tag: tag
        issuer: issuer))))

;; Exercise bearer capability
(define (capability-exercise-bearer cap object)
  "Exercise capability without revealing identity"
  (let ((token (bearer-capability-token cap))
        (sig (bearer-capability-signature cap))
        (tag (bearer-capability-tag cap))
        (issuer (bearer-capability-issuer cap)))
    ;; Verify issuer signed this token for this tag
    (unless (blind-signature-verify issuer token sig tag)
      (error 'invalid-bearer-capability))
    ;; Audit records capability exercise, not principal
    (audit-append action: 'bearer-exercise
                  capability: (sha512 token)
                  tag: tag
                  actor: 'anonymous)
    ;; Perform operation
    (perform-operation tag object)))
</pre>
<p>The audit trail records that a valid bearer capability was exercised, but not who exercised it. The capability hash enables revocation without identification.</p>
<h3>Use Cases</h3>
<table>
<tr><th>Operation </th><th>Why Unlinkability </th></tr>
<tr><td>Quorum voting </td><td>Prove eligibility without linking vote to voter </td></tr>
<tr><td>Whistleblower submission </td><td>Submit evidence without identification </td></tr>
<tr><td>Anonymous reads </td><td>Access sensitive content without tracking </td></tr>
<tr><td>Credential presentation </td><td>Prove role without revealing principal </td></tr>
<tr><td>Rate-limited tokens </td><td>Prevent abuse without profiling users </td></tr>
</table>
<p>Non-use-cases (accountability required):</p>
<ul>
<li>Writes - usually need to know who modified</li>
<li>Delegation - must name the delegate</li>
<li>Administrative actions - audit trail essential</li>
</ul>
<h3>The Tradeoff</h3>
<p>Bearer capabilities sacrifice traceability for privacy. Once issued, the issuer cannot:</p>
<ul>
<li>Determine who exercised the capability</li>
<li>Link multiple exercises to the same principal</li>
<li>Revoke based on principal (only by capability hash)</li>
</ul>
<p>This is the point. Chaum solved the double-spending problem for digital cash without a public ledger - the bank couldn't track who spent what. Bitcoin retreated from this by making all transactions public. Cyberspace preserves the choice: registered capabilities when you need accountability, bearer capabilities when you need privacy.</p>
<p>The axioms still hold:</p>
<pre>
A1. No Ambient Authority - still need a capability
A2. Capabilities Are Unforgeable - blind signatures are Ed25519
A3. Capabilities Only Attenuate - bearer caps cannot delegate
A4. Objects Are Immutable - unchanged
</pre>
<p>Unlinkability is orthogonal to authorization. You still need permission; you just don't have to identify yourself to use it.</p>
</section>
<section>
<h2>Secure Erasure</h2>
<p>When sensitive data must be destroyed, it must be destroyed completely.</p>
<h3>Erasure Requirements</h3>
<table>
<tr><th>What </th><th>How </th><th>Verification </th></tr>
<tr><td>Object content </td><td>Overwrite with random, then zeros </td><td>Read-back verify </td></tr>
<tr><td>Memory buffers </td><td>Secure memset, compiler barrier </td><td>Not optimized away </td></tr>
<tr><td>Key material </td><td>Zeroize immediately after use </td><td>Audit trail entry </td></tr>
<tr><td>Audit entries </td><td>Preserve hash chain, redact content </td><td>Chain integrity </td></tr>
<tr><td>Capability certs </td><td>Revoke, then destroy </td><td>Revocation published </td></tr>
</table>
<h3>Erasure Guarantees</h3>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 570 160" width="570" height="160" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">E1.</text>
<text x="40" y="10">Zeroization</text>
<text x="160" y="10">is</text>
<text x="190" y="10">atomic</text>
<text x="40" y="30">erase(o)</text>
<text x="150" y="30">¬recoverable(o)</text>
<text x="0" y="50">E2.</text>
<text x="40" y="50">Memory</text>
<text x="110" y="50">clearing</text>
<text x="200" y="50">defeats</text>
<text x="280" y="50">inspection</text>
<text x="40" y="70">clear(buffer)</text>
<text x="200" y="70">∀</text>
<text x="220" y="70">address</text>
<text x="300" y="70">∈</text>
<text x="320" y="70">buffer:</text>
<text x="400" y="70">read(address)</text>
<text x="540" y="70">=</text>
<text x="560" y="70">0</text>
<text x="0" y="90">E3.</text>
<text x="40" y="90">Key</text>
<text x="80" y="90">destruction</text>
<text x="200" y="90">is</text>
<text x="230" y="90">immediate</text>
<text x="40" y="110">destroy(key)</text>
<text x="190" y="110">¬usable(key)</text>
<text x="320" y="110">∧</text>
<text x="340" y="110">audit(destroyed,</text>
<text x="510" y="110">key)</text>
<text x="0" y="130">E4.</text>
<text x="40" y="130">Revocation</text>
<text x="150" y="130">propagates</text>
<text x="40" y="150">revoke(cert)</text>
<text x="190" y="150">∀</text>
<text x="210" y="150">delegate(cert,</text>
<text x="360" y="150">c'):</text>
<text x="410" y="150">revoke(c')</text>
</svg>
</div>
<h3>Implementation</h3>
<pre class="language-scheme">
;; Secure memory clearing (defeats compiler optimization)
(define (secure-clear! buffer)
  "Overwrite buffer with zeros, verify"
  (let ((len (blob-size buffer)))
    ;; Write zeros
    (do ((i 0 (+ i 1)))
        ((&gt;= i len))
      (blob-set! buffer i 0))
    ;; Memory barrier (implementation-specific)
    ;; Verify
    (do ((i 0 (+ i 1)))
        ((&gt;= i len) #t)
      (unless (zero? (blob-ref buffer i))
        (error 'secure-clear-failed)))))

;; Key zeroization
(define (key-destroy! key)
  "Zeroize key material, audit"
  (let ((material (key-material key)))
    (secure-clear! material)
    (audit-append actor: (current-principal)
                  action: 'key-destroyed
                  target: (key-id key))
    'destroyed))

;; Object secure deletion
(define (object-erase! hash)
  "Securely erase object content"
  (let ((path (vault-object-path hash)))
    ;; Overwrite with random
    (call-with-output-file path
      (lambda (port)
        (write-blob port (random-bytes (file-size path)))))
    ;; Overwrite with zeros
    (call-with-output-file path
      (lambda (port)
        (write-blob port (make-blob (file-size path) 0))))
    ;; Delete
    (delete-file path)
    ;; Audit
    (audit-append actor: (current-principal)
                  action: 'object-erased
                  target: hash)
    'erased))
</pre>
<h3>What Cannot Be Erased</h3>
<p>Some things must persist:</p>
<table>
<tr><th>Thing </th><th>Why </th></tr>
<tr><td>Audit chain structure </td><td>Hash links must verify </td></tr>
<tr><td>Revocation records </td><td>Must prove capability invalid </td></tr>
<tr><td>Content hashes </td><td>May exist in other chains </td></tr>
</table>
<p>Redaction, not deletion: the fact that something existed remains, but the content is gone.</p>
<h3>SSD/Flash Considerations</h3>
<p>Modern storage complicates secure erasure:</p>
<ul>
<li>Wear leveling moves data without notification</li>
<li>Trim/discard doesn't guarantee overwrite</li>
<li>Encryption is the only reliable approach</li>
</ul>
<p>Our answer: Encrypt at rest (Memo-030). Erasing the key erases the data.</p>
<pre class="language-scheme">
;; With encryption at rest, key destruction = data destruction
(define (secure-erase-encrypted hash)
  "For encrypted objects: destroy decryption key"
  (let ((dek (object-data-encryption-key hash)))
    (key-destroy! dek)
    ;; The ciphertext remains but is now meaningless
    'erased-via-key-destruction))
</pre>
</section>
<section>
<h2>The Trusted Core</h2>
<p>What must work correctly for security to hold:</p>
<table>
<tr><th>Component </th><th>What It Does </th><th>What We Trust </th></tr>
<tr><td>Ed25519 </td><td>Signatures </td><td>libsodium, math </td></tr>
<tr><td>SHA-512 </td><td>Object identity </td><td>libsodium, math </td></tr>
<tr><td>Capability verifier </td><td>Chain validation </td><td>Our code </td></tr>
<tr><td>Vault storage </td><td>Object integrity </td><td>Local filesystem </td></tr>
<tr><td>Audit chain </td><td>What happened </td><td>Hash chain, signatures </td></tr>
<tr><td>Soup </td><td>Object enumeration </td><td>Vault, audit </td></tr>
</table>
<p>The core is small. Objects are dumb content. Policy lives in certificates. Verification is stateless computation.</p>
<h3>Authoritative Counts</h3>
<p>Object counts MUST come from the TCB. The soup is the authoritative source for object enumeration - it walks the vault and audit trail. Counts displayed outside the TCB (prompts, status displays, dashboards) are advisory only and could be stale or spoofed.</p>
<p>If you need to know how many objects exist, ask the soup. Don't cache counts outside the TCB.</p>
</section>
<section>
<h2>Covert Channels</h2>
<p>This is where we get serious.</p>
<p>A covert channel is information flow that violates policy - a way to leak data that bypasses the capability model. They exist in every system. We analyze ours.</p>
<h3>Storage Channels</h3>
<table>
<tr><th>Channel </th><th>How It Works </th><th>Bandwidth </th><th>Mitigation </th></tr>
<tr><td>Object existence </td><td>Create/don't create object as 1/0 </td><td>~1 bit/op </td><td>Bloom filter noise </td></tr>
<tr><td>Object size </td><td>Encode in padding </td><td>~10 bits/obj </td><td>Size quantization </td></tr>
<tr><td>Object count </td><td>Number of objects in namespace </td><td>~4 bits/ns </td><td>Rate limiting </td></tr>
</table>
<h3>Timing Channels</h3>
<table>
<tr><th>Channel </th><th>How It Works </th><th>Bandwidth </th><th>Mitigation </th></tr>
<tr><td>Verification time </td><td>Slow/fast response as 1/0 </td><td>~1 bit/100ms </td><td>Constant-time ops </td></tr>
<tr><td>Network latency </td><td>Delay patterns </td><td>~10 bits/sec </td><td>Batching, Tor </td></tr>
<tr><td>Audit write time </td><td>When entries appear </td><td>~1 bit/sec </td><td>Async, batched </td></tr>
</table>
<h3>Federation Channels</h3>
<table>
<tr><th>Channel </th><th>How It Works </th><th>Bandwidth </th><th>Mitigation </th></tr>
<tr><td>Sync timing </td><td>When objects replicate </td><td>~1 bit/sync </td><td>Random delays </td></tr>
<tr><td>Peer selection </td><td>Which realms to contact </td><td>~4 bits/conn </td><td>Randomized peers </td></tr>
<tr><td>Gossip patterns </td><td>Propagation paths </td><td>~2 bits/round </td><td>Epidemic flooding </td></tr>
</table>
<h3>Analysis</h3>
<p>Scenario: Alice has SECRET access. Bob has UNCLASSIFIED. Alice wants to leak to Bob.</p>
<p>Via storage: Alice creates/deletes objects Bob can see. Each operation signals one bit. Rate: maybe 1 bit/second with careful timing.</p>
<p>Via timing: Alice influences verification time of requests Bob makes. Bob measures. Rate: maybe 0.1 bit/second, noisy.</p>
<p>Via federation: Alice causes sync events Bob can observe. Rate: depends on federation config, maybe 0.01 bit/second.</p>
<p>Assessment: Total covert bandwidth: ~1-2 bits/second under ideal conditions. Not enough for bulk data. Enough for short signals. Acceptable residual risk for our threat model.</p>
<h3>Mitigation Principles</h3>
<pre>
1. Add noise where practical (bloom filters, random delays)
2. Quantize where observable (object sizes, batch windows)
3. Rate limit where controllable (operations per time)
4. Accept what remains (document it, move on)
</pre>
</section>
<section>
<h2>Audit</h2>
<p>Everything important gets logged.</p>
<pre class="language-scheme">
(audit-entry
  (sequence 12345)
  (timestamp 1736300000)
  (lamport 67890)
  (type capability-exercise)
  (actor "ed25519:subject...")
  (action (read "sha512:object..."))
  (capability "sha512:cert...")
  (previous "sha512:prev-entry...")
  (signature "ed25519:auditor..."))
</pre>
<p>Properties: - Hash-chained: tamper-evident - Signed: non-repudiable - Monotonic: gaps detected - Distributed: witnesses replicate</p>
<p>What gets logged: - Capability creation - Capability exercise (access) - Capability revocation - Access denials - Object creation - Realm events (role changes, federation)</p>
</section>
<section>
<h2>Session Observability</h2>
<p>The portal module manages session lifecycle: crossing into and out of cyberspace. Every session provides observability through the banner, session statistics, and the goodbye summary.</p>
<h3>The Banner</h3>
<p>At session start, the banner attests system state. Every line is meaningful:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 470 180" width="470" height="180" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">Cyberspace</text>
<text x="110" y="10">Scheme</text>
<text x="180" y="10">v0.9.17</text>
<text x="260" y="10">(2026-01-11)</text>
<text x="20" y="30">Om</text>
<text x="50" y="30">·</text>
<text x="70" y="30">Darwin-arm64</text>
<text x="200" y="30">·</text>
<text x="220" y="30">16</text>
<text x="250" y="30">cores,</text>
<text x="320" y="30">128GB,</text>
<text x="390" y="30">Apple</text>
<text x="450" y="30">M4</text>
<text x="20" y="50">IPv4:</text>
<text x="80" y="50">192.168.0.105</text>
<text x="20" y="70">IPv6:</text>
<text x="80" y="70">fd0f:a8ba:61a3:42ce:1856:f4d9:e25:998e</text>
<text x="20" y="90">37K</text>
<text x="60" y="90">loc,</text>
<text x="110" y="90">21</text>
<text x="140" y="90">modules,</text>
<text x="230" y="90">0</text>
<text x="250" y="90">rfcs,</text>
<text x="310" y="90">1K</text>
<text x="340" y="90">tcb</text>
<text x="380" y="90">(1:32)</text>
<text x="20" y="110">vault:</text>
<text x="90" y="110">.vault</text>
<text x="160" y="110">(1</text>
<text x="190" y="110">releases,</text>
<text x="290" y="110">23</text>
<text x="320" y="110">audits)</text>
<text x="20" y="130">realm:</text>
<text x="90" y="130">om</text>
<text x="120" y="130">(ecefca39...)</text>
<text x="20" y="150">entropy:</text>
<text x="110" y="150">/dev/urandom</text>
<text x="240" y="150">(sysrandom)</text>
<text x="20" y="170">FIPS:</text>
<text x="80" y="170">passed</text>
</svg>
</div>
<table>
<tr><th>Line </th><th>Security Purpose </th></tr>
<tr><td>Version, date </td><td>Identifies build, detects stale installations </td></tr>
<tr><td>Hostname, arch </td><td>Confirms you're on the expected machine </td></tr>
<tr><td>IPv4/IPv6 </td><td>Network identity for federation, peer verification </td></tr>
<tr><td>loc, modules, tcb </td><td>Codebase size, attack surface visibility </td></tr>
<tr><td>vault </td><td>Confirms vault exists, shows releases and audit count </td></tr>
<tr><td>realm </td><td>Your cryptographic identity (abbreviated principal) </td></tr>
<tr><td>entropy </td><td>Entropy source attestation for key generation </td></tr>
<tr><td>FIPS </td><td>Cryptographic self-test status (must pass) </td></tr>
</table>
<p>The FIPS line is critical. Before trusting any cryptographic operation, the system runs Known-Answer Tests (KATs) against SHA-256, SHA-512, Ed25519, and the RNG. If any test fails, the system displays FAILED and should not be trusted for security operations.</p>
<h3>Realm Naming</h3>
<p>Realms can have human-readable names, analogous to hostnames for IP addresses:</p>
<pre class="language-scheme">
(set-realm-name! "om")     ; Name this realm
(realm-name)               ; =&gt; "om"
</pre>
<p>The name appears in the banner: `realm: om (ecefca39...)` The abbreviated principal (first 8 hex chars) provides cryptographic identity while the name provides human recognition. Names are stored in `.vault/realm-name`.</p>
<h3>Session Statistics</h3>
<p>Every operation is counted. Statistics track session activity for monitoring and forensics:</p>
<table>
<tr><th>Category </th><th>Stats </th><th>Purpose </th></tr>
<tr><td>Vault I/O </td><td>unlocks, reads, writes, deletes, queries </td><td>Storage activity profile </td></tr>
<tr><td>Crypto ops </td><td>hashes, signs, verifies, encrypts, decrypts </td><td>Cryptographic workload </td></tr>
<tr><td>Seal ops </td><td>commits, seals, syncs </td><td>Version control activity </td></tr>
<tr><td>Federation </td><td>peers-discovered, gossip-exchanges, votes </td><td>Network participation </td></tr>
<tr><td>Network I/O </td><td>bytes-in, bytes-out, packets-ipv4/ipv6 </td><td>Traffic volume </td></tr>
<tr><td>Errors </td><td>verify-fails, auth-fails, timeouts </td><td>Security-relevant failures </td></tr>
</table>
<p>Statistics are initialized at session start and accumulated during operation. The primitives live in the `os` module (level 0) so all modules can instrument themselves without circular dependencies.</p>
<pre class="language-scheme">
(session-stat! 'unlocks)           ; Increment unlock counter
(session-stat! 'bytes-in 1024)     ; Add 1024 to bytes-in
(session-stat 'reads)              ; Get current read count
</pre>
<h3>The Portal</h3>
<p>Entry and exit are symmetric. The goodbye message mirrors the banner's attestation style:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 590 40" width="590" height="40" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">Cyberspace</text>
<text x="110" y="10">frozen</text>
<text x="180" y="10">at</text>
<text x="210" y="10">2026-01-11</text>
<text x="320" y="10">20:32</text>
<text x="380" y="10">on</text>
<text x="410" y="10">om.</text>
<text x="20" y="30">Session:</text>
<text x="110" y="30">0s</text>
<text x="140" y="30">·</text>
<text x="160" y="30">5000</text>
<text x="210" y="30">weave</text>
<text x="270" y="30">·</text>
<text x="290" y="30">1</text>
<text x="310" y="30">unlock</text>
<text x="380" y="30">·</text>
<text x="400" y="30">3</text>
<text x="420" y="30">reads</text>
<text x="480" y="30">·</text>
<text x="500" y="30">2</text>
<text x="520" y="30">queries</text>
</svg>
</div>
<p>The session summary shows:</p>
<ul>
<li>Duration (human-readable: 0s, 5m, 2h 30m, 1d 4h)</li>
<li>Weave - crypto benchmark from boot</li>
<li>Notable operations (non-zero counts)</li>
<li>Errors if any occurred (verify-fails, auth-fails, timeouts)</li>
</ul>
<p>The hostname in the goodbye message confirms which realm you're leaving - important when operating multiple realms via SSH.</p>
<h3>Monitoring Philosophy</h3>
<p>"You can always assert() it away." Statistics are conditional instrumentation:</p>
<ul>
<li>Always present in source - documents what's measurable</li>
<li>Minimal overhead - hash table increment</li>
<li>No persistence - session-scoped, vanishes on exit</li>
<li>Extensible - add new stats by instrumenting operations</li>
</ul>
<p>The pattern comes from IKE clustering code: conditional asserts for QA builds, compiled out for production. Here we keep the counters but the cost is negligible.</p>
</section>
<section>
<h2>Kernel Assertions</h2>
<p>The kernel enforces security through typed assertions. Every assertion is cataloged automatically by `extract-assertions.sh` as part of the RFC generation pipeline. The catalog is regenerated on every build - if you add an assertion, it appears in the documentation.</p>
<h3>Assertion Categories</h3>
<table>
<tr><th>Category </th><th>Purpose </th><th>Example </th></tr>
<tr><td>instrumentation </td><td>Session statistics </td><td>(session-stat! 'unlocks) </td></tr>
<tr><td>security-error </td><td>Access control failures </td><td>(error 'capability-amplification) </td></tr>
<tr><td>precondition </td><td>State guards </td><td>(unless (attested?) ...) </td></tr>
</table>
<p>The catalog provides traceability: every security-relevant check in the codebase is enumerated with file and line number.</p>
<h3>Security Errors</h3>
<p>Typed error symbols for access control failures:</p>
<table>
<tr><th>Error </th><th>Meaning </th></tr>
<tr><td>capability-amplification </td><td>Attempted to delegate more rights than held </td></tr>
<tr><td>confidentiality-violation </td><td>Read without read capability </td></tr>
<tr><td>integrity-violation </td><td>Write without write capability </td></tr>
<tr><td>no-ambient-authority </td><td>Wormhole has no capabilities </td></tr>
<tr><td>read-denied </td><td>Principal lacks read capability </td></tr>
<tr><td>write-denied </td><td>Principal lacks write capability </td></tr>
<tr><td>delete-denied </td><td>Principal lacks delete capability </td></tr>
<tr><td>delegate-denied </td><td>Principal lacks delegate capability </td></tr>
<tr><td>secure-clear-failed </td><td>Zeroization verification failed </td></tr>
</table>
<p>These errors are not generic - each has specific semantics for audit and forensics.</p>
<h3>Precondition Guards</h3>
<p>State assertions that must hold before operations proceed:</p>
<pre class="language-scheme">
(unless (attested?)
  (error "Must attest before signing"))

(unless (keystore-exists?)
  (error "No keystore found. Use keystore-create first."))

(unless (quiescent? memo)
  (error "Chaotic memos cannot be published"))
</pre>
<p>Guards enforce the state machine: chaotic vs quiescent, attested vs unattested, locked vs unlocked.</p>
<h3>The Scheme Way</h3>
<p>Conditional assertions via macros with compile-time flags:</p>
<pre class="language-scheme">
;; Config constant
(define-constant +instrumented+ #t)  ; #f for production

;; Zero-cost when disabled
(define-syntax stat!
  (syntax-rules ()
    ((_ key)
     (when +instrumented+ (session-stat! key)))))
</pre>
<p>With `+instrumented+` false, CHICKEN's optimizer eliminates the dead branch entirely. This is the Scheme equivalent of BLISS `%IF DEBUG %THEN %assert(...) %FI`.</p>
<h3>Catalog Generation</h3>
<p>The assertion catalog is generated automatically:</p>
<pre>
$ ./docs/notes/extract-assertions.sh
  -&gt; docs/notes/assertion-catalog.scm
     18 instrumentation, 10 security errors, 12 guards (40 total)
</pre>
<p>The catalog is a first-class S-expression that can be loaded and queried:</p>
<pre class="language-scheme">
(load "assertion-catalog.scm")
(assertion-summary)
;; =&gt; ((instrumentation-points . 18)
;;     (security-errors . 10)
;;     (precondition-guards . 12)
;;     (total . 40))
</pre>
<p>Adding assertions to code automatically updates the documentation on next regeneration.</p>
</section>
<section>
<h2>Trusted Path</h2>
<p>When it matters, talk directly to the core.</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 460 280" width="460" height="280" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<line x1="5" y1="10" x2="10" y2="10"/>
<line x1="5" y1="10" x2="5" y2="21"/>
<line x1="10" y1="10" x2="20" y2="10"/>
<line x1="20" y1="10" x2="30" y2="10"/>
<line x1="30" y1="10" x2="40" y2="10"/>
<line x1="40" y1="10" x2="50" y2="10"/>
<line x1="50" y1="10" x2="60" y2="10"/>
<line x1="60" y1="10" x2="70" y2="10"/>
<line x1="70" y1="10" x2="80" y2="10"/>
<line x1="80" y1="10" x2="90" y2="10"/>
<line x1="90" y1="10" x2="100" y2="10"/>
<line x1="100" y1="10" x2="110" y2="10"/>
<line x1="110" y1="10" x2="120" y2="10"/>
<line x1="120" y1="10" x2="130" y2="10"/>
<line x1="130" y1="10" x2="140" y2="10"/>
<line x1="140" y1="10" x2="150" y2="10"/>
<line x1="150" y1="10" x2="160" y2="10"/>
<line x1="160" y1="10" x2="170" y2="10"/>
<line x1="170" y1="10" x2="180" y2="10"/>
<line x1="180" y1="10" x2="190" y2="10"/>
<line x1="190" y1="10" x2="200" y2="10"/>
<line x1="200" y1="10" x2="210" y2="10"/>
<line x1="210" y1="10" x2="220" y2="10"/>
<line x1="220" y1="10" x2="230" y2="10"/>
<line x1="230" y1="10" x2="240" y2="10"/>
<line x1="240" y1="10" x2="250" y2="10"/>
<line x1="250" y1="10" x2="260" y2="10"/>
<line x1="260" y1="10" x2="270" y2="10"/>
<line x1="270" y1="10" x2="280" y2="10"/>
<line x1="280" y1="10" x2="290" y2="10"/>
<line x1="290" y1="10" x2="300" y2="10"/>
<line x1="300" y1="10" x2="310" y2="10"/>
<line x1="310" y1="10" x2="320" y2="10"/>
<line x1="320" y1="10" x2="330" y2="10"/>
<line x1="330" y1="10" x2="340" y2="10"/>
<line x1="340" y1="10" x2="350" y2="10"/>
<line x1="350" y1="10" x2="360" y2="10"/>
<line x1="360" y1="10" x2="370" y2="10"/>
<line x1="370" y1="10" x2="380" y2="10"/>
<line x1="380" y1="10" x2="390" y2="10"/>
<line x1="390" y1="10" x2="395" y2="10"/>
<line x1="395" y1="10" x2="395" y2="21"/>
<line x1="5" y1="19" x2="5" y2="41"/>
<text x="110" y="30">HUMAN</text>
<text x="170" y="30">OPERATOR</text>
<line x1="395" y1="19" x2="395" y2="41"/>
<line x1="5" y1="50" x2="10" y2="50"/>
<line x1="5" y1="39" x2="5" y2="50"/>
<line x1="10" y1="50" x2="20" y2="50"/>
<line x1="20" y1="50" x2="30" y2="50"/>
<line x1="30" y1="50" x2="40" y2="50"/>
<line x1="40" y1="50" x2="50" y2="50"/>
<line x1="50" y1="50" x2="60" y2="50"/>
<line x1="60" y1="50" x2="70" y2="50"/>
<line x1="70" y1="50" x2="80" y2="50"/>
<line x1="80" y1="50" x2="90" y2="50"/>
<line x1="90" y1="50" x2="100" y2="50"/>
<line x1="100" y1="50" x2="110" y2="50"/>
<line x1="110" y1="50" x2="120" y2="50"/>
<line x1="120" y1="50" x2="130" y2="50"/>
<line x1="130" y1="50" x2="140" y2="50"/>
<line x1="140" y1="50" x2="150" y2="50"/>
<line x1="150" y1="50" x2="160" y2="50"/>
<line x1="160" y1="50" x2="170" y2="50"/>
<line x1="170" y1="50" x2="180" y2="50"/>
<line x1="180" y1="50" x2="190" y2="50"/>
<line x1="185" y1="50" x2="185" y2="61"/>
<line x1="190" y1="50" x2="200" y2="50"/>
<line x1="200" y1="50" x2="210" y2="50"/>
<line x1="210" y1="50" x2="220" y2="50"/>
<line x1="220" y1="50" x2="230" y2="50"/>
<line x1="230" y1="50" x2="240" y2="50"/>
<line x1="240" y1="50" x2="250" y2="50"/>
<line x1="250" y1="50" x2="260" y2="50"/>
<line x1="260" y1="50" x2="270" y2="50"/>
<line x1="270" y1="50" x2="280" y2="50"/>
<line x1="280" y1="50" x2="290" y2="50"/>
<line x1="290" y1="50" x2="300" y2="50"/>
<line x1="300" y1="50" x2="310" y2="50"/>
<line x1="310" y1="50" x2="320" y2="50"/>
<line x1="320" y1="50" x2="330" y2="50"/>
<line x1="330" y1="50" x2="340" y2="50"/>
<line x1="340" y1="50" x2="350" y2="50"/>
<line x1="350" y1="50" x2="360" y2="50"/>
<line x1="360" y1="50" x2="370" y2="50"/>
<line x1="370" y1="50" x2="380" y2="50"/>
<line x1="380" y1="50" x2="390" y2="50"/>
<line x1="390" y1="50" x2="395" y2="50"/>
<line x1="395" y1="39" x2="395" y2="50"/>
<line x1="185" y1="59" x2="185" y2="81"/>
<text x="200" y="70">Local</text>
<text x="260" y="70">terminal,</text>
<text x="360" y="70">no</text>
<text x="390" y="70">network</text>
<line x1="5" y1="90" x2="10" y2="90"/>
<line x1="5" y1="90" x2="5" y2="101"/>
<line x1="10" y1="90" x2="20" y2="90"/>
<line x1="20" y1="90" x2="30" y2="90"/>
<line x1="30" y1="90" x2="40" y2="90"/>
<line x1="40" y1="90" x2="50" y2="90"/>
<line x1="50" y1="90" x2="60" y2="90"/>
<line x1="60" y1="90" x2="70" y2="90"/>
<line x1="70" y1="90" x2="80" y2="90"/>
<line x1="80" y1="90" x2="90" y2="90"/>
<line x1="90" y1="90" x2="100" y2="90"/>
<line x1="100" y1="90" x2="110" y2="90"/>
<line x1="110" y1="90" x2="120" y2="90"/>
<line x1="120" y1="90" x2="130" y2="90"/>
<line x1="130" y1="90" x2="140" y2="90"/>
<line x1="140" y1="90" x2="150" y2="90"/>
<line x1="150" y1="90" x2="160" y2="90"/>
<line x1="160" y1="90" x2="170" y2="90"/>
<line x1="170" y1="90" x2="180" y2="90"/>
<line x1="190" y1="90" x2="200" y2="90"/>
<line x1="200" y1="90" x2="210" y2="90"/>
<line x1="210" y1="90" x2="220" y2="90"/>
<line x1="220" y1="90" x2="230" y2="90"/>
<line x1="230" y1="90" x2="240" y2="90"/>
<line x1="240" y1="90" x2="250" y2="90"/>
<line x1="250" y1="90" x2="260" y2="90"/>
<line x1="260" y1="90" x2="270" y2="90"/>
<line x1="270" y1="90" x2="280" y2="90"/>
<line x1="280" y1="90" x2="290" y2="90"/>
<line x1="290" y1="90" x2="300" y2="90"/>
<line x1="300" y1="90" x2="310" y2="90"/>
<line x1="310" y1="90" x2="320" y2="90"/>
<line x1="320" y1="90" x2="330" y2="90"/>
<line x1="330" y1="90" x2="340" y2="90"/>
<line x1="340" y1="90" x2="350" y2="90"/>
<line x1="350" y1="90" x2="360" y2="90"/>
<line x1="360" y1="90" x2="370" y2="90"/>
<line x1="370" y1="90" x2="380" y2="90"/>
<line x1="380" y1="90" x2="390" y2="90"/>
<line x1="390" y1="90" x2="395" y2="90"/>
<line x1="395" y1="90" x2="395" y2="101"/>
<line x1="5" y1="99" x2="5" y2="121"/>
<text x="100" y="110">CYBERSPACE</text>
<text x="210" y="110">REPL</text>
<line x1="395" y1="99" x2="395" y2="121"/>
<line x1="5" y1="119" x2="5" y2="141"/>
<line x1="45" y1="130" x2="50" y2="130"/>
<line x1="45" y1="130" x2="45" y2="141"/>
<line x1="50" y1="130" x2="60" y2="130"/>
<line x1="60" y1="130" x2="70" y2="130"/>
<line x1="70" y1="130" x2="80" y2="130"/>
<line x1="80" y1="130" x2="90" y2="130"/>
<line x1="90" y1="130" x2="100" y2="130"/>
<line x1="100" y1="130" x2="110" y2="130"/>
<line x1="110" y1="130" x2="120" y2="130"/>
<line x1="120" y1="130" x2="130" y2="130"/>
<line x1="130" y1="130" x2="140" y2="130"/>
<line x1="140" y1="130" x2="150" y2="130"/>
<line x1="150" y1="130" x2="160" y2="130"/>
<line x1="160" y1="130" x2="170" y2="130"/>
<line x1="170" y1="130" x2="180" y2="130"/>
<line x1="180" y1="130" x2="190" y2="130"/>
<line x1="190" y1="130" x2="200" y2="130"/>
<line x1="200" y1="130" x2="210" y2="130"/>
<line x1="210" y1="130" x2="220" y2="130"/>
<line x1="220" y1="130" x2="230" y2="130"/>
<line x1="230" y1="130" x2="240" y2="130"/>
<line x1="240" y1="130" x2="250" y2="130"/>
<line x1="250" y1="130" x2="260" y2="130"/>
<line x1="260" y1="130" x2="270" y2="130"/>
<line x1="270" y1="130" x2="280" y2="130"/>
<line x1="280" y1="130" x2="290" y2="130"/>
<line x1="290" y1="130" x2="300" y2="130"/>
<line x1="300" y1="130" x2="310" y2="130"/>
<line x1="310" y1="130" x2="320" y2="130"/>
<line x1="320" y1="130" x2="330" y2="130"/>
<line x1="330" y1="130" x2="340" y2="130"/>
<line x1="340" y1="130" x2="345" y2="130"/>
<line x1="345" y1="130" x2="345" y2="141"/>
<line x1="395" y1="119" x2="395" y2="141"/>
<line x1="5" y1="139" x2="5" y2="161"/>
<line x1="45" y1="139" x2="45" y2="161"/>
<text x="70" y="150">TRUSTED</text>
<text x="150" y="150">PATH</text>
<text x="200" y="150">ACTIVE</text>
<line x1="345" y1="139" x2="345" y2="161"/>
<line x1="395" y1="139" x2="395" y2="161"/>
<line x1="5" y1="159" x2="5" y2="181"/>
<line x1="45" y1="170" x2="50" y2="170"/>
<line x1="45" y1="159" x2="45" y2="170"/>
<line x1="50" y1="170" x2="60" y2="170"/>
<line x1="60" y1="170" x2="70" y2="170"/>
<line x1="70" y1="170" x2="80" y2="170"/>
<line x1="80" y1="170" x2="90" y2="170"/>
<line x1="90" y1="170" x2="100" y2="170"/>
<line x1="100" y1="170" x2="110" y2="170"/>
<line x1="110" y1="170" x2="120" y2="170"/>
<line x1="120" y1="170" x2="130" y2="170"/>
<line x1="130" y1="170" x2="140" y2="170"/>
<line x1="140" y1="170" x2="150" y2="170"/>
<line x1="150" y1="170" x2="160" y2="170"/>
<line x1="160" y1="170" x2="170" y2="170"/>
<line x1="170" y1="170" x2="180" y2="170"/>
<line x1="180" y1="170" x2="190" y2="170"/>
<line x1="190" y1="170" x2="200" y2="170"/>
<line x1="200" y1="170" x2="210" y2="170"/>
<line x1="210" y1="170" x2="220" y2="170"/>
<line x1="220" y1="170" x2="230" y2="170"/>
<line x1="230" y1="170" x2="240" y2="170"/>
<line x1="240" y1="170" x2="250" y2="170"/>
<line x1="250" y1="170" x2="260" y2="170"/>
<line x1="260" y1="170" x2="270" y2="170"/>
<line x1="270" y1="170" x2="280" y2="170"/>
<line x1="280" y1="170" x2="290" y2="170"/>
<line x1="290" y1="170" x2="300" y2="170"/>
<line x1="300" y1="170" x2="310" y2="170"/>
<line x1="310" y1="170" x2="320" y2="170"/>
<line x1="320" y1="170" x2="330" y2="170"/>
<line x1="330" y1="170" x2="340" y2="170"/>
<line x1="340" y1="170" x2="345" y2="170"/>
<line x1="345" y1="159" x2="345" y2="170"/>
<line x1="395" y1="159" x2="395" y2="181"/>
<line x1="5" y1="190" x2="10" y2="190"/>
<line x1="5" y1="179" x2="5" y2="190"/>
<line x1="10" y1="190" x2="20" y2="190"/>
<line x1="20" y1="190" x2="30" y2="190"/>
<line x1="30" y1="190" x2="40" y2="190"/>
<line x1="40" y1="190" x2="50" y2="190"/>
<line x1="50" y1="190" x2="60" y2="190"/>
<line x1="60" y1="190" x2="70" y2="190"/>
<line x1="70" y1="190" x2="80" y2="190"/>
<line x1="80" y1="190" x2="90" y2="190"/>
<line x1="90" y1="190" x2="100" y2="190"/>
<line x1="100" y1="190" x2="110" y2="190"/>
<line x1="110" y1="190" x2="120" y2="190"/>
<line x1="120" y1="190" x2="130" y2="190"/>
<line x1="130" y1="190" x2="140" y2="190"/>
<line x1="140" y1="190" x2="150" y2="190"/>
<line x1="150" y1="190" x2="160" y2="190"/>
<line x1="160" y1="190" x2="170" y2="190"/>
<line x1="170" y1="190" x2="180" y2="190"/>
<line x1="180" y1="190" x2="190" y2="190"/>
<line x1="185" y1="190" x2="185" y2="201"/>
<line x1="190" y1="190" x2="200" y2="190"/>
<line x1="200" y1="190" x2="210" y2="190"/>
<line x1="210" y1="190" x2="220" y2="190"/>
<line x1="220" y1="190" x2="230" y2="190"/>
<line x1="230" y1="190" x2="240" y2="190"/>
<line x1="240" y1="190" x2="250" y2="190"/>
<line x1="250" y1="190" x2="260" y2="190"/>
<line x1="260" y1="190" x2="270" y2="190"/>
<line x1="270" y1="190" x2="280" y2="190"/>
<line x1="280" y1="190" x2="290" y2="190"/>
<line x1="290" y1="190" x2="300" y2="190"/>
<line x1="300" y1="190" x2="310" y2="190"/>
<line x1="310" y1="190" x2="320" y2="190"/>
<line x1="320" y1="190" x2="330" y2="190"/>
<line x1="330" y1="190" x2="340" y2="190"/>
<line x1="340" y1="190" x2="350" y2="190"/>
<line x1="350" y1="190" x2="360" y2="190"/>
<line x1="360" y1="190" x2="370" y2="190"/>
<line x1="370" y1="190" x2="380" y2="190"/>
<line x1="380" y1="190" x2="390" y2="190"/>
<line x1="390" y1="190" x2="395" y2="190"/>
<line x1="395" y1="179" x2="395" y2="190"/>
<line x1="185" y1="199" x2="185" y2="221"/>
<line x1="5" y1="230" x2="10" y2="230"/>
<line x1="5" y1="230" x2="5" y2="241"/>
<line x1="10" y1="230" x2="20" y2="230"/>
<line x1="20" y1="230" x2="30" y2="230"/>
<line x1="30" y1="230" x2="40" y2="230"/>
<line x1="40" y1="230" x2="50" y2="230"/>
<line x1="50" y1="230" x2="60" y2="230"/>
<line x1="60" y1="230" x2="70" y2="230"/>
<line x1="70" y1="230" x2="80" y2="230"/>
<line x1="80" y1="230" x2="90" y2="230"/>
<line x1="90" y1="230" x2="100" y2="230"/>
<line x1="100" y1="230" x2="110" y2="230"/>
<line x1="110" y1="230" x2="120" y2="230"/>
<line x1="120" y1="230" x2="130" y2="230"/>
<line x1="130" y1="230" x2="140" y2="230"/>
<line x1="140" y1="230" x2="150" y2="230"/>
<line x1="150" y1="230" x2="160" y2="230"/>
<line x1="160" y1="230" x2="170" y2="230"/>
<line x1="170" y1="230" x2="180" y2="230"/>
<line x1="190" y1="230" x2="200" y2="230"/>
<line x1="200" y1="230" x2="210" y2="230"/>
<line x1="210" y1="230" x2="220" y2="230"/>
<line x1="220" y1="230" x2="230" y2="230"/>
<line x1="230" y1="230" x2="240" y2="230"/>
<line x1="240" y1="230" x2="250" y2="230"/>
<line x1="250" y1="230" x2="260" y2="230"/>
<line x1="260" y1="230" x2="270" y2="230"/>
<line x1="270" y1="230" x2="280" y2="230"/>
<line x1="280" y1="230" x2="290" y2="230"/>
<line x1="290" y1="230" x2="300" y2="230"/>
<line x1="300" y1="230" x2="310" y2="230"/>
<line x1="310" y1="230" x2="320" y2="230"/>
<line x1="320" y1="230" x2="330" y2="230"/>
<line x1="330" y1="230" x2="340" y2="230"/>
<line x1="340" y1="230" x2="350" y2="230"/>
<line x1="350" y1="230" x2="360" y2="230"/>
<line x1="360" y1="230" x2="370" y2="230"/>
<line x1="370" y1="230" x2="380" y2="230"/>
<line x1="380" y1="230" x2="390" y2="230"/>
<line x1="390" y1="230" x2="395" y2="230"/>
<line x1="395" y1="230" x2="395" y2="241"/>
<line x1="5" y1="239" x2="5" y2="261"/>
<text x="110" y="250">TRUSTED</text>
<text x="190" y="250">CORE</text>
<line x1="395" y1="239" x2="395" y2="261"/>
<line x1="5" y1="270" x2="10" y2="270"/>
<line x1="5" y1="259" x2="5" y2="270"/>
<line x1="10" y1="270" x2="20" y2="270"/>
<line x1="20" y1="270" x2="30" y2="270"/>
<line x1="30" y1="270" x2="40" y2="270"/>
<line x1="40" y1="270" x2="50" y2="270"/>
<line x1="50" y1="270" x2="60" y2="270"/>
<line x1="60" y1="270" x2="70" y2="270"/>
<line x1="70" y1="270" x2="80" y2="270"/>
<line x1="80" y1="270" x2="90" y2="270"/>
<line x1="90" y1="270" x2="100" y2="270"/>
<line x1="100" y1="270" x2="110" y2="270"/>
<line x1="110" y1="270" x2="120" y2="270"/>
<line x1="120" y1="270" x2="130" y2="270"/>
<line x1="130" y1="270" x2="140" y2="270"/>
<line x1="140" y1="270" x2="150" y2="270"/>
<line x1="150" y1="270" x2="160" y2="270"/>
<line x1="160" y1="270" x2="170" y2="270"/>
<line x1="170" y1="270" x2="180" y2="270"/>
<line x1="180" y1="270" x2="190" y2="270"/>
<line x1="190" y1="270" x2="200" y2="270"/>
<line x1="200" y1="270" x2="210" y2="270"/>
<line x1="210" y1="270" x2="220" y2="270"/>
<line x1="220" y1="270" x2="230" y2="270"/>
<line x1="230" y1="270" x2="240" y2="270"/>
<line x1="240" y1="270" x2="250" y2="270"/>
<line x1="250" y1="270" x2="260" y2="270"/>
<line x1="260" y1="270" x2="270" y2="270"/>
<line x1="270" y1="270" x2="280" y2="270"/>
<line x1="280" y1="270" x2="290" y2="270"/>
<line x1="290" y1="270" x2="300" y2="270"/>
<line x1="300" y1="270" x2="310" y2="270"/>
<line x1="310" y1="270" x2="320" y2="270"/>
<line x1="320" y1="270" x2="330" y2="270"/>
<line x1="330" y1="270" x2="340" y2="270"/>
<line x1="340" y1="270" x2="350" y2="270"/>
<line x1="350" y1="270" x2="360" y2="270"/>
<line x1="360" y1="270" x2="370" y2="270"/>
<line x1="370" y1="270" x2="380" y2="270"/>
<line x1="380" y1="270" x2="390" y2="270"/>
<line x1="390" y1="270" x2="395" y2="270"/>
<line x1="395" y1="259" x2="395" y2="270"/>
</svg>
</div>
<p>Operations requiring trusted path: - (ed25519-keypair) - key generation - (node-role 'coordinator) - role assignment - (seal-release "1.0.0") - signing releases - Key ceremony (Memo-022)</p>
</section>
<section>
<h2>Threats</h2>
<h3>What We Handle</h3>
<table>
<tr><th>Threat </th><th>Defense </th></tr>
<tr><td>Unauthorized access </td><td>No capability = no access </td></tr>
<tr><td>Capability forgery </td><td>Ed25519 signatures </td></tr>
<tr><td>Replay attacks </td><td>Timestamps, nonces, Lamport clocks </td></tr>
<tr><td>Stale capabilities </td><td>Expiration, revocation </td></tr>
<tr><td>Delegation abuse </td><td>Attenuation, propagation flags </td></tr>
<tr><td>Content tampering </td><td>SHA-512 content addressing </td></tr>
<tr><td>Origin spoofing </td><td>Object signatures </td></tr>
<tr><td>Audit tampering </td><td>Hash chain, distribution </td></tr>
</table>
<h3>What We Don't Handle</h3>
<table>
<tr><th>Threat </th><th>Why </th></tr>
<tr><td>Compromised signing key </td><td>Fundamental limit. Mitigate: threshold, rotation. </td></tr>
<tr><td>Endpoint compromise </td><td>Your realm, your problem. </td></tr>
<tr><td>Physical access </td><td>Out of scope for software. </td></tr>
<tr><td>Covert channels &gt; 1 bit/sec </td><td>Residual risk, documented above. </td></tr>
<tr><td>Availability attacks </td><td>Focus on integrity/confidentiality. </td></tr>
<tr><td>Quantum computing </td><td>Ed25519 vulnerable. Migration path planned. </td></tr>
<tr><td>Coercion </td><td>Math doesn't help if you're forced to sign. </td></tr>
</table>
</section>
<section>
<h2>The Invariants</h2>
<p>These must always hold:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 530 240" width="530" height="240" xmlns="http://www.w3.org/2000/svg">
<style>
  .diagram line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: square; }
  .diagram rect { fill: currentColor; }
  .diagram text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: currentColor; dominant-baseline: central; }
</style>
<text x="0" y="10">I1.</text>
<text x="40" y="10">No</text>
<text x="70" y="10">access</text>
<text x="140" y="10">without</text>
<text x="220" y="10">valid</text>
<text x="280" y="10">capability</text>
<text x="40" y="30">access(s,o,r)</text>
<text x="200" y="30">∃c:</text>
<text x="240" y="30">valid_chain(s,o,r,c)</text>
<text x="0" y="50">I2.</text>
<text x="40" y="50">Delegation</text>
<text x="150" y="50">cannot</text>
<text x="220" y="50">amplify</text>
<text x="40" y="70">delegated(c₂,c₁)</text>
<text x="230" y="70">rights(c₂)</text>
<text x="340" y="70">⊆</text>
<text x="360" y="70">rights(c₁)</text>
<text x="0" y="90">I3.</text>
<text x="40" y="90">Object</text>
<text x="110" y="90">identity</text>
<text x="200" y="90">is</text>
<text x="230" y="90">content</text>
<text x="310" y="90">hash</text>
<text x="40" y="110">id(o)</text>
<text x="100" y="110">=</text>
<text x="120" y="110">sha512(content(o))</text>
<text x="0" y="130">I4.</text>
<text x="40" y="130">Audit</text>
<text x="100" y="130">is</text>
<text x="130" y="130">ordered</text>
<text x="40" y="150">sequence(e₁)</text>
<text x="170" y="150">&lt;</text>
<text x="190" y="150">sequence(e₂)</text>
<text x="340" y="150">time(e₁)</text>
<text x="430" y="150">≤</text>
<text x="450" y="150">time(e₂)</text>
<text x="0" y="170">I5.</text>
<text x="40" y="170">Revocation</text>
<text x="150" y="170">is</text>
<text x="180" y="170">permanent</text>
<text x="40" y="190">revoked(c,t)</text>
<text x="190" y="190">∀t'</text>
<text x="230" y="190">&gt;</text>
<text x="250" y="190">t:</text>
<text x="280" y="190">¬valid(c,t')</text>
<text x="0" y="210">I6.</text>
<text x="40" y="210">No</text>
<text x="70" y="210">ambient</text>
<text x="150" y="210">authority</text>
<text x="40" y="230">¬∃c:</text>
<text x="90" y="230">grants(c,,)</text>
</svg>
</div>
</section>
<section>
<h2>References</h2>
<p>1. Ellison, C. et al., SPKI Certificate Theory, RFC 2693, 1999 2. Dennis, J. &amp; Van Horn, E., Programming Semantics for Multiprogrammed Computations, 1966 3. Miller, M., Robust Composition, 2006 4. Lampson, B., A Note on the Confinement Problem, 1973 5. DoD 5200.28-STD (Orange Book), 1985 - for the covert channel lens 6. Bell, D.E. &amp; LaPadula, L.J., Secure Computer Systems: Mathematical Foundations, 1973 - confidentiality model 7. Biba, K.J., Integrity Considerations for Secure Computer Systems, 1977 - integrity model 8. Chaum, D., Blind Signatures for Untraceable Payments, Crypto 1982 9. Chaum, D., Security Without Identification: Transaction Systems to Make Big Brother Obsolete, CACM 1985</p>
</section>
<section>
<h2>Changelog</h2>
<ul>
<li>2026-01-20</li>
<li>Add 'Beyond Bell-LaPadula and Biba' subsection: capability-based flow vs MAC, Shannon bandwidth</li>
<li>2026-01-16</li>
<li>Add Unlinkability section: blind signatures, bearer capabilities, Chaum integration</li>
<li>2026-01-08</li>
<li>Initial draft</li>
</ul>
</section>
<script>
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
}
(function() {
  // Query param override (for REPL: ?theme=dark or ?theme=light)
  const params = new URLSearchParams(window.location.search);
  const param = params.get('theme');
  if (param === 'dark' || param === 'light') {
    document.documentElement.setAttribute('data-theme', param);
    localStorage.setItem('theme', param);
    return;
  }
  // localStorage preference
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
  } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', 'light');
  }
})();
</script>
</body>
</html>
