%!PS-Adobe-3.0
%%BoundingBox: 72 72 540 720
%%Title: Enscript Output
%%For: Derrell Piper
%%Creator: GNU Enscript 1.6.6
%%CreationDate: Sun Jan 11 01:07:51 2026
%%Orientation: Portrait
%%Pages: (atend)
%%DocumentMedia: Letter 612 792 0 () ()
%%DocumentNeededResources: (atend)
%%EndComments
%%BeginProlog
%%BeginResource: procset Enscript-Prolog 1.6 6
%
% Procedures.
%

/_S {	% save current state
  /_s save def
} def
/_R {	% restore from saved state
  _s restore
} def

/S {	% showpage protecting gstate
  gsave
  showpage
  grestore
} bind def

/MF {	% fontname newfontname -> -	make a new encoded font
  /newfontname exch def
  /fontname exch def

  /fontdict fontname findfont def
  /newfont fontdict maxlength dict def

  fontdict {
    exch
    dup /FID eq {
      % skip FID pair
      pop pop
    } {
      % copy to the new font dictionary
      exch newfont 3 1 roll put
    } ifelse
  } forall

  newfont /FontName newfontname put

  % insert only valid encoding vectors
  encoding_vector length 256 eq {
    newfont /Encoding encoding_vector put
  } if

  newfontname newfont definefont pop
} def

/MF_PS { % fontname newfontname -> -	make a new font preserving its enc
  /newfontname exch def
  /fontname exch def

  /fontdict fontname findfont def
  /newfont fontdict maxlength dict def

  fontdict {
    exch
    dup /FID eq {
      % skip FID pair
      pop pop
    } {
      % copy to the new font dictionary
      exch newfont 3 1 roll put
    } ifelse
  } forall

  newfont /FontName newfontname put

  newfontname newfont definefont pop
} def

/SF { % fontname width height -> -	set a new font
  /height exch def
  /width exch def

  findfont
  [width 0 0 height 0 0] makefont setfont
} def

/SUF { % fontname width height -> -	set a new user font
  /height exch def
  /width exch def

  /F-gs-user-font MF
  /F-gs-user-font width height SF
} def

/SUF_PS { % fontname width height -> -	set a new user font preserving its enc
  /height exch def
  /width exch def

  /F-gs-user-font MF_PS
  /F-gs-user-font width height SF
} def

/M {moveto} bind def
/s {show} bind def

/Box {	% x y w h -> -			define box path
  /d_h exch def /d_w exch def /d_y exch def /d_x exch def
  d_x d_y  moveto
  d_w 0 rlineto
  0 d_h rlineto
  d_w neg 0 rlineto
  closepath
} def

/bgs {	% x y height blskip gray str -> -	show string with bg color
  /str exch def
  /gray exch def
  /blskip exch def
  /height exch def
  /y exch def
  /x exch def

  gsave
    x y blskip sub str stringwidth pop height Box
    gray setgray
    fill
  grestore
  x y M str s
} def

/bgcs { % x y height blskip red green blue str -> -  show string with bg color
  /str exch def
  /blue exch def
  /green exch def
  /red exch def
  /blskip exch def
  /height exch def
  /y exch def
  /x exch def

  gsave
    x y blskip sub str stringwidth pop height Box
    red green blue setrgbcolor
    fill
  grestore
  x y M str s
} def

% Highlight bars.
/highlight_bars {	% nlines lineheight output_y_margin gray -> -
  gsave
    setgray
    /ymarg exch def
    /lineheight exch def
    /nlines exch def

    % This 2 is just a magic number to sync highlight lines to text.
    0 d_header_y ymarg sub 2 sub translate

    /cw d_output_w cols div def
    /nrows d_output_h ymarg 2 mul sub lineheight div cvi def

    % for each column
    0 1 cols 1 sub {
      cw mul /xp exch def

      % for each rows
      0 1 nrows 1 sub {
        /rn exch def
        rn lineheight mul neg /yp exch def
        rn nlines idiv 2 mod 0 eq {
	  % Draw highlight bar.  4 is just a magic indentation.
	  xp 4 add yp cw 8 sub lineheight neg Box fill
	} if
      } for
    } for

  grestore
} def

% Line highlight bar.
/line_highlight {	% x y width height gray -> -
  gsave
    /gray exch def
    Box gray setgray fill
  grestore
} def

% Column separator lines.
/column_lines {
  gsave
    .1 setlinewidth
    0 d_footer_h translate
    /cw d_output_w cols div def
    1 1 cols 1 sub {
      cw mul 0 moveto
      0 d_output_h rlineto stroke
    } for
  grestore
} def

% Column borders.
/column_borders {
  gsave
    .1 setlinewidth
    0 d_footer_h moveto
    0 d_output_h rlineto
    d_output_w 0 rlineto
    0 d_output_h neg rlineto
    closepath stroke
  grestore
} def

% Do the actual underlay drawing
/draw_underlay {
  ul_style 0 eq {
    ul_str true charpath stroke
  } {
    ul_str show
  } ifelse
} def

% Underlay
/underlay {	% - -> -
  gsave
    0 d_page_h translate
    d_page_h neg d_page_w atan rotate

    ul_gray setgray
    ul_font setfont
    /dw d_page_h dup mul d_page_w dup mul add sqrt def
    ul_str stringwidth pop dw exch sub 2 div ul_h_ptsize -2 div moveto
    draw_underlay
  grestore
} def

/user_underlay {	% - -> -
  gsave
    ul_x ul_y translate
    ul_angle rotate
    ul_gray setgray
    ul_font setfont
    0 0 ul_h_ptsize 2 div sub moveto
    draw_underlay
  grestore
} def

% Page prefeed
/page_prefeed {		% bool -> -
  statusdict /prefeed known {
    statusdict exch /prefeed exch put
  } {
    pop
  } ifelse
} def

% Wrapped line markers
/wrapped_line_mark {	% x y charwith charheight type -> -
  /type exch def
  /h exch def
  /w exch def
  /y exch def
  /x exch def

  type 2 eq {
    % Black boxes (like TeX does)
    gsave
      0 setlinewidth
      x w 4 div add y M
      0 h rlineto w 2 div 0 rlineto 0 h neg rlineto
      closepath fill
    grestore
  } {
    type 3 eq {
      % Small arrows
      gsave
        .2 setlinewidth
        x w 2 div add y h 2 div add M
        w 4 div 0 rlineto
        x w 4 div add y lineto stroke

        x w 4 div add w 8 div add y h 4 div add M
        x w 4 div add y lineto
	w 4 div h 8 div rlineto stroke
      grestore
    } {
      % do nothing
    } ifelse
  } ifelse
} def

% EPSF import.

/BeginEPSF {
  /b4_Inc_state save def    		% Save state for cleanup
  /dict_count countdictstack def	% Count objects on dict stack
  /op_count count 1 sub def		% Count objects on operand stack
  userdict begin
  /showpage { } def
  0 setgray 0 setlinecap
  1 setlinewidth 0 setlinejoin
  10 setmiterlimit [ ] 0 setdash newpath
  /languagelevel where {
    pop languagelevel
    1 ne {
      false setstrokeadjust false setoverprint
    } if
  } if
} bind def

/EndEPSF {
  count op_count sub { pos } repeat	% Clean up stacks
  countdictstack dict_count sub { end } repeat
  b4_Inc_state restore
} bind def

% Check PostScript language level.
/languagelevel where {
  pop /gs_languagelevel languagelevel def
} {
  /gs_languagelevel 1 def
} ifelse
%%EndResource
%%BeginResource: procset Enscript-Encoding-88591 1.6 6
/encoding_vector [
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/space        	/exclam       	/quotedbl     	/numbersign   	
/dollar       	/percent      	/ampersand    	/quoteright   	
/parenleft    	/parenright   	/asterisk     	/plus         	
/comma        	/hyphen       	/period       	/slash        	
/zero         	/one          	/two          	/three        	
/four         	/five         	/six          	/seven        	
/eight        	/nine         	/colon        	/semicolon    	
/less         	/equal        	/greater      	/question     	
/at           	/A            	/B            	/C            	
/D            	/E            	/F            	/G            	
/H            	/I            	/J            	/K            	
/L            	/M            	/N            	/O            	
/P            	/Q            	/R            	/S            	
/T            	/U            	/V            	/W            	
/X            	/Y            	/Z            	/bracketleft  	
/backslash    	/bracketright 	/asciicircum  	/underscore   	
/quoteleft    	/a            	/b            	/c            	
/d            	/e            	/f            	/g            	
/h            	/i            	/j            	/k            	
/l            	/m            	/n            	/o            	
/p            	/q            	/r            	/s            	
/t            	/u            	/v            	/w            	
/x            	/y            	/z            	/braceleft    	
/bar          	/braceright   	/tilde        	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/space        	/exclamdown   	/cent         	/sterling     	
/currency     	/yen          	/brokenbar    	/section      	
/dieresis     	/copyright    	/ordfeminine  	/guillemotleft	
/logicalnot   	/hyphen       	/registered   	/macron       	
/degree       	/plusminus    	/twosuperior  	/threesuperior	
/acute        	/mu           	/paragraph    	/bullet       	
/cedilla      	/onesuperior  	/ordmasculine 	/guillemotright	
/onequarter   	/onehalf      	/threequarters	/questiondown 	
/Agrave       	/Aacute       	/Acircumflex  	/Atilde       	
/Adieresis    	/Aring        	/AE           	/Ccedilla     	
/Egrave       	/Eacute       	/Ecircumflex  	/Edieresis    	
/Igrave       	/Iacute       	/Icircumflex  	/Idieresis    	
/Eth          	/Ntilde       	/Ograve       	/Oacute       	
/Ocircumflex  	/Otilde       	/Odieresis    	/multiply     	
/Oslash       	/Ugrave       	/Uacute       	/Ucircumflex  	
/Udieresis    	/Yacute       	/Thorn        	/germandbls   	
/agrave       	/aacute       	/acircumflex  	/atilde       	
/adieresis    	/aring        	/ae           	/ccedilla     	
/egrave       	/eacute       	/ecircumflex  	/edieresis    	
/igrave       	/iacute       	/icircumflex  	/idieresis    	
/eth          	/ntilde       	/ograve       	/oacute       	
/ocircumflex  	/otilde       	/odieresis    	/divide       	
/oslash       	/ugrave       	/uacute       	/ucircumflex  	
/udieresis    	/yacute       	/thorn        	/ydieresis    	
] def
%%EndResource
%%EndProlog
%%BeginSetup
%%IncludeResource: font Helvetica-Bold
%%IncludeResource: font Courier
/HFpt_w 10 def
/HFpt_h 10 def
/Helvetica-Bold /HF-gs-font MF
/HF /HF-gs-font findfont [HFpt_w 0 0 HFpt_h 0 0] makefont def
/Courier /F-gs-font MF
/F-gs-font 9 9 SF
/#copies 1 def
% Pagedevice definitions:
gs_languagelevel 1 gt {
  <<
    /PageSize [612 792] 
  >> setpagedevice
} if
%%BeginResource: procset Enscript-Header-enscript 1.6 6
%%IncludeResource: font Times-Bold
%%IncludeResource: font Times-Roman

% Fonts.
/Times-Bold /HeaderFont-Bold MF
/HeaderDateF /HeaderFont-Bold findfont 12 scalefont def

/Times-Roman /HeaderFont-Times MF
/HeaderHDRF /HeaderFont-Times findfont 14 scalefont def

/HeaderPageNumF /Helvetica-Bold findfont 28.8 scalefont def

/do_header {	% print enscript header
  gsave
    d_header_x d_header_y translate

    % light bar
    0 0 d_header_w d_header_h 2 div Box
    .95 setgray fill

    % dark gray boxes
    /dbw d_header_h 2 mul def	% dark box width
    /dbc .7 def			% dark box color

    % left dark box.
    0 0 dbw d_header_h Box
    dbc setgray fill

    0 setgray 
    HeaderDateF setfont
    moddatestr dup stringwidth pop dbw exch sub 2 div 
    d_header_h 2 div 2 add moveto show
    modtimestr dup stringwidth pop dbw exch sub 2 div 
    d_header_h 5 div moveto show

    % right dark box
    d_header_w dbw sub 0 dbw d_header_h Box
    dbc setgray fill

    HeaderPageNumF setfont
    1 setgray
    pagenumstr dup
    stringwidth pop dbw exch sub 2 div d_header_w dbw sub add
    d_header_h .2 mul moveto show

    % filename
    0 setgray 
    HeaderHDRF setfont
    d_header_w fname stringwidth pop sub 2 div d_header_h 8 div moveto
    fname show

    % user supplied header string.
    user_header_p {
      /h d_header_h 8 div 5 mul def

      % Implement strict enscript compatibility.
      user_header_center_str () eq user_header_right_str () eq and {
        d_header_w user_header_left_str stringwidth pop sub 2 div 
        h moveto user_header_left_str show
      } {
        dbw 5 add h moveto user_header_left_str show

        d_header_w user_header_center_str stringwidth pop sub 2 div 
        h moveto user_header_center_str show

	d_header_w dbw sub 5 sub user_header_right_str stringwidth pop
	sub h moveto user_header_right_str show
      } ifelse
    } if

  grestore
} def
%%EndResource
/d_page_w 468 def
/d_page_h 648 def
/d_header_x 0 def
/d_header_y 612 def
/d_header_w 468 def
/d_header_h 36 def
/d_footer_x 0 def
/d_footer_y 0 def
/d_footer_w 468 def
/d_footer_h 0 def
/d_output_w 468 def
/d_output_h 612 def
/cols 1 def
%%EndSetup
%%Page: (1) 1
%%BeginPageSetup
_S
72 72 translate
/pagenum 1 def
/fname (rfc-051-node-enrollment.txt) def
/fdir (.) def
/ftail (rfc-051-node-enrollment.txt) def
% User defined strings:
/pagenumstr (1) def
/moddatestr (01/10/26) def
/modtimestr (14:07:35) def
/user_header_p true def
/user_header_left_str (RFC-044: Node Enrollment Protocol) def
/user_header_center_str (01/10/26) def
/user_header_right_str (Page 1 of 10) def
/user_footer_p false def
%%EndPageSetup
do_header
5 600 M
(RFC-044: Node Enrollment Protocol) s
5 580 M
(Status: Draft) s
5 570 M
(Date: January 2026) s
5 560 M
(Author: Derrell Piper <ddp@eludom.net>) s
5 550 M
(Implementation: Proposed) s
5 530 M
(------------------------------------------------------------------------------) s
5 510 M
(Abstract) s
5 490 M
(This RFC specifies how a new node joins the Library of Cyberspace) s
5 480 M
(confederation. The goal: a simple, memorable process that a human can) s
5 470 M
(complete in five minutes with no special knowledge.) s
5 450 M
(If you can verify a phone number by reading back a code, you can enroll) s
5 440 M
(a node.) s
5 420 M
(------------------------------------------------------------------------------) s
5 400 M
(Motivation) s
5 380 M
(Starlight just arrived. It's a beautiful machine. Now what?) s
5 360 M
(The question every new node faces:) s
5 340 M
(    "How do I become part of the confederation?") s
5 320 M
(This should be obvious. Like plugging in a new device and having it) s
5 310 M
(just work. But we also need:) s
5 290 M
(- Cryptographic identity - the node proves it is who it claims) s
5 280 M
(- Human verification - a person confirms this is the right machine) s
5 270 M
(- No blind trust - the master doesn't just accept any stranger) s
5 250 M
(The challenge: make it simple enough for anyone, secure enough for) s
5 240 M
(cryptographers.) s
5 220 M
(------------------------------------------------------------------------------) s
5 200 M
(Design Principles) s
5 180 M
(1. Physical Presence Is Attestation) s
5 160 M
(    If you're sitting at the keyboard, you can vouch for the machine.) s
5 150 M
(    No TPM, no attestation servers, no remote proof. Just you.) s
5 130 M
(2. The Master Blesses, The Node Requests) s
5 110 M
(    The node never decides on its own identity. It generates keys,) s
5 100 M
(    presents them, and asks: "Will you name me?") s
5 80 M
(3. Human-Readable Verification) s
5 60 M
(    No comparing 64-character hex strings. Use words humans can speak) s
5 50 M
(    aloud and verify by ear.) s
5 30 M
(4. One Command Each Side) s
5 10 M
(    On the new node: one command to request enrollment.) s
_R
S
%%Page: (2) 2
%%BeginPageSetup
_S
72 72 translate
/pagenum 2 def
/fname (rfc-051-node-enrollment.txt) def
/fdir (.) def
/ftail (rfc-051-node-enrollment.txt) def
% User defined strings:
/pagenumstr (2) def
/moddatestr (01/10/26) def
/modtimestr (14:07:35) def
/user_header_p true def
/user_header_left_str (RFC-044: Node Enrollment Protocol) def
/user_header_center_str (01/10/26) def
/user_header_right_str (Page 2 of 10) def
/user_footer_p false def
%%EndPageSetup
do_header
5 600 M
(    On the master: one command to approve.) s
5 580 M
(------------------------------------------------------------------------------) s
5 560 M
(The Protocol) s
5 540 M
(Overview) s
5 520 M
(    ) s
26.6 520 9 9 3 wrapped_line_mark
5 510 M
(\342\\224\\214\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342) s
447.8 510 9 9 3 wrapped_line_mark
5 500 M
(\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\220                      ) s
410 500 9 9 3 wrapped_line_mark
5 490 M
(\342\\224\\214\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342) s
447.8 490 9 9 3 wrapped_line_mark
5 480 M
(\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\220) s
5 470 M
(    \342\\224\\202  starlight  \342\\224\\202                      \342\\224\\202   fluffy    ) s
431.6 470 9 9 3 wrapped_line_mark
5 460 M
(\342\\224\\202) s
5 450 M
(    \342\\224\\202  \(new node\) \342\\224\\202                      \342\\224\\202  \(master\)   ) s
431.6 450 9 9 3 wrapped_line_mark
5 440 M
(\342\\224\\202) s
5 430 M
(    ) s
26.6 430 9 9 3 wrapped_line_mark
5 420 M
(\342\\224\\224\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\254\342\\224\\200\342\\224) s
453.2 420 9 9 3 wrapped_line_mark
5 410 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\230                      ) s
388.4 410 9 9 3 wrapped_line_mark
5 400 M
(\342\\224\\224\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\254\342\\224\\200\342\\224) s
453.2 400 9 9 3 wrapped_line_mark
5 390 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\230) s
5 380 M
(           \342\\224\\202                                    \342\\224\\202) s
5 370 M
(           \342\\224\\202  1. Generate keypair               \342\\224\\202) s
5 360 M
(           \342\\224\\202  2. Display verification words     \342\\224\\202) s
5 350 M
(           \342\\224\\202                                    \342\\224\\202) s
5 340 M
(           \342\\224\\202\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200 enrollment request ) s
415.4 340 9 9 3 wrapped_line_mark
5 330 M
(\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342) s
447.8 330 9 9 3 wrapped_line_mark
5 320 M
(\\224\\200\342\\224\\200>\342\\224\\202) s
5 310 M
(           \342\\224\\202     \(pubkey, proposed name\)        \342\\224\\202) s
5 300 M
(           \342\\224\\202                                    \342\\224\\202) s
5 290 M
(           \342\\224\\202                      3. Display words) s
5 280 M
(           \342\\224\\202                      4. Human verifies) s
5 270 M
(           \342\\224\\202                      5. Master signs cert) s
5 260 M
(           \342\\224\\202                                    \342\\224\\202) s
5 250 M
(           \342\\224\\202<\342\\224\\200\342\\224\\200\342\\224\\200 enrollment response ) s
377.6 250 9 9 3 wrapped_line_mark
5 240 M
(\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342) s
447.8 240 9 9 3 wrapped_line_mark
5 230 M
(\\224\\200\342\\224\\200\342\\224\\202) s
5 220 M
(           \342\\224\\202     \(signed certificate\)           \342\\224\\202) s
5 210 M
(           \342\\224\\202                                    \342\\224\\202) s
5 200 M
(           \342\\224\\202  6. Store certificate              \342\\224\\202) s
5 190 M
(           \342\\224\\202  7. Node is enrolled               \342\\224\\202) s
5 180 M
(           \342\\224\\202                                    \342\\224\\202) s
5 170 M
(           \342\\226\274                                    \342\\226\274) s
5 150 M
(------------------------------------------------------------------------------) s
5 130 M
(Step 1: New Node Generates Keys) s
5 110 M
(On starlight, run:) s
5 90 M
(    $ cyberspace enroll starlight) s
5 70 M
(The node:) s
5 50 M
(1. Generates an Ed25519 keypair) s
5 40 M
(2. Computes verification words from the public key) s
5 30 M
(3. Displays them prominently) s
5 10 M
(    ) s
26.6 10 9 9 3 wrapped_line_mark
_R
S
%%Page: (3) 3
%%BeginPageSetup
_S
72 72 translate
/pagenum 3 def
/fname (rfc-051-node-enrollment.txt) def
/fdir (.) def
/ftail (rfc-051-node-enrollment.txt) def
% User defined strings:
/pagenumstr (3) def
/moddatestr (01/10/26) def
/modtimestr (14:07:35) def
/user_header_p true def
/user_header_left_str (RFC-044: Node Enrollment Protocol) def
/user_header_center_str (01/10/26) def
/user_header_right_str (Page 3 of 10) def
/user_footer_p false def
%%EndPageSetup
do_header
5 600 M
(\342\\225\255\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
453.2 600 9 9 3 wrapped_line_mark
5 590 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 590 9 9 3 wrapped_line_mark
5 580 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 580 9 9 3 wrapped_line_mark
5 570 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 570 9 9 3 wrapped_line_mark
5 560 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 560 9 9 3 wrapped_line_mark
5 550 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\225\256) s
5 540 M
(    \342\\224\\202                                                \342\\224\\202) s
5 530 M
(    \342\\224\\202  Requesting enrollment as: starlight           \342\\224\\202) s
5 520 M
(    \342\\224\\202                                                \342\\224\\202) s
5 510 M
(    \342\\224\\202  Verification words:                           \342\\224\\202) s
5 500 M
(    \342\\224\\202                                                \342\\224\\202) s
5 490 M
(    \342\\224\\202      castle  river  orange  lighthouse         \342\\224\\202) s
5 480 M
(    \342\\224\\202                                                \342\\224\\202) s
5 470 M
(    \342\\224\\202  Waiting for master to approve...              \342\\224\\202) s
5 460 M
(    \342\\224\\202                                                \342\\224\\202) s
5 450 M
(    ) s
26.6 450 9 9 3 wrapped_line_mark
5 440 M
(\342\\225\260\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
453.2 440 9 9 3 wrapped_line_mark
5 430 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 430 9 9 3 wrapped_line_mark
5 420 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 420 9 9 3 wrapped_line_mark
5 410 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 410 9 9 3 wrapped_line_mark
5 400 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 400 9 9 3 wrapped_line_mark
5 390 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\225\257) s
5 370 M
(The node broadcasts its enrollment request on the local network) s
5 360 M
(\(mDNS/Bonjour\) and waits.) s
5 340 M
(------------------------------------------------------------------------------) s
5 320 M
(Step 2: Master Receives Request) s
5 300 M
(On fluffy, the master sees:) s
5 280 M
(    ) s
26.6 280 9 9 3 wrapped_line_mark
5 270 M
(\342\\225\255\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
453.2 270 9 9 3 wrapped_line_mark
5 260 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 260 9 9 3 wrapped_line_mark
5 250 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 250 9 9 3 wrapped_line_mark
5 240 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 240 9 9 3 wrapped_line_mark
5 230 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 230 9 9 3 wrapped_line_mark
5 220 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\225\256) s
5 210 M
(    \342\\224\\202                                                \342\\224\\202) s
5 200 M
(    \342\\224\\202  Enrollment request received                   \342\\224\\202) s
5 190 M
(    \342\\224\\202                                                \342\\224\\202) s
5 180 M
(    \342\\224\\202  Proposed name: starlight                      \342\\224\\202) s
5 170 M
(    \342\\224\\202  From: 192.168.0.42                            \342\\224\\202) s
5 160 M
(    \342\\224\\202  Hardware: MacBook Air \(M4\)                    \342\\224\\202) s
5 150 M
(    \342\\224\\202                                                \342\\224\\202) s
5 140 M
(    \342\\224\\202  Verification words:                           \342\\224\\202) s
5 130 M
(    \342\\224\\202                                                \342\\224\\202) s
5 120 M
(    \342\\224\\202      castle  river  orange  lighthouse         \342\\224\\202) s
5 110 M
(    \342\\224\\202                                                \342\\224\\202) s
5 100 M
(    \342\\224\\202  Do these match what you see on starlight?     \342\\224\\202) s
5 90 M
(    \342\\224\\202                                                \342\\224\\202) s
5 80 M
(    \342\\224\\202  [y] Approve   [n] Reject   [?] Help           \342\\224\\202) s
5 70 M
(    \342\\224\\202                                                \342\\224\\202) s
5 60 M
(    ) s
26.6 60 9 9 3 wrapped_line_mark
5 50 M
(\342\\225\260\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
453.2 50 9 9 3 wrapped_line_mark
5 40 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 40 9 9 3 wrapped_line_mark
5 30 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 30 9 9 3 wrapped_line_mark
5 20 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 20 9 9 3 wrapped_line_mark
5 10 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 10 9 9 3 wrapped_line_mark
_R
S
%%Page: (4) 4
%%BeginPageSetup
_S
72 72 translate
/pagenum 4 def
/fname (rfc-051-node-enrollment.txt) def
/fdir (.) def
/ftail (rfc-051-node-enrollment.txt) def
% User defined strings:
/pagenumstr (4) def
/moddatestr (01/10/26) def
/modtimestr (14:07:35) def
/user_header_p true def
/user_header_left_str (RFC-044: Node Enrollment Protocol) def
/user_header_center_str (01/10/26) def
/user_header_right_str (Page 4 of 10) def
/user_footer_p false def
%%EndPageSetup
do_header
5 600 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\225\257) s
5 580 M
(The human:) s
5 560 M
(1. Walks over to starlight \(or looks at it across the room\)) s
5 550 M
(2. Reads the words displayed there) s
5 540 M
(3. Confirms they match) s
5 520 M
(This is the attestation. Physical presence. Human verification.) s
5 500 M
(------------------------------------------------------------------------------) s
5 480 M
(Step 3: Master Signs Certificate) s
5 460 M
(If approved, the master:) s
5 440 M
(1. Creates an SPKI certificate binding the name to the public key) s
5 430 M
(2. Signs it with the master key) s
5 420 M
(3. Sends it back to the node) s
5 400 M
(    \(spki-cert) s
5 390 M
(      \(issuer \(public-key \(ed25519 "fluffy-master-key..."\)\)\)) s
5 380 M
(      \(subject \(public-key \(ed25519 "starlight-pubkey..."\)\)\)) s
5 370 M
(      \(name starlight\)) s
5 360 M
(      \(capability) s
5 350 M
(        \(action vault-read vault-write sync-participate\)\)) s
5 340 M
(      \(validity) s
5 330 M
(        \(not-before 2026-01-09\)) s
5 320 M
(        \(not-after 2027-01-09\)\)) s
5 310 M
(      \(signature ...\)\)) s
5 290 M
(The certificate says: "I, fluffy, declare that this key is starlight,) s
5 280 M
(and starlight may read, write, and sync.") s
5 260 M
(------------------------------------------------------------------------------) s
5 240 M
(Step 4: Node Receives Certificate) s
5 220 M
(Starlight receives and stores the certificate:) s
5 200 M
(    ) s
26.6 200 9 9 3 wrapped_line_mark
5 190 M
(\342\\225\255\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
453.2 190 9 9 3 wrapped_line_mark
5 180 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 180 9 9 3 wrapped_line_mark
5 170 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 170 9 9 3 wrapped_line_mark
5 160 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 160 9 9 3 wrapped_line_mark
5 150 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 150 9 9 3 wrapped_line_mark
5 140 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\225\256) s
5 130 M
(    \342\\224\\202                                                \342\\224\\202) s
5 120 M
(    \342\\224\\202  Enrollment complete!                          \342\\224\\202) s
5 110 M
(    \342\\224\\202                                                \342\\224\\202) s
5 100 M
(    \342\\224\\202  You are now: starlight                        \342\\224\\202) s
5 90 M
(    \342\\224\\202  Blessed by: fluffy                            \342\\224\\202) s
5 80 M
(    \342\\224\\202  Role: full                                    \342\\224\\202) s
5 70 M
(    \342\\224\\202  Valid until: 2027-01-09                       \342\\224\\202) s
5 60 M
(    \342\\224\\202                                                \342\\224\\202) s
5 50 M
(    \342\\224\\202  Certificate stored in ~/.cyberspace/          \342\\224\\202) s
5 40 M
(    \342\\224\\202                                                \342\\224\\202) s
5 30 M
(    \342\\224\\202  Run 'cyberspace status' to verify.            \342\\224\\202) s
5 20 M
(    \342\\224\\202                                                \342\\224\\202) s
5 10 M
(    ) s
26.6 10 9 9 3 wrapped_line_mark
_R
S
%%Page: (5) 5
%%BeginPageSetup
_S
72 72 translate
/pagenum 5 def
/fname (rfc-051-node-enrollment.txt) def
/fdir (.) def
/ftail (rfc-051-node-enrollment.txt) def
% User defined strings:
/pagenumstr (5) def
/moddatestr (01/10/26) def
/modtimestr (14:07:35) def
/user_header_p true def
/user_header_left_str (RFC-044: Node Enrollment Protocol) def
/user_header_center_str (01/10/26) def
/user_header_right_str (Page 5 of 10) def
/user_footer_p false def
%%EndPageSetup
do_header
5 600 M
(\342\\225\260\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
453.2 600 9 9 3 wrapped_line_mark
5 590 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 590 9 9 3 wrapped_line_mark
5 580 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 580 9 9 3 wrapped_line_mark
5 570 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 570 9 9 3 wrapped_line_mark
5 560 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 560 9 9 3 wrapped_line_mark
5 550 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\225\257) s
5 530 M
(Done. Five minutes. No hex strings. No manual key copying.) s
5 510 M
(------------------------------------------------------------------------------) s
5 490 M
(Verification Words) s
5 470 M
(The word list uses the PGP Word List \(or similar\):) s
5 450 M
(- 256 even-position words \(two syllables\)) s
5 440 M
(- 256 odd-position words \(three syllables\)) s
5 430 M
(- Phonetically distinct \(no rhymes, no similar sounds\)) s
5 420 M
(- Easy to speak over the phone) s
5 400 M
(Converting public key to words:) s
5 380 M
(    \(define \(pubkey->words pubkey\)) s
5 370 M
(      "Convert public key to verification words") s
5 360 M
(      \(let* \(\(hash \(sha256 pubkey\)\)) s
5 350 M
(             \(bytes \(take hash 4\)\)\)  ; First 4 bytes = 4 words) s
5 340 M
(        \(map byte->word bytes\)\)\)) s
5 320 M
(    ;; Example) s
5 310 M
(    \(pubkey->words starlight-pubkey\)) s
5 300 M
(    => \("castle" "river" "orange" "lighthouse"\)) s
5 280 M
(Why only 4 words?) s
5 260 M
(- 32 bits of entropy) s
5 250 M
(- Enough to prevent accidental confusion) s
5 240 M
(- Not trying to prevent brute force \(physical presence does that\)) s
5 230 M
(- Short enough to remember while walking across the room) s
5 210 M
(------------------------------------------------------------------------------) s
5 190 M
(Local Discovery) s
5 170 M
(Enrollment uses mDNS \(Bonjour\) for local discovery:) s
5 150 M
(    Service: _cyberspace-enroll._tcp.local) s
5 140 M
(    TXT record: name=starlight, pubkey=<base64>) s
5 120 M
(The master listens for enrollment requests on the local network only.) s
5 110 M
(No enrollment over the internet. Physical proximity required.) s
5 90 M
(    \(define \(broadcast-enrollment-request name pubkey\)) s
5 80 M
(      \(mdns-register) s
5 70 M
(        service: "_cyberspace-enroll._tcp.local") s
5 60 M
(        port: 7654) s
5 50 M
(        txt: `\(\(name ,name\)) s
5 40 M
(               \(pubkey ,\(base64-encode pubkey\)\)) s
5 30 M
(               \(timestamp ,\(current-time\)\)\)\)\)) s
5 10 M
(------------------------------------------------------------------------------) s
_R
S
%%Page: (6) 6
%%BeginPageSetup
_S
72 72 translate
/pagenum 6 def
/fname (rfc-051-node-enrollment.txt) def
/fdir (.) def
/ftail (rfc-051-node-enrollment.txt) def
% User defined strings:
/pagenumstr (6) def
/moddatestr (01/10/26) def
/modtimestr (14:07:35) def
/user_header_p true def
/user_header_left_str (RFC-044: Node Enrollment Protocol) def
/user_header_center_str (01/10/26) def
/user_header_right_str (Page 6 of 10) def
/user_footer_p false def
%%EndPageSetup
do_header
5 590 M
(Roles and Capabilities) s
5 570 M
(When approving, the master assigns a role:) s
5 550 M
(    ) s
26.6 550 9 9 3 wrapped_line_mark
5 540 M
(\342\\225\255\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
453.2 540 9 9 3 wrapped_line_mark
5 530 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 530 9 9 3 wrapped_line_mark
5 520 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 520 9 9 3 wrapped_line_mark
5 510 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 510 9 9 3 wrapped_line_mark
5 500 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 500 9 9 3 wrapped_line_mark
5 490 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\225\256) s
5 480 M
(    \342\\224\\202                                                \342\\224\\202) s
5 470 M
(    \342\\224\\202  Assign role for starlight:                    \342\\224\\202) s
5 460 M
(    \342\\224\\202                                                \342\\224\\202) s
5 450 M
(    \342\\224\\202  [1] full     - Read, write, sync, witness     \342\\224\\202) s
5 440 M
(    \342\\224\\202  [2] witness  - Read, sync, witness votes      \342\\224\\202) s
5 430 M
(    \342\\224\\202  [3] archive  - Read-only backup               \342\\224\\202) s
5 420 M
(    \342\\224\\202  [4] custom   - Choose specific capabilities   \342\\224\\202) s
5 410 M
(    \342\\224\\202                                                \342\\224\\202) s
5 400 M
(    ) s
26.6 400 9 9 3 wrapped_line_mark
5 390 M
(\342\\225\260\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
453.2 390 9 9 3 wrapped_line_mark
5 380 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 380 9 9 3 wrapped_line_mark
5 370 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 370 9 9 3 wrapped_line_mark
5 360 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 360 9 9 3 wrapped_line_mark
5 350 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 350 9 9 3 wrapped_line_mark
5 340 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\225\257) s
5 320 M
(Roles map to SPKI capabilities:) s
5 300 M
(    \(define roles) s
5 290 M
(      '\(\(full    \(vault-read vault-write sync-participate witness-vote\)\)) s
5 280 M
(        \(witness \(vault-read sync-participate witness-vote\)\)) s
5 270 M
(        \(archive \(vault-read sync-receive\)\)\)\)) s
5 250 M
(------------------------------------------------------------------------------) s
5 230 M
(Certificate Renewal) s
5 210 M
(Certificates expire \(default: 1 year\). Before expiry:) s
5 190 M
(    ) s
26.6 190 9 9 3 wrapped_line_mark
5 180 M
(\342\\225\255\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
453.2 180 9 9 3 wrapped_line_mark
5 170 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 170 9 9 3 wrapped_line_mark
5 160 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 160 9 9 3 wrapped_line_mark
5 150 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 150 9 9 3 wrapped_line_mark
5 140 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 140 9 9 3 wrapped_line_mark
5 130 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\225\256) s
5 120 M
(    \342\\224\\202                                                \342\\224\\202) s
5 110 M
(    \342\\224\\202  Certificate expires in 30 days               \342\\224\\202) s
5 100 M
(    \342\\224\\202                                                \342\\224\\202) s
5 90 M
(    \342\\224\\202  Run 'cyberspace renew' to request renewal    \342\\224\\202) s
5 80 M
(    \342\\224\\202                                                \342\\224\\202) s
5 70 M
(    ) s
26.6 70 9 9 3 wrapped_line_mark
5 60 M
(\342\\225\260\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
453.2 60 9 9 3 wrapped_line_mark
5 50 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 50 9 9 3 wrapped_line_mark
5 40 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 40 9 9 3 wrapped_line_mark
5 30 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 30 9 9 3 wrapped_line_mark
5 20 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 20 9 9 3 wrapped_line_mark
5 10 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\225\257) s
_R
S
%%Page: (7) 7
%%BeginPageSetup
_S
72 72 translate
/pagenum 7 def
/fname (rfc-051-node-enrollment.txt) def
/fdir (.) def
/ftail (rfc-051-node-enrollment.txt) def
% User defined strings:
/pagenumstr (7) def
/moddatestr (01/10/26) def
/modtimestr (14:07:35) def
/user_header_p true def
/user_header_left_str (RFC-044: Node Enrollment Protocol) def
/user_header_center_str (01/10/26) def
/user_header_right_str (Page 7 of 10) def
/user_footer_p false def
%%EndPageSetup
do_header
5 590 M
(Renewal is simpler than initial enrollment - the node already has a) s
5 580 M
(valid certificate, so it can authenticate the renewal request) s
5 570 M
(cryptographically. No word verification needed.) s
5 550 M
(    $ cyberspace renew) s
5 530 M
(    ) s
26.6 530 9 9 3 wrapped_line_mark
5 520 M
(\342\\225\255\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
453.2 520 9 9 3 wrapped_line_mark
5 510 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 510 9 9 3 wrapped_line_mark
5 500 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 500 9 9 3 wrapped_line_mark
5 490 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 490 9 9 3 wrapped_line_mark
5 480 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 480 9 9 3 wrapped_line_mark
5 470 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\225\256) s
5 460 M
(    \342\\224\\202                                                \342\\224\\202) s
5 450 M
(    \342\\224\\202  Renewal request sent to fluffy               \342\\224\\202) s
5 440 M
(    \342\\224\\202  ...                                           \342\\224\\202) s
5 430 M
(    \342\\224\\202  Certificate renewed until 2028-01-09          \342\\224\\202) s
5 420 M
(    \342\\224\\202                                                \342\\224\\202) s
5 410 M
(    ) s
26.6 410 9 9 3 wrapped_line_mark
5 400 M
(\342\\225\260\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
453.2 400 9 9 3 wrapped_line_mark
5 390 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 390 9 9 3 wrapped_line_mark
5 380 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 380 9 9 3 wrapped_line_mark
5 370 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 370 9 9 3 wrapped_line_mark
5 360 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 360 9 9 3 wrapped_line_mark
5 350 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\225\257) s
5 330 M
(------------------------------------------------------------------------------) s
5 310 M
(Revocation) s
5 290 M
(If a node is compromised or retired:) s
5 270 M
(    $ cyberspace revoke starlight) s
5 250 M
(    ) s
26.6 250 9 9 3 wrapped_line_mark
5 240 M
(\342\\225\255\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
453.2 240 9 9 3 wrapped_line_mark
5 230 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 230 9 9 3 wrapped_line_mark
5 220 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 220 9 9 3 wrapped_line_mark
5 210 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 210 9 9 3 wrapped_line_mark
5 200 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 200 9 9 3 wrapped_line_mark
5 190 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\225\256) s
5 180 M
(    \342\\224\\202                                                \342\\224\\202) s
5 170 M
(    \342\\224\\202  Revoke certificate for: starlight            \342\\224\\202) s
5 160 M
(    \342\\224\\202                                                \342\\224\\202) s
5 150 M
(    \342\\224\\202  This will:                                    \342\\224\\202) s
5 140 M
(    \342\\224\\202  - Add starlight to the revocation list       \342\\224\\202) s
5 130 M
(    \342\\224\\202  - Notify all confederation nodes             \342\\224\\202) s
5 120 M
(    \342\\224\\202  - Prevent starlight from syncing             \342\\224\\202) s
5 110 M
(    \342\\224\\202                                                \342\\224\\202) s
5 100 M
(    \342\\224\\202  Type 'starlight' to confirm: _               \342\\224\\202) s
5 90 M
(    \342\\224\\202                                                \342\\224\\202) s
5 80 M
(    ) s
26.6 80 9 9 3 wrapped_line_mark
5 70 M
(\342\\225\260\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
453.2 70 9 9 3 wrapped_line_mark
5 60 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 60 9 9 3 wrapped_line_mark
5 50 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 50 9 9 3 wrapped_line_mark
5 40 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 40 9 9 3 wrapped_line_mark
5 30 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
442.4 30 9 9 3 wrapped_line_mark
5 20 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\225\257) s
_R
S
%%Page: (8) 8
%%BeginPageSetup
_S
72 72 translate
/pagenum 8 def
/fname (rfc-051-node-enrollment.txt) def
/fdir (.) def
/ftail (rfc-051-node-enrollment.txt) def
% User defined strings:
/pagenumstr (8) def
/moddatestr (01/10/26) def
/modtimestr (14:07:35) def
/user_header_p true def
/user_header_left_str (RFC-044: Node Enrollment Protocol) def
/user_header_center_str (01/10/26) def
/user_header_right_str (Page 8 of 10) def
/user_footer_p false def
%%EndPageSetup
do_header
5 600 M
(Revocation propagates via the sync protocol. All nodes learn that) s
5 590 M
(starlight is no longer trusted.) s
5 570 M
(------------------------------------------------------------------------------) s
5 550 M
(Implementation) s
5 530 M
(Node-Side CLI) s
5 510 M
(    \(define \(cmd-enroll name\)) s
5 500 M
(      "Request enrollment in the confederation") s
5 480 M
(      ;; Generate keypair) s
5 470 M
(      \(let* \(\(keypair \(ed25519-generate-keypair\)\)) s
5 460 M
(             \(pubkey \(keypair-public keypair\)\)) s
5 450 M
(             \(words \(pubkey->words pubkey\)\)\)) s
5 430 M
(        ;; Save private key locally) s
5 420 M
(        \(save-private-key keypair\)) s
5 400 M
(        ;; Display verification words) s
5 390 M
(        \(display-enrollment-ui name words\)) s
5 370 M
(        ;; Broadcast enrollment request) s
5 360 M
(        \(broadcast-enrollment-request name pubkey\)) s
5 340 M
(        ;; Wait for response) s
5 330 M
(        \(let \(\(response \(wait-for-enrollment-response\)\)\)) s
5 320 M
(          \(if \(enrollment-approved? response\)) s
5 310 M
(              \(begin) s
5 300 M
(                \(save-certificate \(enrollment-certificate response\)\)) s
5 290 M
(                \(display-success name\)\)) s
5 280 M
(              \(display-rejection response\)\)\)\)\)) s
5 260 M
(Master-Side Handler) s
5 240 M
(    \(define \(handle-enrollment-request request\)) s
5 230 M
(      "Process incoming enrollment request") s
5 220 M
(      \(let* \(\(name \(request-name request\)\)) s
5 210 M
(             \(pubkey \(request-pubkey request\)\)) s
5 200 M
(             \(words \(pubkey->words pubkey\)\)\)) s
5 180 M
(        ;; Display for human verification) s
5 170 M
(        \(display-approval-ui name words\)) s
5 150 M
(        ;; Get human decision) s
5 140 M
(        \(let \(\(decision \(prompt-approval\)\)\)) s
5 130 M
(          \(case decision) s
5 120 M
(            \(\(approve\)) s
5 110 M
(             \(let* \(\(role \(prompt-role\)\)) s
5 100 M
(                    \(cert \(create-enrollment-cert name pubkey role\)\)\)) s
5 90 M
(               \(send-enrollment-response request cert\)\)\)) s
5 70 M
(            \(\(reject\)) s
5 60 M
(             \(send-rejection request "Rejected by operator"\)\)\)\)\)\)) s
5 40 M
(------------------------------------------------------------------------------) s
5 20 M
(Security Considerations) s
_R
S
%%Page: (9) 9
%%BeginPageSetup
_S
72 72 translate
/pagenum 9 def
/fname (rfc-051-node-enrollment.txt) def
/fdir (.) def
/ftail (rfc-051-node-enrollment.txt) def
% User defined strings:
/pagenumstr (9) def
/moddatestr (01/10/26) def
/modtimestr (14:07:35) def
/user_header_p true def
/user_header_left_str (RFC-044: Node Enrollment Protocol) def
/user_header_center_str (01/10/26) def
/user_header_right_str (Page 9 of 10) def
/user_footer_p false def
%%EndPageSetup
do_header
5 600 M
(Physical Presence Requirement) s
5 580 M
(    The entire security model rests on physical presence:) s
5 560 M
(    - Enrollment only works on local network) s
5 550 M
(    - Human must visually verify words) s
5 540 M
(    - No remote enrollment possible) s
5 520 M
(    If an attacker has physical access to your network AND can) s
5 510 M
(    intercept your visual verification, you have bigger problems.) s
5 490 M
(Word Collision) s
5 470 M
(    With 32 bits, collision probability is ~1 in 4 billion.) s
5 460 M
(    If you're enrolling billions of nodes, use more words.) s
5 450 M
(    For a small confederation, 4 words is plenty.) s
5 430 M
(Certificate Theft) s
5 410 M
(    If someone steals a node's private key:) s
5 390 M
(    1. Revoke the certificate immediately) s
5 380 M
(    2. Re-enroll with a new keypair) s
5 370 M
(    3. The old key is useless once revoked) s
5 350 M
(Man-in-the-Middle) s
5 330 M
(    An attacker could intercept the enrollment and substitute their) s
5 320 M
(    own public key. But then the words wouldn't match. The human) s
5 310 M
(    verification defeats this attack.) s
5 290 M
(------------------------------------------------------------------------------) s
5 270 M
(Future Extensions) s
5 250 M
(Multi-Master Enrollment) s
5 230 M
(    For confederations with multiple masters, enrollment could require) s
5 220 M
(    approval from K-of-N masters \(threshold enrollment\). This is) s
5 210 M
(    explicitly deferred to keep the initial protocol simple.) s
5 190 M
(Remote Enrollment) s
5 170 M
(    For nodes that can't be physically present, a ceremony involving) s
5 160 M
(    video call + word verification could work. Also deferred.) s
5 140 M
(Hardware Attestation) s
5 120 M
(    TPM-based attestation could supplement \(not replace\) human) s
5 110 M
(    verification. This adds complexity without clear benefit for) s
5 100 M
(    small confederations.) s
5 80 M
(------------------------------------------------------------------------------) s
5 60 M
(User Experience Summary) s
5 40 M
(For the person enrolling starlight:) s
5 20 M
(    1. Run: cyberspace enroll starlight) s
5 10 M
(    2. See four words on screen) s
_R
S
%%Page: (10) 10
%%BeginPageSetup
_S
72 72 translate
/pagenum 10 def
/fname (rfc-051-node-enrollment.txt) def
/fdir (.) def
/ftail (rfc-051-node-enrollment.txt) def
% User defined strings:
/pagenumstr (10) def
/moddatestr (01/10/26) def
/modtimestr (14:07:35) def
/user_header_p true def
/user_header_left_str (RFC-044: Node Enrollment Protocol) def
/user_header_center_str (01/10/26) def
/user_header_right_str (Page 10 of 10) def
/user_footer_p false def
%%EndPageSetup
do_header
5 600 M
(    3. Walk to the master) s
5 590 M
(    4. Confirm the same words appear there) s
5 580 M
(    5. Press 'y') s
5 570 M
(    6. Done) s
5 550 M
(That's it. Four words. One confirmation. Welcome to the confederation.) s
5 530 M
(------------------------------------------------------------------------------) s
5 510 M
(References) s
5 490 M
(1. RFC-000: The Library of Cyberspace) s
5 480 M
(2. RFC-022: Key Ceremony Protocol) s
5 470 M
(3. RFC-010: Federation) s
5 460 M
(4. PGP Word List - https://en.wikipedia.org/wiki/PGP_word_list) s
5 450 M
(5. RFC 2693 - SPKI Certificate Theory) s
5 430 M
(------------------------------------------------------------------------------) s
5 410 M
(Changelog) s
5 390 M
(- 2026-01-09: Initial draft, inspired by starlight's arrival) s
5 370 M
(------------------------------------------------------------------------------) s
5 350 M
(Implementation Status: Draft) s
5 340 M
(Dependencies: spki, mdns, word-list) s
5 330 M
(Integration: cyberspace CLI, vault initialization) s
_R
S
%%Trailer
%%Pages: 10
%%DocumentNeededResources: font Helvetica-Bold Times-Roman Courier 
%%+ font Times-Bold 
%%EOF
