;; assertion-catalog.scm - Auto-generated kernel assertion catalog
;; Generated by extract-assertions.sh
;; DO NOT EDIT - regenerate with: ./docs/rfc/extract-assertions.sh

(define *assertion-catalog*
  '(
    ;; === Instrumentation Points (session-stat!) ===
    (instrumentation bytes-in "./gossip.scm" 179)
    (instrumentation bytes-out "./gossip.scm" 169)
    (instrumentation bytes-written "./vault.scm" 653)
    (instrumentation commits "./repl.scm" 5221)
    (instrumentation decrypts "./vault.scm" 317)
    (instrumentation encrypts "./vault.scm" 261)
    (instrumentation federation-changes "./repl.scm" 5252)
    (instrumentation gossip-exchanges "./repl.scm" 5572)
    (instrumentation hashes "./vault.scm" 2083)
    (instrumentation mdns-messages "./mdns.scm" 128)
    (instrumentation packets-ipv "./gossip.scm" 185)
    (instrumentation peers-discovered "./repl.scm" 5564)
    (instrumentation queries "./repl.scm" 1471)
    (instrumentation reads "./vault.scm" 1349)
    (instrumentation seals "./repl.scm" 5222)
    (instrumentation signs "./repl.scm" 5232)
    (instrumentation syncs "./repl.scm" 1346)
    (instrumentation unlocks "./docs/notes/memo-0045-security-architecture.scm" 388)
    (instrumentation verifies "./repl.scm" 5237)
    (instrumentation votes "./repl.scm" 1604)
    (instrumentation wormholes "./repl.scm" 2090)
    (instrumentation writes "./vault.scm" 652)

    ;; === Security Errors ===
    (security-error capability-amplification "./repl.scm" 2132)
    (security-error confidentiality-violation "./repl.scm" 2347)
    (security-error delegate-denied "./repl.scm" 2382)
    (security-error delete-denied "./repl.scm" 2379)
    (security-error forbidden "./docs/notes/memo-0026-network-protocol.scm" 134)
    (security-error integrity-violation "./repl.scm" 2351)
    (security-error invalid-bearer-capability "./docs/notes/memo-0045-security-architecture.scm" 205)
    (security-error no-ambient-authority "./repl.scm" 2368)
    (security-error rate-limited "./docs/notes/memo-0042-fuse-filesystem.scm" 216)
    (security-error read-denied "./repl.scm" 2373)
    (security-error secure-clear "./repl.scm" 2541)
    (security-error secure-clear-failed "./repl.scm" 2529)
    (security-error unauthorized "./docs/notes/memo-0040-local-inference.scm" 71)
    (security-error write-denied "./repl.scm" 2376)

    ;; === Precondition Guards ===
    (precondition directory-exists? keystore-path "./enroll.scm" 497)
    (precondition directory-exists? ".forge" "./repl.scm" 409)
    (precondition chaotic? thing "./repl.scm" 996)
    (precondition attested? "./repl.scm" 1145)
    (precondition quiescent? memo "./repl.scm" 1249)
    (precondition attested? "./repl.scm" 1789)
    (precondition attested? "./repl.scm" 1817)
    (precondition directory-exists? ".vault/keys" "./repl.scm" 4010)
    (precondition attested? "./docs/notes/memo-0045-security-architecture.scm" 390)
    (precondition quiescent? memo "./docs/notes/memo-0045-security-architecture.scm" 410)
    (precondition directory-exists? output-dir "./spki-keygen.scm" 83)
    (precondition directory-exists? *forum-path* "./forum.scm" 52)
    (precondition directory-exists? d "./scrutinize.scm" 191)
    (precondition directory-exists? path "./keyring.scm" 76)
    (precondition directory-exists? ks-dir "./vault.scm" 247)
    (precondition keystore-exists? "./vault.scm" 301)
    (precondition directory-exists? ".vault" "./vault.scm" 421)
))

;; Summary counts
(define (assertion-summary)
  (let ((instrs (filter (lambda (a) (eq? (car a) 'instrumentation)) *assertion-catalog*))
        (errors (filter (lambda (a) (eq? (car a) 'security-error)) *assertion-catalog*))
        (guards (filter (lambda (a) (eq? (car a) 'precondition)) *assertion-catalog*)))
    `((instrumentation-points . ,(length instrs))
      (security-errors . ,(length errors))
      (precondition-guards . ,(length guards))
      (total . ,(length *assertion-catalog*)))))
