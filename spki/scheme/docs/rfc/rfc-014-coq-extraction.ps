%!PS-Adobe-3.0
%%Creator: groff version 1.23.0
%%CreationDate: Fri Jan  9 11:49:18 2026
%%DocumentNeededResources: font Times-Roman
%%DocumentSuppliedResources: procset grops 1.23 0
%%Pages: 5
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.23 0
%!PS-Adobe-3.0 Resource-ProcSet
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
% The ASCII code of the space character.
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
% name size font SF -
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
% name a c d font MF -
/MF{
findfont
[5 2 roll
0 3 1 roll % b
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
% Enable manual feed.
% MANUAL -
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
% Guess the page length.
% This assumes that the imageable area is vertically centered on the page.
% PLG - length
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
% BP -
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
% centerx centery radius startangle endangle DA -
/DA{
newpath arcn stroke
}bind def
% x y SN - x' y'
% round a position to nearest (pixel + (.25,.25))
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
% endx endy startx starty DL -
% we round the endpoints of the line, so that parallel horizontal
% and vertical lines will appear even
/DL{
SN
moveto
SN
lineto stroke
}bind def
% centerx centery radius DC -
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
%  width height centerx centery DE -
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
% these are for splines
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
% fill the last path
% r g b Fr -
/Fr{
setrgbcolor fill
}bind def
% c m y k Fk -
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
% g Fg -
/Fg{
setgray fill
}bind def
% fill with the "current color"
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
% new_font_name encoding_vector old_font_name RE -
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
% hpos vpos EBEGIN -
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
% llx lly newwid wid newht ht newllx newlly PBEGIN -
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
% set the graphics state to default values
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
%
%  Any included setpagedevice should be ignored.
%  See: http://www.w-beer.de/doc/ps/.
%
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%EndProlog
%%BeginSetup
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Times-Roman
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/Euro/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Times-Roman@0 ENC0/Times-Roman RE
%%EndSetup
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(RFC-014: Coq Extraction for TCB)72 12 Q(Status:\
 Proposed Date: January 2026 Author: Derrell Piper <ddp@eludom.net>)72
36 Q(------------------------------------------------------------------\
------------)72 60 Q(Abstract)72 84 Q .468
(This RFC speci\214es the use of Coq proof assistant for v)72 108 R .468
(eri\214ed implementation of the T)-.15 F .468
(rusted Computing Base, with)-.35 F -.15(ex)72 120 S
(traction to OCaml for production use. Pro).15 E .3 -.15(ve o)-.15 H
(nce, trust fore).15 E -.15(ve)-.25 G -.55(r.).15 G(-------------------\
-----------------------------------------------------------)72 144 Q
(Moti)72 168 Q -.25(va)-.25 G(tion).25 E(The Prime Directi)72 192 Q .3
-.15(ve \()-.25 H(RFC-002\):).15 E(If it')77 216 Q 2.5(si)-.55 G 2.5(nt)
-2.5 G(he TCB, it')-2.5 E 2.5(si)-.55 G 2.5(nO)-2.5 G
(Caml. Otherwise it')-2.5 E 2.5(si)-.55 G 2.5(nC)-2.5 G(hick)-2.5 E
(en Scheme.)-.1 E .246(But e)72 240 R -.15(ve)-.25 G 2.746(nO).15 G .246
(Caml can ha)-2.746 F .546 -.15(ve b)-.2 H .247(ugs. The TCB handles: -\
 Ed25519 signatures - SHA-512 hashing - Signature chain v)-.05 F(eri-)
-.15 E(\214cation)72 252 Q 2.5(As)72 276 S(ingle b)-2.5 E(ug breaks e)
-.2 E -.15(ve)-.25 G(rything.).15 E(Coq pro)72 300 Q(vides:)-.15 E .379
(1. Machine-check)72 324 R .379(ed proofs: Theorems v)-.1 F .378(eri\
\214ed by computer 2. Extraction: Generate OCaml from proofs 3. Correct\
-)-.15 F(ness by construction: Implementation matches speci\214cation 4\
. Eternal v)72 336 Q(alidity: Proofs don')-.25 E 2.5(te)-.18 G(xpire)
-2.65 E(From the Coq motto:)72 360 Q(The proof is in the code.)77 384 Q
(----------------------------------------------------------------------\
--------)72 408 Q(Speci\214cation)72 432 Q -.35(Tr)72 456 S
(usted Computing Base).35 E 12.605<60e2>72 480 S 10.105<e2e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e220e2>-12.605 F(CYBERSP)60.105 E -.4
(AC)-.92 G 12.605(ET).4 G(CB)-12.605 E 141.431 6.069<e2e220e2e2>72 492 T
6.069<e2e2e2e2e2e2e2e2e2e2e2e2e2e2e220e2e2e2e2e2e2e2e2e2e2e2e2e2e2e220e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2>5 F -3.57 6.069<e2e220e2>23.569 H 7.644
(Ed25519 \342)72 504 R 10.144<e253>7.644 G 7.644(HA-512 \342)-10.144 F
10.144<e256>7.644 G 10.144(erify \342)-11.254 F -2.644 5.144
<e2e220e22050>22.644 H(ro)-5.144 E -.15(ve)-.15 G 12.644<6ee2>.15 G
10.144<e250>-5 G(ro)-10.144 E -.15(ve)-.15 G 12.644<6ee2>.15 G 10.144
<e250>-5 G(ro)-10.144 E -.15(ve)-.15 G -5.144 12.644<6ee220e2>.15 H<e2>
-7.5 E 6.967<e2e2e2e2e2e2e2e2ace2e2e2e2e2e2e220e2e2e2e2e2e2e2e2ace2e2e2
e2e2e2e220e2e2e2e2e2e2e2e2ace2e2e2e2e2e2e2>72 516 R 13.033 6.967
<e2e220e2>24.467 H 44.466<e2e2e2>37.5 G<e2>-37.5 E 38.112<e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2bce2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e220e2>72 528 R
-55.613 68.113<e2e220e2>3.113 H 50.613<e243>-65 G .613(oq Ex-)-50.613 F
76.442(traction \342)72 540 R -66.442 78.942<e2e220e2>13.942 H 61.441
<e2e2>-65.001 G<e2e2e2e2e2e2e2bce2e2e2e2e2e2e2>-61.441 E 35.719 9.281
<e2e220e2>72 552 T 14.281(OCaml \342)7.5 F 35.718 9.282<e2e220e2>71.782
H 6.782(~1000 LOC \342)5 F 9.282<e2e2>71.782 G 63.367
<e2e2e2e2e2e2e2e2e2e2e2e2e2e2e220e2>72 564 R 153.367<e2e2>3.367 G 8.367
<e250>-150 G(ro)-8.367 E -.15(ve)-.15 G 3.367(ni).15 G 3.367(nC)-3.367 G
.867(oq. Extracted to OCaml.)-3.367 F 41.494(Called from Scheme.)72 576
R 103.506 43.994<e2e220e2>48.994 H<e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e22060>72 588 Q(---------------------------------------\
---------------------------------------)72 612 Q(Coq Speci\214cations)72
636 Q -.8(Ty)72 660 S(pes).8 E
(`coq \( Byte arrays \) De\214nition bytes := list byte.)72 684 Q 2.5
(\(K)72 708 S -.15(ey)-2.75 G 2.5(s\)R).15 G(ecord ed25519publick)-2.5 E
.3 -.15(ey :)-.1 H 2.5(={).15 G(pk_bytes : bytes;)77 720 Q
(pklength : length pkbytes = 32 }.)77 732 Q(Record ed25519pri)72 756 Q
-.25(va)-.25 G(tek).25 E .3 -.15(ey :)-.1 H 2.5(={).15 G
(sk_bytes : bytes;)77 768 Q(sklength : length skbytes = 64 }.)77 780 Q 0
Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 2.5(\(S)72 12 S
(ignatures \) Record ed25519_signature := {)-2.5 E(sig_bytes : bytes;)77
24 Q(siglength : length sigbytes = 64 }.)77 36 Q 2.5(\(H)72 60 S
(ashes \) Record sha512_hash := {)-2.5 E(hash_bytes : bytes;)77 72 Q
(hashlength : length hashbytes = 64 }.)77 84 Q(`)5 E
(Signature Speci\214cation)72 108 Q
(`coq \( Abstract signature scheme \) Module T)72 132 Q
(ype ED25519_SPEC.)-.8 E -.15(Pa)77 144 S(rameter sign : ed25519pri).15
E -.25(va)-.25 G(tek).25 E .3 -.15(ey -)-.1 H 2.5(>b).15 G
(ytes -> ed25519_signature.)-2.5 E -.15(Pa)77 156 S(rameter v).15 E
(erify : ed25519publick)-.15 E .3 -.15(ey -)-.1 H 2.5(>b).15 G
(ytes -> ed25519_signature -> bool.)-2.5 E 2.5(\(C)77 180 S
(orrectness: v)-2.5 E(alid signatures v)-.25 E(erify \))-.15 E
(Axiom sign)77 192 Q -.15(ve)-.4 G(rifycorrect :).15 E
(forall sk pk msg,)82 204 Q(pk = deri)87 216 Q -.15(ve)-.25 G
(_public sk ->).15 E -.15(ve)87 228 S
(rify pk msg \(sign sk msg\) = true.).15 E 2.5(\(S)77 252 S
(ecurity: cannot for)-2.5 E(ge without pri)-.18 E -.25(va)-.25 G(te k)
.25 E .3 -.15(ey \))-.1 H(Axiom unfor)77 264 Q(geability :)-.18 E
(forall pk msg sig,)82 276 Q -.15(ve)87 288 S(rify pk msg sig = true ->)
.15 E -.15(ex)87 300 S(ists sk, pk = deri).15 E -.15(ve)-.25 G
(_public sk / sig = sign sk msg.).15 E(End ED25519_SPEC.)5 E(`)5 E
(Hash Speci\214cation)72 324 Q(`coq Module T)72 348 Q(ype SHA512_SPEC.)
-.8 E -.15(Pa)77 360 S(rameter hash : bytes -> sha512_hash.).15 E 2.5
(\(D)77 384 S(eterminism \))-2.5 E(Axiom hash_deterministic :)77 396 Q
(forall x, hash x = hash x.)82 408 Q 2.5(\(C)77 432 S
(ollision resistance \(assumed\) \))-2.5 E(Axiom collision_resistant :)
77 444 Q(forall x y)82 456 Q 2.5(,h)-.65 G(ash x = hash y -> x = y)-2.5
E 2.5(.\(I)-.65 G(dealized \) End SHA512_SPEC.)-2.5 E(`)5 E(Chain V)72
480 Q(eri\214cation)-1.11 E(`coq \( Certi\214cate chain v)72 504 Q
(eri\214cation \) Fixpoint v)-.15 E(erify_chain)-.15 E
(\(root : ed25519publick)77 516 Q -.15(ey)-.1 G(\)).15 E
(\(certs : list signed_cert\))77 528 Q(\(tar)77 540 Q
(get_tag : tag\) : bool :=)-.18 E(match certs with)77 552 Q 2.5(|n)77
564 S(il => f)-2.5 E(alse)-.1 E 2.5(|c)77 576 S(ert :: rest =>)-2.5 E
(let issuerk)87 588 Q .3 -.15(ey :)-.1 H 2.5(=c).15 G(ertissuer cert in)
-2.5 E(let subjectk)87 600 Q .3 -.15(ey :)-.1 H 2.5(=c).15 G
(ertsubject cert in)-2.5 E(let certtag := certtag cert in)87 612 Q 2.5
(\(C)87 624 S(heck issuer matches current k)-2.5 E .3 -.15(ey \))-.1 H
(andb \(k)87 636 Q -.15(ey)-.1 G(eq root issuerk).15 E -.15(ey)-.1 G(\))
.15 E 2.5(\(C)87 648 S(heck signature v)-2.5 E(alid \))-.25 E
(\(andb \(v)87 660 Q(erify issuerk)-.15 E .3 -.15(ey \()-.1 H
(certcontent cert\) \(cert_signature cert\)\)).15 E 2.5(\(C)87 672 S
(heck tag grants permission \))-2.5 E(\(andb \(tagimplies certtag tar)87
684 Q(get_tag\))-.18 E 2.5(\(C)87 696 S(ontinue chain \))-2.5 E
(\(match rest with)87 708 Q 2.5(|n)89.5 720 S(il => true)-2.5 E 5(|=)
89.5 732 S 2.5(>v)-5 G(erifychain subjectk)-2.65 E .3 -.15(ey r)-.1 H
(est tar).15 E(gettag)-.18 E(end\)\)\))89.5 744 Q(end.)77 756 Q 2.5(\(T)
72 780 S(heorem: V)-2.5 E
(alid chain implies authorization \) Theorem chain_authorization :)-1.11
E(forall root certs tag,)77 792 Q 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF -.15(ve)82 12 S
(rify_chain root certs tag = true ->).15 E(authorized root tag.)82 24 Q
(Proof.)5 E 2.5(\(P)77 36 S(roof by induction on chain length \))-2.5 E
2.5(... Qed. `)77 48 R(------------------------------------------------\
------------------------------)72 72 Q(Extraction to OCaml)72 96 Q
(Extraction Directi)72 120 Q -.15(ve)-.25 G(s).15 E
(`coq Require Import ExtrOcamlBasic.)72 144 Q
(Require Import ExtrOcamlString.)5 E 3.49(\(E)72 168 S .99
(xtract to OCaml types \) Extract Inducti)-3.49 F 1.29 -.15(ve b)-.25 H
.99(ool => "bool" ["true" "f).15 F 3.49(alse"]. Extract)-.1 F(Inducti)
3.49 E 1.29 -.15(ve l)-.25 H .99(ist => "list" ["[]").15 F("\(::\)"].)72
180 Q 2.763(\(L)72 204 S .263(ink to libsodium \) Extract Constant ed25\
519_sign => "Sodium.Ed25519.sign".)-2.763 F .264
(Extract Constant ed25519_v)5.264 F(erify)-.15 E(=> "Sodium.Ed25519.v)72
216 Q 2.5(erify". Extract)-.15 F
(Constant sha512_hash => "Sodium.SHA512.hash".)2.5 E 2.5(\(G)72 240 S
(enerate OCaml \) Extraction "tcb)-2.5 E(.ml" v)-.4 E
(erify_chain sign v)-.15 E(erify hash.)-.15 E(`)5 E(Generated OCaml)72
264 Q(`ocaml \( tcb)72 288 Q(.ml - Extracted from Coq \))-.4 E
(let rec v)72 312 Q(erifychain root certs tar)-.15 E(gettag =)-.18 E
(match certs with)77 324 Q 2.5(|[)77 336 S 2.5(]-)-2.5 G 2.5(>f)-2.5 G
(alse)-2.6 E 2.5(|c)77 348 S(ert :: rest ->)-2.5 E(let issuerk)87 360 Q
.3 -.15(ey = c)-.1 H(ertissuer cert in).15 E(let subjectk)87 372 Q .3
-.15(ey = c)-.1 H(ertsubject cert in).15 E -.1(ke)87 384 S
(yeq root issuerk)-.05 E .3 -.15(ey &)-.1 H(&).15 E(Sodium.Ed25519.v)87
396 Q(erify issuerk)-.15 E .3 -.15(ey \()-.1 H
(certcontent cert\) \(cert_signature cert\) &&).15 E
(tagimplies \(certtag cert\) tar)87 408 Q(get_tag &&)-.18 E
(\(match rest with)87 420 Q 2.5(|[)89.5 432 S 2.5(]-)-2.5 G 2.5(>t)-2.5
G(rue)-2.5 E 5(|-)89.5 444 S 2.5(>v)-5 G(erifychain subjectk)-2.65 E .3
-.15(ey r)-.1 H(est tar).15 E(gettag\) `)-.18 E(-----------------------\
-------------------------------------------------------)72 468 Q(Inte)72
492 Q(gration with Scheme)-.15 E(FFI Layer)72 516 Q(`ocaml \( tcb_f)72
540 Q(\214.ml - FFI bindings for Chick)-.25 E(en Scheme \))-.1 E 2.206
(let \(\) = Callback.re)72 564 R 2.206(gister "tcb)-.15 F -.15(ve)-.15 G
2.206(rifychain" v).15 F 2.206(erify_chain let \(\) = Callback.re)-.15 F
2.206(gister "tcb_sign" sign let \(\) = Call-)-.15 F(back.re)72 576 Q
(gister "tcb_v)-.15 E(erify" v)-.15 E(erify let \(\) = Callback.re)-.15
E(gister "tcb_hash" hash `)-.15 E(Scheme Bindings)72 600 Q
(`scheme ;; crypto-f)72 624 Q(\214.scm \(module crypto-f)-.25 E<8c>-.25
E(\(ed25519-sign ed25519-v)77 636 Q(erify sha512-hash v)-.15 E
(erify-chain\))-.15 E(\(import \(chick)77 660 Q(en foreign\)\))-.1 E
(;; Call into v)77 684 Q(eri\214ed OCaml)-.15 E(\(de\214ne ed25519-sign)
77 696 Q(\(foreign-lambda* blob \(\(blob k)82 708 Q -.15(ey)-.1 G 2.5
(\)\().15 G(blob msg\)\))-2.5 E("return tcb_sign\(k)87 720 Q -.15(ey)-.1
G 2.5(,m)-.5 G(sg\);"\)\))-2.5 E(\(de\214ne v)77 744 Q(erify-chain)-.15
E(\(foreign-lambda* bool \(\(blob root\) \(pointer certs\) \(pointer ta\
g\)\))82 756 Q("return tcb)87 768 Q -.15(ve)-.15 G
(rifychain\(root, certs, tag\);"\)\)).15 E 2.5(...\) `)77 792 R 0 Cg EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-----------------------------------------------\
-------------------------------)72 24 Q(Proof Oblig)72 48 Q(ations)-.05
E(What W)72 72 Q 2.5(eP)-.8 G(ro)-2.5 E -.15(ve)-.15 G .102
(1. Signature correctness: V)72 96 R .102(alid signatures v)-1.11 F .103
(erify 2. Chain soundness: V)-.15 F .103
(alid chain implies authorization 3. Hash prop-)-1.11 F
(erties: Determinism, length preserv)72 108 Q(ation 4. T)-.25 E
(ype safety: No b)-.8 E(uf)-.2 E(fer o)-.25 E -.15(ve)-.15 G(r\215o).15
E(ws, no null pointers)-.25 E(What W)72 132 Q 2.5(eA)-.8 G(ssume)-2.5 E
2.567(1. Cryptographic hardness: Ed25519 unfor)72 156 R 2.566
(geability 2. libsodium correctness: Implementation matches spec 3.)-.18
F(OCaml runtime: Extraction tar)72 168 Q(get is correct 4. Hardw)-.18 E
(are: CPU e)-.1 E -.15(xe)-.15 G(cutes instructions correctly).15 E -.35
(Tr)72 192 S(ust Chain).35 E 2.5(`M)72 216 S(athematical proof \(Coq\))
-2.5 E 2.5<e245>82 228 S(xtraction \(v)-2.5 E(eri\214ed by Coq\))-.15 E
2.5<e24f>82 240 S(Caml code \(typed, memory-safe\))-2.5 E 2.5<e26c>82
252 S(ibsodium \(audited, widely deplo)-2.5 E(yed\))-.1 E 2.5<e243>82
264 S(PU instructions \(trust hardw)-2.5 E(are\) `)-.1 E(--------------\
----------------------------------------------------------------)72 288
Q(De)72 312 Q -.15(ve)-.25 G(lopment W).15 E(ork\215o)-.8 E(w)-.25 E
(1. Specify in Coq)72 336 Q(`coq \( De\214ne types and operations \) \(\
 State properties and theorems \) `)72 360 Q(2. Pro)72 384 Q .3 -.15
(ve C)-.15 H(orrectness).15 E(`coq \( Pro)72 408 Q .3 -.15(ve t)-.15 H
(heorems \) \( Coq checks proofs mechanically \) `).15 E
(3. Extract to OCaml)72 432 Q(`bash $ coqc -R . Cyberspace tcb)72 456 Q
(.v $ coqc -R . Cyberspace e)-.4 E(xtract.v $ ls *.ml tcb)-.15 E
(.ml tcb_types.ml `)-.4 E(4. Compile and Link)72 480 Q
(`bash $ ocaml\214nd ocamlopt -package sodium -linkpkg)72 504 Q(tcb)12.5
E(.ml tcb_f)-.4 E(\214.ml -o tcb)-.25 E(.cmxa `)-.4 E
(5. Call from Scheme)72 528 Q(`scheme \(import crypto-f)72 552 Q
(\214\) \(ed25519-sign k)-.25 E .3 -.15(ey m)-.1 H 2.5(essage\) ;).15 F
(Calls v)2.5 E(eri\214ed code `)-.15 E(--------------------------------\
----------------------------------------------)72 576 Q(Existing V)72
600 Q(eri\214ed Libraries)-1.11 E(Fiat-Crypto)72 624 Q 2.5(-V)72 648 S
(eri\214ed elliptic curv)-3.61 E 2.5(ei)-.15 G
(mplementations - Used by BoringSSL, Chrome - Extraction to C, Ja)-2.5 E
-.25(va)-.2 G 2.5(,G).25 G(o)-2.5 E(HA)72 672 Q(CL*)-.4 E 2.5(-V)72 696
S(eri\214ed cryptographic library - Written in F* \(similar to Coq\) - \
Used by Firefox, W)-3.61 E(ire)-.4 E(guard)-.15 E(Potential Use)72 720 Q
(`coq Require Import Fiat.Crypto.Ed25519.)72 744 Q 2.5(\(U)5 G(se pre-v)
-2.5 E(eri\214ed Ed25519 implementation \) `)-.15 E(-------------------\
-----------------------------------------------------------)72 768 Q
(Security Considerations)72 792 Q 0 Cg EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF -1.11(Ve)72 24 S(ri\214ed Components)1.11 E 2.5
(-S)72 48 S(ignature operations - Hash operations - Chain v)-2.5 E
(eri\214cation logic)-.15 E(Un)72 72 Q -.15(ve)-.4 G(ri\214ed \(T).15 E
(rusted\))-.35 E 2.5(-F)72 96 S
(FI layer \(small, auditable\) - libsodium bindings - Scheme runtime)
-2.5 E(Audit Surf)72 120 Q(ace)-.1 E 3.135(`T)72 144 S .635(otal TCB:)
-3.935 F .635(~1000 lines OCaml V)13.135 F 13.136(eri\214ed: ~800)-1.11
F .636(lines \(e)3.136 F .636(xtracted from ~2000 lines Coq\) T)-.15 F
15.636(rusted: ~200)-.35 F(lines)3.136 E(\(FFI, bindings\) `)72 156 Q(-\
-----------------------------------------------------------------------\
------)72 180 Q(References)72 204 Q .49(1. Coq De)72 228 R -.15(ve)-.25
G .49(lopment T).15 F .49
(eam. The Coq Proof Assistant Reference Manual.)-.7 F .49
(2. Erbsen, A., et al. \(2019\). Simple High-)5.49 F(Le)72 240 Q -.15
(ve)-.25 G 2.801(lC).15 G .301(ode for Cryptographic Arithmetic.)-2.801
F .301(3. Protzenk)5.301 F .302(o, J., et al. \(2017\). V)-.1 F .302
(eri\214ed Lo)-1.11 F(w-Le)-.25 E -.15(ve)-.25 G 2.802(lP).15 G .302
(rogramming Embed-)-2.802 F .664(ded in F*.)72 252 R .663
(4. Chlipala, A. \(2013\). Certi\214ed Programming with Dependent T)
5.664 F 3.163(ypes. 5.)-.8 F .663(RFC-002: Cyberspace Archi-)3.163 F
(tecture)72 264 Q(-----------------------------------------------------\
-------------------------)72 288 Q(Changelog)72 312 Q 2.5(-2)72 336 S
(026-01-06 - Initial speci\214cation)-2.5 E(---------------------------\
---------------------------------------------------)72 360 Q
(Implementation Status: Proposed Proof Assistant: Coq Extraction T)72
384 Q(ar)-.8 E(get: OCaml TCB Size: ~1000 lines)-.18 E 0 Cg EP
%%Trailer
end
%%EOF
