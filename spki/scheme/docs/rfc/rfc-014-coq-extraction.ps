%!PS-Adobe-3.0
%%Creator: groff version 1.23.0
%%CreationDate: Thu Jan  8 15:17:53 2026
%%DocumentNeededResources: font Times-Roman
%%DocumentSuppliedResources: procset grops 1.23 0
%%Pages: 6
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.23 0
%!PS-Adobe-3.0 Resource-ProcSet
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
% The ASCII code of the space character.
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
% name size font SF -
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
% name a c d font MF -
/MF{
findfont
[5 2 roll
0 3 1 roll % b
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
% Enable manual feed.
% MANUAL -
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
% Guess the page length.
% This assumes that the imageable area is vertically centered on the page.
% PLG - length
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
% BP -
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
% centerx centery radius startangle endangle DA -
/DA{
newpath arcn stroke
}bind def
% x y SN - x' y'
% round a position to nearest (pixel + (.25,.25))
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
% endx endy startx starty DL -
% we round the endpoints of the line, so that parallel horizontal
% and vertical lines will appear even
/DL{
SN
moveto
SN
lineto stroke
}bind def
% centerx centery radius DC -
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
%  width height centerx centery DE -
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
% these are for splines
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
% fill the last path
% r g b Fr -
/Fr{
setrgbcolor fill
}bind def
% c m y k Fk -
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
% g Fg -
/Fg{
setgray fill
}bind def
% fill with the "current color"
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
% new_font_name encoding_vector old_font_name RE -
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
% hpos vpos EBEGIN -
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
% llx lly newwid wid newht ht newllx newlly PBEGIN -
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
% set the graphics state to default values
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
%
%  Any included setpagedevice should be ignored.
%  See: http://www.w-beer.de/doc/ps/.
%
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%EndProlog
%%BeginSetup
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Times-Roman
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/Euro/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Times-Roman@0 ENC0/Times-Roman RE
%%EndSetup
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(RFC-014: Coq Extraction for TCB)72 12 Q(Status:\
 Proposed Date: January 2026 Author: Derrell Piper ddp@eludom.net)72 36
Q(---------------------------------------------------------------------\
---------)72 60 Q(Abstract)72 84 Q .468
(This RFC speci\214es the use of Coq proof assistant for v)72 108 R .468
(eri\214ed implementation of the T)-.15 F .468
(rusted Computing Base, with)-.35 F -.15(ex)72 120 S
(traction to OCaml for production use.).15 E(Pro)5 E .3 -.15(ve o)-.15 H
(nce, trust fore).15 E -.15(ve)-.25 G -.55(r.).15 G(-------------------\
-----------------------------------------------------------)72 144 Q
(Moti)72 168 Q -.25(va)-.25 G(tion).25 E(The Prime Directi)72 192 Q .3
-.15(ve \()-.25 H(RFC-002\):).15 E
(If it\342s in the TCB, it\342s in OCaml. Otherwise it\342s in Chick)77
216 Q(en Scheme.)-.1 E .246(But e)72 240 R -.15(ve)-.25 G 2.746(nO).15 G
.246(Caml can ha)-2.746 F .546 -.15(ve b)-.2 H .247(ugs. The TCB handle\
s: - Ed25519 signatures - SHA-512 hashing - Signature chain v)-.05 F
(eri-)-.15 E(\214cation)72 252 Q 2.5(As)72 276 S(ingle b)-2.5 E
(ug breaks e)-.2 E -.15(ve)-.25 G(rything.).15 E(Coq pro)72 300 Q
(vides:)-.15 E 3.428(1. Machine-check)72 324 R .928
(ed proofs: Theorems v)-.1 F .928(eri\214ed by computer 2.)-.15 F .928
(Extraction: Generate OCaml from proofs 3.)5.928 F(Cor)5.927 E(-)-.2 E
(rectness by construction: Implementation matches speci\214cation 4.)72
336 Q(Eternal v)5 E(alidity: Proofs don\342t e)-.25 E(xpire)-.15 E
(From the Coq motto:)72 360 Q(The proof is in the code.)77 384 Q(------\
-----------------------------------------------------------------------\
-)72 408 Q(Speci\214cation)72 432 Q -.35(Tr)72 456 S
(usted Computing Base).35 E<e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2
e2e2e2e2e2>82 480 Q 50<e243>82 492 S(YBERSP)-50 E -.4(AC)-.92 G 2.5(ET)
.4 G 65(CB \342)-2.5 F 152.5<e2e2>82 504 S 7.5<e2e2>82 516 S 2.5<e2e2e2
e2e2e2e2e2e2e2e2e2e2e220e2e2e2e2e2e2e2e2e2e2e2e2e2e2e220e2e2e2e2e2e2e2e2
e2e2e2e2e2e2e2>-7.5 F<e2>20 E 7.5<e2e245>82 528 S 5(d25519 \342)-7.5 F
7.5<e253>5 G 5(HA-512 \342)-7.5 F 7.5<e256>5 G 7.5(erify \342)-8.61 F
<e2>20 E 7.5<e2e250>82 540 S(ro)-7.5 E -.15(ve)-.15 G 10<6ee2>.15 G 7.5
<e250>-5 G(ro)-7.5 E -.15(ve)-.15 G 10<6ee2>.15 G 7.5<e250>-5 G(ro)-7.5
E -.15(ve)-.15 G -2.5 10<6ee220e2>.15 H 7.5<e2e2>82 552 S 2.5<e2e2e2e2e2
e2e2ace2e2e2e2e2e2e220e2e2e2e2e2e2e2e2ace2e2e2e2e2e2e220e2e2e2e2e2e2e2e2
ace2e2e2e2e2e2e2>-7.5 F<e2>20 E -12.5 25<e2e220e220e220e2>82 564 T 25
<e2e2>82 576 S 37.5<e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2bce2e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e220e2>-25 F -55 67.5<e2e220e2>82 588 T 50<e243>82 600 S
(oq Extraction)-50 E<e2>67.5 E -55 67.5<e2e220e2>82 612 T 50<e2e2>82 624
S 62.5<e2e2e2e2e2e2e2bce2e2e2e2e2e2e220e2>-50 F 50<e2e2>82 636 S 7.5
(OCaml \342)-40 F<e2>65 E 50<e2e2>82 648 S(~1000 LOC \342)-42.5 E<e2>65
E 50<e2e2>82 660 S 62.5<e2e2e2e2e2e2e2e2e2e2e2e2e2e220e2>-50 F 152.5
<e2e2>82 672 S 7.5<e250>82 684 S(ro)-7.5 E -.15(ve)-.15 G 2.5(ni).15 G
2.5(nC)-2.5 G(oq. Extracted to OCaml. Called from Scheme.)-2.5 E<e2>7.5
E 152.5<e2e2>82 696 S<e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2
e2e2>82 708 Q(---------------------------------------------------------\
---------------------)72 732 Q(Coq Speci\214cations)72 756 Q -.8(Ty)72
780 S(pes).8 E 0 Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(* Byte arrays *\))82 12 Q
(De\214nition bytes := list byte.)82 24 Q(\(* K)82 48 Q -.15(ey)-.25 G
2.5(s*).15 G(\))-2.5 E(Record ed25519_public_k)82 60 Q .3 -.15(ey :)-.1
H 2.5(={).15 G(pk_bytes : bytes;)87 72 Q
(pk_length : length pk_bytes = 32)87 84 Q(}.)82 96 Q(Record ed25519_pri)
82 120 Q -.25(va)-.25 G(te_k).25 E .3 -.15(ey :)-.1 H 2.5(={).15 G
(sk_bytes : bytes;)87 132 Q(sk_length : length sk_bytes = 64)87 144 Q
(}.)82 156 Q(\(* Signatures *\))82 180 Q(Record ed25519_signature := {)
82 192 Q(sig_bytes : bytes;)87 204 Q(sig_length : length sig_bytes = 64)
87 216 Q(}.)82 228 Q(\(* Hashes *\))82 252 Q(Record sha512_hash := {)82
264 Q(hash_bytes : bytes;)87 276 Q(hash_length : length hash_bytes = 64)
87 288 Q(}.)82 300 Q(Signature Speci\214cation)72 324 Q
(\(* Abstract signature scheme *\))82 348 Q(Module T)82 360 Q
(ype ED25519_SPEC.)-.8 E -.15(Pa)87 372 S(rameter sign : ed25519_pri).15
E -.25(va)-.25 G(te_k).25 E .3 -.15(ey -)-.1 H 2.5(>b).15 G
(ytes -> ed25519_signature.)-2.5 E -.15(Pa)87 384 S(rameter v).15 E
(erify : ed25519_public_k)-.15 E .3 -.15(ey -)-.1 H 2.5(>b).15 G
(ytes -> ed25519_signature -> bool.)-2.5 E(\(* Correctness: v)87 408 Q
(alid signatures v)-.25 E(erify *\))-.15 E(Axiom sign_v)87 420 Q
(erify_correct :)-.15 E(forall sk pk msg,)92 432 Q(pk = deri)97 444 Q
-.15(ve)-.25 G(_public sk ->).15 E -.15(ve)97 456 S
(rify pk msg \(sign sk msg\) = true.).15 E(\(* Security: cannot for)87
480 Q(ge without pri)-.18 E -.25(va)-.25 G(te k).25 E .3 -.15(ey *)-.1 H
(\)).15 E(Axiom unfor)87 492 Q(geability :)-.18 E(forall pk msg sig,)92
504 Q -.15(ve)97 516 S(rify pk msg sig = true ->).15 E -.15(ex)97 528 S
(ists sk, pk = deri).15 E -.15(ve)-.25 G
(_public sk / sig = sign sk msg.).15 E(End ED25519_SPEC.)82 540 Q
(Hash Speci\214cation)72 564 Q(Module T)82 588 Q(ype SHA512_SPEC.)-.8 E
-.15(Pa)87 600 S(rameter hash : bytes -> sha512_hash.).15 E
(\(* Determinism *\))87 624 Q(Axiom hash_deterministic :)87 636 Q
(forall x, hash x = hash x.)92 648 Q
(\(* Collision resistance \(assumed\) *\))87 672 Q
(Axiom collision_resistant :)87 684 Q(forall x y)92 696 Q 2.5(,h)-.65 G
(ash x = hash y -> x = y)-2.5 E 2.5(.\()-.65 G 2.5(*I)-2.5 G
(dealized *\))-2.5 E(End SHA512_SPEC.)82 708 Q(Chain V)72 732 Q
(eri\214cation)-1.11 E(\(* Certi\214cate chain v)82 756 Q
(eri\214cation *\))-.15 E(Fixpoint v)82 768 Q(erify_chain)-.15 E
(\(root : ed25519_public_k)87 780 Q -.15(ey)-.1 G(\)).15 E
(\(certs : list signed_cert\))87 792 Q 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(tar)87 12 Q(get_tag : tag\) : bool :=)-.18 E
(match certs with)87 24 Q 2.5(|n)87 36 S(il => f)-2.5 E(alse)-.1 E 2.5
(|c)87 48 S(ert :: rest =>)-2.5 E(let issuer_k)97 60 Q .3 -.15(ey :)-.1
H 2.5(=c).15 G(ert_issuer cert in)-2.5 E(let subject_k)97 72 Q .3 -.15
(ey :)-.1 H 2.5(=c).15 G(ert_subject cert in)-2.5 E
(let cert_tag := cert_tag cert in)97 84 Q
(\(* Check issuer matches current k)97 96 Q .3 -.15(ey *)-.1 H(\)).15 E
(andb \(k)97 108 Q -.15(ey)-.1 G(_eq root issuer_k).15 E -.15(ey)-.1 G
(\)).15 E(\(* Check signature v)97 120 Q(alid *\))-.25 E(\(andb \(v)97
132 Q(erify issuer_k)-.15 E .3 -.15(ey \()-.1 H
(cert_content cert\) \(cert_signature cert\)\)).15 E
(\(* Check tag grants permission *\))97 144 Q
(\(andb \(tag_implies cert_tag tar)97 156 Q(get_tag\))-.18 E
(\(* Continue chain *\))97 168 Q(\(match rest with)97 180 Q 2.5(|n)99.5
192 S(il => true)-2.5 E 2.5(|_=)99.5 204 S 2.5(>v)-2.5 G
(erify_chain subject_k)-2.65 E .3 -.15(ey r)-.1 H(est tar).15 E(get_tag)
-.18 E(end\)\)\))99.5 216 Q(end.)87 228 Q(\(* Theorem: V)82 252 Q
(alid chain implies authorization *\))-1.11 E
(Theorem chain_authorization :)82 264 Q(forall root certs tag,)87 276 Q
-.15(ve)92 288 S(rify_chain root certs tag = true ->).15 E
(authorized root tag.)92 300 Q(Proof.)82 312 Q
(\(* Proof by induction on chain length *\))87 324 Q(...)87 336 Q(Qed.)
82 348 Q(--------------------------------------------------------------\
----------------)72 372 Q(Extraction to OCaml)72 396 Q
(Extraction Directi)72 420 Q -.15(ve)-.25 G(s).15 E
(Require Import ExtrOcamlBasic.)82 444 Q
(Require Import ExtrOcamlString.)82 456 Q
(\(* Extract to OCaml types *\))82 480 Q(Extract Inducti)82 492 Q .3
-.15(ve b)-.25 H(ool => "bool" ["true" "f).15 E(alse"].)-.1 E
(Extract Inducti)82 504 Q .3 -.15(ve l)-.25 H
(ist => "list" ["[]" "\(::\)"].).15 E(\(* Link to libsodium *\))82 528 Q
(Extract Constant ed25519_sign => "Sodium.Ed25519.sign".)82 540 Q
(Extract Constant ed25519_v)82 552 Q(erify => "Sodium.Ed25519.v)-.15 E
(erify".)-.15 E(Extract Constant sha512_hash => "Sodium.SHA512.hash".)82
564 Q(\(* Generate OCaml *\))82 588 Q(Extraction "tcb)82 600 Q(.ml" v)
-.4 E(erify_chain sign v)-.15 E(erify hash.)-.15 E(Generated OCaml)72
624 Q(\(* tcb)82 648 Q(.ml - Extracted from Coq *\))-.4 E(let rec v)82
672 Q(erify_chain root certs tar)-.15 E(get_tag =)-.18 E
(match certs with)87 684 Q 2.5(|[)87 696 S 2.5(]-)-2.5 G 2.5(>f)-2.5 G
(alse)-2.6 E 2.5(|c)87 708 S(ert :: rest ->)-2.5 E(let issuer_k)97 720 Q
.3 -.15(ey = c)-.1 H(ert_issuer cert in).15 E(let subject_k)97 732 Q .3
-.15(ey = c)-.1 H(ert_subject cert in).15 E -.1(ke)97 744 S
(y_eq root issuer_k)-.05 E .3 -.15(ey &)-.1 H(&).15 E(Sodium.Ed25519.v)
97 756 Q(erify issuer_k)-.15 E .3 -.15(ey \()-.1 H
(cert_content cert\) \(cert_signature cert\) &&).15 E
(tag_implies \(cert_tag cert\) tar)97 768 Q(get_tag &&)-.18 E
(\(match rest with)97 780 Q 2.5(|[)99.5 792 S 2.5(]-)-2.5 G 2.5(>t)-2.5
G(rue)-2.5 E 0 Cg EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 2.5(|_-)99.5 12 S 2.5(>v)-2.5 G
(erify_chain subject_k)-2.65 E .3 -.15(ey r)-.1 H(est tar).15 E
(get_tag\))-.18 E(-----------------------------------------------------\
-------------------------)72 36 Q(Inte)72 60 Q(gration with Scheme)-.15
E(FFI Layer)72 84 Q(\(* tcb_f)82 108 Q(\214.ml - FFI bindings for Chick)
-.25 E(en Scheme *\))-.1 E(let \(\) = Callback.re)82 132 Q
(gister "tcb_v)-.15 E(erify_chain" v)-.15 E(erify_chain)-.15 E
(let \(\) = Callback.re)82 144 Q(gister "tcb_sign" sign)-.15 E
(let \(\) = Callback.re)82 156 Q(gister "tcb_v)-.15 E(erify" v)-.15 E
(erify)-.15 E(let \(\) = Callback.re)82 168 Q(gister "tcb_hash" hash)
-.15 E(Scheme Bindings)72 192 Q(;; crypto-f)82 216 Q(\214.scm)-.25 E
(\(module crypto-f)82 228 Q<8c>-.25 E(\(ed25519-sign ed25519-v)87 240 Q
(erify sha512-hash v)-.15 E(erify-chain\))-.15 E(\(import \(chick)87 264
Q(en foreign\)\))-.1 E(;; Call into v)87 288 Q(eri\214ed OCaml)-.15 E
(\(de\214ne ed25519-sign)87 300 Q(\(foreign-lambda* blob \(\(blob k)92
312 Q -.15(ey)-.1 G 2.5(\)\().15 G(blob msg\)\))-2.5 E
("return tcb_sign\(k)97 324 Q -.15(ey)-.1 G 2.5(,m)-.5 G(sg\);"\)\))-2.5
E(\(de\214ne v)87 348 Q(erify-chain)-.15 E(\(foreign-lambda* bool \(\(b\
lob root\) \(pointer certs\) \(pointer tag\)\))92 360 Q("return tcb_v)97
372 Q(erify_chain\(root, certs, tag\);"\)\))-.15 E(...\))87 396 Q(-----\
-----------------------------------------------------------------------\
--)72 420 Q(Proof Oblig)72 444 Q(ations)-.05 E(What W)72 468 Q 2.5(eP)
-.8 G(ro)-2.5 E -.15(ve)-.15 G 3.8(1. Signature)72 492 R 1.3
(correctness: V)3.8 F 1.3(alid signatures v)-1.11 F 1.3(erify 2.)-.15 F
1.3(Chain soundness: V)6.3 F 1.3(alid chain implies authorization 3.)
-1.11 F(Hash)6.3 E(properties: Determinism, length preserv)72 504 Q
(ation 4.)-.25 E -.8(Ty)5 G(pe safety: No b).8 E(uf)-.2 E(fer o)-.25 E
-.15(ve)-.15 G(r\215o).15 E(ws, no null pointers)-.25 E(What W)72 528 Q
2.5(eA)-.8 G(ssume)-2.5 E 4.612(1. Cryptographic)72 552 R 2.112
(hardness: Ed25519 unfor)4.612 F 2.112(geability 2.)-.18 F 2.112
(libsodium correctness: Implementation matches spec 3.)7.112 F
(OCaml runtime: Extraction tar)72 564 Q(get is correct 4.)-.18 E(Hardw)5
E(are: CPU e)-.1 E -.15(xe)-.15 G(cutes instructions correctly).15 E
-.35(Tr)72 588 S(ust Chain).35 E(Mathematical proof \(Coq\))82 612 Q<e2>
92 624 Q(Extraction \(v)82 636 Q(eri\214ed by Coq\))-.15 E<e2>92 648 Q
(OCaml code \(typed, memory-safe\))82 660 Q<e2>92 672 Q
(libsodium \(audited, widely deplo)82 684 Q(yed\))-.1 E<e2>92 696 Q
(CPU instructions \(trust hardw)82 708 Q(are\))-.1 E(------------------\
------------------------------------------------------------)72 732 Q
(De)72 756 Q -.15(ve)-.25 G(lopment W).15 E(ork\215o)-.8 E(w)-.25 E
(1. Specify in Coq)72 780 Q 0 Cg EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(* De\214ne types and operations *\))82 12 Q
(\(* State properties and theorems *\))82 24 Q(2. Pro)72 48 Q .3 -.15
(ve C)-.15 H(orrectness).15 E(\(* Pro)82 72 Q .3 -.15(ve t)-.15 H
(heorems *\)).15 E(\(* Coq checks proofs mechanically *\))82 84 Q
(3. Extract to OCaml)72 108 Q 2.5($c)82 132 S(oqc -R . Cyberspace tcb)
-2.5 E(.v)-.4 E 2.5($c)82 144 S(oqc -R . Cyberspace e)-2.5 E(xtract.v)
-.15 E 2.5($l)82 156 S 2.5(s*)-2.5 G(.ml)-2.5 E(tcb)82 168 Q
(.ml tcb_types.ml)-.4 E(4. Compile and Link)72 192 Q 2.5($o)82 216 S
(caml\214nd ocamlopt -package sodium -linkpkg)-2.5 E(tcb)22.5 E
(.ml tcb_f)-.4 E(\214.ml -o tcb)-.25 E(.cmxa)-.4 E(5. Call from Scheme)
72 240 Q(\(import crypto-f)82 264 Q<8c29>-.25 E(\(ed25519-sign k)82 276
Q .3 -.15(ey m)-.1 H 2.5(essage\) ;).15 F(Calls v)2.5 E(eri\214ed code)
-.15 E(----------------------------------------------------------------\
--------------)72 300 Q(Existing V)72 324 Q(eri\214ed Libraries)-1.11 E
(Fiat-Crypto)72 348 Q 2.5(-V)72 372 S(eri\214ed elliptic curv)-3.61 E
2.5(ei)-.15 G
(mplementations - Used by BoringSSL, Chrome - Extraction to C, Ja)-2.5 E
-.25(va)-.2 G 2.5(,G).25 G(o)-2.5 E(HA)72 396 Q(CL*)-.4 E 2.5(-V)72 420
S(eri\214ed cryptographic library - Written in F* \(similar to Coq\) - \
Used by Firefox, W)-3.61 E(ire)-.4 E(guard)-.15 E(Potential Use)72 444 Q
(Require Import Fiat.Crypto.Ed25519.)82 468 Q(\(* Use pre-v)82 480 Q
(eri\214ed Ed25519 implementation *\))-.15 E(--------------------------\
----------------------------------------------------)72 504 Q
(Security Considerations)72 528 Q -1.11(Ve)72 552 S(ri\214ed Components)
1.11 E 2.5(-S)72 576 S(ignature operations - Hash operations - Chain v)
-2.5 E(eri\214cation logic)-.15 E(Un)72 600 Q -.15(ve)-.4 G
(ri\214ed \(T).15 E(rusted\))-.35 E 2.5(-F)72 624 S
(FI layer \(small, auditable\) - libsodium bindings - Scheme runtime)
-2.5 E(Audit Surf)72 648 Q(ace)-.1 E -.8(To)82 672 S(tal TCB:).8 E
(~1000 lines OCaml)12.5 E -1.11(Ve)82 684 S 12.5(ri\214ed: ~800)1.11 F
(lines \(e)2.5 E(xtracted from ~2000 lines Coq\))-.15 E -.35(Tr)82 696 S
15(usted: ~200).35 F(lines \(FFI, bindings\))2.5 E(--------------------\
----------------------------------------------------------)72 720 Q
(References)72 744 Q 3.871(1. Coq)72 768 R(De)3.871 E -.15(ve)-.25 G
1.371(lopment T).15 F 1.371
(eam. The Coq Proof Assistant Reference Manual.)-.7 F 3.871(2. Erbsen,)
6.371 F 1.372(A., et al.\302 \(2019\). Simple)3.871 F(High-Le)72 780 Q
-.15(ve)-.25 G 2.5(lC).15 G(ode for Cryptographic)-2.5 E 2.5
(Arithmetic. 3. Protzenk)82 792 R(o, J., et al.\302 \(2017\). V)-.1 E
(eri\214ed Lo)-1.11 E(w-Le)-.25 E -.15(ve)-.25 G 2.5(lP).15 G
(rogramming Embedded in)-2.5 E 0 Cg EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 3.309(F*. 4. Chlipala,)82 12 R .809
(A. \(2013\). Certi\214ed Programming with Dependent T)3.309 F 3.308
(ypes. 5. RFC-002:)-.8 F .808(Cyberspace Architec-)3.308 F(ture)72 24 Q
(----------------------------------------------------------------------\
--------)72 48 Q(Changelog)72 72 Q 2.5(-2)72 96 S
(026-01-06 - Initial speci\214cation)-2.5 E(---------------------------\
---------------------------------------------------)72 120 Q
(Implementation Status: Proposed Proof Assistant: Coq Extraction T)72
144 Q(ar)-.8 E(get: OCaml TCB Size: ~1000 lines)-.18 E 0 Cg EP
%%Trailer
end
%%EOF
