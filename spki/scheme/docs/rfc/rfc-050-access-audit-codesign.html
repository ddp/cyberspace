<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <title>RFC-050: Access Control and Audit Co-Design</title>
  <link rel="icon" id="favicon" href="data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27%230f0%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>">
  <script>
(function(){
  var h=new Date().getHours(),c;
  if(h>=4&&h<6)c='%23845EC2';       // brahma muhurta - violet
  else if(h>=6&&h<8)c='%23ffd700';  // dawn - gold
  else if(h>=8&&h<11)c='%2300d4aa'; // morning - teal
  else if(h>=11&&h<14)c='%230f0';   // midday - phosphor
  else if(h>=14&&h<17)c='%2339ff14';// afternoon - neon
  else if(h>=17&&h<19)c='%23ff6600';// sunset - orange
  else if(h>=19&&h<22)c='%23ff3366';// evening - coral
  else c='%2300ffff';               // night - cyan
  document.getElementById('favicon').href='data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 32 32%27><text x=%2716%27 y=%2725%27 font-family=%27serif%27 font-size=%2728%27 fill=%27'+c+'%27 text-anchor=%27middle%27 font-weight=%27bold%27>λ</text></svg>';
})();
</script>
  <link rel="stylesheet" href="rfc.css">
</head>
<body>
<span class="theme-toggle" onclick="toggleTheme()" title="Toggle light/dark">[theme]</span>
<h1>RFC-050: Access Control and Audit Co-Design</h1>
<dl class="metadata">
</dl>
<hr>
<section>
<h2>Abstract</h2>
<p>This RFC establishes the principle that access control and auditing must be designed together, not separately. Every access control decision point produces three outputs: a decision, an effect, and a record. Audit policy is per-realm, with lean defaults.</p>
</section>
<section>
<h2>Motivation</h2>
<p>Security systems often treat auditing as an afterthought—bolted on after access control is designed. This leads to:</p>
<ul>
<li>Incomplete coverage: Some decisions are never logged</li>
<li>Inconsistent records: Different formats at different points</li>
<li>Performance surprises: Auditing added late without cost analysis</li>
<li>Policy gaps: No framework for what to log when</li>
</ul>
<p>The solution: co-design access control and auditing from the start.</p>
</section>
<section>
<h2>Design Principle</h2>
<p>Access control and auditing are co-designed, not bolted on.</p>
<p>Every access control point has three outputs:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 374.4 230.4" width="374.4" height="230.4" xmlns="http://www.w3.org/2000/svg">
<style>
  line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: round; }
  text { font-family: 'Hack', 'SF Mono', monospace; font-size: 14px; fill: currentColor; }
</style>
<line x1="4.8" y1="9.6" x2="9.6" y2="9.6"/>
<line x1="4.8" y1="9.6" x2="4.8" y2="19.2"/>
<line x1="9.6" y1="9.6" x2="19.2" y2="9.6"/>
<line x1="19.2" y1="9.6" x2="28.8" y2="9.6"/>
<line x1="28.8" y1="9.6" x2="38.4" y2="9.6"/>
<line x1="38.4" y1="9.6" x2="48.0" y2="9.6"/>
<line x1="48.0" y1="9.6" x2="57.6" y2="9.6"/>
<line x1="57.6" y1="9.6" x2="67.2" y2="9.6"/>
<line x1="67.2" y1="9.6" x2="76.8" y2="9.6"/>
<line x1="76.8" y1="9.6" x2="86.4" y2="9.6"/>
<line x1="86.4" y1="9.6" x2="96.0" y2="9.6"/>
<line x1="96.0" y1="9.6" x2="105.6" y2="9.6"/>
<line x1="105.6" y1="9.6" x2="115.2" y2="9.6"/>
<line x1="115.2" y1="9.6" x2="124.8" y2="9.6"/>
<line x1="124.8" y1="9.6" x2="134.4" y2="9.6"/>
<line x1="134.4" y1="9.6" x2="144.0" y2="9.6"/>
<line x1="144.0" y1="9.6" x2="153.6" y2="9.6"/>
<line x1="153.6" y1="9.6" x2="163.2" y2="9.6"/>
<line x1="163.2" y1="9.6" x2="172.8" y2="9.6"/>
<line x1="172.8" y1="9.6" x2="182.4" y2="9.6"/>
<line x1="182.4" y1="9.6" x2="192.0" y2="9.6"/>
<line x1="192.0" y1="9.6" x2="201.6" y2="9.6"/>
<line x1="201.6" y1="9.6" x2="211.2" y2="9.6"/>
<line x1="211.2" y1="9.6" x2="220.8" y2="9.6"/>
<line x1="220.8" y1="9.6" x2="230.4" y2="9.6"/>
<line x1="230.4" y1="9.6" x2="240.0" y2="9.6"/>
<line x1="240.0" y1="9.6" x2="249.6" y2="9.6"/>
<line x1="249.6" y1="9.6" x2="259.2" y2="9.6"/>
<line x1="259.2" y1="9.6" x2="268.8" y2="9.6"/>
<line x1="268.8" y1="9.6" x2="278.4" y2="9.6"/>
<line x1="278.4" y1="9.6" x2="288.0" y2="9.6"/>
<line x1="288.0" y1="9.6" x2="297.6" y2="9.6"/>
<line x1="297.6" y1="9.6" x2="307.2" y2="9.6"/>
<line x1="307.2" y1="9.6" x2="316.8" y2="9.6"/>
<line x1="316.8" y1="9.6" x2="326.4" y2="9.6"/>
<line x1="326.4" y1="9.6" x2="336.0" y2="9.6"/>
<line x1="336.0" y1="9.6" x2="345.6" y2="9.6"/>
<line x1="345.6" y1="9.6" x2="355.2" y2="9.6"/>
<line x1="355.2" y1="9.6" x2="364.8" y2="9.6"/>
<line x1="364.8" y1="9.6" x2="369.6" y2="9.6"/>
<line x1="369.6" y1="9.6" x2="369.6" y2="19.2"/>
<line x1="4.8" y1="19.2" x2="4.8" y2="38.4"/>
<line x1="369.6" y1="19.2" x2="369.6" y2="38.4"/>
<line x1="4.8" y1="38.4" x2="4.8" y2="57.6"/>
<line x1="4.8" y1="48.0" x2="9.6" y2="48.0"/>
<line x1="9.6" y1="48.0" x2="19.2" y2="48.0"/>
<line x1="19.2" y1="48.0" x2="28.8" y2="48.0"/>
<line x1="28.8" y1="48.0" x2="38.4" y2="48.0"/>
<line x1="38.4" y1="48.0" x2="48.0" y2="48.0"/>
<line x1="48.0" y1="48.0" x2="57.6" y2="48.0"/>
<line x1="57.6" y1="48.0" x2="67.2" y2="48.0"/>
<line x1="67.2" y1="48.0" x2="76.8" y2="48.0"/>
<line x1="76.8" y1="48.0" x2="86.4" y2="48.0"/>
<line x1="86.4" y1="48.0" x2="96.0" y2="48.0"/>
<line x1="96.0" y1="48.0" x2="105.6" y2="48.0"/>
<line x1="105.6" y1="48.0" x2="115.2" y2="48.0"/>
<line x1="115.2" y1="48.0" x2="124.8" y2="48.0"/>
<line x1="124.8" y1="48.0" x2="134.4" y2="48.0"/>
<line x1="134.4" y1="48.0" x2="144.0" y2="48.0"/>
<line x1="144.0" y1="48.0" x2="153.6" y2="48.0"/>
<line x1="153.6" y1="48.0" x2="163.2" y2="48.0"/>
<line x1="163.2" y1="48.0" x2="172.8" y2="48.0"/>
<line x1="172.8" y1="48.0" x2="182.4" y2="48.0"/>
<line x1="182.4" y1="48.0" x2="192.0" y2="48.0"/>
<line x1="192.0" y1="48.0" x2="201.6" y2="48.0"/>
<line x1="201.6" y1="48.0" x2="211.2" y2="48.0"/>
<line x1="211.2" y1="48.0" x2="220.8" y2="48.0"/>
<line x1="220.8" y1="48.0" x2="230.4" y2="48.0"/>
<line x1="230.4" y1="48.0" x2="240.0" y2="48.0"/>
<line x1="240.0" y1="48.0" x2="249.6" y2="48.0"/>
<line x1="249.6" y1="48.0" x2="259.2" y2="48.0"/>
<line x1="259.2" y1="48.0" x2="268.8" y2="48.0"/>
<line x1="268.8" y1="48.0" x2="278.4" y2="48.0"/>
<line x1="278.4" y1="48.0" x2="288.0" y2="48.0"/>
<line x1="288.0" y1="48.0" x2="297.6" y2="48.0"/>
<line x1="297.6" y1="48.0" x2="307.2" y2="48.0"/>
<line x1="307.2" y1="48.0" x2="316.8" y2="48.0"/>
<line x1="316.8" y1="48.0" x2="326.4" y2="48.0"/>
<line x1="326.4" y1="48.0" x2="336.0" y2="48.0"/>
<line x1="336.0" y1="48.0" x2="345.6" y2="48.0"/>
<line x1="345.6" y1="48.0" x2="355.2" y2="48.0"/>
<line x1="355.2" y1="48.0" x2="364.8" y2="48.0"/>
<line x1="369.6" y1="38.4" x2="369.6" y2="57.6"/>
<line x1="364.8" y1="48.0" x2="369.6" y2="48.0"/>
<line x1="4.8" y1="57.6" x2="4.8" y2="76.8"/>
<line x1="369.6" y1="57.6" x2="369.6" y2="76.8"/>
<line x1="4.8" y1="76.8" x2="4.8" y2="96.0"/>
<line x1="4.8" y1="86.4" x2="9.6" y2="86.4"/>
<line x1="9.6" y1="86.4" x2="19.2" y2="86.4"/>
<line x1="19.2" y1="86.4" x2="28.8" y2="86.4"/>
<line x1="28.8" y1="86.4" x2="38.4" y2="86.4"/>
<line x1="38.4" y1="86.4" x2="48.0" y2="86.4"/>
<line x1="48.0" y1="86.4" x2="57.6" y2="86.4"/>
<line x1="57.6" y1="86.4" x2="67.2" y2="86.4"/>
<line x1="67.2" y1="86.4" x2="76.8" y2="86.4"/>
<line x1="76.8" y1="86.4" x2="86.4" y2="86.4"/>
<line x1="86.4" y1="86.4" x2="96.0" y2="86.4"/>
<line x1="96.0" y1="86.4" x2="105.6" y2="86.4"/>
<line x1="105.6" y1="86.4" x2="115.2" y2="86.4"/>
<line x1="115.2" y1="86.4" x2="124.8" y2="86.4"/>
<line x1="124.8" y1="86.4" x2="134.4" y2="86.4"/>
<line x1="134.4" y1="86.4" x2="144.0" y2="86.4"/>
<line x1="144.0" y1="86.4" x2="153.6" y2="86.4"/>
<line x1="153.6" y1="86.4" x2="163.2" y2="86.4"/>
<line x1="163.2" y1="86.4" x2="172.8" y2="86.4"/>
<line x1="172.8" y1="86.4" x2="182.4" y2="86.4"/>
<line x1="182.4" y1="86.4" x2="192.0" y2="86.4"/>
<line x1="192.0" y1="86.4" x2="201.6" y2="86.4"/>
<line x1="201.6" y1="86.4" x2="211.2" y2="86.4"/>
<line x1="211.2" y1="86.4" x2="220.8" y2="86.4"/>
<line x1="220.8" y1="86.4" x2="230.4" y2="86.4"/>
<line x1="230.4" y1="86.4" x2="240.0" y2="86.4"/>
<line x1="240.0" y1="86.4" x2="249.6" y2="86.4"/>
<line x1="249.6" y1="86.4" x2="259.2" y2="86.4"/>
<line x1="259.2" y1="86.4" x2="268.8" y2="86.4"/>
<line x1="268.8" y1="86.4" x2="278.4" y2="86.4"/>
<line x1="278.4" y1="86.4" x2="288.0" y2="86.4"/>
<line x1="288.0" y1="86.4" x2="297.6" y2="86.4"/>
<line x1="297.6" y1="86.4" x2="307.2" y2="86.4"/>
<line x1="307.2" y1="86.4" x2="316.8" y2="86.4"/>
<line x1="316.8" y1="86.4" x2="326.4" y2="86.4"/>
<line x1="326.4" y1="86.4" x2="336.0" y2="86.4"/>
<line x1="336.0" y1="86.4" x2="345.6" y2="86.4"/>
<line x1="345.6" y1="86.4" x2="355.2" y2="86.4"/>
<line x1="355.2" y1="86.4" x2="364.8" y2="86.4"/>
<line x1="369.6" y1="76.8" x2="369.6" y2="96.0"/>
<line x1="364.8" y1="86.4" x2="369.6" y2="86.4"/>
<line x1="4.8" y1="96.0" x2="4.8" y2="115.2"/>
<line x1="369.6" y1="96.0" x2="369.6" y2="115.2"/>
<line x1="4.8" y1="115.2" x2="4.8" y2="134.4"/>
<line x1="369.6" y1="115.2" x2="369.6" y2="134.4"/>
<line x1="4.8" y1="134.4" x2="4.8" y2="153.6"/>
<line x1="369.6" y1="134.4" x2="369.6" y2="153.6"/>
<line x1="4.8" y1="153.6" x2="4.8" y2="172.8"/>
<line x1="369.6" y1="153.6" x2="369.6" y2="172.8"/>
<line x1="4.8" y1="172.8" x2="4.8" y2="192.0"/>
<line x1="369.6" y1="172.8" x2="369.6" y2="192.0"/>
<line x1="4.8" y1="192.0" x2="4.8" y2="211.2"/>
<line x1="369.6" y1="192.0" x2="369.6" y2="211.2"/>
<line x1="4.8" y1="220.8" x2="9.6" y2="220.8"/>
<line x1="4.8" y1="211.2" x2="4.8" y2="220.8"/>
<line x1="9.6" y1="220.8" x2="19.2" y2="220.8"/>
<line x1="19.2" y1="220.8" x2="28.8" y2="220.8"/>
<line x1="28.8" y1="220.8" x2="38.4" y2="220.8"/>
<line x1="38.4" y1="220.8" x2="48.0" y2="220.8"/>
<line x1="48.0" y1="220.8" x2="57.6" y2="220.8"/>
<line x1="57.6" y1="220.8" x2="67.2" y2="220.8"/>
<line x1="67.2" y1="220.8" x2="76.8" y2="220.8"/>
<line x1="76.8" y1="220.8" x2="86.4" y2="220.8"/>
<line x1="86.4" y1="220.8" x2="96.0" y2="220.8"/>
<line x1="96.0" y1="220.8" x2="105.6" y2="220.8"/>
<line x1="105.6" y1="220.8" x2="115.2" y2="220.8"/>
<line x1="115.2" y1="220.8" x2="124.8" y2="220.8"/>
<line x1="124.8" y1="220.8" x2="134.4" y2="220.8"/>
<line x1="134.4" y1="220.8" x2="144.0" y2="220.8"/>
<line x1="144.0" y1="220.8" x2="153.6" y2="220.8"/>
<line x1="153.6" y1="220.8" x2="163.2" y2="220.8"/>
<line x1="163.2" y1="220.8" x2="172.8" y2="220.8"/>
<line x1="172.8" y1="220.8" x2="182.4" y2="220.8"/>
<line x1="182.4" y1="220.8" x2="192.0" y2="220.8"/>
<line x1="192.0" y1="220.8" x2="201.6" y2="220.8"/>
<line x1="201.6" y1="220.8" x2="211.2" y2="220.8"/>
<line x1="211.2" y1="220.8" x2="220.8" y2="220.8"/>
<line x1="220.8" y1="220.8" x2="230.4" y2="220.8"/>
<line x1="230.4" y1="220.8" x2="240.0" y2="220.8"/>
<line x1="240.0" y1="220.8" x2="249.6" y2="220.8"/>
<line x1="249.6" y1="220.8" x2="259.2" y2="220.8"/>
<line x1="259.2" y1="220.8" x2="268.8" y2="220.8"/>
<line x1="268.8" y1="220.8" x2="278.4" y2="220.8"/>
<line x1="278.4" y1="220.8" x2="288.0" y2="220.8"/>
<line x1="288.0" y1="220.8" x2="297.6" y2="220.8"/>
<line x1="297.6" y1="220.8" x2="307.2" y2="220.8"/>
<line x1="307.2" y1="220.8" x2="316.8" y2="220.8"/>
<line x1="316.8" y1="220.8" x2="326.4" y2="220.8"/>
<line x1="326.4" y1="220.8" x2="336.0" y2="220.8"/>
<line x1="336.0" y1="220.8" x2="345.6" y2="220.8"/>
<line x1="345.6" y1="220.8" x2="355.2" y2="220.8"/>
<line x1="355.2" y1="220.8" x2="364.8" y2="220.8"/>
<line x1="364.8" y1="220.8" x2="369.6" y2="220.8"/>
<line x1="369.6" y1="211.2" x2="369.6" y2="220.8"/>
<text x="100.8" y="28.8" text-anchor="middle" dominant-baseline="central">A</text>
<text x="110.4" y="28.8" text-anchor="middle" dominant-baseline="central">c</text>
<text x="120.0" y="28.8" text-anchor="middle" dominant-baseline="central">c</text>
<text x="129.6" y="28.8" text-anchor="middle" dominant-baseline="central">e</text>
<text x="139.2" y="28.8" text-anchor="middle" dominant-baseline="central">s</text>
<text x="148.8" y="28.8" text-anchor="middle" dominant-baseline="central">s</text>
<text x="168.0" y="28.8" text-anchor="middle" dominant-baseline="central">C</text>
<text x="177.6" y="28.8" text-anchor="middle" dominant-baseline="central">o</text>
<text x="187.2" y="28.8" text-anchor="middle" dominant-baseline="central">n</text>
<text x="196.8" y="28.8" text-anchor="middle" dominant-baseline="central">t</text>
<text x="206.4" y="28.8" text-anchor="middle" dominant-baseline="central">r</text>
<text x="216.0" y="28.8" text-anchor="middle" dominant-baseline="central">o</text>
<text x="225.6" y="28.8" text-anchor="middle" dominant-baseline="central">l</text>
<text x="244.8" y="28.8" text-anchor="middle" dominant-baseline="central">P</text>
<text x="254.4" y="28.8" text-anchor="middle" dominant-baseline="central">o</text>
<text x="264.0" y="28.8" text-anchor="middle" dominant-baseline="central">i</text>
<text x="273.6" y="28.8" text-anchor="middle" dominant-baseline="central">n</text>
<text x="283.2" y="28.8" text-anchor="middle" dominant-baseline="central">t</text>
<text x="24.0" y="67.2" text-anchor="middle" dominant-baseline="central">I</text>
<text x="33.6" y="67.2" text-anchor="middle" dominant-baseline="central">n</text>
<text x="43.2" y="67.2" text-anchor="middle" dominant-baseline="central">p</text>
<text x="52.8" y="67.2" text-anchor="middle" dominant-baseline="central">u</text>
<text x="62.4" y="67.2" text-anchor="middle" dominant-baseline="central">t</text>
<text x="72.0" y="67.2" text-anchor="middle" dominant-baseline="central">:</text>
<text x="100.8" y="67.2" text-anchor="middle" dominant-baseline="central">p</text>
<text x="110.4" y="67.2" text-anchor="middle" dominant-baseline="central">r</text>
<text x="120.0" y="67.2" text-anchor="middle" dominant-baseline="central">i</text>
<text x="129.6" y="67.2" text-anchor="middle" dominant-baseline="central">n</text>
<text x="139.2" y="67.2" text-anchor="middle" dominant-baseline="central">c</text>
<text x="148.8" y="67.2" text-anchor="middle" dominant-baseline="central">i</text>
<text x="158.4" y="67.2" text-anchor="middle" dominant-baseline="central">p</text>
<text x="168.0" y="67.2" text-anchor="middle" dominant-baseline="central">a</text>
<text x="177.6" y="67.2" text-anchor="middle" dominant-baseline="central">l</text>
<text x="187.2" y="67.2" text-anchor="middle" dominant-baseline="central">,</text>
<text x="206.4" y="67.2" text-anchor="middle" dominant-baseline="central">a</text>
<text x="216.0" y="67.2" text-anchor="middle" dominant-baseline="central">c</text>
<text x="225.6" y="67.2" text-anchor="middle" dominant-baseline="central">t</text>
<text x="235.2" y="67.2" text-anchor="middle" dominant-baseline="central">i</text>
<text x="244.8" y="67.2" text-anchor="middle" dominant-baseline="central">o</text>
<text x="254.4" y="67.2" text-anchor="middle" dominant-baseline="central">n</text>
<text x="264.0" y="67.2" text-anchor="middle" dominant-baseline="central">,</text>
<text x="283.2" y="67.2" text-anchor="middle" dominant-baseline="central">c</text>
<text x="292.8" y="67.2" text-anchor="middle" dominant-baseline="central">o</text>
<text x="302.4" y="67.2" text-anchor="middle" dominant-baseline="central">n</text>
<text x="312.0" y="67.2" text-anchor="middle" dominant-baseline="central">t</text>
<text x="321.6" y="67.2" text-anchor="middle" dominant-baseline="central">e</text>
<text x="331.2" y="67.2" text-anchor="middle" dominant-baseline="central">x</text>
<text x="340.8" y="67.2" text-anchor="middle" dominant-baseline="central">t</text>
<text x="24.0" y="105.6" text-anchor="middle" dominant-baseline="central">O</text>
<text x="33.6" y="105.6" text-anchor="middle" dominant-baseline="central">u</text>
<text x="43.2" y="105.6" text-anchor="middle" dominant-baseline="central">t</text>
<text x="52.8" y="105.6" text-anchor="middle" dominant-baseline="central">p</text>
<text x="62.4" y="105.6" text-anchor="middle" dominant-baseline="central">u</text>
<text x="72.0" y="105.6" text-anchor="middle" dominant-baseline="central">t</text>
<text x="81.6" y="105.6" text-anchor="middle" dominant-baseline="central">:</text>
<text x="100.8" y="105.6" text-anchor="middle" dominant-baseline="central">d</text>
<text x="110.4" y="105.6" text-anchor="middle" dominant-baseline="central">e</text>
<text x="120.0" y="105.6" text-anchor="middle" dominant-baseline="central">c</text>
<text x="129.6" y="105.6" text-anchor="middle" dominant-baseline="central">i</text>
<text x="139.2" y="105.6" text-anchor="middle" dominant-baseline="central">s</text>
<text x="148.8" y="105.6" text-anchor="middle" dominant-baseline="central">i</text>
<text x="158.4" y="105.6" text-anchor="middle" dominant-baseline="central">o</text>
<text x="168.0" y="105.6" text-anchor="middle" dominant-baseline="central">n</text>
<text x="187.2" y="105.6" text-anchor="middle" dominant-baseline="central">(</text>
<text x="196.8" y="105.6" text-anchor="middle" dominant-baseline="central">g</text>
<text x="206.4" y="105.6" text-anchor="middle" dominant-baseline="central">r</text>
<text x="216.0" y="105.6" text-anchor="middle" dominant-baseline="central">a</text>
<text x="225.6" y="105.6" text-anchor="middle" dominant-baseline="central">n</text>
<text x="235.2" y="105.6" text-anchor="middle" dominant-baseline="central">t</text>
<text x="254.4" y="105.6" text-anchor="middle" dominant-baseline="central">|</text>
<text x="273.6" y="105.6" text-anchor="middle" dominant-baseline="central">r</text>
<text x="283.2" y="105.6" text-anchor="middle" dominant-baseline="central">e</text>
<text x="292.8" y="105.6" text-anchor="middle" dominant-baseline="central">f</text>
<text x="302.4" y="105.6" text-anchor="middle" dominant-baseline="central">u</text>
<text x="312.0" y="105.6" text-anchor="middle" dominant-baseline="central">s</text>
<text x="321.6" y="105.6" text-anchor="middle" dominant-baseline="central">e</text>
<text x="331.2" y="105.6" text-anchor="middle" dominant-baseline="central">)</text>
<text x="100.8" y="124.8" text-anchor="middle" dominant-baseline="central">e</text>
<text x="110.4" y="124.8" text-anchor="middle" dominant-baseline="central">f</text>
<text x="120.0" y="124.8" text-anchor="middle" dominant-baseline="central">f</text>
<text x="129.6" y="124.8" text-anchor="middle" dominant-baseline="central">e</text>
<text x="139.2" y="124.8" text-anchor="middle" dominant-baseline="central">c</text>
<text x="148.8" y="124.8" text-anchor="middle" dominant-baseline="central">t</text>
<text x="187.2" y="124.8" text-anchor="middle" dominant-baseline="central">(</text>
<text x="196.8" y="124.8" text-anchor="middle" dominant-baseline="central">w</text>
<text x="206.4" y="124.8" text-anchor="middle" dominant-baseline="central">h</text>
<text x="216.0" y="124.8" text-anchor="middle" dominant-baseline="central">a</text>
<text x="225.6" y="124.8" text-anchor="middle" dominant-baseline="central">t</text>
<text x="244.8" y="124.8" text-anchor="middle" dominant-baseline="central">h</text>
<text x="254.4" y="124.8" text-anchor="middle" dominant-baseline="central">a</text>
<text x="264.0" y="124.8" text-anchor="middle" dominant-baseline="central">p</text>
<text x="273.6" y="124.8" text-anchor="middle" dominant-baseline="central">p</text>
<text x="283.2" y="124.8" text-anchor="middle" dominant-baseline="central">e</text>
<text x="292.8" y="124.8" text-anchor="middle" dominant-baseline="central">n</text>
<text x="302.4" y="124.8" text-anchor="middle" dominant-baseline="central">s</text>
<text x="312.0" y="124.8" text-anchor="middle" dominant-baseline="central">)</text>
<text x="100.8" y="144.0" text-anchor="middle" dominant-baseline="central">r</text>
<text x="110.4" y="144.0" text-anchor="middle" dominant-baseline="central">e</text>
<text x="120.0" y="144.0" text-anchor="middle" dominant-baseline="central">c</text>
<text x="129.6" y="144.0" text-anchor="middle" dominant-baseline="central">o</text>
<text x="139.2" y="144.0" text-anchor="middle" dominant-baseline="central">r</text>
<text x="148.8" y="144.0" text-anchor="middle" dominant-baseline="central">d</text>
<text x="187.2" y="144.0" text-anchor="middle" dominant-baseline="central">(</text>
<text x="196.8" y="144.0" text-anchor="middle" dominant-baseline="central">a</text>
<text x="206.4" y="144.0" text-anchor="middle" dominant-baseline="central">u</text>
<text x="216.0" y="144.0" text-anchor="middle" dominant-baseline="central">d</text>
<text x="225.6" y="144.0" text-anchor="middle" dominant-baseline="central">i</text>
<text x="235.2" y="144.0" text-anchor="middle" dominant-baseline="central">t</text>
<text x="254.4" y="144.0" text-anchor="middle" dominant-baseline="central">e</text>
<text x="264.0" y="144.0" text-anchor="middle" dominant-baseline="central">n</text>
<text x="273.6" y="144.0" text-anchor="middle" dominant-baseline="central">t</text>
<text x="283.2" y="144.0" text-anchor="middle" dominant-baseline="central">r</text>
<text x="292.8" y="144.0" text-anchor="middle" dominant-baseline="central">y</text>
<text x="302.4" y="144.0" text-anchor="middle" dominant-baseline="central">)</text>
<text x="187.2" y="163.2" text-anchor="middle" dominant-baseline="central">↓</text>
<text x="100.8" y="182.4" text-anchor="middle" dominant-baseline="central">p</text>
<text x="110.4" y="182.4" text-anchor="middle" dominant-baseline="central">o</text>
<text x="120.0" y="182.4" text-anchor="middle" dominant-baseline="central">l</text>
<text x="129.6" y="182.4" text-anchor="middle" dominant-baseline="central">i</text>
<text x="139.2" y="182.4" text-anchor="middle" dominant-baseline="central">c</text>
<text x="148.8" y="182.4" text-anchor="middle" dominant-baseline="central">y</text>
<text x="168.0" y="182.4" text-anchor="middle" dominant-baseline="central">→</text>
<text x="187.2" y="182.4" text-anchor="middle" dominant-baseline="central">l</text>
<text x="196.8" y="182.4" text-anchor="middle" dominant-baseline="central">e</text>
<text x="206.4" y="182.4" text-anchor="middle" dominant-baseline="central">a</text>
<text x="216.0" y="182.4" text-anchor="middle" dominant-baseline="central">n</text>
<text x="225.6" y="182.4" text-anchor="middle" dominant-baseline="central">:</text>
<text x="244.8" y="182.4" text-anchor="middle" dominant-baseline="central">p</text>
<text x="254.4" y="182.4" text-anchor="middle" dominant-baseline="central">r</text>
<text x="264.0" y="182.4" text-anchor="middle" dominant-baseline="central">i</text>
<text x="273.6" y="182.4" text-anchor="middle" dominant-baseline="central">n</text>
<text x="283.2" y="182.4" text-anchor="middle" dominant-baseline="central">t</text>
<text x="187.2" y="201.6" text-anchor="middle" dominant-baseline="central">p</text>
<text x="196.8" y="201.6" text-anchor="middle" dominant-baseline="central">a</text>
<text x="206.4" y="201.6" text-anchor="middle" dominant-baseline="central">r</text>
<text x="216.0" y="201.6" text-anchor="middle" dominant-baseline="central">a</text>
<text x="225.6" y="201.6" text-anchor="middle" dominant-baseline="central">n</text>
<text x="235.2" y="201.6" text-anchor="middle" dominant-baseline="central">o</text>
<text x="244.8" y="201.6" text-anchor="middle" dominant-baseline="central">i</text>
<text x="254.4" y="201.6" text-anchor="middle" dominant-baseline="central">d</text>
<text x="264.0" y="201.6" text-anchor="middle" dominant-baseline="central">:</text>
<text x="283.2" y="201.6" text-anchor="middle" dominant-baseline="central">a</text>
<text x="292.8" y="201.6" text-anchor="middle" dominant-baseline="central">p</text>
<text x="302.4" y="201.6" text-anchor="middle" dominant-baseline="central">p</text>
<text x="312.0" y="201.6" text-anchor="middle" dominant-baseline="central">e</text>
<text x="321.6" y="201.6" text-anchor="middle" dominant-baseline="central">n</text>
<text x="331.2" y="201.6" text-anchor="middle" dominant-baseline="central">d</text>
</svg>
</div>
<h3>The Three Outputs</h3>
<p>1. Decision: Grant or refuse the requested action 2. Effect: The consequence of the decision (action performed, or refusal message) 3. Record: An audit entry capturing what happened</p>
<h3>Auditable vs. Audited</h3>
<ul>
<li>Auditable: The mechanism exists to log the event</li>
<li>Audited: The event is actively being logged</li>
</ul>
<p>All access control decisions are auditable. Whether they are audited depends on realm policy.</p>
</section>
<section>
<h2>Per-Realm Audit Policy</h2>
<p>Each realm configures its own audit policy. The default is lean.</p>
<h3>Policy Levels</h3>
<table>
<tr><th>Level </th><th>Description </th></tr>
<tr><td>lean </td><td>Minimal auditing, low overhead (default) </td></tr>
<tr><td>standard </td><td>Security-relevant events audited </td></tr>
<tr><td>paranoid </td><td>All access decisions audited </td></tr>
</table>
<h3>Event Categories</h3>
<table>
<tr><th>Event </th><th>Lean </th><th>Standard </th><th>Paranoid </th></tr>
<tr><td>Successful joins </td><td>audit </td><td>audit </td><td>audit </td></tr>
<tr><td>Join refusals </td><td>print </td><td>audit </td><td>audit </td></tr>
<tr><td>Delegations </td><td>audit </td><td>audit </td><td>audit </td></tr>
<tr><td>Revocations </td><td>audit </td><td>audit </td><td>audit </td></tr>
<tr><td>Capability grants </td><td>audit </td><td>audit </td><td>audit </td></tr>
<tr><td>Capability refusals </td><td>print </td><td>audit </td><td>audit </td></tr>
<tr><td>Object reads </td><td>— </td><td>— </td><td>audit </td></tr>
<tr><td>Object writes </td><td>print </td><td>audit </td><td>audit </td></tr>
</table>
<h3>Configuration</h3>
<pre class="language-scheme">
(realm-audit-policy 'lean)      ; default
(realm-audit-policy 'standard)
(realm-audit-policy 'paranoid)

;; Or fine-grained:
(realm-audit-policy
  '((joins . audit)
    (refusals . print)
    (delegations . audit)
    (reads . none)))
</pre>
</section>
<section>
<h2>Implementation Pattern</h2>
<p>When implementing an access control point:</p>
<pre class="language-scheme">
(define (access-control-point principal action context)
  "Template for access control with co-designed auditing"

  ;; 1. Make the decision
  (let ((decision (evaluate-policy principal action context)))

    ;; 2. Record based on policy
    (case (realm-audit-policy)
      ((paranoid)
       (audit-append
         actor: principal
         action: `(,action ,@context)
         motivation: (if (eq? decision 'grant)
                         "Access granted"
                         "Access refused")))
      ((standard)
       (when (or (eq? decision 'grant)
                 (security-relevant? action))
         (audit-append ...)))
      ((lean)
       (when (eq? decision 'refuse)
         (print (format "~a Refused: ~a" action (refuse-reason))))))

    ;; 3. Effect
    (if (eq? decision 'grant)
        (perform-action action context)
        (refuse-with-reason action context))))
</pre>
</section>
<section>
<h2>Vocabulary</h2>
<p>Consistent terminology for access control outcomes:</p>
<table>
<tr><th>Outcome </th><th>Verb </th><th>Usage </th></tr>
<tr><td>Execution fails </td><td>Evaporated </td><td>"Execution Evaporated: Signature verification failed" </td></tr>
<tr><td>Join denied </td><td>Refused </td><td>"Join Refused: No valid attestation" </td></tr>
<tr><td>Capability denied </td><td>Refused </td><td>"Capability Refused: Insufficient authority" </td></tr>
<tr><td>Operation blocked </td><td>Refused </td><td>"Operation Refused: Policy violation" </td></tr>
</table>
<p>Avoid: terminated, aborted, ended, failed (where possible).</p>
</section>
<section>
<h2>Security Considerations</h2>
<h3>Refusal Patterns</h3>
<p>A pattern of refusals may indicate: - Misconfiguration (legitimate users being blocked) - Attack probing (malicious principals testing boundaries) - Policy too restrictive (needs adjustment)</p>
<p>Standard and paranoid policies audit refusals to enable pattern detection.</p>
<h3>Audit Cost</h3>
<p>Each audit entry is: - Cryptographically signed (Ed25519) - Hash-chained to previous entry - Persisted to storage</p>
<p>Lean policy minimizes this overhead for high-throughput realms.</p>
<h3>Audit Integrity</h3>
<p>Audit entries themselves are tamper-evident. An attacker cannot: - Delete entries (breaks hash chain) - Modify entries (invalidates signature) - Reorder entries (violates sequence numbers)</p>
</section>
<section>
<h2>References</h2>
<ul>
<li>RFC-003: Cryptographic Audit Trail</li>
<li>RFC-004: SPKI Authorization</li>
<li>RFC-046: Security Architecture</li>
</ul>
</section>
<section>
<h2>Changelog</h2>
<p>- 2026-01-10: Initial draft</p>
</section>
<script>
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
}
(function() {
  // Query param override (for REPL: ?theme=dark or ?theme=light)
  const params = new URLSearchParams(window.location.search);
  const param = params.get('theme');
  if (param === 'dark' || param === 'light') {
    document.documentElement.setAttribute('data-theme', param);
    localStorage.setItem('theme', param);
    return;
  }
  // localStorage preference
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
  } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', 'light');
  }
})();
</script>
</body>
</html>
