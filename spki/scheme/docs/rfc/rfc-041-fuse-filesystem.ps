%!PS-Adobe-3.0
%%BoundingBox: 24 24 571 818
%%Title: Enscript Output
%%For: Derrell Piper
%%Creator: GNU Enscript 1.6.6
%%CreationDate: Fri Jan  9 12:07:50 2026
%%Orientation: Portrait
%%Pages: (atend)
%%DocumentMedia: A4 595 842 0 () ()
%%DocumentNeededResources: (atend)
%%EndComments
%%BeginProlog
%%BeginResource: procset Enscript-Prolog 1.6 6
%
% Procedures.
%

/_S {	% save current state
  /_s save def
} def
/_R {	% restore from saved state
  _s restore
} def

/S {	% showpage protecting gstate
  gsave
  showpage
  grestore
} bind def

/MF {	% fontname newfontname -> -	make a new encoded font
  /newfontname exch def
  /fontname exch def

  /fontdict fontname findfont def
  /newfont fontdict maxlength dict def

  fontdict {
    exch
    dup /FID eq {
      % skip FID pair
      pop pop
    } {
      % copy to the new font dictionary
      exch newfont 3 1 roll put
    } ifelse
  } forall

  newfont /FontName newfontname put

  % insert only valid encoding vectors
  encoding_vector length 256 eq {
    newfont /Encoding encoding_vector put
  } if

  newfontname newfont definefont pop
} def

/MF_PS { % fontname newfontname -> -	make a new font preserving its enc
  /newfontname exch def
  /fontname exch def

  /fontdict fontname findfont def
  /newfont fontdict maxlength dict def

  fontdict {
    exch
    dup /FID eq {
      % skip FID pair
      pop pop
    } {
      % copy to the new font dictionary
      exch newfont 3 1 roll put
    } ifelse
  } forall

  newfont /FontName newfontname put

  newfontname newfont definefont pop
} def

/SF { % fontname width height -> -	set a new font
  /height exch def
  /width exch def

  findfont
  [width 0 0 height 0 0] makefont setfont
} def

/SUF { % fontname width height -> -	set a new user font
  /height exch def
  /width exch def

  /F-gs-user-font MF
  /F-gs-user-font width height SF
} def

/SUF_PS { % fontname width height -> -	set a new user font preserving its enc
  /height exch def
  /width exch def

  /F-gs-user-font MF_PS
  /F-gs-user-font width height SF
} def

/M {moveto} bind def
/s {show} bind def

/Box {	% x y w h -> -			define box path
  /d_h exch def /d_w exch def /d_y exch def /d_x exch def
  d_x d_y  moveto
  d_w 0 rlineto
  0 d_h rlineto
  d_w neg 0 rlineto
  closepath
} def

/bgs {	% x y height blskip gray str -> -	show string with bg color
  /str exch def
  /gray exch def
  /blskip exch def
  /height exch def
  /y exch def
  /x exch def

  gsave
    x y blskip sub str stringwidth pop height Box
    gray setgray
    fill
  grestore
  x y M str s
} def

/bgcs { % x y height blskip red green blue str -> -  show string with bg color
  /str exch def
  /blue exch def
  /green exch def
  /red exch def
  /blskip exch def
  /height exch def
  /y exch def
  /x exch def

  gsave
    x y blskip sub str stringwidth pop height Box
    red green blue setrgbcolor
    fill
  grestore
  x y M str s
} def

% Highlight bars.
/highlight_bars {	% nlines lineheight output_y_margin gray -> -
  gsave
    setgray
    /ymarg exch def
    /lineheight exch def
    /nlines exch def

    % This 2 is just a magic number to sync highlight lines to text.
    0 d_header_y ymarg sub 2 sub translate

    /cw d_output_w cols div def
    /nrows d_output_h ymarg 2 mul sub lineheight div cvi def

    % for each column
    0 1 cols 1 sub {
      cw mul /xp exch def

      % for each rows
      0 1 nrows 1 sub {
        /rn exch def
        rn lineheight mul neg /yp exch def
        rn nlines idiv 2 mod 0 eq {
	  % Draw highlight bar.  4 is just a magic indentation.
	  xp 4 add yp cw 8 sub lineheight neg Box fill
	} if
      } for
    } for

  grestore
} def

% Line highlight bar.
/line_highlight {	% x y width height gray -> -
  gsave
    /gray exch def
    Box gray setgray fill
  grestore
} def

% Column separator lines.
/column_lines {
  gsave
    .1 setlinewidth
    0 d_footer_h translate
    /cw d_output_w cols div def
    1 1 cols 1 sub {
      cw mul 0 moveto
      0 d_output_h rlineto stroke
    } for
  grestore
} def

% Column borders.
/column_borders {
  gsave
    .1 setlinewidth
    0 d_footer_h moveto
    0 d_output_h rlineto
    d_output_w 0 rlineto
    0 d_output_h neg rlineto
    closepath stroke
  grestore
} def

% Do the actual underlay drawing
/draw_underlay {
  ul_style 0 eq {
    ul_str true charpath stroke
  } {
    ul_str show
  } ifelse
} def

% Underlay
/underlay {	% - -> -
  gsave
    0 d_page_h translate
    d_page_h neg d_page_w atan rotate

    ul_gray setgray
    ul_font setfont
    /dw d_page_h dup mul d_page_w dup mul add sqrt def
    ul_str stringwidth pop dw exch sub 2 div ul_h_ptsize -2 div moveto
    draw_underlay
  grestore
} def

/user_underlay {	% - -> -
  gsave
    ul_x ul_y translate
    ul_angle rotate
    ul_gray setgray
    ul_font setfont
    0 0 ul_h_ptsize 2 div sub moveto
    draw_underlay
  grestore
} def

% Page prefeed
/page_prefeed {		% bool -> -
  statusdict /prefeed known {
    statusdict exch /prefeed exch put
  } {
    pop
  } ifelse
} def

% Wrapped line markers
/wrapped_line_mark {	% x y charwith charheight type -> -
  /type exch def
  /h exch def
  /w exch def
  /y exch def
  /x exch def

  type 2 eq {
    % Black boxes (like TeX does)
    gsave
      0 setlinewidth
      x w 4 div add y M
      0 h rlineto w 2 div 0 rlineto 0 h neg rlineto
      closepath fill
    grestore
  } {
    type 3 eq {
      % Small arrows
      gsave
        .2 setlinewidth
        x w 2 div add y h 2 div add M
        w 4 div 0 rlineto
        x w 4 div add y lineto stroke

        x w 4 div add w 8 div add y h 4 div add M
        x w 4 div add y lineto
	w 4 div h 8 div rlineto stroke
      grestore
    } {
      % do nothing
    } ifelse
  } ifelse
} def

% EPSF import.

/BeginEPSF {
  /b4_Inc_state save def    		% Save state for cleanup
  /dict_count countdictstack def	% Count objects on dict stack
  /op_count count 1 sub def		% Count objects on operand stack
  userdict begin
  /showpage { } def
  0 setgray 0 setlinecap
  1 setlinewidth 0 setlinejoin
  10 setmiterlimit [ ] 0 setdash newpath
  /languagelevel where {
    pop languagelevel
    1 ne {
      false setstrokeadjust false setoverprint
    } if
  } if
} bind def

/EndEPSF {
  count op_count sub { pos } repeat	% Clean up stacks
  countdictstack dict_count sub { end } repeat
  b4_Inc_state restore
} bind def

% Check PostScript language level.
/languagelevel where {
  pop /gs_languagelevel languagelevel def
} {
  /gs_languagelevel 1 def
} ifelse
%%EndResource
%%BeginResource: procset Enscript-Encoding-88591 1.6 6
/encoding_vector [
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/space        	/exclam       	/quotedbl     	/numbersign   	
/dollar       	/percent      	/ampersand    	/quoteright   	
/parenleft    	/parenright   	/asterisk     	/plus         	
/comma        	/hyphen       	/period       	/slash        	
/zero         	/one          	/two          	/three        	
/four         	/five         	/six          	/seven        	
/eight        	/nine         	/colon        	/semicolon    	
/less         	/equal        	/greater      	/question     	
/at           	/A            	/B            	/C            	
/D            	/E            	/F            	/G            	
/H            	/I            	/J            	/K            	
/L            	/M            	/N            	/O            	
/P            	/Q            	/R            	/S            	
/T            	/U            	/V            	/W            	
/X            	/Y            	/Z            	/bracketleft  	
/backslash    	/bracketright 	/asciicircum  	/underscore   	
/quoteleft    	/a            	/b            	/c            	
/d            	/e            	/f            	/g            	
/h            	/i            	/j            	/k            	
/l            	/m            	/n            	/o            	
/p            	/q            	/r            	/s            	
/t            	/u            	/v            	/w            	
/x            	/y            	/z            	/braceleft    	
/bar          	/braceright   	/tilde        	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/space        	/exclamdown   	/cent         	/sterling     	
/currency     	/yen          	/brokenbar    	/section      	
/dieresis     	/copyright    	/ordfeminine  	/guillemotleft	
/logicalnot   	/hyphen       	/registered   	/macron       	
/degree       	/plusminus    	/twosuperior  	/threesuperior	
/acute        	/mu           	/paragraph    	/bullet       	
/cedilla      	/onesuperior  	/ordmasculine 	/guillemotright	
/onequarter   	/onehalf      	/threequarters	/questiondown 	
/Agrave       	/Aacute       	/Acircumflex  	/Atilde       	
/Adieresis    	/Aring        	/AE           	/Ccedilla     	
/Egrave       	/Eacute       	/Ecircumflex  	/Edieresis    	
/Igrave       	/Iacute       	/Icircumflex  	/Idieresis    	
/Eth          	/Ntilde       	/Ograve       	/Oacute       	
/Ocircumflex  	/Otilde       	/Odieresis    	/multiply     	
/Oslash       	/Ugrave       	/Uacute       	/Ucircumflex  	
/Udieresis    	/Yacute       	/Thorn        	/germandbls   	
/agrave       	/aacute       	/acircumflex  	/atilde       	
/adieresis    	/aring        	/ae           	/ccedilla     	
/egrave       	/eacute       	/ecircumflex  	/edieresis    	
/igrave       	/iacute       	/icircumflex  	/idieresis    	
/eth          	/ntilde       	/ograve       	/oacute       	
/ocircumflex  	/otilde       	/odieresis    	/divide       	
/oslash       	/ugrave       	/uacute       	/ucircumflex  	
/udieresis    	/yacute       	/thorn        	/ydieresis    	
] def
%%EndResource
%%EndProlog
%%BeginSetup
%%IncludeResource: font Courier-Bold
%%IncludeResource: font Courier
/HFpt_w 10 def
/HFpt_h 10 def
/Courier-Bold /HF-gs-font MF
/HF /HF-gs-font findfont [HFpt_w 0 0 HFpt_h 0 0] makefont def
/Courier /F-gs-font MF
/F-gs-font 10 10 SF
/#copies 1 def
% Pagedevice definitions:
gs_languagelevel 1 gt {
  <<
    /PageSize [595 842] 
  >> setpagedevice
} if
/d_page_w 547 def
/d_page_h 794 def
/d_header_x 0 def
/d_header_y 794 def
/d_header_w 547 def
/d_header_h 0 def
/d_footer_x 0 def
/d_footer_y 0 def
/d_footer_w 547 def
/d_footer_h 0 def
/d_output_w 547 def
/d_output_h 794 def
/cols 1 def
%%EndSetup
%%Page: (1) 1
%%BeginPageSetup
_S
24 24 translate
/pagenum 1 def
/fname (rfc-041-fuse-filesystem.txt) def
/fdir (.) def
/ftail (rfc-041-fuse-filesystem.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 781 M
(RFC-041: Wormholes \(FUSE Filesystem Layer\)) s
5 759 M
(Status: Draft) s
5 748 M
(Created: 2026-01-07) s
5 737 M
(Authors: Library of Cyberspace Contributors) s
5 715 M
(------------------------------------------------------------------------------) s
5 693 M
(Abstract) s
5 671 M
(This RFC specifies wormholes\342\\200\\224FUSE-based bidirectional portals between the) s
5 660 M
(macOS filesystem and the Library of Cyberspace vault. Wormholes preserve full) s
5 649 M
(metadata including extended attributes, Finder tags, and ACLs. All operations) s
5 638 M
(are auditable \(RFC-003\) and rate-limited \(RFC-032\).[^h1]) s
5 616 M
([^h1]: Historical: FUSE originated in Linux 2.6 \(2005\), inspired by earlier) s
5 605 M
(userspace filesystem work in Plan 9 and Hurd. macFUSE \(originally MacFUSE\)) s
5 594 M
(brought it to macOS in 2007. The abstraction outlived Apple's hostility.) s
5 572 M
(------------------------------------------------------------------------------) s
5 550 M
(Motivation) s
5 528 M
(Users need seamless integration between their existing filesystem and the) s
5 517 M
(vault. Manual import/export creates friction and risks metadata loss.) s
5 495 M
(A wormhole provides:) s
5 473 M
(1. Transparency \342\\200\\224 Finder, cp, rsync work unchanged) s
5 462 M
(2. Bidirectionality \342\\200\\224 No separate sync step; it IS the filesystem) s
5 451 M
(3. Metadata preservation \342\\200\\224 Full macOS attributes captured automatically) s
5 440 M
(4. Content addressing \342\\200\\224 Deduplication and integrity built-in) s
5 429 M
(5. Security \342\\200\\224 First-class SPKI object with audit and rate-limit) s
5 407 M
(The filesystem abstraction is the right boundary\342\\200\\224everything above it \(apps,) s
5 396 M
(shell, Finder\) works without modification.[^d1]) s
5 374 M
([^d1]: Design: FUSE inverts the usual model. Instead of teaching applications) s
5 363 M
(about vaults, we teach the vault to speak filesystem. Unix got this right:) s
5 352 M
(everything is a file.) s
5 330 M
(------------------------------------------------------------------------------) s
5 308 M
(Wormhole as Security Object) s
5 286 M
(A wormhole is a first-class security object in cyberspace, subject to:[^d2]) s
5 264 M
(- SPKI Authorization \(RFC-004\) \342\\200\\224 Opening requires valid certificate) s
5 253 M
(- Capability Delegation \(RFC-021\) \342\\200\\224 Wormhole access can be delegated) s
5 242 M
(- Audit Trail \(RFC-003\) \342\\200\\224 All operations logged) s
5 231 M
(- Rate Limiting \(RFC-032\) \342\\200\\224 Configurable ops/minute) s
5 220 M
(- Sandboxing \(RFC-023\) \342\\200\\224 Agents access wormholes through capabilities) s
5 198 M
([^d2]: Design: Wormholes are attack surface. Unrestricted filesystem access) s
5 187 M
(defeats vault security. Every wormhole must be explicitly authorized,) s
5 176 M
(continuously audited, and rate-limited against abuse.) s
5 154 M
(Wormhole Certificate) s
5 132 M
(`scheme) s
5 121 M
(\(define \(wormhole-cert issuer fs-path vault-path permissions\)) s
5 110 M
(  "Create SPKI certificate authorizing wormhole") s
5 99 M
(  \(create-cert) s
5 88 M
(   issuer) s
5 77 M
(   \(wormhole-principal fs-path vault-path\)) s
5 66 M
(   `\(tag \(wormhole) s
5 55 M
(          \(fs-path ,fs-path\)) s
5 44 M
(          \(vault-path ,vault-path\)) s
5 33 M
(          \(permissions ,@permissions\)   ; read, write, delete) s
5 22 M
(          \(rate-limit 1000\)             ; ops/minute) s
5 11 M
(          \(expires ,\(+ \(current-seconds\) 86400\)\)\)\)\)\)) s
_R
S
%%Page: (2) 2
%%BeginPageSetup
_S
24 24 translate
/pagenum 2 def
/fname (rfc-041-fuse-filesystem.txt) def
/fdir (.) def
/ftail (rfc-041-fuse-filesystem.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 781 M
(`) s
5 759 M
(Capability Model) s
5 737 M
(Wormholes support fine-grained capabilities:[^d3]) s
5 715 M
([^d3]: Design: Rich capabilities enable principle of least privilege.) s
5 704 M
(A backup agent needs read-only; a sync agent needs read-write but not) s
5 693 M
(delete. Capabilities compose\342\\200\\224grant exactly what's needed.) s
5 671 M
(Table 0: Wormhole Capabilities) s
5 649 M
(| Capability | Allows |) s
5 638 M
(|------------|--------|) s
5 627 M
(| Data Access | |) s
5 616 M
(| read | Read file contents |) s
5 605 M
(| write | Write/modify file contents |) s
5 594 M
(| create | Create new files |) s
5 583 M
(| delete | Remove files |) s
5 572 M
(| rename | Rename/move files |) s
5 561 M
(| Metadata | |) s
5 550 M
(| stat | Read POSIX attributes |) s
5 539 M
(| chmod | Modify permissions |) s
5 528 M
(| chown | Change ownership |) s
5 517 M
(| xattr-read | Read extended attributes |) s
5 506 M
(| xattr-write | Modify extended attributes |) s
5 495 M
(| acl-read | Read ACLs |) s
5 484 M
(| acl-write | Modify ACLs |) s
5 473 M
(| Directory | |) s
5 462 M
(| readdir | List directory contents |) s
5 451 M
(| mkdir | Create directories |) s
5 440 M
(| rmdir | Remove directories |) s
5 429 M
(| Control | |) s
5 418 M
(| admin | Configure wormhole |) s
5 407 M
(| delegate | Delegate capabilities to others |) s
5 396 M
(| audit-read | Read wormhole audit log |) s
5 385 M
(| rate-limit | Modify rate limits |) s
5 363 M
(Capability Composition) s
5 341 M
(`scheme) s
5 330 M
(;; Common capability sets \(long form for readability\)) s
5 319 M
(\(define capability:read-only) s
5 308 M
(  '\(read stat readdir xattr-read acl-read\)\)) s
5 286 M
(\(define capability:read-write) s
5 275 M
(  '\(read write create stat chmod readdir mkdir xattr-read xattr-write\)\)) s
5 253 M
(\(define capability:full) s
5 242 M
(  '\(read write create delete rename) s
5 231 M
(    stat chmod chown) s
5 220 M
(    xattr-read xattr-write acl-read acl-write) s
5 209 M
(    readdir mkdir rmdir admin delegate audit-read rate-limit\)\)) s
5 187 M
(\(define capability:backup) s
5 176 M
(  '\(read stat readdir xattr-read acl-read\)\)) s
5 154 M
(\(define capability:synchronize) s
5 143 M
(  '\(read write create delete rename) s
5 132 M
(    stat chmod readdir mkdir rmdir) s
5 121 M
(    xattr-read xattr-write\)\)) s
5 110 M
(`) s
5 88 M
(Capability Attenuation) s
5 66 M
(Capabilities can only be reduced, never amplified:[^r1]) s
5 44 M
([^r1]: Research: Capability attenuation is fundamental to the object-capability) s
5 33 M
(model. See Miller, "Robust Composition" \(2006\). You cannot grant more authority) s
5 22 M
(than you possess.) s
_R
S
%%Page: (3) 3
%%BeginPageSetup
_S
24 24 translate
/pagenum 3 def
/fname (rfc-041-fuse-filesystem.txt) def
/fdir (.) def
/ftail (rfc-041-fuse-filesystem.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 781 M
(`scheme) s
5 770 M
(\(define \(wormhole-delegate wormhole new-caps recipient\)) s
5 759 M
(  "Delegate subset of wormhole capabilities") s
5 748 M
(  \(let \(\(my-caps \(wormhole-capabilities wormhole\)\)\)) s
5 737 M
(    \(unless \(subset? new-caps my-caps\)) s
5 726 M
(      \(error 'capability-amplification) s
5 715 M
(             "Cannot delegate capabilities you don't have"\)\)) s
5 704 M
(    \(wormhole-cert) s
5 693 M
(     \(wormhole-issuer wormhole\)) s
5 682 M
(     \(wormhole-fs-path wormhole\)) s
5 671 M
(     \(wormhole-vault-path wormhole\)) s
5 660 M
(     new-caps) s
5 649 M
(     recipient: recipient\)\)\)) s
5 638 M
(`) s
5 616 M
(Opening a Wormhole) s
5 594 M
(`scheme) s
5 583 M
(\(define \(wormhole-open fs-path #!key \(vault-path "/"\)) s
5 572 M
(                                     \(capabilities capability:read-write\)) s
5 561 M
(                                     \(rate-limit 1000\)) s
5 550 M
(                                     \(locked #f\)) s
5 539 M
(                                     \(auth-required '\(\)\)) s
5 528 M
(                                     \(certificate #f\)\)) s
5 517 M
(  "Open wormhole - requires valid certificate") s
5 506 M
(  \(unless certificate) s
5 495 M
(    \(error 'unauthorized "Wormhole requires SPKI certificate"\)\)) s
5 484 M
(  \(unless \(verify-wormhole-cert certificate fs-path vault-path\)) s
5 473 M
(    \(error 'unauthorized "Invalid wormhole certificate"\)\)) s
5 462 M
(  ;; Audit the open) s
5 451 M
(  \(wormhole-audit 'wormhole-open fs-path) s
5 440 M
(                  `\(\(vault ,vault-path\)) s
5 429 M
(                    \(capabilities ,\(length capabilities\)\)\)\)) s
5 418 M
(  ;; Proceed with FUSE mount) s
5 407 M
(  ...\)) s
5 396 M
(`) s
5 374 M
(Usage Examples) s
5 352 M
(`scheme) s
5 341 M
(;; Basic read-write wormhole) s
5 330 M
(\(wormhole-open "~/Cyberspace"\)) s
5 308 M
(;; Read-only wormhole for browsing) s
5 297 M
(\(wormhole-open "~/Archive" capabilities: capability:read-only\)) s
5 275 M
(;; Sync wormhole with rate limiting) s
5 264 M
(\(wormhole-open "~/Sync") s
5 253 M
(  capabilities: capability:synchronize) s
5 242 M
(  rate-limit: 500\)) s
5 220 M
(;; Locked wormhole requiring unlock for sensitive operations) s
5 209 M
(\(wormhole-open "~/Secure") s
5 198 M
(  capabilities: capability:full) s
5 187 M
(  locked: #t) s
5 176 M
(  auth-required: '\(delete admin\)\)) s
5 165 M
(`) s
5 143 M
(------------------------------------------------------------------------------) s
5 121 M
(Architecture) s
5 99 M
(Mount Topology) s
5 77 M
(`) s
5 66 M
(~/Cyberspace/                    \342\\206\\220 FUSE mount point) s
5 55 M
(\342\\224\\234\342\\224\\200\342\\224\\200 documents/) s
5 44 M
(\342\\224\\202   \342\\224\\234\342\\224\\200\342\\224\\200 paper.pdf               \342\\206\\220 Virtual file \(c) s
5 33 M
(ontent in vault\)) s
5 22 M
(\342\\224\\202   \342\\224\\224\342\\224\\200\342\\224\\200 notes.txt) s
5 11 M
(\342\\224\\234\342\\224\\200\342\\224\\200 projects/) s
_R
S
%%Page: (4) 4
%%BeginPageSetup
_S
24 24 translate
/pagenum 4 def
/fname (rfc-041-fuse-filesystem.txt) def
/fdir (.) def
/ftail (rfc-041-fuse-filesystem.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 781 M
(\342\\224\\202   \342\\224\\224\342\\224\\200\342\\224\\200 cyberspace/) s
5 770 M
(\342\\224\\202       \342\\224\\224\342\\224\\200\342\\224\\200 ...) s
5 759 M
(\342\\224\\224\342\\224\\200\342\\224\\200 .vault/                      \342\\206\\220 Hidden, actual storage) s
5 748 M
(    \342\\224\\234\342\\224\\200\342\\224\\200 objects/                 \342\\206\\220 Content-addressed blob) s
5 737 M
(s) s
5 726 M
(    \342\\224\\202   \342\\224\\234\342\\224\\200\342\\224\\200 sha256:abc123...) s
5 715 M
(    \342\\224\\202   \342\\224\\224\342\\224\\200\342\\224\\200 sha256:def456...) s
5 704 M
(    \342\\224\\234\342\\224\\200\342\\224\\200 manifests/               \342\\206\\220 Directory \342\\206\\222 fi) s
5 693 M
(le mappings) s
5 682 M
(    \342\\224\\224\342\\224\\200\342\\224\\200 metadata/                \342\\206\\220 Per-file metadata stor) s
5 671 M
(e) s
5 660 M
(`) s
5 638 M
(Component Stack) s
5 616 M
(`) s
5 605 M
(\342\\224\\214\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
5 594 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342) s
5 583 M
(\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200) s
5 572 M
(\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
5 561 M
(\\220) s
5 550 M
(\342\\224\\202         Applications                \342\\224\\202) s
5 539 M
(\342\\224\\202    \(Finder, cp, rsync, etc.\)        \342\\224\\202) s
5 528 M
(\342\\224\\234\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
5 517 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342) s
5 506 M
(\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200) s
5 495 M
(\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\244) s
5 484 M
(\342\\224\\202         VFS \(kernel\)                \342\\224\\202) s
5 473 M
(\342\\224\\234\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
5 462 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342) s
5 451 M
(\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200) s
5 440 M
(\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\244) s
5 429 M
(\342\\224\\202      FUSE-T / macFUSE               \342\\224\\202) s
5 418 M
(\342\\224\\234\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
5 407 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342) s
5 396 M
(\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200) s
5 385 M
(\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\244) s
5 374 M
(\342\\224\\202    cyberspace-fuse daemon           \342\\224\\202  \342\\206\\220 Our code) s
5 363 M
(\342\\224\\234\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
5 352 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342) s
5 341 M
(\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200) s
5 330 M
(\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\244) s
5 319 M
(\342\\224\\202         Vault layer                 \342\\224\\202) s
5 308 M
(\342\\224\\202   \(content-address, metadata\)       \342\\224\\202) s
5 297 M
(\342\\224\\224\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
5 286 M
(\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342) s
5 275 M
(\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200) s
5 264 M
(\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224\\200\342\\224) s
5 253 M
(\\230) s
5 242 M
(`) s
5 220 M
(------------------------------------------------------------------------------) s
5 198 M
(Metadata Preservation) s
5 176 M
(macOS Metadata Captured) s
5 154 M
(Table 1: Preserved Metadata) s
5 132 M
(| Category | Attributes | Capture Method |) s
5 121 M
(|----------|------------|----------------|) s
5 110 M
(| POSIX | mode, uid, gid, size | stat\(\) |) s
5 99 M
(| Timestamps | mtime, atime, ctime, birthtime | stat\(\) |) s
5 88 M
(| Extended attrs | Finder info, tags, quarantine | listxattr\(\), getxattr\(\) |) s
5 77 M
(| Spotlight | kMDItem* metadata | mdls / MDItem API |) s
5 66 M
(| ACLs | Access control lists | aclgetfile\(\) |) s
5 55 M
(| Flags | hidden, locked, immutable | chflags\(\) / stat\(\) |) s
5 44 M
(| Resource fork | Legacy resource data | xattr com.apple.ResourceFork |) s
5 22 M
(Internal Representation) s
_R
S
%%Page: (5) 5
%%BeginPageSetup
_S
24 24 translate
/pagenum 5 def
/fname (rfc-041-fuse-filesystem.txt) def
/fdir (.) def
/ftail (rfc-041-fuse-filesystem.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 781 M
(`scheme) s
5 770 M
(\(define-record-type <vault-file>) s
5 759 M
(  \(make-vault-file path content-hash metadata\)) s
5 748 M
(  vault-file?) s
5 737 M
(  \(path vault-file-path\)) s
5 726 M
(  \(content-hash vault-file-hash\)) s
5 715 M
(  \(metadata vault-file-metadata\)\)) s
5 693 M
(\(define \(capture-metadata path\)) s
5 682 M
(  "Capture all macOS metadata for a file") s
5 671 M
(  `\(\(posix) s
5 660 M
(     \(mode ,\(file-mode path\)\)) s
5 649 M
(     \(uid ,\(file-uid path\)\)) s
5 638 M
(     \(gid ,\(file-gid path\)\)) s
5 627 M
(     \(size ,\(file-size path\)\)) s
5 616 M
(     \(mtime ,\(file-mtime path\)\)) s
5 605 M
(     \(atime ,\(file-atime path\)\)) s
5 594 M
(     \(ctime ,\(file-ctime path\)\)) s
5 583 M
(     \(birthtime ,\(file-birthtime path\)\)\)) s
5 572 M
(    \(xattr ,\(capture-xattrs path\)\)) s
5 561 M
(    \(flags ,\(capture-flags path\)\)) s
5 550 M
(    \(acl ,\(capture-acl path\)\)\)\)) s
5 539 M
(`) s
5 517 M
(Restoration) s
5 495 M
(`scheme) s
5 484 M
(\(define \(restore-metadata path metadata\)) s
5 473 M
(  "Restore all metadata to a file") s
5 462 M
(  \(let \(\(posix \(alist-ref 'posix metadata\)\)) s
5 451 M
(        \(xattr \(alist-ref 'xattr metadata\)\)) s
5 440 M
(        \(flags \(alist-ref 'flags metadata\)\)) s
5 429 M
(        \(acl \(alist-ref 'acl metadata\)\)\)) s
5 418 M
(    \(restore-posix path posix\)) s
5 407 M
(    \(restore-xattrs path xattr\)) s
5 396 M
(    \(restore-flags path flags\)) s
5 385 M
(    \(restore-acl path acl\)\)\)) s
5 374 M
(`) s
5 352 M
(------------------------------------------------------------------------------) s
5 330 M
(FUSE Operations) s
5 308 M
(Required Operations) s
5 286 M
(Table 2: FUSE Operations) s
5 264 M
(| Operation | Purpose | Vault Action |) s
5 253 M
(|-----------|---------|--------------|) s
5 242 M
(| getattr | stat\(\) | Return stored metadata |) s
5 231 M
(| readdir | List directory | Read manifest |) s
5 220 M
(| open | Open file | Validate hash exists |) s
5 209 M
(| read | Read content | Fetch by content hash |) s
5 198 M
(| write | Write content | Content-address, update manifest |) s
5 187 M
(| create | Create file | Allocate manifest entry |) s
5 176 M
(| unlink | Delete file | Remove from manifest \(GC later\) |) s
5 165 M
(| mkdir | Create directory | Create manifest node |) s
5 154 M
(| rmdir | Remove directory | Remove manifest node |) s
5 143 M
(| rename | Move/rename | Update manifest path |) s
5 132 M
(| setxattr | Set extended attr | Store in metadata |) s
5 121 M
(| getxattr | Get extended attr | Retrieve from metadata |) s
5 110 M
(| listxattr | List extended attrs | Enumerate metadata |) s
5 88 M
(Implementation Sketch) s
5 66 M
(`scheme) s
5 55 M
(\(define \(fuse-getattr path\)) s
5 44 M
(  "Return file attributes from vault metadata") s
5 33 M
(  \(let \(\(entry \(manifest-lookup path\)\)\)) s
5 22 M
(    \(if entry) s
5 11 M
(        \(let \(\(meta \(vault-file-metadata entry\)\)\)) s
_R
S
%%Page: (6) 6
%%BeginPageSetup
_S
24 24 translate
/pagenum 6 def
/fname (rfc-041-fuse-filesystem.txt) def
/fdir (.) def
/ftail (rfc-041-fuse-filesystem.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 781 M
(          \(make-stat) s
5 770 M
(           \(alist-ref 'mode \(alist-ref 'posix meta\)\)) s
5 759 M
(           \(alist-ref 'size \(alist-ref 'posix meta\)\)) s
5 748 M
(           \(alist-ref 'mtime \(alist-ref 'posix meta\)\)) s
5 737 M
(           ...\)\)) s
5 726 M
(        -ENOENT\)\)\)) s
5 704 M
(\(define \(fuse-read path size offset\)) s
5 693 M
(  "Read file content from vault") s
5 682 M
(  \(let* \(\(entry \(manifest-lookup path\)\)) s
5 671 M
(         \(hash \(vault-file-hash entry\)\)) s
5 660 M
(         \(content \(vault-fetch hash\)\)\)) s
5 649 M
(    \(subbytes content offset \(+ offset size\)\)\)\)) s
5 627 M
(\(define \(fuse-write path data offset\)) s
5 616 M
(  "Write to file, content-address the result") s
5 605 M
(  \(let* \(\(entry \(manifest-lookup path\)\)) s
5 594 M
(         \(current \(vault-fetch \(vault-file-hash entry\)\)\)) s
5 583 M
(         \(updated \(bytes-splice current offset data\)\)) s
5 572 M
(         \(new-hash \(content-address updated\)\)\)) s
5 561 M
(    \(manifest-update! path new-hash\)) s
5 550 M
(    \(string-length data\)\)\)) s
5 528 M
(\(define \(fuse-setxattr path name value\)) s
5 517 M
(  "Store extended attribute in vault metadata") s
5 506 M
(  \(let \(\(entry \(manifest-lookup path\)\)\)) s
5 495 M
(    \(metadata-set-xattr! entry name value\)) s
5 484 M
(    0\)\)) s
5 473 M
(`) s
5 451 M
(------------------------------------------------------------------------------) s
5 429 M
(Content Addressing) s
5 407 M
(Files are stored by content hash \(RFC-020\):) s
5 385 M
(`scheme) s
5 374 M
(\(define \(content-address data\)) s
5 363 M
(  "Store data, return hash") s
5 352 M
(  \(let* \(\(hash \(sha256 data\)\)) s
5 341 M
(         \(path \(vault-object-path hash\)\)\)) s
5 330 M
(    \(unless \(file-exists? path\)) s
5 319 M
(      \(write-blob path data\)\)) s
5 308 M
(    hash\)\)) s
5 286 M
(\(define \(vault-fetch hash\)) s
5 275 M
(  "Retrieve data by hash") s
5 264 M
(  \(read-blob \(vault-object-path hash\)\)\)) s
5 253 M
(`) s
5 231 M
(Benefits:) s
5 220 M
(- Identical files stored once \(deduplication\)) s
5 209 M
(- Integrity verification on every read) s
5 198 M
(- Immutable objects enable safe caching) s
5 176 M
(------------------------------------------------------------------------------) s
5 154 M
(Synchronization) s
5 132 M
(Change Detection) s
5 110 M
(The FUSE layer captures all writes in real-time. No separate sync needed) s
5 99 M
(for local changes.) s
5 77 M
(For multi-device sync, the manifest includes version vectors \(RFC-012\):) s
5 55 M
(`scheme) s
5 44 M
(\(define \(manifest-entry path hash metadata\)) s
5 33 M
(  `\(entry) s
5 22 M
(    \(path ,path\)) s
5 11 M
(    \(hash ,hash\)) s
_R
S
%%Page: (7) 7
%%BeginPageSetup
_S
24 24 translate
/pagenum 7 def
/fname (rfc-041-fuse-filesystem.txt) def
/fdir (.) def
/ftail (rfc-041-fuse-filesystem.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 781 M
(    \(metadata ,metadata\)) s
5 770 M
(    \(version-vector ,local-node ,lamport-clock\)\)\)) s
5 759 M
(`) s
5 737 M
(Conflict Resolution) s
5 715 M
(When merging manifests from different devices \(RFC-016 lazy clustering\):) s
5 693 M
(1. Same hash \342\\206\\222 No conflict \(identical content\)) s
5 682 M
(2. Different hash, one newer \342\\206\\222 Take newer) s
5 671 M
(3. Different hash, concurrent \342\\206\\222 Conflict, apply lazy-resolve) s
5 649 M
(`scheme) s
5 638 M
(\(define \(merge-manifests local remote\)) s
5 627 M
(  \(for-each) s
5 616 M
(   \(lambda \(path\)) s
5 605 M
(     \(let \(\(l \(manifest-lookup local path\)\)) s
5 594 M
(           \(r \(manifest-lookup remote path\)\)\)) s
5 583 M
(       \(cond) s
5 572 M
(        \(\(not l\) \(manifest-add! local r\)\)) s
5 561 M
(        \(\(not r\) 'keep-local\)) s
5 550 M
(        \(\(equal? \(vault-file-hash l\) \(vault-file-hash r\)\) 'identical\)) s
5 539 M
(        \(\(version-newer? r l\) \(manifest-update! local r\)\)) s
5 528 M
(        \(\(version-newer? l r\) 'keep-local\)) s
5 517 M
(        \(else \(queue-conflict! path l r\)\)\)\)\)) s
5 506 M
(   \(union \(manifest-paths local\) \(manifest-paths remote\)\)\)\)) s
5 495 M
(`) s
5 473 M
(------------------------------------------------------------------------------) s
5 451 M
(Mount Commands) s
5 429 M
(REPL Interface) s
5 407 M
(`scheme) s
5 396 M
(\(define \(vault-mount point\)) s
5 385 M
(  "Mount vault at filesystem path") s
5 374 M
(  \(fuse-main point) s
5 363 M
(    `\(\(getattr . ,fuse-getattr\)) s
5 352 M
(      \(readdir . ,fuse-readdir\)) s
5 341 M
(      \(open . ,fuse-open\)) s
5 330 M
(      \(read . ,fuse-read\)) s
5 319 M
(      \(write . ,fuse-write\)) s
5 308 M
(      \(create . ,fuse-create\)) s
5 297 M
(      \(unlink . ,fuse-unlink\)) s
5 286 M
(      \(mkdir . ,fuse-mkdir\)) s
5 275 M
(      \(rmdir . ,fuse-rmdir\)) s
5 264 M
(      \(rename . ,fuse-rename\)) s
5 253 M
(      \(setxattr . ,fuse-setxattr\)) s
5 242 M
(      \(getxattr . ,fuse-getxattr\)) s
5 231 M
(      \(listxattr . ,fuse-listxattr\)\)\)\)) s
5 209 M
(\(define \(vault-unmount point\)) s
5 198 M
(  "Unmount vault filesystem") s
5 187 M
(  \(fuse-unmount point\)\)) s
5 176 M
(`) s
5 154 M
(Command Line) s
5 132 M
(`bash) s
5 121 M
(Mount) s
5 110 M
(cyberspace mount ~/Cyberspace) s
5 88 M
(Unmount) s
5 77 M
(cyberspace unmount ~/Cyberspace) s
5 55 M
(Or via REPL) s
5 44 M
($ ./cyberspace-repl) s
5 33 M
(  \(vault-mount "~/Cyberspace"\)) s
5 22 M
(Mounted vault at /Users/ddp/Cyberspace) s
5 11 M
(`) s
_R
S
%%Page: (8) 8
%%BeginPageSetup
_S
24 24 translate
/pagenum 8 def
/fname (rfc-041-fuse-filesystem.txt) def
/fdir (.) def
/ftail (rfc-041-fuse-filesystem.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 770 M
(------------------------------------------------------------------------------) s
5 748 M
(macOS Integration) s
5 726 M
(FUSE-T vs macFUSE) s
5 704 M
(Table 3: FUSE Implementation Options) s
5 682 M
(| Feature | macFUSE | FUSE-T |) s
5 671 M
(|---------|---------|--------|) s
5 660 M
(| Kernel extension | Yes \(deprecated\) | No |) s
5 649 M
(| System extension | Optional | Uses NFS |) s
5 638 M
(| SIP compatible | Requires disable | Yes |) s
5 627 M
(| Performance | Better | Adequate |) s
5 616 M
(| Maintenance | Active | Active |) s
5 594 M
(FUSE-T recommended for new installations\342\\200\\224no kernel extension required.[^i1]) s
5 572 M
([^i1]: Implementation: FUSE-T implements FUSE API over NFS loopback.) s
5 561 M
(Slightly higher latency but avoids Apple's kernel extension hostility.) s
5 539 M
(Installation) s
5 517 M
(`bash) s
5 506 M
(FUSE-T \(recommended\)) s
5 495 M
(brew install fuse-t) s
5 473 M
(Or macFUSE \(if kernel ext acceptable\)) s
5 462 M
(brew install macfuse) s
5 451 M
(`) s
5 429 M
(Finder Integration) s
5 407 M
(The mount appears as a regular volume in Finder. Optional .VolumeIcon.icns) s
5 396 M
(for custom icon.) s
5 374 M
(Spotlight indexing can be enabled by implementing getxattr for) s
5 363 M
(com.apple.FinderInfo and related Spotlight attributes.) s
5 341 M
(------------------------------------------------------------------------------) s
5 319 M
(Security Considerations) s
5 297 M
(Permissions) s
5 275 M
(FUSE daemon runs as user, not root. Respects vault ACLs.) s
5 253 M
(Content Integrity) s
5 231 M
(Every read verifies content hash. Corruption detected immediately.) s
5 209 M
(Metadata Trust) s
5 187 M
(Metadata is stored separately from content. A compromised metadata store) s
5 176 M
(cannot alter file contents \(hashes won't match\).) s
5 154 M
(Mount Security) s
5 132 M
(`scheme) s
5 121 M
(\(define \(vault-mount point #!key \(allow-other #f\)\)) s
5 110 M
(  ;; allow-other permits other users to access mount) s
5 99 M
(  ;; Default: owner only) s
5 88 M
(  ...\)) s
5 77 M
(`) s
5 55 M
(------------------------------------------------------------------------------) s
5 33 M
(Dependencies) s
5 11 M
(| Component | Purpose |) s
_R
S
%%Page: (9) 9
%%BeginPageSetup
_S
24 24 translate
/pagenum 9 def
/fname (rfc-041-fuse-filesystem.txt) def
/fdir (.) def
/ftail (rfc-041-fuse-filesystem.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 781 M
(|-----------|---------|) s
5 770 M
(| FUSE-T or macFUSE | Userspace filesystem |) s
5 759 M
(| libfuse | FUSE library |) s
5 748 M
(| Scheme FFI | Bindings to libfuse |) s
5 726 M
(------------------------------------------------------------------------------) s
5 704 M
(References) s
5 682 M
(1. RFC-012: Lamport Clocks) s
5 671 M
(2. RFC-016: Lazy Clustering) s
5 660 M
(3. RFC-020: Content-Addressed Storage) s
5 649 M
(4. FUSE documentation: https://libfuse.github.io/) s
5 638 M
(5. FUSE-T: https://github.com/macos-fuse-t/fuse-t) s
5 616 M
(------------------------------------------------------------------------------) s
5 594 M
(Changelog) s
5 572 M
(- 2026-01-07 - Initial specification) s
5 550 M
(------------------------------------------------------------------------------) s
5 528 M
(Implementation Status: Draft) s
_R
S
%%Trailer
%%Pages: 9
%%DocumentNeededResources: font Courier-Bold Courier 
%%EOF
