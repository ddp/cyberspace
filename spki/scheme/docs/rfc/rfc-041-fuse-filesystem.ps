%!PS-Adobe-3.0
%%Creator: groff version 1.23.0
%%CreationDate: Thu Jan  8 15:17:54 2026
%%DocumentNeededResources: font Times-Roman
%%DocumentSuppliedResources: procset grops 1.23 0
%%Pages: 8
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.23 0
%!PS-Adobe-3.0 Resource-ProcSet
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
% The ASCII code of the space character.
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
% name size font SF -
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
% name a c d font MF -
/MF{
findfont
[5 2 roll
0 3 1 roll % b
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
% Enable manual feed.
% MANUAL -
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
% Guess the page length.
% This assumes that the imageable area is vertically centered on the page.
% PLG - length
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
% BP -
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
% centerx centery radius startangle endangle DA -
/DA{
newpath arcn stroke
}bind def
% x y SN - x' y'
% round a position to nearest (pixel + (.25,.25))
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
% endx endy startx starty DL -
% we round the endpoints of the line, so that parallel horizontal
% and vertical lines will appear even
/DL{
SN
moveto
SN
lineto stroke
}bind def
% centerx centery radius DC -
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
%  width height centerx centery DE -
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
% these are for splines
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
% fill the last path
% r g b Fr -
/Fr{
setrgbcolor fill
}bind def
% c m y k Fk -
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
% g Fg -
/Fg{
setgray fill
}bind def
% fill with the "current color"
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
% new_font_name encoding_vector old_font_name RE -
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
% hpos vpos EBEGIN -
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
% llx lly newwid wid newht ht newllx newlly PBEGIN -
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
% set the graphics state to default values
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
%
%  Any included setpagedevice should be ignored.
%  See: http://www.w-beer.de/doc/ps/.
%
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%EndProlog
%%BeginSetup
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Times-Roman
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/Euro/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Times-Roman@0 ENC0/Times-Roman RE
%%EndSetup
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(RFC-041: W)72 12 Q
(ormholes \(FUSE Filesystem Layer\))-.8 E(Status: Draft Created: 2026-0\
1-07 Authors: Library of Cyberspace Contrib)72 36 Q(utors)-.2 E(-------\
-----------------------------------------------------------------------)
72 60 Q(Abstract)72 84 Q .52(This RFC speci\214es w)72 108 R .52(ormhol\
es\342FUSE-based bidirectional portals between the macOS \214lesystem a\
nd the Library of)-.1 F .175(Cyberspace v)72 120 R .175(ault. W)-.25 F
.175(ormholes preserv)-.8 F 2.675(ef)-.15 G .175
(ull metadata including e)-2.675 F .175(xtended attrib)-.15 F .175
(utes, Finder tags, and A)-.2 F .175(CLs. All oper)-.4 F(-)-.2 E
(ations are auditable \(RFC-003\) and rate-limited \(RFC-032\).[1])72
132 Q(-----------------------------------------------------------------\
-------------)72 156 Q(Moti)72 180 Q -.25(va)-.25 G(tion).25 E .687
(Users need seamless inte)72 204 R .687(gration between their e)-.15 F
.686(xisting \214lesystem and the v)-.15 F .686(ault. Manual import/e)
-.25 F .686(xport creates fric-)-.15 F(tion and risks metadata loss.)72
216 Q 2.5(Aw)72 240 S(ormhole pro)-2.6 E(vides:)-.15 E 2.633(1. T)72 264
R(ransparenc)-.35 E -5.132 2.633(y\342 F)-.15 H(inder)-2.633 E 2.634(,c)
-.4 G .134(p, rsync w)-2.634 F .134(ork unchanged 2.)-.1 F .134
(Bidirectionality \342 No separate sync step; it IS the \214lesystem)
5.134 F 2.553(3. Metadata)72 276 R(preserv)2.553 E .053
(ation \342 Full macOS attrib)-.25 F .053
(utes captured automatically 4.)-.2 F .053
(Content addressing \342 Deduplication and)5.053 F(inte)72 288 Q
(grity b)-.15 E(uilt-in 5.)-.2 E
(Security \342 First-class SPKI object with audit and rate-limit)5 E
.949(The \214lesystem abstraction is the right boundary\342e)72 312 R
-.15(ve)-.25 G .949(rything abo).15 F 1.249 -.15(ve i)-.15 H 3.449(t\()
.15 G .95(apps, shell, Finder\) w)-3.449 F .95(orks without modi\214ca-)
-.1 F(tion.[2])72 324 Q(-----------------------------------------------\
-------------------------------)72 348 Q -.8(Wo)72 372 S
(rmhole as Security Object).8 E 2.5(Aw)72 396 S
(ormhole is a \214rst-class security object in c)-2.6 E
(yberspace, subject to:[3])-.15 E 3.443(-S)72 420 S .943
(PKI Authorization \(RFC-004\) \342 Opening requires v)-3.443 F .943
(alid certi\214cate - Capability Dele)-.25 F -.05(ga)-.15 G .942
(tion \(RFC-021\) \342 W).05 F(orm-)-.8 E .447(hole access can be dele)
72 432 R -.05(ga)-.15 G .447(ted - Audit T).05 F .447(rail \(RFC-003\) \
\342 All operations logged - Rate Limiting \(RFC-032\) \342 Con\214g-)
-.35 F(urable ops/minute - Sandboxing \(RFC-023\) \342 Agents access w)
72 444 Q(ormholes through capabilities)-.1 E -.8(Wo)72 468 S
(rmhole Certi\214cate).8 E(\(de\214ne \(w)82 492 Q
(ormhole-cert issuer fs-path v)-.1 E(ault-path permissions\))-.25 E
("Create SPKI certi\214cate authorizing w)87 504 Q(ormhole")-.1 E
(\(create-cert)87 516 Q(issuer)89.5 528 Q(\(w)89.5 540 Q
(ormhole-principal fs-path v)-.1 E(ault-path\))-.25 E(`\(tag \(w)89.5
552 Q(ormhole)-.1 E(\(fs-path ,fs-path\))107 564 Q(\(v)107 576 Q
(ault-path ,v)-.25 E(ault-path\))-.25 E(\(permissions ,@permissions\))
107 588 Q 2.5(;r)7.5 G(ead, write, delete)-2.5 E(\(rate-limit 1000\))107
600 Q 2.5(;o)32.5 G(ps/minute)-2.5 E(\(e)107 612 Q
(xpires ,\(+ \(current-seconds\) 86400\)\)\)\)\)\))-.15 E
(Capability Model)72 636 Q -.8(Wo)72 660 S
(rmholes support \214ne-grained capabilities:[4]).8 E -.8(Ta)72 684 S
(ble 0: W).8 E(ormhole Capabilities)-.8 E 7.5(Capability Allo)77 708 R
(ws)-.25 E(------------- ---------------------------------)77 720 Q
(Data Access)77 732 Q 22.5(read Read)77 744 R(\214le contents)2.5 E 20
(write Write/modify)77 756 R(\214le contents)2.5 E 17.5(create Create)77
768 R(ne)2.5 E 2.5<778c>-.25 G(les)-2.5 E 17.5(delete Remo)77 780 R .3
-.15(ve \214)-.15 H(les).15 E 17.5(rename Rename/mo)77 792 R .3 -.15
(ve \214)-.15 H(les).15 E 0 Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(Metadata)77 12 Q 22.5(stat Read)77 24 R
(POSIX attrib)2.5 E(utes)-.2 E 20(chmod Modify)77 36 R(permissions)2.5 E
(cho)77 48 Q 20(wn Change)-.25 F -.25(ow)2.5 G(nership).25 E(xattr)77 60
Q 7.5(-read Read)-.2 F -.15(ex)2.5 G(tended attrib).15 E(utes)-.2 E
(xattr)77 72 Q 5(-write Modify)-.2 F -.15(ex)2.5 G(tended attrib).15 E
(utes)-.2 E 12.5(acl-read Read)77 84 R -.4(AC)2.5 G(Ls).4 E 10
(acl-write Modify)77 96 R -.4(AC)2.5 G(Ls).4 E(Directory)77 108 Q 15
(readdir List)77 120 R(directory contents)2.5 E 20(mkdir Create)77 132 R
(directories)2.5 E 20(rmdir Remo)77 144 R .3 -.15(ve d)-.15 H
(irectories).15 E(Control)77 156 Q 20(admin Con\214gure)77 168 R -.1(wo)
2.5 G(rmhole).1 E(dele)77 180 Q -.05(ga)-.15 G 12.5(te Dele).05 F -.05
(ga)-.15 G(te capabilities to others).05 E 7.5(audit-read Read)77 192 R
-.1(wo)2.5 G(rmhole audit log).1 E 7.5(rate-limit Modify)77 204 R
(rate limits)2.5 E(Capability Composition)72 228 Q
(;; Common capability sets \(long form for readability\))82 252 Q
(\(de\214ne capability:read-only)82 264 Q('\(read stat readdir xattr)87
276 Q(-read acl-read\)\))-.2 E(\(de\214ne capability:read-write)82 300 Q
('\(read write create stat chmod readdir mkdir xattr)87 312 Q
(-read xattr)-.2 E(-write\)\))-.2 E(\(de\214ne capability:full)82 336 Q
('\(read write create delete rename)87 348 Q(stat chmod cho)92 360 Q(wn)
-.25 E(xattr)92 372 Q(-read xattr)-.2 E(-write acl-read acl-write)-.2 E
(readdir mkdir rmdir admin dele)92 384 Q -.05(ga)-.15 G
(te audit-read rate-limit\)\)).05 E(\(de\214ne capability:backup)82 408
Q('\(read stat readdir xattr)87 420 Q(-read acl-read\)\))-.2 E
(\(de\214ne capability:synchronize)82 444 Q
('\(read write create delete rename)87 456 Q
(stat chmod readdir mkdir rmdir)92 468 Q(xattr)92 480 Q(-read xattr)-.2
E(-write\)\))-.2 E(Capability Attenuation)72 504 Q
(Capabilities can only be reduced, ne)72 528 Q -.15(ve)-.25 G 2.5(ra).15
G(mpli\214ed:[5])-2.5 E(\(de\214ne \(w)82 552 Q(ormhole-dele)-.1 E -.05
(ga)-.15 G(te w).05 E(ormhole ne)-.1 E(w-caps recipient\))-.25 E("Dele)
87 564 Q -.05(ga)-.15 G(te subset of w).05 E(ormhole capabilities")-.1 E
(\(let \(\(my-caps \(w)87 576 Q(ormhole-capabilities w)-.1 E
(ormhole\)\)\))-.1 E(\(unless \(subset? ne)92 588 Q(w-caps my-caps\))
-.25 E(\(error 'capability-ampli\214cation)97 600 Q("Cannot dele)114.5
612 Q -.05(ga)-.15 G(te capabilities you don').05 E 2.5(th)-.18 G -2.25
-.2(av e)-2.5 H("\)\)).2 E(\(w)92 624 Q(ormhole-cert)-.1 E(\(w)94.5 636
Q(ormhole-issuer w)-.1 E(ormhole\))-.1 E(\(w)94.5 648 Q
(ormhole-fs-path w)-.1 E(ormhole\))-.1 E(\(w)94.5 660 Q(ormhole-v)-.1 E
(ault-path w)-.25 E(ormhole\))-.1 E(ne)94.5 672 Q(w-caps)-.25 E
(recipient: recipient\)\)\))94.5 684 Q(Opening a W)72 708 Q(ormhole)-.8
E(\(de\214ne \(w)82 732 Q(ormhole-open fs-path #!k)-.1 E .3 -.15(ey \()
-.1 H -.25(va).15 G(ult-path "/"\)).25 E
(\(capabilities capability:read-write\))174.5 744 Q(\(rate-limit 1000\))
174.5 756 Q(\(lock)174.5 768 Q(ed #f\))-.1 E(\(auth-required '\(\)\))
174.5 780 Q(\(certi\214cate #f\)\))174.5 792 Q 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF("Open w)87 12 Q(ormhole - requires v)-.1 E
(alid certi\214cate")-.25 E(\(unless certi\214cate)87 24 Q
(\(error 'unauthorized "W)92 36 Q
(ormhole requires SPKI certi\214cate"\)\))-.8 E(\(unless \(v)87 48 Q
(erify-w)-.15 E(ormhole-cert certi\214cate fs-path v)-.1 E(ault-path\))
-.25 E(\(error 'unauthorized "In)92 60 Q -.25(va)-.4 G(lid w).25 E
(ormhole certi\214cate"\)\))-.1 E(;; Audit the open)87 72 Q(\(w)87 84 Q
(ormhole-audit 'w)-.1 E(ormhole-open fs-path)-.1 E(`\(\(v)127 96 Q
(ault ,v)-.25 E(ault-path\))-.25 E
(\(capabilities ,\(length capabilities\)\)\)\))132 108 Q
(;; Proceed with FUSE mount)87 120 Q(...\))87 132 Q(Usage Examples)72
156 Q(;; Basic read-write w)82 180 Q(ormhole)-.1 E(\(w)82 192 Q
(ormhole-open "~/Cyberspace"\))-.1 E(;; Read-only w)82 216 Q
(ormhole for bro)-.1 E(wsing)-.25 E(\(w)82 228 Q(ormhole-open "~/Archi)
-.1 E -.15(ve)-.25 G 2.5("c).15 G(apabilities: capability:read-only\))
-2.5 E(;; Sync w)82 252 Q(ormhole with rate limiting)-.1 E(\(w)82 264 Q
(ormhole-open "~/Sync")-.1 E(capabilities: capability:synchronize)87 276
Q(rate-limit: 500\))87 288 Q(;; Lock)82 312 Q(ed w)-.1 E
(ormhole requiring unlock for sensiti)-.1 E .3 -.15(ve o)-.25 H
(perations).15 E(\(w)82 324 Q(ormhole-open "~/Secure")-.1 E
(capabilities: capability:full)87 336 Q(lock)87 348 Q(ed: #t)-.1 E
(auth-required: '\(delete admin\)\))87 360 Q(--------------------------\
----------------------------------------------------)72 384 Q
(Architecture)72 408 Q(Mount T)72 432 Q(opology)-.8 E 47.5
(~/Cyberspace/ \342)82 456 R(FUSE mount point)2.5 E
(\342\342\342 documents/)82 468 Q 7.5<e2e2>82 480 S(\342\342 paper)-7.5
E 35(.pdf \342)-.55 F -.6(Vi)2.5 G(rtual \214le \(content in v).6 E
(ault\))-.25 E 7.5<e2e2>82 492 S(\342\342 notes.txt)-7.5 E
(\342\342\342 projects/)82 504 Q 7.5<e2e2>82 516 S<e2e22063>-7.5 E
(yberspace/)-.15 E 17.5<e2e2>82 528 S(\342\342 ...)-17.5 E<e2e2e2202e76>
82 540 Q 52.5(ault/ \342)-.25 F(Hidden, actual storage)2.5 E
(\342\342\342 objects/)92 552 Q 2.5<e243>42.5 G(ontent-addressed blobs)
-2.5 E 7.5<e2e2>92 564 S(\342\342 sha256:abc123...)-7.5 E 7.5<e2e2>92
576 S(\342\342 sha256:def456...)-7.5 E(\342\342\342 manifests/)92 588 Q
2.5<e244>37.5 G(irectory \342 \214le mappings)-2.5 E
(\342\342\342 metadata/)92 600 Q 2.5<e250>40 G(er)-2.5 E
(-\214le metadata store)-.2 E(Component Stack)72 624 Q<e2e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2>82 648 Q
22.5<e241>82 660 S 37.5(pplications \342)-22.5 F 10<e228>82 672 S
(Finder)-10 E 2.5(,c)-.4 G(p, rsync, etc.\))-2.5 E<e2>20 E<e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2a4>82
684 Q 22.5<e256>82 696 S(FS \(k)-22.5 E 37.5(ernel\) \342)-.1 F<e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2a4>
82 708 Q 15<e246>82 720 S(USE-T / macFUSE)-15 E<e2>37.5 E<e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2a4>82
732 Q 10<e263>82 744 S(yberspace-fuse daemon)-10.15 E 5<e2e2>27.5 G
(Our code)-2.5 E<e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2a4>82 756 Q 22.5<e256>82 768 S(ault layer)-23.61
E<e2>42.5 E 7.5<e228>82 780 S(content-address, metadata\))-7.5 E<e2>17.5
E<e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2
e2e2e2e2>82 792 Q 0 Cg EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-----------------------------------------------\
-------------------------------)72 24 Q(Metadata Preserv)72 48 Q(ation)
-.25 E(macOS Metadata Captured)72 72 Q -.8(Ta)72 96 S(ble 1: Preserv).8
E(ed Metadata)-.15 E(--------------------------------------------------\
----------------------------)77 120 Q(Cate)77 132 Q 30(gory Attrib)-.15
F 35(utes Capture)-.2 F(Method)2.5 E(-------------------- -------------\
----------- --------------------------------)77 144 Q 37.5(POSIX mode,)
77 156 R(uid, gid, size)2.5 E(stat\(\))12.5 E -.35(Ti)77 180 S 25
(mestamps mtime,).35 F(atime, ctime,)2.5 E(stat\(\))12.5 E(birthtime)
129.5 192 Q(Extended attrs)77 216 Q(Finder info, tags,)17.5 E
(listxattr\(\), getxattr\(\))17.5 E(quarantine)129.5 228 Q 27.5
(Spotlight kMDItem*)77 252 R 17.5(metadata mdls)2.5 F 2.5(/M)2.5 G
(DItem API)-2.5 E -.4(AC)77 276 S 40(Ls Access).4 F(control lists)2.5 E
(acl_get_\214le\(\))12.5 E 37.5(Flags hidden,)77 300 R(lock)2.5 E 22.5
(ed, ch\215ags\(\))-.1 F 2.5(/s)2.5 G(tat\(\))-2.5 E(immutable)129.5 312
Q(Resource fork)77 336 Q(Le)20 E -.05(ga)-.15 G .3 -.15(cy r).05 H
(esource data).15 E(xattr com.apple.ResourceF)12.5 E(ork)-.15 E(-------\
-----------------------------------------------------------------------)
77 348 Q(Internal Representation)72 372 Q(\(de\214ne-record-type <v)82
396 Q(ault-\214le>)-.25 E(\(mak)87 408 Q(e-v)-.1 E
(ault-\214le path content-hash metadata\))-.25 E -.25(va)87 420 S
(ult-\214le?).25 E(\(path v)87 432 Q(ault-\214le-path\))-.25 E
(\(content-hash v)87 444 Q(ault-\214le-hash\))-.25 E(\(metadata v)87 456
Q(ault-\214le-metadata\)\))-.25 E(\(de\214ne \(capture-metadata path\))
82 480 Q("Capture all macOS metadata for a \214le")87 492 Q(`\(\(posix)
87 504 Q(\(mode ,\(\214le-mode path\)\))94.5 516 Q
(\(uid ,\(\214le-uid path\)\))94.5 528 Q(\(gid ,\(\214le-gid path\)\))
94.5 540 Q(\(size ,\(\214le-size path\)\))94.5 552 Q
(\(mtime ,\(\214le-mtime path\)\))94.5 564 Q
(\(atime ,\(\214le-atime path\)\))94.5 576 Q
(\(ctime ,\(\214le-ctime path\)\))94.5 588 Q
(\(birthtime ,\(\214le-birthtime path\)\)\))94.5 600 Q
(\(xattr ,\(capture-xattrs path\)\))92 612 Q
(\(\215ags ,\(capture-\215ags path\)\))92 624 Q
(\(acl ,\(capture-acl path\)\)\)\))92 636 Q(Restoration)72 660 Q
(\(de\214ne \(restore-metadata path metadata\))82 684 Q
("Restore all metadata to a \214le")87 696 Q
(\(let \(\(posix \(alist-ref 'posix metadata\)\))87 708 Q
(\(xattr \(alist-ref 'xattr metadata\)\))102 720 Q
(\(\215ags \(alist-ref '\215ags metadata\)\))102 732 Q
(\(acl \(alist-ref 'acl metadata\)\)\))102 744 Q
(\(restore-posix path posix\))92 756 Q(\(restore-xattrs path xattr\))92
768 Q(\(restore-\215ags path \215ags\))92 780 Q
(\(restore-acl path acl\)\)\))92 792 Q 0 Cg EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-----------------------------------------------\
-------------------------------)72 24 Q(FUSE Operations)72 48 Q
(Required Operations)72 72 Q -.8(Ta)72 96 S(ble 2: FUSE Operations).8 E
5(Operation Purpose)77 120 R -1.11(Va)37.5 G(ult Action)1.11 E
(----------- --------------------- ----------------------------------)77
132 Q 10(getattr stat\(\))77 144 R(Return stored metadata)40 E 10
(readdir List)77 156 R 17.5(directory Read)2.5 F(manifest)2.5 E 17.5
(open Open)77 168 R 30(\214le V)2.5 F(alidate hash e)-1.11 E(xists)-.15
E 17.5(read Read)77 180 R 22.5(content Fetch)2.5 F(by content hash)2.5 E
15(write Write)77 192 R 20(content Content-address,)2.5 F
(update manifest)2.5 E 12.5(create Create)77 204 R 25(\214le Allocate)
2.5 F(manifest entry)2.5 E 12.5(unlink Delete)77 216 R 25(\214le Remo)
2.5 F .3 -.15(ve f)-.15 H(rom manifest \(GC later\)).15 E 15
(mkdir Create)77 228 R 12.5(directory Create)2.5 F(manifest node)2.5 E
15(rmdir Remo)77 240 R .3 -.15(ve d)-.15 H 12.5(irectory Remo).15 F .3
-.15(ve m)-.15 H(anifest node).15 E 12.5(rename Mo)77 252 R -.15(ve)-.15
G 25(/rename Update).15 F(manifest path)2.5 E 7.5(setxattr Set)77 264 R
-.15(ex)2.5 G(tended attr).15 E(Store in metadata)12.5 E 7.5
(getxattr Get)77 276 R -.15(ex)2.5 G(tended attr).15 E(Retrie)12.5 E .3
-.15(ve f)-.25 H(rom metadata).15 E 5(listxattr List)77 288 R -.15(ex)
2.5 G(tended attrs).15 E(Enumerate metadata)7.5 E(Implementation Sk)72
312 Q(etch)-.1 E(\(de\214ne \(fuse-getattr path\))82 336 Q
("Return \214le attrib)87 348 Q(utes from v)-.2 E(ault metadata")-.25 E
(\(let \(\(entry \(manifest-lookup path\)\)\))87 360 Q(\(if entry)92 372
Q(\(let \(\(meta \(v)102 384 Q(ault-\214le-metadata entry\)\)\))-.25 E
(\(mak)107 396 Q(e-stat)-.1 E
(\(alist-ref 'mode \(alist-ref 'posix meta\)\))109.5 408 Q
(\(alist-ref ')109.5 420 Q(size \(alist-ref 'posix meta\)\))-.55 E
(\(alist-ref 'mtime \(alist-ref 'posix meta\)\))109.5 432 Q(...\)\))
109.5 444 Q(-ENOENT\)\)\))102 456 Q(\(de\214ne \(fuse-read path size of)
82 480 Q(fset\))-.25 E("Read \214le content from v)87 492 Q(ault")-.25 E
(\(let* \(\(entry \(manifest-lookup path\)\))87 504 Q(\(hash \(v)104.5
516 Q(ault-\214le-hash entry\)\))-.25 E(\(content \(v)104.5 528 Q
(ault-fetch hash\)\)\))-.25 E(\(subbytes content of)92 540 Q
(fset \(+ of)-.25 E(fset size\)\)\)\))-.25 E
(\(de\214ne \(fuse-write path data of)82 564 Q(fset\))-.25 E
("Write to \214le, content-address the result")87 576 Q
(\(let* \(\(entry \(manifest-lookup path\)\))87 588 Q(\(current \(v)
104.5 600 Q(ault-fetch \(v)-.25 E(ault-\214le-hash entry\)\)\))-.25 E
(\(updated \(bytes-splice current of)104.5 612 Q(fset data\)\))-.25 E
(\(ne)104.5 624 Q(w-hash \(content-address updated\)\)\))-.25 E
(\(manifest-update! path ne)92 636 Q(w-hash\))-.25 E
(\(string-length data\)\)\))92 648 Q
(\(de\214ne \(fuse-setxattr path name v)82 672 Q(alue\))-.25 E("Store e)
87 684 Q(xtended attrib)-.15 E(ute in v)-.2 E(ault metadata")-.25 E
(\(let \(\(entry \(manifest-lookup path\)\)\))87 696 Q
(\(metadata-set-xattr! entry name v)92 708 Q(alue\))-.25 E(0\)\))92 720
Q(---------------------------------------------------------------------\
---------)72 744 Q(Content Addressing)72 768 Q
(Files are stored by content hash \(RFC-020\):)72 792 Q 0 Cg EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(de\214ne \(content-address data\))82 24 Q
("Store data, return hash")87 36 Q(\(let* \(\(hash \(sha256 data\)\))87
48 Q(\(path \(v)104.5 60 Q(ault-object-path hash\)\)\))-.25 E
(\(unless \(\214le-e)92 72 Q(xists? path\))-.15 E
(\(write-blob path data\)\))97 84 Q(hash\)\))92 96 Q(\(de\214ne \(v)82
120 Q(ault-fetch hash\))-.25 E("Retrie)87 132 Q .3 -.15(ve d)-.25 H
(ata by hash").15 E(\(read-blob \(v)87 144 Q
(ault-object-path hash\)\)\))-.25 E .827
(Bene\214ts: - Identical \214les stored once \(deduplication\) - Inte)72
168 R .827(grity v)-.15 F .827(eri\214cation on e)-.15 F -.15(ve)-.25 G
.827(ry read - Immutable objects en-).15 F(able safe caching)72 180 Q(-\
-----------------------------------------------------------------------\
------)72 204 Q(Synchronization)72 228 Q(Change Detection)72 252 Q(The \
FUSE layer captures all writes in real-time. No separate sync needed fo\
r local changes.)72 276 Q -.15(Fo)72 300 S 2.5(rm).15 G(ulti-de)-2.5 E
(vice sync, the manifest includes v)-.25 E(ersion v)-.15 E
(ectors \(RFC-012\):)-.15 E
(\(de\214ne \(manifest-entry path hash metadata\))82 324 Q(`\(entry)87
336 Q(\(path ,path\))92 348 Q(\(hash ,hash\))92 360 Q
(\(metadata ,metadata\))92 372 Q(\(v)92 384 Q(ersion-v)-.15 E
(ector ,*local-node* ,*lamport-clock*\)\)\))-.15 E
(Con\215ict Resolution)72 408 Q(When mer)72 432 Q
(ging manifests from dif)-.18 E(ferent de)-.25 E
(vices \(RFC-016 lazy clustering\):)-.25 E 2.585(1. Same)72 456 R .085
(hash \342 No con\215ict \(identical content\) 2.)2.585 F(Dif)5.085 E
.085(ferent hash, one ne)-.25 F .085(wer \342 T)-.25 F(ak)-.8 E 2.586
(en)-.1 G -.25(ew)-2.586 G .086(er 3.).25 F(Dif)5.086 E .086
(ferent hash, concur)-.25 F(-)-.2 E
(rent \342 Con\215ict, apply lazy-resolv)72 468 Q(e)-.15 E
(\(de\214ne \(mer)82 492 Q(ge-manifests local remote\))-.18 E(\(for)87
504 Q(-each)-.2 E(\(lambda \(path\))89.5 516 Q
(\(let \(\(l \(manifest-lookup local path\)\))94.5 528 Q
(\(r \(manifest-lookup remote path\)\)\))109.5 540 Q(\(cond)99.5 552 Q
(\(\(not l\) \(manifest-add! local r\)\))102 564 Q(\(\(not r\) 'k)102
576 Q(eep-local\))-.1 E(\(\(equal? \(v)102 588 Q
(ault-\214le-hash l\) \(v)-.25 E(ault-\214le-hash r\)\) 'identical\))
-.25 E(\(\(v)102 600 Q(ersion-ne)-.15 E
(wer? r l\) \(manifest-update! local r\)\))-.25 E(\(\(v)102 612 Q
(ersion-ne)-.15 E(wer? l r\) 'k)-.25 E(eep-local\))-.1 E
(\(else \(queue-con\215ict! path l r\)\)\)\)\))102 624 Q
(\(union \(manifest-paths local\) \(manifest-paths remote\)\)\)\))89.5
636 Q(-----------------------------------------------------------------\
-------------)72 660 Q(Mount Commands)72 684 Q(REPL Interf)72 708 Q(ace)
-.1 E(\(de\214ne \(v)82 732 Q(ault-mount point\))-.25 E("Mount v)87 744
Q(ault at \214lesystem path")-.25 E(\(fuse-main point)87 756 Q
(`\(\(getattr . ,fuse-getattr\))92 768 Q(\(readdir . ,fuse-readdir\))97
780 Q(\(open . ,fuse-open\))97 792 Q 0 Cg EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(read . ,fuse-read\))97 12 Q
(\(write . ,fuse-write\))97 24 Q(\(create . ,fuse-create\))97 36 Q
(\(unlink . ,fuse-unlink\))97 48 Q(\(mkdir . ,fuse-mkdir\))97 60 Q
(\(rmdir . ,fuse-rmdir\))97 72 Q(\(rename . ,fuse-rename\))97 84 Q
(\(setxattr . ,fuse-setxattr\))97 96 Q(\(getxattr . ,fuse-getxattr\))97
108 Q(\(listxattr . ,fuse-listxattr\)\)\)\))97 120 Q(\(de\214ne \(v)82
144 Q(ault-unmount point\))-.25 E("Unmount v)87 156 Q
(ault \214lesystem")-.25 E(\(fuse-unmount point\)\))87 168 Q
(Command Line)72 192 Q 2.5(#M)82 216 S(ount)-2.5 E -.15(cy)82 228 S
(berspace mount ~/Cyberspace).15 E 2.5(#U)82 252 S(nmount)-2.5 E -.15
(cy)82 264 S(berspace unmount ~/Cyberspace).15 E 2.5(#O)82 288 S 2.5(rv)
-2.5 G(ia REPL)-2.5 E 2.5($.)82 300 S(/c)-2.5 E(yberspace-repl)-.15 E
2.5(>\()82 312 S -.25(va)-2.5 G(ult-mount "~/Cyberspace"\)).25 E
(Mounted v)82 324 Q(ault at /Users/ddp/Cyberspace)-.25 E(--------------\
----------------------------------------------------------------)72 348
Q(macOS Inte)72 372 Q(gration)-.15 E(FUSE-T vs macFUSE)72 396 Q -.8(Ta)
72 420 S(ble 3: FUSE Implementation Options).8 E 27.5
(Feature macFUSE FUSE-T)77 444 R
(------------------ ------------------ ----------)77 456 Q -.25(Ke)77
468 S(rnel e).25 E 5(xtension Y)-.15 F(es \(deprecated\))-1 E(No)7.5 E
(System e)77 480 Q 5(xtension Optional)-.15 F(Uses NFS)27.5 E
(SIP compatible)77 492 Q(Requires disable)12.5 E -1(Ye)7.5 G(s)1 E 17.5
(Performance Better)77 504 R(Adequate)32.5 E 17.5(Maintenance Acti)77
516 R 30.3 -.15(ve A)-.25 H(cti).15 E -.15(ve)-.25 G
(FUSE-T recommended for ne)72 540 Q 2.5(wi)-.25 G(nstallations\342no k)
-2.5 E(ernel e)-.1 E(xtension required.[6])-.15 E(Installation)72 564 Q
2.5(#F)82 588 S(USE-T \(recommended\))-2.5 E(bre)82 600 Q 2.5(wi)-.25 G
(nstall fuse-t)-2.5 E 2.5(#O)82 624 S 2.5(rm)-2.5 G(acFUSE \(if k)-2.5 E
(ernel e)-.1 E(xt acceptable\))-.15 E(bre)82 636 Q 2.5(wi)-.25 G
(nstall macfuse)-2.5 E(Finder Inte)72 660 Q(gration)-.15 E
(The mount appears as a re)72 684 Q(gular v)-.15 E(olume in Finder)-.2 E
2.5(.O)-.55 G(ptional .V)-2.5 E(olumeIcon.icns for custom icon.)-1.29 E
.951(Spotlight inde)72 708 R .951(xing can be enabled by implementing g\
etxattr for com.apple.FinderInfo and related Spotlight attrib-)-.15 F
(utes.)72 720 Q(-------------------------------------------------------\
-----------------------)72 744 Q(Security Considerations)72 768 Q
(Permissions)72 792 Q 0 Cg EP
%%Page: 8 8
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(FUSE daemon runs as user)72 24 Q 2.5(,n)-.4 G
(ot root. Respects v)-2.5 E(ault A)-.25 E(CLs.)-.4 E(Content Inte)72 48
Q(grity)-.15 E(Ev)72 72 Q(ery read v)-.15 E
(eri\214es content hash. Corruption detected immediately)-.15 E(.)-.65 E
(Metadata T)72 96 Q(rust)-.35 E .546(Metadata is stored separately from\
 content. A compromised metadata store cannot alter \214le contents \(h\
ashes w)72 120 R(on\342t)-.1 E(match\).)72 132 Q(Mount Security)72 156 Q
(\(de\214ne \(v)82 180 Q(ault-mount point #!k)-.25 E .3 -.15(ey \()-.1 H
(allo).15 E(w-other #f\)\))-.25 E(;; allo)87 192 Q
(w-other permits other users to access mount)-.25 E(;; Def)87 204 Q
(ault: o)-.1 E(wner only)-.25 E(...\))87 216 Q(------------------------\
------------------------------------------------------)72 240 Q
(Dependencies)72 264 Q 25(Component Purpose)77 288 R
(------------------- ----------------------)77 300 Q(FUSE-T or macFUSE)
77 312 Q(Userspace \214lesystem)7.5 E 30(libfuse FUSE)77 324 R(library)
2.5 E(Scheme FFI)77 336 Q(Bindings to libfuse)25 E(--------------------\
----------------------------------------------------------)72 360 Q
(References)72 384 Q 3.991(1. RFC-012:)72 408 R 1.491(Lamport Clocks 2.)
3.991 F 1.491(RFC-016: Lazy Clustering 3.)6.491 F 1.49
(RFC-020: Content-Addressed Storage 4.)6.491 F(FUSE)6.49 E
(documentation: https://libfuse.github)72 420 Q(.io/ 5.)-.4 E(FUSE-T)5 E
2.5(:h)-.5 G(ttps://github)-2.5 E(.com/macos-fuse-t/fuse-t)-.4 E(------\
-----------------------------------------------------------------------\
-)72 444 Q(Changelog)72 468 Q 2.5(-2)72 492 S
(026-01-07 - Initial speci\214cation)-2.5 E(---------------------------\
---------------------------------------------------)72 516 Q
(Implementation Status: Draft)72 540 Q 1.215([1] Historical: FUSE origi\
nated in Linux 2.6 \(2005\), inspired by earlier userspace \214lesystem\
 w)72 564 R 1.215(ork in Plan 9 and)-.1 F(Hurd. macFUSE \(originally Ma\
cFUSE\) brought it to macOS in 2007. The abstraction outli)72 576 Q -.15
(ve)-.25 G 2.5(dA).15 G(pple\342s hostility)-2.5 E(.)-.65 E .29
([2] Design: FUSE in)72 600 R -.15(ve)-.4 G .29
(rts the usual model. Instead of teaching applications about v).15 F .29
(aults, we teach the v)-.25 F .29(ault to speak)-.25 F
(\214lesystem. Unix got this right: e)72 612 Q -.15(ve)-.25 G
(rything is a \214le.).15 E 1.401([3] Design: W)72 636 R 1.401
(ormholes are attack surf)-.8 F 1.402
(ace. Unrestricted \214lesystem access defeats v)-.1 F 1.402
(ault security)-.25 F 3.902(.E)-.65 G -.15(ve)-3.902 G 1.402(ry w).15 F
(ormhole)-.1 E(must be e)72 648 Q
(xplicitly authorized, continuously audited, and rate-limited ag)-.15 E
(ainst ab)-.05 E(use.)-.2 E .206
([4] Design: Rich capabilities enable principle of least pri)72 672 R
(vile)-.25 E .206
(ge. A backup agent needs read-only; a sync agent needs)-.15 F
(read-write b)72 684 Q(ut not delete.)-.2 E
(Capabilities compose\342grant e)5 E(xactly what\342s needed.)-.15 E
1.028([5] Research: Capability attenuation is fundamental to the object\
-capability model. See Miller)72 708 R 3.528<2ce2>-.4 G(Rob)-3.528 E
1.028(ust Composi-)-.2 F(tion\342 \(2006\). Y)72 720 Q
(ou cannot grant more authority than you possess.)-1.1 E .152
([6] Implementation: FUSE-T implements FUSE API o)72 744 R -.15(ve)-.15
G 2.651(rN).15 G .151(FS loopback. Slightly higher latenc)-2.651 F 2.651
(yb)-.15 G .151(ut a)-2.851 F -.2(vo)-.2 G .151(ids Apple\342s).2 F -.1
(ke)72 756 S(rnel e).1 E(xtension hostility)-.15 E(.)-.65 E 0 Cg EP
%%Trailer
end
%%EOF
