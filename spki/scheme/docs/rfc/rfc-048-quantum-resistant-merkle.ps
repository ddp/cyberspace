%!PS-Adobe-3.0
%%Creator: groff version 1.23.0
%%CreationDate: Fri Jan  9 11:29:13 2026
%%DocumentNeededResources: font Times-Roman
%%DocumentSuppliedResources: procset grops 1.23 0
%%Pages: 6
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.23 0
%!PS-Adobe-3.0 Resource-ProcSet
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
% The ASCII code of the space character.
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
% name size font SF -
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
% name a c d font MF -
/MF{
findfont
[5 2 roll
0 3 1 roll % b
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
% Enable manual feed.
% MANUAL -
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
% Guess the page length.
% This assumes that the imageable area is vertically centered on the page.
% PLG - length
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
% BP -
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
% centerx centery radius startangle endangle DA -
/DA{
newpath arcn stroke
}bind def
% x y SN - x' y'
% round a position to nearest (pixel + (.25,.25))
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
% endx endy startx starty DL -
% we round the endpoints of the line, so that parallel horizontal
% and vertical lines will appear even
/DL{
SN
moveto
SN
lineto stroke
}bind def
% centerx centery radius DC -
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
%  width height centerx centery DE -
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
% these are for splines
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
% fill the last path
% r g b Fr -
/Fr{
setrgbcolor fill
}bind def
% c m y k Fk -
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
% g Fg -
/Fg{
setgray fill
}bind def
% fill with the "current color"
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
% new_font_name encoding_vector old_font_name RE -
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
% hpos vpos EBEGIN -
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
% llx lly newwid wid newht ht newllx newlly PBEGIN -
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
% set the graphics state to default values
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
%
%  Any included setpagedevice should be ignored.
%  See: http://www.w-beer.de/doc/ps/.
%
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%EndProlog
%%BeginSetup
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Times-Roman
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/Euro/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Times-Roman@0 ENC0/Times-Roman RE
%%EndSetup
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(RFC-048: Quantum-Resistant Merkle T)72 12 Q
(rees)-.35 E .56(**Status:** Draft **Date:** January 2026 **Author:** D\
errell Piper <ddp@eludom.net> **Requires:** RFC-020)72 36 R
(\(Content-Addressed Storage\), RFC-040 \(Security Architecture\))72 48
Q(---)72 72 Q(Abstract)72 96 Q .243(SHA-512 w)72 120 R(on')-.1 E 2.743
(ts)-.18 G(urvi)-2.743 E -.15(ve)-.25 G 2.743(.G).15 G(ro)-2.743 E -.15
(ve)-.15 G(r').15 E 2.743(sa)-.55 G .243(lgorithm halv)-2.743 F .243
(es the ef)-.15 F(fecti)-.25 E .543 -.15(ve s)-.25 H .243
(ecurity - 256 bits becomes 128. F).15 F .244(or the wilderness)-.15 F
.425(of mirrors to endure the quantum winter)72 132 R 2.924(,w)-.4 G
2.924(en)-2.924 G .424(eed quantum-resistant Merkle trees. This RFC spe\
ci\214es the transition)-2.924 F
(from \215at SHA-512 hashes to tree-structured SHAKE256 hashes.)72 144 Q
(---)72 168 Q(The Problem)72 192 Q(Current c)72 216 Q
(yberspace object identity: `)-.15 E 1.48 -.74(`` s)-.74 H
(ha512\(content\) \342 64 bytes \342 object address `).74 E -.74(``)-.74
G(Ag)72 240 Q 1.113(ainst a quantum computer with Gro)-.05 F -.15(ve)
-.15 G(r').15 E 3.614(sa)-.55 G 1.114
(lgorithm: - Classical security: 256 bits - Quantum security: 128 bits)
-3.614 F(\(square root\))72 252 Q .196
(128 bits may be acceptable for some threat models, b)72 276 R .195
(ut c)-.2 F .195(yberspace is b)-.15 F .195
(uilt to last. The Library of Ale)-.2 F .195(xandria b)-.15 F(urned)-.2
E(once. W)72 288 Q 2.5(ew)-.8 G(on')-2.6 E 2.5(tl)-.18 G
(et quantum computers b)-2.5 E(urn it ag)-.2 E(ain.)-.05 E(---)72 312 Q
(The Solution: Merkle T)72 336 Q(rees)-.35 E
(Instead of hashing content as a \215at blob, structure it as a tree:)72
360 Q -.74(```)72 384 S<e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2>122 396 Q
7.5<e24d>122 408 S(erkle Root)-7.5 E 5<e2e2>7.5 G(Object identity)-2.5 E
5<e273>122 420 S(hak)-5 E 2.5(e256\(...\) \342)-.1 F
<e2e2e2e2e2e2e2e2e2e2ace2e2e2e2e2e2e2e2e2>122 432 Q<e2>144.5 444 Q
<e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2bce2e2e2e2e2e2e2e2e2e2e2e2e2e2e2>107
456 Q 35<e2e2e2>107 468 S 7.5<e2e2e2e2e2e2bce2e2e2e2e220e2e2e2e2e2e2bce2
e2e2e2e220e2e2e2e2e2e2bce2e2e2e2e2>94.5 480 R 2.5<e24e>94.5 492 S(ode 0)
-2.5 E 10<e2e2>5 G(Node 1)-7.5 E 10<e2e2>5 G(Node 2)-7.5 E<e2>5 E 7.5<e2
e2e2e2e2e2ace2e2e2e2e220e2e2e2e2e2e2ace2e2e2e2e220e2e2e2e2e2e2ace2e2e2e2
e2>94.5 504 R 35<e2e2e2>107 516 S 2.5<e2e2e2e2e2e2e2b4e2e2e2e2e2e220e2e2
e2e2e2e2e2b4e2e2e2e2e2e220e2e2e2e2e2e2e2b4e2e2e2e2e2e2>92 528 R 27.5
<e2e2>92 540 S 27.5<e2e2>-22.5 G 27.5<e2e2>-22.5 G<e2e2e2e2e2bce2e2e2e2
20e2e2e2e2e2bce2e2e2e220e2e2e2e2e2bce2e2e2e220e2e2e2e2e2bce2e2e2e220e2e2
e2e2e2bce2e2e2e2202e2e2e>82 552 Q(\342Chunk 0\342 \342Chunk 1\342 \342C\
hunk 2\342 \342Chunk 3\342 \342Chunk 4\342)82 564 Q 2.5(\3424K)82 576 S
5<42e2>-2.5 G 2.5(\3424K)-2.5 G 5<42e2>-2.5 G 2.5(\3424K)-2.5 G 5<42e2>
-2.5 G 2.5(\3424K)-2.5 G 5<42e2>-2.5 G 2.5(\3424K)-2.5 G 5<42e2>-2.5 G<
e2e2e2e2e2e2e2e2e220e2e2e2e2e2e2e2e2e220e2e2e2e2e2e2e2e2e220e2e2e2e2e2e2
e2e2e220e2e2e2e2e2e2e2e2e22060>82 588 Q -.74(``)-.74 G(**Bene\214ts:**)
72 612 Q .265(1. **Incremental updates** - Change one chunk, rehash one\
 branch 2. **Selecti)72 636 R .565 -.15(ve d)-.25 H .266
(isclosure** - Pro).15 F .566 -.15(ve a c)-.15 H .266(hunk e).15 F(x-)
-.15 E .972(ists without re)72 648 R -.15(ve)-.25 G .972
(aling siblings 3. **Streaming v).15 F .972(eri\214cation** - V)-.15 F
.972(erify chunks as the)-1.11 F 3.472(ya)-.15 G(rri)-3.472 E 1.272 -.15
(ve 4)-.25 H 3.472(.*).15 G(*P)-3.472 E .972(arallelizable** -)-.15 F
(Hash chunks concurrently 5. **Quantum-resistant** - SHAKE256 at e)72
660 Q -.15(ve)-.25 G(ry node).15 E(---)72 684 Q(Hash Function: SHAKE256)
72 708 Q(SHAKE256 is an e)72 732 Q
(xtendable-output function \(XOF\) from the SHA-3 \(K)-.15 E(eccak\) f)
-.25 E(amily)-.1 E(.)-.65 E(**Wh)72 756 Q 2.5(yS)-.05 G(HAKE256:**)-2.5
E 3.397(|P)72 780 S .897(roperty | V)-3.397 F .897
(alue | |----------|-------| | Security le)-1.11 F -.15(ve)-.25 G 3.397
(l|2).15 G .898(56-bit classical, 128-bit quantum | | Output length | V)
-3.397 F(ariable)-1.11 E .025
(\(we use 256 bits\) | | Construction | Sponge \(dif)72 792 R .025
(ferent from SHA-2')-.25 F 2.525(sM)-.55 G .024
(erkle-Damg\303\245rd\) | | Standard | NIST FIPS 202)-2.525 F 0 Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 2.5(||U)72 12 S
(sed by | SPHINCS+ \(post-quantum signatures\) | | In libsodium | No, b)
-2.5 E(ut in OpenSSL, libgcrypt |)-.2 E(**Alternati)72 36 Q -.15(ve)-.25
G 2.5(:B).15 G(LAKE3**)-2.5 E 2.883(|P)72 60 S .383(roperty | V)-2.883 F
.383(alue | |----------|-------| | Security le)-1.11 F -.15(ve)-.25 G
2.883(l|2).15 G .384
(56-bit classical, 128-bit quantum | | Output length | V)-2.883 F .384
(ariable | |)-1.11 F .044
(Construction | Merkle tree internally | | Speed | V)72 72 R .044(ery f)
-1.11 F .044(ast, SIMD optimized | | Standard | Not NIST)-.1 F 2.543(,b)
-.74 G .043(ut widely trusted)-2.743 F(|)72 84 Q(BLAKE3 is f)72 108 Q
(aster and already tree-structured, b)-.1 E
(ut SHAKE256 has NIST blessing. W)-.2 E 2.5(es)-.8 G(upport both.)-2.5 E
(---)72 132 Q(Object F)72 156 Q(ormat)-.15 E(Current \(Le)72 180 Q -.05
(ga)-.15 G -.15(cy).05 G(\)).15 E -.74(```)72 204 S(scheme \(object).74
E(\(hash "sha512:3a7bd3e2c4f8..."\))77 216 Q(\(size 1048576\))77 228 Q
(\(content ...\)\))77 240 Q -.74(```)5 G(Quantum-Resistant)72 264 Q -.74
(```)72 288 S(scheme \(object).74 E(\(merkle-root "shak)77 300 Q
(e256:7f4a2b9c..."\))-.1 E(\(hash-algorithm "shak)77 312 Q 22.5
(e256"\) ;)-.1 F(or "blak)2.5 E(e3")-.1 E(\(tree-params)77 324 Q
(\(chunk-size 4096\))82 336 Q 2.5(;4K)45 G 2.5(Bc)-2.5 G(hunks)-2.5 E
(\(f)82 348 Q(anout 16\))-.1 E 2.5(;C)60 G(hildren per node)-2.5 E
(\(depth 4\)\))82 360 Q 2.5(;T)62.5 G(ree depth)-2.85 E
(\(size 1048576\))77 372 Q(\(content ...\)\))77 384 Q -.74(```)5 G -.35
(Tr)72 408 S(ansition Period \(Dual Hash\)).35 E -.74(```)72 432 S
(scheme \(object).74 E(\(hash "sha512:3a7bd3e2c4f8..."\))77 444 Q 2.5
(;L)27.5 G -2.25 -.15(eg a)-2.5 H .3 -.15(cy - f).15 H(or old clients)
.15 E(\(merkle-root "shak)77 456 Q 12.5(e256:7f4a2b9c..."\) ;)-.1 F
(Quantum-resistant)2.5 E(\(hash-algorithm "shak)77 468 Q(e256"\))-.1 E
(\(tree-params)77 480 Q(\(chunk-size 4096\))82 492 Q(\(f)82 504 Q
(anout 16\))-.1 E(\(depth 4\)\))82 516 Q(\(size 1048576\))77 528 Q
(\(content ...\)\))77 540 Q -.74(```)5 G(Old clients use `hash`. Ne)72
564 Q 2.5(wc)-.25 G(lients use `merkle-root`. Both v)-2.5 E
(erify the same content.)-.15 E(---)72 588 Q -.35(Tr)72 612 S
(ee Construction).35 E(Algorithm)72 636 Q -.74(```)72 660 S
(scheme \(de\214ne \(merkle-hash content algorithm chunk-size f).74 E
(anout\))-.1 E("Build Merkle tree, return root hash")77 672 Q
(;; 1. Split content into chunks)77 696 Q
(\(let* \(\(chunks \(chunk-content content chunk-size\)\))77 708 Q
(;; 2. Hash each chunk \(lea)94.5 732 Q -.15(ve)-.2 G(s\)).15 E(\(lea)
94.5 744 Q -.15(ve)-.2 G 2.5(s\().15 G(map \(lambda \(chunk\))-2.5 E
(\(hash algorithm chunk\)\))132 756 Q(chunks\)\))127 768 Q
(;; 3. Build tree bottom-up)94.5 792 Q 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(root \(b)94.5 12 Q(uild-tree lea)-.2 E -.15
(ve)-.2 G 2.5(sf).15 G(anout algorithm\)\)\))-2.6 E(root\)\))82 36 Q
(\(de\214ne \(b)72 60 Q(uild-tree nodes f)-.2 E(anout algorithm\))-.1 E
("Combine nodes into parent nodes until one root remains")77 72 Q
(\(if \(<= \(length nodes\) 1\))77 84 Q(\(car nodes\))87 96 Q
(\(let \(\(parents \(map \(lambda \(group\))87 108 Q
(\(hash algorithm \(apply append group\)\)\))142 120 Q
(\(partition nodes f)137 132 Q(anout\)\)\)\))-.1 E(\(b)92 144 Q
(uild-tree parents f)-.2 E(anout algorithm\)\)\)\) `)-.1 E -.74(``)-.74
G(Node Hashing)72 168 Q
(Each internal node hashes the concatenation of its children:)72 192 Q
1.48 -.74(``` n)72 216 T(ode_hash = shak).74 E
(e256\(child_0 || child_1 || ... || child_n\) `)-.1 E -.74(``)-.74 G
-.15(Fo)72 240 S 2.5(rl).15 G(ea)-2.5 E -.15(ve)-.2 G(s: `).15 E 1.48
-.74(`` l)-.74 H(eaf_hash = shak).74 E(e256\(chunk_data\) `)-.1 E -.74
(``)-.74 G(Canonical P)72 264 Q(arameters)-.15 E 2.798(|P)72 288 S .298
(arameter | Def)-2.948 F .299(ault | Notes | |-----------|---------|---\
----| | chunk-size | 4096 | 4 KB, \214lesystem-friendly | | f)-.1 F .299
(anout | 16 |)-.1 F
(Balance between depth and width | | algorithm | shak)72 300 Q
(e256 | NIST appro)-.1 E -.15(ve)-.15 G 2.5(d||o).15 G
(utput-length | 32 | 256 bits |)-2.5 E(---)72 324 Q(Proofs)72 348 Q
(Inclusion Proof)72 372 Q(Pro)72 396 Q .3 -.15(ve a c)-.15 H
(hunk is part of an object without re).15 E -.15(ve)-.25 G
(aling other chunks:).15 E -.74(```)72 420 S(scheme \(inclusion-proof)
.74 E(\(merkle-root "shak)77 432 Q(e256:7f4a2b9c..."\))-.1 E
(\(chunk-inde)77 444 Q 2.5(x4)-.15 G(2\))-2.5 E(\(chunk-hash "shak)77
456 Q(e256:abc123..."\))-.1 E(\(path)77 468 Q(\(\(sibling "shak)82 480 Q
(e256:def456..." position left\))-.1 E(\(sibling "shak)84.5 492 Q
(e256:789abc..." position right\))-.1 E(\(sibling "shak)84.5 504 Q
(e256:012def..." position left\)\)\)\) `)-.1 E -.74(``)-.74 G -1.11(Ve)
72 528 S(ri\214er reconstructs path to root: `)1.11 E 1.48 -.74(`` c)
-.74 H(hunk_hash \342 combine with sibling \342 ... \342 must equal mer\
kle-root `).74 E -.74(``)-.74 G(Exclusion Proof)72 552 Q(Pro)72 576 Q .3
-.15(ve a c)-.15 H(hunk does NO).15 E 2.5(Te)-.4 G
(xist \(for sparse objects\):)-2.65 E -.74(```)72 600 S(scheme \(e).74 E
(xclusion-proof)-.15 E(\(merkle-root "shak)77 612 Q(e256:7f4a2b9c..."\))
-.1 E(\(chunk-inde)77 624 Q 2.5(x9)-.15 G(99\))-2.5 E
(\(boundary-left 998 "shak)77 636 Q(e256:left..."\))-.1 E
(\(boundary-right 1000 "shak)77 648 Q(e256:right..."\))-.1 E
(\(path ...\)\))77 660 Q -.74(```)5 G(---)72 684 Q(Streaming V)72 708 Q
(eri\214cation)-1.11 E(Lar)72 732 Q(ge objects can be v)-.18 E
(eri\214ed chunk-by-chunk as the)-.15 E 2.5(ys)-.15 G(tream:)-2.5 E -.74
(```)72 756 S(scheme \(de\214ne \(v).74 E
(erify-stream merkle-root chunk-size\))-.15 E("Return a v)77 768 Q
(eri\214er that checks chunks as the)-.15 E 2.5(ya)-.15 G(rri)-2.5 E
-.15(ve)-.25 G(").15 E(\(let \(\(recei)77 780 Q -.15(ve)-.25 G
(d-chunks '\(\)\)).15 E(\(v)92 792 Q(eri\214ed-nodes \(mak)-.15 E
(e-hash-table\)\)\))-.1 E 0 Cg EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(lambda \(chunk-inde)82 24 Q 2.5(xc)-.15 G
(hunk-data proof\))-2.5 E(;; V)87 36 Q(erify this chunk ag)-1.11 E
(ainst the proof)-.05 E(\(let \(\(chunk-hash \(shak)87 48 Q
(e256 chunk-data\)\)\))-.1 E(\(if \(v)92 60 Q
(erify-inclusion-proof merkle-root chunk-inde)-.15 E 2.5(xc)-.15 G
(hunk-hash proof\))-2.5 E(\(be)102 72 Q(gin)-.15 E(\(cache-v)107 84 Q
(eri\214ed-node! v)-.15 E(eri\214ed-nodes chunk-inde)-.15 E 2.5(xc)-.15
G(hunk-hash\))-2.5 E(#t\))107 96 Q(#f\)\)\)\)\) `)102 108 Q -.74(``)-.74
G -1.1(Yo)72 132 S 2.5(ud)1.1 G(on')-2.5 E 2.5(tn)-.18 G
(eed the whole object to start v)-2.5 E
(erifying. Each chunk carries its o)-.15 E(wn proof.)-.25 E(---)72 156 Q
(The F)72 180 Q(orest)-.15 E(The soup becomes a forest of Merkle trees:)
72 204 Q 1.996 -.74(``` \342)72 228 T .516<e2e2e2e2e2e2e2e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e220e2>.74 F .516(THE FOREST \(formerly)
50.516 F 48.91(soup\) \342)72 240 R 166.41<e2e2>3.91 G 13.91<e2f0>-162.5
G 3.91<b26f>-13.91 G 8.91<626a20f0b2>-3.91 F 16.41
<6f626a20e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2>3.91 F<f0b2>16.41 E
15.446(obj \342)72 252 R 25.446<e2f0>2.946 G 2.946<b26f>-25.446 G 25.446
<626a20e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e220f0b2>-2.946 F 2.946
(obj \342)2.946 F 10.446<e2f0>2.946 G 2.946<b26f>-10.446 G 22.946
<626a20f0b2>-2.946 F .446<6f626a20e2e2e2e2>2.946 F 2.945
<5245414c4d20e2e2e2e2e2e2>5.446 F<f0b2>10.445 E 20.343(obj \342)72 264 R
22.844<e2f0>2.843 G 2.844<b26f>-22.844 G 27.844<626a20e2e2e2e2>-2.844 F
.344<2869736c616e642920e2e2e2e2e2>2.844 F .344(\360\262 obj)22.844 F
-.344 2.844<e2e220f0>10.344 H 2.844<b26f>-2.844 G 15.344<626a20f0b2>
-2.844 F 10.344<6f626a20e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2>2.844 F
.344(\360\262 obj)5.344 F 11.698 3.302<e2e220f0>72 276 T 3.302<b26f>
-3.302 G 30.802<626a20e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2>-3.302 F
.802(\360\262 obj)18.302 F 156.697 3.302<e2e220e2>15.802 H 8.301<e245>
-.001 G .801(ach ob-)-8.301 F 44.122
(ject a tree. Each tree quantum-hardened.)72 288 R<e2>81.622 E<e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e22060>72 300 Q -.74
(``)-.74 G 1.021(Objects are trees. The wilderness of mirrors becomes a\
 forest. Agents na)72 324 R(vig)-.2 E 1.02
(ate between trees, climbing branches,)-.05 F -.15(ve)72 336 S
(rifying paths. The capability chain is still their thread - b).15 E
(ut no)-.2 E 2.5(wt)-.25 G(he mirrors are structured.)-2.5 E(---)72 360
Q(Migration)72 384 Q(Phase 1: Dual Hash \(No)72 408 Q 2.5(w\342Q)-.25 G
(-Day - 5 years\))-2.5 E(All ne)72 432 Q 2.5(wo)-.25 G
(bjects get both hashes. Old objects rehashed on access.)-2.5 E -.74
(```)72 456 S(scheme \(de\214ne \(store-object content\)).74 E
(\(let \(\(le)77 468 Q -.05(ga)-.15 G -.15(cy).05 G
(-hash \(sha512 content\)\)).15 E(\(merkle-root \(merkle-hash content ')
92 480 Q(shak)-.55 E(e256 4096 16\)\)\))-.1 E(\(v)82 492 Q(ault-store)
-.25 E(`\(object)87 504 Q(\(hash ,\(string-append "sha512:" le)92 516 Q
-.05(ga)-.15 G -.15(cy).05 G(-hash\)\)).15 E
(\(merkle-root ,\(string-append "shak)92 528 Q(e256:" merkle-root\)\))
-.1 E 2.5(...\)\)\)\) `)92 540 R -.74(``)-.74 G
(Phase 2: Merkle Primary \(Q-Day - 5 years \342 Q-Day\))72 564 Q
(Merkle root becomes the canonical address. SHA-512 k)72 588 Q
(ept for compatibility)-.1 E(.)-.65 E(Phase 3: Le)72 612 Q -.05(ga)-.15
G .3 -.15(cy S).05 H(unset \(Q-Day \342 Q-Day + 2 years\)).15 E
(SHA-512 hashes deprecated. Only Merkle roots used for addressing.)72
636 Q(Phase 4: Pure Quantum-Resistant \(Q-Day + 2 years \342\))72 660 Q
(SHA-512 hashes remo)72 684 Q -.15(ve)-.15 G 2.5(df).15 G(rom ne)-2.5 E
2.5(wo)-.25 G(bjects. Le)-2.5 E -.05(ga)-.15 G .3 -.15(cy o).05 H
(bjects retain both for historical v).15 E(eri\214cation.)-.15 E(---)72
708 Q(Performance)72 732 Q 2.785(|O)72 756 S .286(peration | SHA-512 \(\
\215at\) | SHAKE256 \(Merkle\) | Notes | |-----------|----------------|\
-------------------|-------| | Hash 1)-2.785 F .151
(MB | 2 ms | 3 ms | Slightly slo)72 768 R .151
(wer | | Hash 1 GB | 2000 ms | 2500 ms | T)-.25 F .15(ree o)-.35 F -.15
(ve)-.15 G .15(rhead | | Update 4 KB in 1 GB | 2000).15 F .491
(ms | 15 ms | Merkle wins | | Pro)72 780 R .791 -.15(ve i)-.15 H .491
(nclusion | N/A | 0.1 ms | Ne).15 F 2.992(wc)-.25 G .492
(apability | | Streaming v)-2.992 F .492(erify | N/A | Per)-.15 F .492
(-chunk |)-.2 F(Ne)72 792 Q 2.5(wc)-.25 G(apability |)-2.5 E 0 Cg EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(The o)72 24 Q -.15(ve)-.15 G
(rhead is small. The bene\214ts are lar).15 E(ge.)-.18 E(---)72 48 Q
(Security Considerations)72 72 Q(Gro)72 96 Q -.15(ve)-.15 G(r').15 E 2.5
(sA)-.55 G(lgorithm)-2.5 E(Gro)72 120 Q -.15(ve)-.15 G(r').15 E 4.419
(sa)-.55 G 1.919(lgorithm pro)-4.419 F 1.919(vides quadratic speedup fo\
r searching: - SHA-512: 2^256 \342 2^128 quantum operations -)-.15 F
(SHAKE256-256: 2^256 \342 2^128 quantum operations)72 132 Q
(128-bit quantum security is considered suf)72 156 Q
(\214cient for the foreseeable future.)-.25 E
(Second Preimage Resistance)72 180 Q .719(Finding another input that ha\
shes to the same tree requires: - Classical: 2^256 operations - Quantum\
: 2^128 opera-)72 204 R(tions \(Gro)72 216 Q -.15(ve)-.15 G(r\)).15 E
-.35(Tr)72 240 S(ee Structure Attacks).35 E 2.137
(The Merkle tree structure must pre)72 264 R -.15(ve)-.25 G 2.137
(nt: - **Length e).15 F 2.137
(xtension**: SHAKE256 immune \(sponge construction\) -)-.15 F(**Subtree\
 collision**: Domain separation in node hashing - **Malleability**: Can\
onical serialization required)72 276 Q(Implementation)72 300 Q -.74(```)
72 324 S(scheme ;; Domain separation for nodes vs lea).74 E -.15(ve)-.2
G 2.5(s\().15 G(de\214ne \(hash-leaf algorithm chunk\))-2.5 E
(\(hash algorithm \(byte)77 336 Q -.15(ve)-.25 G(ctor).15 E
(-append #u8\(0\) chunk\)\)\))-.2 E
(\(de\214ne \(hash-node algorithm children\))72 360 Q
(\(hash algorithm \(byte)77 372 Q -.15(ve)-.25 G(ctor).15 E
(-append #u8\(1\) \(apply byte)-.2 E -.15(ve)-.25 G(ctor).15 E
(-append children\)\)\)\) `)-.2 E -.74(``)-.74 G
(The `0x00` pre\214x for lea)72 396 Q -.15(ve)-.2 G 2.5(sa).15 G
(nd `0x01` for nodes pre)-2.5 E -.15(ve)-.25 G
(nts a leaf from being interpreted as a node.).15 E(---)72 420 Q(In)72
444 Q -.25(va)-.4 G(riants).25 E 1.48 -.74(``` M)72 468 T
(1. Object identity is Merkle root).74 E(id\(o\) = merkle-root\(shak)82
480 Q(e256, chunks\(o\)\))-.1 E(M2. An)72 504 Q 2.5(yc)-.15 G
(hunk is pro)-2.5 E -.25(va)-.15 G(ble).25 E
(chunk\(o,i\) \342 \342proof: v)82 516 Q
(erify\(root\(o\), i, chunk, proof\))-.15 E(M3. T)72 540 Q
(ree structure is canonical)-.35 E
(tree\(content, params\) is deterministic)82 552 Q
(M4. Dual hashes are consistent)72 576 Q
(sha512\(content\) \342 merkle-root\(content\) v)82 588 Q
(erify same content)-.15 E(M5. Migration preserv)72 612 Q(es identity)
-.15 E(old-objects retain v)82 624 Q(eri\214able le)-.15 E -.05(ga)-.15
G .3 -.15(cy h).05 H(ashes `).15 E -.74(``)-.74 G(---)72 648 Q
(References)72 672 Q 13.987(1. NIST FIPS 202 - SHA-3 Standard \(SHAKE25\
6\) 2. BLAKE3 speci\214cation -)72 696 R(https://github)72 708 Q .95(.c\
om/BLAKE3-team/BLAKE3 3. Merkle, R., "A Digital Signature Based on a Co\
n)-.4 F -.15(ve)-.4 G .95(ntional Encryp-).15 F .086
(tion Function", 1987 4. Gro)72 720 R -.15(ve)-.15 G .886 -.4(r, L).15 H
.086(., "A F).4 F .086
(ast Quantum Mechanical Algorithm for Database Search", 1996 5. RFC-040)
-.15 F 2.5(-C)72 732 S(yberspace Security Architecture)-2.5 E(---)72 756
Q(Changelog)72 780 Q 0 Cg EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 2.5(-2)72 12 S(026-01-08 - Initial draft)-2.5 E
0 Cg EP
%%Trailer
end
%%EOF
