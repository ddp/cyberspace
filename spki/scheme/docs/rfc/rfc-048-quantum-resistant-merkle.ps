%!PS-Adobe-3.0
%%Creator: groff version 1.23.0
%%CreationDate: Sun Jan 11 10:41:56 2026
%%DocumentNeededResources: font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%+ font Courier
%%DocumentSuppliedResources: procset grops 1.23 0
%%Pages: 6
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.23 0
%!PS-Adobe-3.0 Resource-ProcSet
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
% The ASCII code of the space character.
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
% name size font SF -
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
% name a c d font MF -
/MF{
findfont
[5 2 roll
0 3 1 roll % b
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
% Enable manual feed.
% MANUAL -
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
% Guess the page length.
% This assumes that the imageable area is vertically centered on the page.
% PLG - length
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
% BP -
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
% centerx centery radius startangle endangle DA -
/DA{
newpath arcn stroke
}bind def
% x y SN - x' y'
% round a position to nearest (pixel + (.25,.25))
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
% endx endy startx starty DL -
% we round the endpoints of the line, so that parallel horizontal
% and vertical lines will appear even
/DL{
SN
moveto
SN
lineto stroke
}bind def
% centerx centery radius DC -
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
%  width height centerx centery DE -
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
% these are for splines
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
% fill the last path
% r g b Fr -
/Fr{
setrgbcolor fill
}bind def
% c m y k Fk -
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
% g Fg -
/Fg{
setgray fill
}bind def
% fill with the "current color"
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
% new_font_name encoding_vector old_font_name RE -
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
% hpos vpos EBEGIN -
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
% llx lly newwid wid newht ht newllx newlly PBEGIN -
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
% set the graphics state to default values
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
%
%  Any included setpagedevice should be ignored.
%  See: http://www.w-beer.de/doc/ps/.
%
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%EndProlog
%%BeginSetup
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Times-Bold
%%IncludeResource: font Times-Italic
%%IncludeResource: font Times-Roman
%%IncludeResource: font Courier
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/Euro/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Courier@0 ENC0/Courier RE/Times-Roman@0 ENC0/Times-Roman RE
/Times-Italic@0 ENC0/Times-Italic RE/Times-Bold@0 ENC0/Times-Bold RE
%%EndSetup
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 12/Times-Bold@0 SF(RFC-048: Quantum-Resistant Merkle T)193.404 123 Q
-.216(re)-.888 G(es).216 E/F1 10/Times-Italic@0 SF(Libr)260.85 159 Q
(ary of Cyber)-.15 E(space)-.1 E/F2 10/Times-Roman@0 SF(2026)296 177 Q
F1(ABSTRA)282.535 213 Q(CT)-.3 E/F3 10/Times-Bold@0 SF 2.5(1. Abstract)
72 261 R F2 .244(SHA-512 w)72 276.6 R(on')-.1 E 2.744(ts)-.18 G(urvi)
-2.744 E -.15(ve)-.25 G 2.743(.G).15 G(ro)-2.743 E -.15(ve)-.15 G(r').15
E 2.743(sa)-.55 G .243(lgorithm halv)-2.743 F .243(es the ef)-.15 F
(fecti)-.25 E .543 -.15(ve s)-.25 H .243
(ecurity - 256 bits becomes 128. F).15 F .243(or the wilderness)-.15 F
.424(of mirrors to endure the quantum winter)72 288.6 R 2.924(,w)-.4 G
2.924(en)-2.924 G .425(eed quantum-resistant Merkle trees. This RFC spe\
ci\214es the transition)-2.924 F
(from \215at SHA-512 hashes to tree-structured SHAKE256 hashes.)72 300.6
Q F3 2.5(2. The)72 324.6 R(Pr)2.5 E(oblem)-.18 E F2(Current c)72 340.2 Q
(yberspace object identity:)-.15 E/F4 8/Courier@0 SF
(sha512\(content\) \342 64 bytes \342 object address)108 358.2 Q F2(Ag)
72 376.2 Q 1.114(ainst a quantum computer with Gro)-.05 F -.15(ve)-.15 G
(r').15 E 3.614(sa)-.55 G 1.114
(lgorithm: - Classical security: 256 bits - Quantum security: 128 bits)
-3.614 F(\(square root\))72 388.2 Q .195
(128 bits may be acceptable for some threat models, b)72 403.8 R .195
(ut c)-.2 F .195(yberspace is b)-.15 F .196
(uilt to last. The Library of Ale)-.2 F .196(xandria b)-.15 F(urned)-.2
E(once. W)72 415.8 Q 2.5(ew)-.8 G(on')-2.6 E 2.5(tl)-.18 G
(et quantum computers b)-2.5 E(urn it ag)-.2 E(ain.)-.05 E F3 2.5
(3. The)72 439.8 R(Solution: Merkle T)2.5 E -.18(re)-.74 G(es).18 E F2
(Instead of hashing content as a \215at blob, structure it as a tree:)72
455.4 Q F4<e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2>204 473.4 Q 14.4<e24d>
204 485.4 S(erkle Root)-14.4 E 9.6<e2e2>14.4 G(Object identity)-4.8 E
9.6<e273>204 497.4 S 4.8(hake256\(...\) \342)-9.6 F
<e2e2e2e2e2e2e2e2e2e2ace2e2e2e2e2e2e2e2e2>204 509.4 Q<e2>247.2 521.4 Q
<e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2bce2e2e2e2e2e2e2e2e2e2e2e2e2e2e2>175.2
533.4 Q 67.2<e2e2e2>175.2 545.4 S 14.4<e2e2e2e2e2e2bce2e2e2e2e220e2e2e2
e2e2e2bce2e2e2e2e220e2e2e2e2e2e2bce2e2e2e2e2>151.2 557.4 R 4.8<e24e>
151.2 569.4 S(ode 0)-4.8 E 19.2<e2e2>9.6 G(Node 1)-14.4 E 19.2<e2e2>9.6
G(Node 2)-14.4 E<e2>9.6 E 14.4<e2e2e2e2e2e2ace2e2e2e2e220e2e2e2e2e2e2ac
e2e2e2e2e220e2e2e2e2e2e2ace2e2e2e2e2>151.2 581.4 R 67.2<e2e2e2>175.2
593.4 S 4.8<e2e2e2e2e2e2e2b4e2e2e2e2e2e220e2e2e2e2e2e2e2b4e2e2e2e2e2e220
e2e2e2e2e2e2e2b4e2e2e2e2e2e2>146.4 605.4 R 52.8<e2e2>146.4 617.4 S 52.8
<e2e2>-43.2 G 52.8<e2e2>-43.2 G<e2e2e2e2e2bce2e2e2e220e2e2e2e2e2bce2e2e2
e220e2e2e2e2e2bce2e2e2e220e2e2e2e2e2bce2e2e2e220e2e2e2e2e2bce2e2e2e2202e
2e2e>127.2 629.4 Q(\342Chunk 0\342 \342Chunk 1\342 \342Chunk 2\342 \342\
Chunk 3\342 \342Chunk 4\342)127.2 641.4 Q 4.8(\3424K)127.2 653.4 S 9.6
<42e2>-4.8 G 4.8(\3424K)-4.8 G 9.6<42e2>-4.8 G 4.8(\3424K)-4.8 G 9.6
<42e2>-4.8 G 4.8(\3424K)-4.8 G 9.6<42e2>-4.8 G 4.8(\3424K)-4.8 G 9.6
<42e2>-4.8 G<e2e2e2e2e2e2e2e2e220e2e2e2e2e2e2e2e2e220e2e2e2e2e2e2e2e2e2
20e2e2e2e2e2e2e2e2e220e2e2e2e2e2e2e2e2e2>127.2 665.4 Q F2(Bene\214ts:)72
683.4 Q .08(1. Incremental updates - Change one chunk, rehash one branc\
h 2. Selecti)72 699 R .38 -.15(ve d)-.25 H .08(isclosure - Pro).15 F .38
-.15(ve a c)-.15 H .08(hunk e).15 F .08(xists without)-.15 F(re)72 711 Q
-.15(ve)-.25 G 1.047(aling siblings 3. Streaming v).15 F 1.047
(eri\214cation - V)-.15 F 1.047(erify chunks as the)-1.11 F 3.548(ya)
-.15 G(rri)-3.548 E 1.348 -.15(ve 4)-.25 H 3.548(.P).15 G 1.048
(arallelizable - Hash chunks concur)-3.698 F(-)-.2 E
(rently 5. Quantum-resistant - SHAKE256 at e)72 723 Q -.15(ve)-.25 G
(ry node).15 E 0 Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-048 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(4. Hash)72 84 R(Function: SHAKE256)2.5 E F0(SHAKE256 is an e)72 99.6
Q(xtendable-output function \(XOF\) from the SHA-3 \(K)-.15 E(eccak\) f)
-.25 E(amily.)-.1 E(Wh)72 115.2 Q 2.5(yS)-.05 G(HAKE256:)-2.5 E .147
(center box; l l l.)72 133.2 R 13.207(Property V)5.147 F .147
(alue Security le)-1.11 F -.15(ve)-.25 G 20.277(l2).15 G .146
(56-bit classical, 128-bit quantum Output length)-20.277 F -1.11(Va)
19.866 G(riable)1.11 E 1.015(\(we use 256 bits\) Construction)72 145.2 R
1.016(Sponge \(dif)24.346 F 1.016(ferent from SHA-2')-.25 F 3.516(sM)
-.55 G 1.016(erkle-Damg\303\245rd\) Standard)-3.516 F 1.016(NIST FIPS)
15.466 F(202 Used by)72 157.2 Q
(SPHINCS+ \(post-quantum signatures\) In libsodium)16.95 E(No, b)24.16 E
(ut in OpenSSL, libgcrypt)-.2 E(Alternati)72 175.2 Q -.15(ve)-.25 G 2.5
(:B).15 G(LAKE3)-2.5 E .147(center box; l l l.)72 193.2 R 13.207
(Property V)5.147 F .147(alue Security le)-1.11 F -.15(ve)-.25 G 20.277
(l2).15 G .146(56-bit classical, 128-bit quantum Output length)-20.277 F
-1.11(Va)19.866 G(riable)1.11 E 21.591(Construction Merkle)72 205.2 R
.461(tree internally Speed)2.961 F -1.11(Ve)26.021 G .461(ry f)1.11 F
.462(ast, SIMD optimized Standard)-.1 F .462(Not NIST)14.912 F 2.962(,b)
-.74 G .462(ut widely)-3.162 F(trusted)72 217.2 Q(BLAKE3 is f)72 235.2 Q
(aster and already tree-structured, b)-.1 E
(ut SHAKE256 has NIST blessing. W)-.2 E 2.5(es)-.8 G(upport both.)-2.5 E
F1 2.5(5. Object)72 259.2 R -.25(Fo)2.5 G(rmat).25 E 2.5(5.1. Curr)72
283.2 R(ent \(Legacy\))-.18 E/F2 8/Courier@0 SF(\(object)108 301.2 Q
(\(hash "sha512:3a7bd3e2c4f8..."\))117.6 313.2 Q(\(size 1048576\))117.6
325.2 Q(\(content ...\)\))117.6 337.2 Q F1 2.5(5.2. Quantum-Resistant)72
355.2 R F2(\(object)108 373.2 Q(\(merkle-root "shake256:7f4a2b9c..."\))
117.6 385.2 Q(\(hash-algorithm "shake256"\))117.6 397.2 Q 4.8(;o)48 G
4.8(r")-4.8 G(blake3")-4.8 E(\(tree-params)117.6 409.2 Q
(\(chunk-size 4096\))127.2 421.2 Q 4.8(;4K)86.4 G 4.8(Bc)-4.8 G(hunks)
-4.8 E(\(fanout 16\))127.2 433.2 Q 4.8(;C)115.2 G(hildren per node)-4.8
E(\(depth 4\)\))127.2 445.2 Q 4.8(;T)120 G(ree depth)-4.8 E
(\(size 1048576\))117.6 457.2 Q(\(content ...\)\))117.6 469.2 Q F1 2.5
(5.3. T)72 487.2 R(ransition P)-.74 E(eriod \(Dual Hash\))-.2 E F2
(\(object)108 505.2 Q(\(hash "sha512:3a7bd3e2c4f8..."\))117.6 517.2 Q
4.8(;L)52.8 G(egacy - for old clients)-4.8 E
(\(merkle-root "shake256:7f4a2b9c..."\))117.6 529.2 Q 4.8(;Q)28.8 G
(uantum-resistant)-4.8 E(\(hash-algorithm "shake256"\))117.6 541.2 Q
(\(tree-params)117.6 553.2 Q(\(chunk-size 4096\))127.2 565.2 Q
(\(fanout 16\))127.2 577.2 Q(\(depth 4\)\))127.2 589.2 Q
(\(size 1048576\))117.6 601.2 Q(\(content ...\)\))117.6 613.2 Q F0
(Old clients use hash. Ne)72 631.2 Q 2.5(wc)-.25 G
(lients use merkle-root. Both v)-2.5 E(erify the same content.)-.15 E F1
2.5(6. T)72 655.2 R -.18(re)-.74 G 2.5(eC).18 G(onstruction)-2.5 E 0 Cg
EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-048 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(6.1. Algorithm)72 84 R/F2 8/Courier@0 SF
(\(define \(merkle-hash content algorithm chunk-size fanout\))108 102 Q
("Build Merkle tree, return root hash")117.6 114 Q
(;; 1. Split content into chunks)117.6 138 Q
(\(let* \(\(chunks \(chunk-content content chunk-size\)\))117.6 150 Q
(;; 2. Hash each chunk \(leaves\))151.2 174 Q
(\(leaves \(map \(lambda \(chunk\))151.2 186 Q
(\(hash algorithm chunk\)\))223.2 198 Q(chunks\)\))213.6 210 Q
(;; 3. Build tree bottom-up)151.2 234 Q
(\(root \(build-tree leaves fanout algorithm\)\)\))151.2 246 Q(root\)\))
127.2 270 Q(\(define \(build-tree nodes fanout algorithm\))108 294 Q
("Combine nodes into parent nodes until one root remains")117.6 306 Q
(\(if \(<= \(length nodes\) 1\))117.6 318 Q(\(car nodes\))136.8 330 Q
(\(let \(\(parents \(map \(lambda \(group\))136.8 342 Q
(\(hash algorithm \(apply append group\)\)\))242.4 354 Q
(\(partition nodes fanout\)\)\)\))232.8 366 Q
(\(build-tree parents fanout algorithm\)\)\)\))146.4 378 Q F1 2.5
(6.2. Node)72 396 R(Hashing)2.5 E F0
(Each internal node hashes the concatenation of its children:)72 411.6 Q
F2(nodehash = shake256\(child0 || child1 || ... || childn\))108 429.6 Q
F0 -.15(Fo)72 447.6 S 2.5(rl).15 G(ea)-2.5 E -.15(ve)-.2 G(s:).15 E F2
(leafhash = shake256\(chunkdata\))108 465.6 Q F1 2.5(6.3. Canonical)72
483.6 R -.1(Pa)2.5 G(rameters).1 E 1.923(center box; l l l.)72 501.6 R
-.1(Pa)6.922 G 3.992(rameter Default).1 F 1.922(Notes chunk-size)20.262
F 4.422(4096 4)6.362 F 1.922(KB, \214lesystem-friendly fanout)4.422 F
(16)24.142 E(Balance between depth and width algorithm)84.5 513.6 Q
(shak)7.78 E 8.15(e256 NIST)-.1 F(appr)2.5 E -.1(ove)-.18 G 2.5(do).1 G
14.16(utput-length 32)-2.5 F(256 bits)15 E 2.5(7. Pr)72 531.6 R(oofs)
-.18 E 2.5(7.1. Inclusion)72 555.6 R(Pr)2.5 E(oof)-.18 E F0(Pro)72 571.2
Q .3 -.15(ve a c)-.15 H(hunk is part of an object without re).15 E -.15
(ve)-.25 G(aling other chunks:).15 E F2(\(inclusion-proof)108 589.2 Q
(\(merkle-root "shake256:7f4a2b9c..."\))117.6 601.2 Q
(\(chunk-index 42\))117.6 613.2 Q(\(chunk-hash "shake256:abc123..."\))
117.6 625.2 Q(\(path)117.6 637.2 Q
(\(\(sibling "shake256:def456..." position left\))127.2 649.2 Q
(\(sibling "shake256:789abc..." position right\))132 661.2 Q
(\(sibling "shake256:012def..." position left\)\)\)\))132 673.2 Q F0
-1.11(Ve)72 691.2 S(ri\214er reconstructs path to root:)1.11 E F2(chunk\
_hash \342 combine with sibling \342 ... \342 must equal merkle-root)108
709.2 Q 0 Cg EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-048 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(7.2. Exclusion)72 84 R(Pr)2.5 E(oof)-.18 E F0(Pro)72 99.6 Q .3 -.15
(ve a c)-.15 H(hunk does NO).15 E 2.5(Te)-.4 G
(xist \(for sparse objects\):)-2.65 E/F2 8/Courier@0 SF
(\(exclusion-proof)108 117.6 Q(\(merkle-root "shake256:7f4a2b9c..."\))
117.6 129.6 Q(\(chunk-index 999\))117.6 141.6 Q
(\(boundary-left 998 "shake256:left..."\))117.6 153.6 Q
(\(boundary-right 1000 "shake256:right..."\))117.6 165.6 Q
(\(path ...\)\))117.6 177.6 Q F1 2.5(8. Str)72 195.6 R(eaming V)-.18 E
(eri\214cation)-1 E F0(Lar)72 211.2 Q(ge objects can be v)-.18 E
(eri\214ed chunk-by-chunk as the)-.15 E 2.5(ys)-.15 G(tream:)-2.5 E F2
(\(define \(verify-stream merkle-root chunk-size\))108 229.2 Q
("Return a verifier that checks chunks as they arrive")117.6 241.2 Q
(\(let \(\(received-chunks '\(\)\))117.6 253.2 Q
(\(verified-nodes \(make-hash-table\)\)\))146.4 265.2 Q
(\(lambda \(chunk-index chunk-data proof\))127.2 289.2 Q
(;; Verify this chunk against the proof)136.8 301.2 Q
(\(let \(\(chunk-hash \(shake256 chunk-data\)\)\))136.8 313.2 Q(\(if \(\
verify-inclusion-proof merkle-root chunk-index chunk-hash proof\))146.4
325.2 Q(\(begin)165.6 337.2 Q
(\(cache-verified-node! verified-nodes chunk-index chunk-hash\))175.2
349.2 Q(#t\))175.2 361.2 Q(#f\)\)\)\)\))165.6 373.2 Q F0 -1.1(Yo)72
391.2 S 2.5(ud)1.1 G(on')-2.5 E 2.5(tn)-.18 G
(eed the whole object to start v)-2.5 E
(erifying. Each chunk carries its o)-.15 E(wn proof.)-.25 E F1 2.5
(9. The)72 415.2 R -.25(Fo)2.5 G -.18(re).25 G(st).18 E F0
(The soup becomes a forest of Merkle trees:)72 430.8 Q F2<e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2>108 448.8 Q 96<e254>108
460.8 S(HE FOREST \(formerly soup\))-96 E<e2>96 E 316.8<e2e2>108 472.8 S
24<e2f0>108 484.8 S 4.8<b26f>-24 G 14.4<626a20f0b2>-4.8 F 28.8
<6f626a20e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2>4.8 F(\360\262 obj)28.8
E<e2>33.6 E 48<e2f0>108 496.8 S 4.8<b26f>-48 G 48
<626a20e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e220f0b2>-4.8 F 4.8(obj \342)
4.8 F 19.2<e2f0>108 508.8 S 4.8<b26f>-19.2 G 43.2<626a20f0b2>-4.8 F
<6f626a20e2e2e2e2>4.8 E 4.8<5245414c4d20e2e2e2e2e2e2>9.6 F(\360\262 obj)
19.2 E<e2>43.2 E 43.2<e2f0>108 520.8 S 4.8<b26f>-43.2 G 52.8
<626a20e2e2e2e2>-4.8 F<2869736c616e642920e2e2e2e2e2>4.8 E(\360\262 obj)
43.2 E<e2>19.2 E 14.4<e2f0>108 532.8 S 4.8<b26f>-14.4 G 28.8<626a20f0b2>
-4.8 F 19.2<6f626a20e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2>4.8 F
(\360\262 obj)9.6 E<e2>52.8 E 38.4<e2f0>108 544.8 S 4.8<b26f>-38.4 G
57.6<626a20e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2>-4.8 F(\360\262 obj)
33.6 E<e2>28.8 E 316.8<e2e2>108 556.8 S 14.4<e245>108 568.8 S
(ach object a tree. Each tree quantum-hardened.)-14.4 E<e2>72 E<e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2
e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2e2>108 580.8 Q F0
1.021(Objects are trees. The wilderness of mirrors becomes a forest. Ag\
ents na)72 598.8 R(vig)-.2 E 1.021
(ate between trees, climbing branches,)-.05 F -.15(ve)72 610.8 S
(rifying paths. The capability chain is still their thread - b).15 E
(ut no)-.2 E 2.5(wt)-.25 G(he mirrors are structured.)-2.5 E F1 2.5
(10. Migration)72 634.8 R 2.5(10.1. Phase)72 658.8 R(1: Dual Hash \(No)
2.5 E 2.5(w\342Q)-.1 G(-Day - 5 y)-2.5 E(ears\))-.1 E 0 Cg EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-048 0)72 48 R(All ne)72 84 Q 2.5(wo)
-.25 G(bjects get both hashes. Old objects rehashed on access.)-2.5 E/F1
8/Courier@0 SF(\(define \(store-object content\))108 102 Q
(\(let \(\(legacy-hash \(sha512 content\)\))117.6 114 Q
(\(merkle-root \(merkle-hash content 'shake256 4096 16\)\)\))146.4 126 Q
(\(vault-store)127.2 138 Q(`\(object)136.8 150 Q
(\(hash ,\(string-append "sha512:" legacy-hash\)\))146.4 162 Q
(\(merkle-root ,\(string-append "shake256:" merkle-root\)\))146.4 174 Q
(...\)\)\)\))146.4 186 Q/F2 10/Times-Bold@0 SF 2.5(10.2. Phase)72 204 R
(2: Merkle Primary \(Q-Day - 5 y)2.5 E(ears \342 Q-Day\))-.1 E F0
(Merkle root becomes the canonical address. SHA-512 k)72 219.6 Q
(ept for compatibility.)-.1 E F2 2.5(10.3. Phase)72 243.6 R
(3: Legacy Sunset \(Q-Day \342 Q-Day + 2 y)2.5 E(ears\))-.1 E F0
(SHA-512 hashes deprecated. Only Merkle roots used for addressing.)72
259.2 Q F2 2.5(10.4. Phase)72 283.2 R(4: Pur)2.5 E 2.5(eQ)-.18 G
(uantum-Resistant \(Q-Day + 2 y)-2.5 E(ears \342\))-.1 E F0
(SHA-512 hashes remo)72 298.8 Q -.15(ve)-.15 G 2.5(df).15 G(rom ne)-2.5
E 2.5(wo)-.25 G(bjects. Le)-2.5 E -.05(ga)-.15 G .3 -.15(cy o).05 H
(bjects retain both for historical v).15 E(eri\214cation.)-.15 E F2 2.5
(11. P)72 322.8 R(erf)-.2 E(ormance)-.25 E 1.502(center box; l l l.)72
340.8 R 5.111(Operation SHA-512)6.501 F 12.061(\(\215at\) SHAKE256)4.001
F 8.731(\(Merkle\) Notes)4.001 F 1.501(Hash 1 MB)4.001 F 4.001(2m)28.161
G 6.781(s3)-4.001 G(ms)-2.78 E .586(Slightly slo)74.78 352.8 R .586
(wer Hash 1 GB)-.1 F .586(2000 ms)3.906 F .586(2500 ms)15.866 F -1.2
-.74(Tr e)15.866 H 3.086(eo).74 G -.1(ve)-3.186 G .587
(rhead Update 4 KB in 1 GB).1 F .587(2000 ms)9.737 F .587(15 ms)15.867 F
.36(Merkle wins Pr)94.78 364.8 R .56 -.1(ove i)-.18 H 7.4(nclusion N/A)
.1 F .36(0.1 ms)8.14 F .36(New capability Str)23.14 F .36(eaming v)-.18
F 1.21(erify N/A)-.1 F -.2(Pe)8.14 G -.37(r-).2 G 3.43(chunk New).37 F
(capability)72 376.8 Q F0(The o)72 394.8 Q -.15(ve)-.15 G
(rhead is small. The bene\214ts are lar).15 E(ge.)-.18 E F2 2.5
(12. Security)72 418.8 R(Considerations)2.5 E 2.5(12.1. Gr)72 442.8 R
-.1(ove)-.18 G(r').1 E 2.5(sA)-.37 G(lgorithm)-2.5 E F0(Gro)72 458.4 Q
-.15(ve)-.15 G(r').15 E 4.418(sa)-.55 G 1.918(lgorithm pro)-4.418 F
1.919(vides quadratic speedup for searching: - SHA-512: 2^256 \342 2^12\
8 quantum operations -)-.15 F
(SHAKE256-256: 2^256 \342 2^128 quantum operations)72 470.4 Q
(128-bit quantum security is considered suf)72 486 Q
(\214cient for the foreseeable future.)-.25 E F2 2.5(12.2. Second)72 510
R(Pr)2.5 E(eimage Resistance)-.18 E F0 .719(Finding another input that \
hashes to the same tree requires: - Classical: 2^256 operations - Quant\
um: 2^128 opera-)72 525.6 R(tions \(Gro)72 537.6 Q -.15(ve)-.15 G(r\))
.15 E F2 2.5(12.3. T)72 561.6 R -.18(re)-.74 G 2.5(eS).18 G(tructur)-2.5
E 2.5(eA)-.18 G(ttacks)-2.5 E F0 1.052
(The Merkle tree structure must pre)72 577.2 R -.15(ve)-.25 G 1.052
(nt: - Length e).15 F 1.052
(xtension: SHAKE256 immune \(sponge construction\) - Subtree)-.15 F(col\
lision: Domain separation in node hashing - Malleability: Canonical ser\
ialization required)72 589.2 Q F2 2.5(12.4. Implementation)72 613.2 R F1
(;; Domain separation for nodes vs leaves)108 631.2 Q
(\(define \(hash-leaf algorithm chunk\))108 643.2 Q
(\(hash algorithm \(bytevector-append #u8\(0\) chunk\)\)\))117.6 655.2 Q
(\(define \(hash-node algorithm children\))108 679.2 Q(\(hash algorithm\
 \(bytevector-append #u8\(1\) \(apply bytevector-append children\)\)\)\
\))117.6 691.2 Q F0(The 0x00 pre\214x for lea)72 709.2 Q -.15(ve)-.2 G
2.5(sa).15 G(nd 0x01 for nodes pre)-2.5 E -.15(ve)-.25 G
(nts a leaf from being interpreted as a node.).15 E 0 Cg EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-048 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(13. In)72 84 R -.1(va)-.4 G(riants).1 E/F2 8/Courier@0 SF
(M1. Object identity is Merkle root)108 102 Q
(id\(o\) = merkle-root\(shake256, chunks\(o\)\))127.2 114 Q
(M2. Any chunk is provable)108 138 Q
(chunk\(o,i\) \342 \342proof: verify\(root\(o\), i, chunk, proof\))127.2
150 Q(M3. Tree structure is canonical)108 174 Q
(tree\(content, params\) is deterministic)127.2 186 Q
(M4. Dual hashes are consistent)108 210 Q
(sha512\(content\) \342 merkle-root\(content\) verify same content)127.2
222 Q(M5. Migration preserves identity)108 246 Q
(old-objects retain verifiable legacy hashes)127.2 258 Q F1 2.5
(14. Refer)72 276 R(ences)-.18 E F0 13.987(1. NIST FIPS 202 - SHA-3 Sta\
ndard \(SHAKE256\) 2. BLAKE3 speci\214cation -)72 291.6 R .914(https://\
github.com/BLAKE3-team/BLAKE3 3. Merkle, R., "A Digital Signature Based\
 on a Con)72 303.6 R -.15(ve)-.4 G .914(ntional Encryp-).15 F .087
(tion Function", 1987 4. Gro)72 315.6 R -.15(ve)-.15 G .886 -.4(r, L).15
H .086(., "A F).4 F .086
(ast Quantum Mechanical Algorithm for Database Search", 1996 5. RFC-040)
-.15 F 2.5(-C)72 327.6 S(yberspace Security Architecture)-2.5 E F1 2.5
(15. Changelog)72 351.6 R F0 2.5(-2)72 367.2 S
(026-01-08 - Initial draft)-2.5 E 0 Cg EP
%%Trailer
end
%%EOF
