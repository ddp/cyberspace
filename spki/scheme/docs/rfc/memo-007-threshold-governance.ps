%!PS-Adobe-3.0
%%Title: memo-007-threshold-governance
%%Creator: Library of Cyberspace Memo Pipeline
%%Pages: (atend)
%%EndComments

/Courier findfont 10 scalefont setfont
/margin 72 def
/pagewidth 612 def
/pageheight 792 def
/leading 12 def
/topmargin pageheight margin sub def
/bottommargin margin def
/linewidth pagewidth margin 2 mul sub def
/ypos topmargin def
/pagenum 1 def

/newline {
  /ypos ypos leading sub def
  ypos bottommargin lt {
    showpage
    /pagenum pagenum 1 add def
    /ypos topmargin def
  } if
  margin ypos moveto
} def

margin topmargin moveto
(Memo 007: Threshold Signature Governance) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
() show newline
(------------------------------------------------------------------------) show newline
(ABSTRACT) show newline
(------------------------------------------------------------------------) show newline
() show newline
(This RFC specifies the threshold signature system for Cyberspace) show newline
(governance, enabling K-of-N multi-party authorization for critical) show newline
(operations. Democracy in code: no single point of failure, no rogue) show newline
(administrator.) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(MOTIVATION) show newline
(------------------------------------------------------------------------) show newline
() show newline
(Critical operations require collective authorization:) show newline
() show newline
(  * Release signing: Multiple maintainers must approve) show newline
(  * Deployment: Operations team quorum required) show newline
(  * Key ceremonies: Distributed trust for root keys) show newline
(  * Emergency response: Prevent unilateral action) show newline
() show newline
(Traditional approaches fail: - Shared passwords: Who has it? Who used) show newline
(it? - Sudo access: Root is root - Approval workflows: Soft controls,) show newline
(bypassable) show newline
() show newline
(Threshold signatures provide cryptographic enforcement:) show newline
() show newline
() show newline
(    "K valid signatures required. Not K-1. Not bypass. Mathematics.") show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(SPECIFICATION) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Tiered Signing Model) show newline
(--------------------) show newline
() show newline
() show newline
(    +-------------------------------------------------------------+) show newline
(    |                    SIGNING TIERS                            |) show newline
(    +-------------------------------------------------------------+) show newline
(    |  Development     1-of-1    Single developer can iterate    |) show newline
(    |  Staging         2-of-2    Peer review required             |) show newline
(    |  Production      3-of-5    Governance council quorum        |) show newline
(    |  Emergency       5-of-7    Full council for critical ops    |) show newline
(    +-------------------------------------------------------------+) show newline
() show newline
() show newline
(Script Signature Record) show newline
(-----------------------) show newline
() show newline
() show newline
(    \(define-record-type <script-signature>) show newline
(      \(make-script-signature signer signature timestamp\)) show newline
(      script-signature?) show newline
(      \(signer signature-signer\)        ; Ed25519 public key \(32 bytes\)) show newline
(      \(signature signature-value\)      ; Ed25519 signature \(64 bytes\)) show newline
(      \(timestamp signature-timestamp\)\) ; Unix epoch seconds) show newline
() show newline
() show newline
(Signing a Script) show newline
(----------------) show newline
() show newline
() show newline
(    \(define \(sign-script script-content private-key #!optional public-key\)) show newline
(      "Sign script content with a private key") show newline
(      ...\)) show newline
() show newline
(Process: 1. Convert content to blob if string 2. Derive public key from) show newline
(private \(if not provided\) 3. Sign content with Ed25519 4. Record) show newline
(timestamp 5. Return script-signature record) show newline
() show newline
() show newline
(Verifying Single Signature) show newline
(--------------------------) show newline
() show newline
() show newline
(    \(define \(verify-script script-content signature-record\)) show newline
(      "Verify a script signature") show newline
(      \(ed25519-verify \(signature-signer signature-record\)) show newline
(                      content-blob) show newline
(                      \(signature-value signature-record\)\)\)) show newline
() show newline
() show newline
(Threshold Verification) show newline
(----------------------) show newline
() show newline
() show newline
(    \(define \(verify-threshold-script script-content signature-records threshold\)) show newline
(      "Verify threshold signatures on a script) show newline
(       Returns: #t if at least K signatures are valid") show newline
(      \(let* \(\(valid-sigs \(filter \(lambda \(sig\)) show newline
(                                   \(verify-script script-content sig\)\)) show newline
(                                 signature-records\)\)) show newline
(             \(valid-count \(length valid-sigs\)\)\)) show newline
(        \(>= valid-count threshold\)\)\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(SIGNATURE FILE FORMAT) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(    ;; deploy.sig) show newline
(    \(\(signature "hex-signature" "hex-pubkey" 1767685100\)) show newline
(     \(signature "hex-signature" "hex-pubkey" 1767685200\)) show newline
(     \(signature "hex-signature" "hex-pubkey" 1767685300\)\)) show newline
() show newline
(Each entry contains: - Signature bytes \(hex-encoded\) - Signer public key) show newline
(\(hex-encoded\) - Timestamp \(Unix epoch\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(CLI INTERFACE) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(cyberspace verify) show newline
(-----------------) show newline
() show newline
() show newline
(    $ cyberspace verify deploy.scm deploy.sig \\) show newline
(        --threshold 3 \\) show newline
(        --keys alice.pub bob.pub carol.pub dave.pub eve.pub) show newline
(    === Cyberspace Script Verification ===) show newline
(    Script:     deploy.scm) show newline
(    Signatures: deploy.sig) show newline
(    Threshold:  3) show newline
(    Keys:       5 provided) show newline
(    Found 3 signature\(s\) in file) show newline
(      Signature 1: ✓ VALID \(signer: cbc9b260da65f6a7...\)) show newline
(      Signature 2: ✓ VALID \(signer: a5f8c9e3d2b1f0e4...\)) show newline
(      Signature 3: ✓ VALID \(signer: 7d3e8b2c1a0f5e4d...\)) show newline
(    ✓ SUCCESS: Script verified with 3-of-3 threshold) show newline
() show newline
() show newline
(cyberspace run) show newline
(--------------) show newline
() show newline
() show newline
(    $ cyberspace run deploy.scm deploy.sig \\) show newline
(        --threshold 3 \\) show newline
(        --keys alice.pub bob.pub carol.pub dave.pub eve.pub) show newline
(    === Cyberspace Script Verification ===) show newline
(    ...) show newline
(    ✓ SUCCESS: Script verified with 3-of-5 threshold) show newline
(    === Executing Script ===) show newline
(    \(seal-release "2.0.0") show newline
(      message: "Major release with new governance model") show newline
(      preserve: #t\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(GOVERNANCE SCENARIOS) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Production Deployment \(3-of-5\)) show newline
(------------------------------) show newline
() show newline
() show newline
(    ;; Governance Council: Alice, Bob, Carol, Dave, Eve) show newline
(    ;; Threshold: 3 signatures required) show newline
(    \(define deployment-script) show newline
(      "\(seal-release \\"2.0.0\\") show newline
(        message: \\"Major release\\") show newline
(        preserve: #t\)"\)) show newline
(    ;; Alice signs) show newline
(    \(define sig-alice) show newline
(      \(sign-script deployment-script alice-private alice-public\)\)) show newline
(    ;; Carol signs) show newline
(    \(define sig-carol) show newline
(      \(sign-script deployment-script carol-private carol-public\)\)) show newline
(    ;; Dave signs) show newline
(    \(define sig-dave) show newline
(      \(sign-script deployment-script dave-private dave-public\)\)) show newline
(    ;; Verify threshold) show newline
(    \(verify-threshold-script deployment-script) show newline
(                            \(list sig-alice sig-carol sig-dave\)) show newline
(                            3\)) show newline
(    ;; => #t) show newline
() show newline
() show newline
(Insufficient Signatures) show newline
(-----------------------) show newline
() show newline
() show newline
(    ;; Only 2 signatures) show newline
(    \(define insufficient-sigs) show newline
(      \(list sig-alice sig-carol\)\)) show newline
(    \(verify-threshold-script deployment-script insufficient-sigs 3\)) show newline
(    ;; => #f \(rejected: need 3, got 2\)) show newline
() show newline
() show newline
(Tampered Script Detection) show newline
(-------------------------) show newline
() show newline
() show newline
(    ;; Attacker modifies script) show newline
(    \(define tampered-script) show newline
(      "\(seal-release \\"2.0.0\\") show newline
(        message: \\"HACKED - deploying malware\\") show newline
(        preserve: #t\)"\)) show newline
(    \(verify-threshold-script tampered-script sufficient-sigs 3\)) show newline
(    ;; => #f \(signatures don't match modified content\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(MULTI-SIGNATURE VS SHAMIR) show newline
(------------------------------------------------------------------------) show newline
() show newline
(Two threshold approaches exist:) show newline
() show newline
() show newline
(Multi-Signature \(This RFC\)) show newline
(--------------------------) show newline
() show newline
() show newline
(    Each party: own keypair) show newline
(    Signing:    each signs independently) show newline
(    Verify:     count valid signatures ≥ K) show newline
(    Use case:   governance, approvals) show newline
() show newline
(Advantages: - Each party maintains own key - Clear audit trail \(who) show newline
(signed\) - Simple revocation \(by key\) - No key reconstruction) show newline
() show newline
() show newline
(Shamir Splitting \(RFC-008\)) show newline
(--------------------------) show newline
() show newline
() show newline
(    Single key: split into N shares) show newline
(    Signing:    K parties reconstruct, sign once) show newline
(    Verify:     single signature) show newline
(    Use case:   key backup, recovery) show newline
() show newline
(Advantages: - Single signature output - Key never fully assembled \(in) show newline
(advanced schemes\) - Smaller signature files) show newline
() show newline
(For governance, multi-signature is preferred: - Accountability \(which) show newline
(individuals approved\) - No reconstruction ceremony - Works) show newline
(asynchronously) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(SECURITY CONSIDERATIONS) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Threat Model) show newline
(------------) show newline
() show newline
(Protected against: - Single compromised key \(need K\) - Rogue) show newline
(administrator \(need quorum\) - Script tampering \(signatures fail\) -) show newline
(Replay of old scripts \(timestamps, context\)) show newline
() show newline
(Not protected against: - K compromised keys - All parties colluding -) show newline
(Side-channel on signing devices) show newline
() show newline
() show newline
(Key Management) show newline
(--------------) show newline
() show newline
(1. Generation: Secure random via libsodium 2. Storage: Hardware tokens) show newline
(preferred, encrypted files acceptable 3. Distribution: Out-of-band) show newline
(verification of public keys 4. Rotation: New ceremony, revoke old keys) show newline
() show newline
() show newline
(Threshold Selection) show newline
(-------------------) show newline
() show newline
() show newline
(  Scenario      Threshold   Rationale         ) show newline
(  Development   1-of-1      Fast iteration    ) show newline
(  Staging       2-of-2      Peer review       ) show newline
(  Production    3-of-5      Majority quorum   ) show newline
(  Root key      5-of-7      Supermajority     ) show newline
(  Emergency     N-of-N      Full consensus    ) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(AUDIT INTEGRATION) show newline
(------------------------------------------------------------------------) show newline
() show newline
(Every verified execution records:) show newline
() show newline
() show newline
(    \(audit-append) show newline
(      actor: \(threshold-verifier-list\)) show newline
(      action: \(list 'script-execute script-hash\)) show newline
(      motivation: "Production deployment authorized") show newline
(      context: \(list 'threshold 3 'signatures 3\)\)) show newline
() show newline
(Audit trail shows: - Which signers authorized - What script was executed) show newline
(- When authorization occurred - Threshold requirements met) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(IMPLEMENTATION NOTES) show newline
(------------------------------------------------------------------------) show newline
() show newline
() show newline
(Dependencies) show newline
(------------) show newline
() show newline
(  * crypto-ffi) show newline
(  * Ed25519 operations - cert) show newline
(  * SPKI integration - audit) show newline
(  * Trail recording) show newline
() show newline
() show newline
(Performance) show newline
(-----------) show newline
() show newline
(  * Signature verification: ~10μs per Ed25519 verify) show newline
(  * Threshold check: O\(N\) where N = signature count) show newline
(  * No network round-trips \(offline verification\)) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(REFERENCES) show newline
(------------------------------------------------------------------------) show newline
() show newline
(1. Boneh, D., et al. \(2001\). Short Signatures from the Weil Pairing. 2.) show newline
(Gennaro, R., et al. \(2016\). Threshold-optimal DSA/ECDSA signatures. 3.) show newline
(NIST SP 800-57. Recommendation for Key Management. 4. RFC-004: SPKI) show newline
(Authorization Integration) show newline
() show newline
() show newline
(------------------------------------------------------------------------) show newline
(CHANGELOG) show newline
(------------------------------------------------------------------------) show newline
() show newline
(  * 2026-01-06) show newline
(  * Initial specification) show newline
() show newline
(------------------------------------------------------------------------) show newline

showpage
%%Trailer
%%Pages: pagenum
%%EOF
