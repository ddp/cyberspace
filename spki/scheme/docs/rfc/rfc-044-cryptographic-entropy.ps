%!PS-Adobe-3.0
%%BoundingBox: 24 24 571 818
%%Title: Enscript Output
%%For: Derrell Piper
%%Creator: GNU Enscript 1.6.6
%%CreationDate: Fri Jan  9 12:12:50 2026
%%Orientation: Portrait
%%Pages: (atend)
%%DocumentMedia: A4 595 842 0 () ()
%%DocumentNeededResources: (atend)
%%EndComments
%%BeginProlog
%%BeginResource: procset Enscript-Prolog 1.6 6
%
% Procedures.
%

/_S {	% save current state
  /_s save def
} def
/_R {	% restore from saved state
  _s restore
} def

/S {	% showpage protecting gstate
  gsave
  showpage
  grestore
} bind def

/MF {	% fontname newfontname -> -	make a new encoded font
  /newfontname exch def
  /fontname exch def

  /fontdict fontname findfont def
  /newfont fontdict maxlength dict def

  fontdict {
    exch
    dup /FID eq {
      % skip FID pair
      pop pop
    } {
      % copy to the new font dictionary
      exch newfont 3 1 roll put
    } ifelse
  } forall

  newfont /FontName newfontname put

  % insert only valid encoding vectors
  encoding_vector length 256 eq {
    newfont /Encoding encoding_vector put
  } if

  newfontname newfont definefont pop
} def

/MF_PS { % fontname newfontname -> -	make a new font preserving its enc
  /newfontname exch def
  /fontname exch def

  /fontdict fontname findfont def
  /newfont fontdict maxlength dict def

  fontdict {
    exch
    dup /FID eq {
      % skip FID pair
      pop pop
    } {
      % copy to the new font dictionary
      exch newfont 3 1 roll put
    } ifelse
  } forall

  newfont /FontName newfontname put

  newfontname newfont definefont pop
} def

/SF { % fontname width height -> -	set a new font
  /height exch def
  /width exch def

  findfont
  [width 0 0 height 0 0] makefont setfont
} def

/SUF { % fontname width height -> -	set a new user font
  /height exch def
  /width exch def

  /F-gs-user-font MF
  /F-gs-user-font width height SF
} def

/SUF_PS { % fontname width height -> -	set a new user font preserving its enc
  /height exch def
  /width exch def

  /F-gs-user-font MF_PS
  /F-gs-user-font width height SF
} def

/M {moveto} bind def
/s {show} bind def

/Box {	% x y w h -> -			define box path
  /d_h exch def /d_w exch def /d_y exch def /d_x exch def
  d_x d_y  moveto
  d_w 0 rlineto
  0 d_h rlineto
  d_w neg 0 rlineto
  closepath
} def

/bgs {	% x y height blskip gray str -> -	show string with bg color
  /str exch def
  /gray exch def
  /blskip exch def
  /height exch def
  /y exch def
  /x exch def

  gsave
    x y blskip sub str stringwidth pop height Box
    gray setgray
    fill
  grestore
  x y M str s
} def

/bgcs { % x y height blskip red green blue str -> -  show string with bg color
  /str exch def
  /blue exch def
  /green exch def
  /red exch def
  /blskip exch def
  /height exch def
  /y exch def
  /x exch def

  gsave
    x y blskip sub str stringwidth pop height Box
    red green blue setrgbcolor
    fill
  grestore
  x y M str s
} def

% Highlight bars.
/highlight_bars {	% nlines lineheight output_y_margin gray -> -
  gsave
    setgray
    /ymarg exch def
    /lineheight exch def
    /nlines exch def

    % This 2 is just a magic number to sync highlight lines to text.
    0 d_header_y ymarg sub 2 sub translate

    /cw d_output_w cols div def
    /nrows d_output_h ymarg 2 mul sub lineheight div cvi def

    % for each column
    0 1 cols 1 sub {
      cw mul /xp exch def

      % for each rows
      0 1 nrows 1 sub {
        /rn exch def
        rn lineheight mul neg /yp exch def
        rn nlines idiv 2 mod 0 eq {
	  % Draw highlight bar.  4 is just a magic indentation.
	  xp 4 add yp cw 8 sub lineheight neg Box fill
	} if
      } for
    } for

  grestore
} def

% Line highlight bar.
/line_highlight {	% x y width height gray -> -
  gsave
    /gray exch def
    Box gray setgray fill
  grestore
} def

% Column separator lines.
/column_lines {
  gsave
    .1 setlinewidth
    0 d_footer_h translate
    /cw d_output_w cols div def
    1 1 cols 1 sub {
      cw mul 0 moveto
      0 d_output_h rlineto stroke
    } for
  grestore
} def

% Column borders.
/column_borders {
  gsave
    .1 setlinewidth
    0 d_footer_h moveto
    0 d_output_h rlineto
    d_output_w 0 rlineto
    0 d_output_h neg rlineto
    closepath stroke
  grestore
} def

% Do the actual underlay drawing
/draw_underlay {
  ul_style 0 eq {
    ul_str true charpath stroke
  } {
    ul_str show
  } ifelse
} def

% Underlay
/underlay {	% - -> -
  gsave
    0 d_page_h translate
    d_page_h neg d_page_w atan rotate

    ul_gray setgray
    ul_font setfont
    /dw d_page_h dup mul d_page_w dup mul add sqrt def
    ul_str stringwidth pop dw exch sub 2 div ul_h_ptsize -2 div moveto
    draw_underlay
  grestore
} def

/user_underlay {	% - -> -
  gsave
    ul_x ul_y translate
    ul_angle rotate
    ul_gray setgray
    ul_font setfont
    0 0 ul_h_ptsize 2 div sub moveto
    draw_underlay
  grestore
} def

% Page prefeed
/page_prefeed {		% bool -> -
  statusdict /prefeed known {
    statusdict exch /prefeed exch put
  } {
    pop
  } ifelse
} def

% Wrapped line markers
/wrapped_line_mark {	% x y charwith charheight type -> -
  /type exch def
  /h exch def
  /w exch def
  /y exch def
  /x exch def

  type 2 eq {
    % Black boxes (like TeX does)
    gsave
      0 setlinewidth
      x w 4 div add y M
      0 h rlineto w 2 div 0 rlineto 0 h neg rlineto
      closepath fill
    grestore
  } {
    type 3 eq {
      % Small arrows
      gsave
        .2 setlinewidth
        x w 2 div add y h 2 div add M
        w 4 div 0 rlineto
        x w 4 div add y lineto stroke

        x w 4 div add w 8 div add y h 4 div add M
        x w 4 div add y lineto
	w 4 div h 8 div rlineto stroke
      grestore
    } {
      % do nothing
    } ifelse
  } ifelse
} def

% EPSF import.

/BeginEPSF {
  /b4_Inc_state save def    		% Save state for cleanup
  /dict_count countdictstack def	% Count objects on dict stack
  /op_count count 1 sub def		% Count objects on operand stack
  userdict begin
  /showpage { } def
  0 setgray 0 setlinecap
  1 setlinewidth 0 setlinejoin
  10 setmiterlimit [ ] 0 setdash newpath
  /languagelevel where {
    pop languagelevel
    1 ne {
      false setstrokeadjust false setoverprint
    } if
  } if
} bind def

/EndEPSF {
  count op_count sub { pos } repeat	% Clean up stacks
  countdictstack dict_count sub { end } repeat
  b4_Inc_state restore
} bind def

% Check PostScript language level.
/languagelevel where {
  pop /gs_languagelevel languagelevel def
} {
  /gs_languagelevel 1 def
} ifelse
%%EndResource
%%BeginResource: procset Enscript-Encoding-88591 1.6 6
/encoding_vector [
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/space        	/exclam       	/quotedbl     	/numbersign   	
/dollar       	/percent      	/ampersand    	/quoteright   	
/parenleft    	/parenright   	/asterisk     	/plus         	
/comma        	/hyphen       	/period       	/slash        	
/zero         	/one          	/two          	/three        	
/four         	/five         	/six          	/seven        	
/eight        	/nine         	/colon        	/semicolon    	
/less         	/equal        	/greater      	/question     	
/at           	/A            	/B            	/C            	
/D            	/E            	/F            	/G            	
/H            	/I            	/J            	/K            	
/L            	/M            	/N            	/O            	
/P            	/Q            	/R            	/S            	
/T            	/U            	/V            	/W            	
/X            	/Y            	/Z            	/bracketleft  	
/backslash    	/bracketright 	/asciicircum  	/underscore   	
/quoteleft    	/a            	/b            	/c            	
/d            	/e            	/f            	/g            	
/h            	/i            	/j            	/k            	
/l            	/m            	/n            	/o            	
/p            	/q            	/r            	/s            	
/t            	/u            	/v            	/w            	
/x            	/y            	/z            	/braceleft    	
/bar          	/braceright   	/tilde        	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/space        	/exclamdown   	/cent         	/sterling     	
/currency     	/yen          	/brokenbar    	/section      	
/dieresis     	/copyright    	/ordfeminine  	/guillemotleft	
/logicalnot   	/hyphen       	/registered   	/macron       	
/degree       	/plusminus    	/twosuperior  	/threesuperior	
/acute        	/mu           	/paragraph    	/bullet       	
/cedilla      	/onesuperior  	/ordmasculine 	/guillemotright	
/onequarter   	/onehalf      	/threequarters	/questiondown 	
/Agrave       	/Aacute       	/Acircumflex  	/Atilde       	
/Adieresis    	/Aring        	/AE           	/Ccedilla     	
/Egrave       	/Eacute       	/Ecircumflex  	/Edieresis    	
/Igrave       	/Iacute       	/Icircumflex  	/Idieresis    	
/Eth          	/Ntilde       	/Ograve       	/Oacute       	
/Ocircumflex  	/Otilde       	/Odieresis    	/multiply     	
/Oslash       	/Ugrave       	/Uacute       	/Ucircumflex  	
/Udieresis    	/Yacute       	/Thorn        	/germandbls   	
/agrave       	/aacute       	/acircumflex  	/atilde       	
/adieresis    	/aring        	/ae           	/ccedilla     	
/egrave       	/eacute       	/ecircumflex  	/edieresis    	
/igrave       	/iacute       	/icircumflex  	/idieresis    	
/eth          	/ntilde       	/ograve       	/oacute       	
/ocircumflex  	/otilde       	/odieresis    	/divide       	
/oslash       	/ugrave       	/uacute       	/ucircumflex  	
/udieresis    	/yacute       	/thorn        	/ydieresis    	
] def
%%EndResource
%%EndProlog
%%BeginSetup
%%IncludeResource: font Courier-Bold
%%IncludeResource: font Courier
/HFpt_w 10 def
/HFpt_h 10 def
/Courier-Bold /HF-gs-font MF
/HF /HF-gs-font findfont [HFpt_w 0 0 HFpt_h 0 0] makefont def
/Courier /F-gs-font MF
/F-gs-font 10 10 SF
/#copies 1 def
% Pagedevice definitions:
gs_languagelevel 1 gt {
  <<
    /PageSize [595 842] 
  >> setpagedevice
} if
/d_page_w 547 def
/d_page_h 794 def
/d_header_x 0 def
/d_header_y 794 def
/d_header_w 547 def
/d_header_h 0 def
/d_footer_x 0 def
/d_footer_y 0 def
/d_footer_w 547 def
/d_footer_h 0 def
/d_output_w 547 def
/d_output_h 794 def
/cols 1 def
%%EndSetup
%%Page: (1) 1
%%BeginPageSetup
_S
24 24 translate
/pagenum 1 def
/fname (rfc-044-cryptographic-entropy.txt) def
/fdir (.) def
/ftail (rfc-044-cryptographic-entropy.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 781 M
(RFC-044: Cryptographic Entropy Sources) s
5 759 M
(Status: Draft) s
5 748 M
(Created: 2026-01-08) s
5 737 M
(Author: ddp@eludom.net) s
5 715 M
(Abstract) s
5 693 M
(All cryptographic operations in Cyberspace require high-quality entropy. This RFC specifi) s
5 682 M
(es the canonical entropy sources for each platform, ensuring consistent, auditable, and s) s
5 671 M
(ecure randomness across the entire system.) s
5 649 M
(Motivation) s
5 627 M
(The Fundamental Requirement) s
5 605 M
(All cryptography requires true quantum randomness. The math doesn't work otherwise.) s
5 583 M
(Cryptographic proofs assume a source of bits that are:) s
5 572 M
(1. Statistically uniform - Each bit equally likely 0 or 1) s
5 561 M
(2. Independent - No correlations between bits) s
5 550 M
(3. Unpredictable in principle - Not just hard to predict, but impossible) s
5 528 M
(Only quantum mechanical processes satisfy condition 3. Classical chaotic systems \(lava la) s
5 517 M
(mps, thermal noise, ring oscillators\) are deterministic - an adversary with sufficient kn) s
5 506 M
(owledge of initial conditions could, in theory, predict their output. Quantum processes h) s
5 495 M
(ave no "initial conditions" to know - the randomness is fundamental to physics itself.) s
5 473 M
(Why this matters:) s
5 462 M
(- Security proofs assume perfect randomness) s
5 451 M
(- Key security = min\(algorithmbits, entropybits\)) s
5 440 M
(- A 256-bit key from a 32-bit PRNG seed provides only 32 bits of security) s
5 429 M
(- Nation-state adversaries may have capabilities to model classical entropy sources) s
5 407 M
(Cryptographic Operations Requiring Entropy) s
5 385 M
(- Key generation \(Ed25519, X25519\)) s
5 374 M
(- Nonce generation \(XSalsa20-Poly1305\)) s
5 363 M
(- Salt generation \(Argon2id\)) s
5 352 M
(- Shamir secret sharing) s
5 341 M
(- Challenge-response protocols) s
5 330 M
(- Zero-knowledge proofs) s
5 308 M
(Weak or predictable entropy destroys security completely. A realm's sovereignty depends o) s
5 297 M
(n unpredictable secrets.) s
5 275 M
(Specification) s
5 253 M
(Canonical Source: libsodium) s
5 231 M
(All Cyberspace implementations MUST use libsodium's randombytes_buf\(\) as the primary entr) s
5 220 M
(opy source:) s
5 198 M
(randombytes_buf\(buffer, size\)) s
5 176 M
(libsodium automatically selects the best available source:) s
5 165 M
(- Linux: getrandom\(2\) syscall, falls back to /dev/urandom) s
5 154 M
(- macOS/iOS: arc4random_buf\(\)) s
5 143 M
(- Windows: RtlGenRandom\(\)) s
5 132 M
(- OpenBSD: arc4random_buf\(\) \(ChaCha20-based\)) s
5 110 M
(Why libsodium?) s
5 88 M
(1. Cross-platform consistency - Same API everywhere) s
5 77 M
(2. Automatic best-source selection - No platform-specific code) s
5 66 M
(3. Initialization safety - Blocks until entropy available) s
5 55 M
(4. Fork safety - Handles process forking correctly) s
5 44 M
(5. Audited implementation - Widely reviewed cryptographic library) s
5 22 M
(Platform Requirements) s
_R
S
%%Page: (2) 2
%%BeginPageSetup
_S
24 24 translate
/pagenum 2 def
/fname (rfc-044-cryptographic-entropy.txt) def
/fdir (.) def
/ftail (rfc-044-cryptographic-entropy.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 781 M
(Scheme \(CHICKEN\)) s
5 759 M
(;; crypto-ffi.scm provides:) s
5 748 M
(\(define \(random-bytes n\)) s
5 737 M
(  "Generate n cryptographically secure random bytes") s
5 726 M
(  \(let \(\(buf \(make-blob n\)\)\)) s
5 715 M
(    \(\(foreign-lambda void "randombytes_buf" scheme-pointer unsigned-integer\)) s
5 704 M
(     buf n\)) s
5 693 M
(    buf\)\)) s
5 671 M
(All Scheme code MUST use random-bytes from crypto-ffi. NEVER use:) s
5 660 M
(- \(chicken random\) - Uses PRNG, not cryptographically secure) s
5 649 M
(- /dev/random directly - Platform-specific, may block) s
5 638 M
(- Custom PRNGs - Unaudited, likely insecure) s
5 616 M
(OCaml) s
5 594 M
(Status: Open Issue) s
5 572 M
(OCaml implementations should use one of:) s
5 561 M
(- mirage-crypto-rng with Nocrypto.Rng.generate) s
5 550 M
(- Direct FFI to libsodium via ctypes) s
5 528 M
(Decision pending based on:) s
5 517 M
(- Multicore OCaml compatibility) s
5 506 M
(- Domain-local PRNG state handling) s
5 495 M
(- Build system integration \(dune vs opam\)) s
5 473 M
(Entropy Initialization) s
5 451 M
(Before ANY cryptographic operation, ensure libsodium is initialized:) s
5 429 M
(\(define \(sodium-init\)) s
5 418 M
(  \(let \(\(result \(\(foreign-lambda int "sodium_init"\)\)\)\)) s
5 407 M
(    \(when \(= result -1\)) s
5 396 M
(      \(error "sodium_init failed - entropy source unavailable"\)\)\)\)) s
5 374 M
(sodium_init\(\) is idempotent and thread-safe. Call it early in program startup.) s
5 352 M
(Key Generation) s
5 330 M
(All key generation MUST use libsodium's key generation functions, which internally use ra) s
5 319 M
(ndombytes_buf\(\):) s
5 297 M
(| Operation | Function |) s
5 286 M
(|-----------|----------|) s
5 275 M
(| Ed25519 signing key | cryptosignkeypair\(\) |) s
5 264 M
(| X25519 key exchange | cryptoboxkeypair\(\) |) s
5 253 M
(| Symmetric key | cryptosecretboxkeygen\(\) |) s
5 242 M
(| Generic random | randombytes_buf\(\) |) s
5 220 M
(Nonce Generation) s
5 198 M
(Nonces MUST be generated fresh for each encryption:) s
5 176 M
(\(define \(generate-nonce\)) s
5 165 M
(  \(random-bytes \(secretbox-noncebytes\)\)\)  ;; 24 bytes) s
5 143 M
(For XSalsa20-Poly1305 with 24-byte nonces, random nonces are safe:) s
5 132 M
(- 2^192 possible nonces) s
5 121 M
(- Birthday collision after ~2^96 messages) s
5 110 M
(- Practical limit: ~2^64 messages per key \(still astronomical\)) s
5 88 M
(Salt Generation) s
5 66 M
(For Argon2id key derivation:) s
5 44 M
(\(define \(generate-salt\)) s
5 33 M
(  \(random-bytes 16\)\)  ;; cryptopwhashSALTBYTES) s
5 11 M
(Salts prevent rainbow table attacks. Each salt MUST be unique per derived key.) s
_R
S
%%Page: (3) 3
%%BeginPageSetup
_S
24 24 translate
/pagenum 3 def
/fname (rfc-044-cryptographic-entropy.txt) def
/fdir (.) def
/ftail (rfc-044-cryptographic-entropy.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 770 M
(Deep Dive: Entropy Sources) s
5 748 M
(Randomness is the foundation of all cryptography. This section explores the physics and e) s
5 737 M
(ngineering of true randomness.) s
5 715 M
(The Entropy Hierarchy) s
5 693 M
(+-------------------------------------------------------------+) s
5 682 M
(|                    Entropy Quality Pyramid                   |) s
5 671 M
(+-------------------------------------------------------------+) s
5 660 M
(|                                                              |) s
5 649 M
(|                    +---------------+                         |) s
5 638 M
(|           \342\\230\\205\342\\230\\205\342\\230\\205     |  Quantum RNG  |  \342\\206\\220 TRUE RANDOMNESS ) s
5 627 M
(     |) s
5 616 M
(|                    +---------------+    \(required for        |) s
5 605 M
(|                         ^                cryptographic       |) s
5 594 M
(|                         |                security\)           |) s
5 583 M
(|                    -----+-----                               |) s
5 572 M
(|                    SECURITY BOUNDARY                         |) s
5 561 M
(|                    ---------------                           |) s
5 550 M
(|                         |                                    |) s
5 539 M
(|                         v                                    |) s
5 528 M
(|                  +-------------------+                       |) s
5 517 M
(|                  |  Hardware TRNG    |  \342\\206\\220 Best effort       |) s
5 506 M
(|                  +-------------------+    \(should feed       |) s
5 495 M
(|                +-----------------------+   quantum source\)   |) s
5 484 M
(|                |  Environmental/Analog |                     |) s
5 473 M
(|                +-----------------------+                     |) s
5 462 M
(|              +---------------------------+                   |) s
5 451 M
(|              |  Public Beacons \(NIST\)    |  \342\\206\\220 Verifiable     |) s
5 440 M
(|              +---------------------------+                   |) s
5 429 M
(|            +-------------------------------+                 |) s
5 418 M
(|            |  OS Entropy Pool              |  \342\\206\\220 Mixed        |) s
5 407 M
(|            +-------------------------------+                 |) s
5 396 M
(|          +-----------------------------------+               |) s
5 385 M
(|          |  CSPRNG \(seeded from above\)       |  \342\\206\\220 Expansion  |) s
5 374 M
(|          +-----------------------------------+               |) s
5 363 M
(|                                                              |) s
5 352 M
(+-------------------------------------------------------------+) s
5 330 M
(   \342\\230\\205\342\\230\\205\342\\230\\205 = Cryptographic operations MUST ultimately trace to quantu) s
5 319 M
(m sources) s
5 297 M
(Critical distinction: Everything below the security boundary is computationally secure \(h) s
5 286 M
(ard to predict\), not information-theoretically secure \(impossible to predict\). For operat) s
5 275 M
(ions like key generation that must withstand future advances in computation and modeling,) s
5 264 M
( only quantum sources provide provable security.) s
5 242 M
(Practical Access to Quantum Randomness) s
5 220 M
(The ideal: Every cryptographic operation sources entropy from a local quantum RNG.) s
5 198 M
(Current reality: Most systems rely on:) s
5 187 M
(1. Hardware RNG \(thermal noise, ring oscillators\) - classical, but unpredictable at human) s
5 176 M
( scales) s
5 165 M
(2. OS mixing of multiple sources - defense in depth) s
5 154 M
(3. NIST beacon - quantum-sourced, publicly verifiable, but network-dependent) s
5 132 M
(Path forward for Cyberspace:) s
5 121 M
(- Phase 1 \(Now\): libsodium with OS entropy \(relies on hardware quality\)) s
5 110 M
(- Phase 2: Optional quantum RNG hardware support \(USB devices, PCIe cards\)) s
5 99 M
(- Phase 3: Attestation of entropy source in realm metadata) s
5 88 M
(- Phase 4: Quantum RNG as standard infrastructure \(as quantum internet develops\)) s
5 66 M
(Minimum acceptable: Modern Intel/AMD RDSEED instruction, which samples thermal noise at t) s
5 55 M
(he silicon level. While not provably quantum, it has no known exploits and is mixed with ) s
5 44 M
(other sources.) s
5 22 M
(Goal: True quantum randomness as the foundation. The math requires it; the engineering wi) s
5 11 M
(ll catch up.) s
_R
S
%%Page: (4) 4
%%BeginPageSetup
_S
24 24 translate
/pagenum 4 def
/fname (rfc-044-cryptographic-entropy.txt) def
/fdir (.) def
/ftail (rfc-044-cryptographic-entropy.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 770 M
(Cyberspace as Entropy Provider) s
5 748 M
(We will provide all the randomness that our users need - on demand, for whatever their cr) s
5 737 M
(yptographic desires.) s
5 715 M
(Cyberspace realms can serve as entropy sources for their users:) s
5 693 M
(;; Request entropy from the realm) s
5 682 M
(\(realm-entropy-request) s
5 671 M
(  \(bytes 32\)) s
5 660 M
(  \(purpose "key-generation"\)) s
5 649 M
(  \(attestation-required #t\)\)) s
5 627 M
(;; Response includes attestation of entropy source) s
5 616 M
(\(realm-entropy-response) s
5 605 M
(  \(value #${...32 bytes...}\)) s
5 594 M
(  \(source "quantum-rng"\)) s
5 583 M
(  \(attestation \(signed-by realm-principal\)) s
5 572 M
(               \(hardware "ID-Quantique-QUANTIS"\)) s
5 561 M
(               \(timestamp 1736344800\)\)\)) s
5 539 M
(Entropy services:) s
5 528 M
(1. Local generation - Realm uses its best available source) s
5 517 M
(2. Federated entropy - Request quantum entropy from realms with quantum hardware) s
5 506 M
(3. Beacon aggregation - Mix NIST + drand + realm sources) s
5 495 M
(4. Attestation chain - Prove the entropy source for audit) s
5 473 M
(Long-term vision: A network of realms with quantum RNG hardware providing verifiable, qua) s
5 462 M
(ntum-sourced entropy to all participants. The soup carries randomness as naturally as it ) s
5 451 M
(carries data.) s
5 429 M
(True Random Number Generators \(TRNG\)) s
5 407 M
(True randomness comes from physical processes that are fundamentally unpredictable:) s
5 385 M
(Quantum Sources \(Required for Provable Security\)) s
5 363 M
(The only sources that satisfy cryptographic assumptions. Quantum mechanics guarantees unp) s
5 352 M
(redictability:) s
5 330 M
(- Photon beam splitters - Single photon hits 50/50 beam splitter, detection is truly rand) s
5 319 M
(om) s
5 308 M
(- Vacuum fluctuations - Measuring quantum vacuum state) s
5 297 M
(- Quantum tunneling - Electron tunneling through barriers) s
5 286 M
(- Nuclear decay - Timing of radioactive decay events) s
5 264 M
(Commercial quantum RNGs: ID Quantique \(QUANTIS\), Quintessence Labs, Crypta Labs) s
5 242 M
(Silicon-Based TRNG) s
5 220 M
(Modern CPUs include hardware random number generators:) s
5 198 M
(| CPU | Instruction | Mechanism |) s
5 187 M
(|-----|-------------|-----------|) s
5 176 M
(| Intel | RDRAND/RDSEED | Thermal noise + AES-CBC-MAC |) s
5 165 M
(| AMD | RDRAND/RDSEED | Ring oscillator jitter |) s
5 154 M
(| ARM | TRNG | Metastable flip-flops |) s
5 143 M
(| RISC-V | Zkr extension | Implementation-defined |) s
5 121 M
(Security note: Intel's RDRAND has faced scrutiny. Mix with other sources.) s
5 99 M
(Environmental Entropy: Lavarand) s
5 77 M
(The most famous entropy source in computing.) s
5 55 M
(Silicon Graphics \(SGI\) invented Lavarand in 1996. Cloudflare operates the modern successo) s
5 44 M
(r.) s
5 22 M
(How It Works) s
_R
S
%%Page: (5) 5
%%BeginPageSetup
_S
24 24 translate
/pagenum 5 def
/fname (rfc-044-cryptographic-entropy.txt) def
/fdir (.) def
/ftail (rfc-044-cryptographic-entropy.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 781 M
(+-------------------------------------------------------------+) s
5 770 M
(|                     LAVARAND SYSTEM                          |) s
5 759 M
(+-------------------------------------------------------------+) s
5 748 M
(|                                                              |) s
5 737 M
(|   +---------+    +---------+    +---------------------+     |) s
5 726 M
(|   |  Lava   |    | Camera  |    |  Image \342\\206\\222 Hash       |     |) s
5 715 M
(|   |  Lamp   |---\342\\226\266|  Feed   |---\342\\226\266|  SHA-256 per frame  |     |) s
5 704 M
(|   |  Wall   |    |         |    |                     |     |) s
5 693 M
(|   +---------+    +---------+    +----------+----------+     |) s
5 682 M
(|                                            |                 |) s
5 671 M
(|                                            v                 |) s
5 660 M
(|                                  +---------------------+     |) s
5 649 M
(|                                  |  Entropy Pool       |     |) s
5 638 M
(|                                  |  \(mix with CSPRNG\)  |     |) s
5 627 M
(|                                  +---------------------+     |) s
5 616 M
(|                                                              |) s
5 605 M
(+-------------------------------------------------------------+) s
5 583 M
(Why Lava Lamps?) s
5 561 M
(1. Chaotic fluid dynamics - Wax movement is unpredictable) s
5 550 M
(2. Thermal convection - Heat creates complex flow patterns) s
5 539 M
(3. High bandwidth - Each video frame yields fresh entropy) s
5 528 M
(4. Tamper-evident - Physical installation is visible) s
5 517 M
(5. Independent source - Not correlated with CPU state) s
5 495 M
(Cloudflare's wall of 100 lava lamps generates entropy for ~10% of internet HTTPS traffic.) s
5 473 M
(Other Environmental Sources) s
5 451 M
(| Source | Mechanism | Bandwidth |) s
5 440 M
(|--------|-----------|-----------|) s
5 429 M
(| Lava lamps | Fluid dynamics | ~100 Kbit/s |) s
5 418 M
(| Radioactive decay | Nuclear physics | ~1-10 Kbit/s |) s
5 407 M
(| Atmospheric noise | RF antenna | ~1 Mbit/s |) s
5 396 M
(| Thermal camera | Johnson-Nyquist noise | ~10 Kbit/s |) s
5 385 M
(| Double pendulum | Chaotic motion | ~100 bit/s |) s
5 374 M
(| Keyboard timing | Human unpredictability | ~1-10 bit/keystroke |) s
5 352 M
(Public Randomness Beacons) s
5 330 M
(Beacons provide verifiable public randomness - useful for:) s
5 319 M
(- Lottery systems) s
5 308 M
(- Audit sampling) s
5 297 M
(- Distributed protocols) s
5 286 M
(- Zero-knowledge proofs) s
5 264 M
(NIST Randomness Beacon) s
5 242 M
(The National Institute of Standards and Technology operates a public randomness beacon si) s
5 231 M
(nce 2013.) s
5 209 M
(https://beacon.nist.gov/beacon/2.0/pulse/last) s
5 187 M
(Architecture:) s
5 176 M
(+-------------------------------------------------------------+) s
5 165 M
(|                   NIST BEACON 2.0                            |) s
5 154 M
(+-------------------------------------------------------------+) s
5 143 M
(|                                                              |) s
5 132 M
(|  Sources:           Processing:         Output:              |) s
5 121 M
(|  +---------+       +-----------+      +--------------+      |) s
5 110 M
(|  | Quantum |--+    |           |      | Pulse Record |      |) s
5 99 M
(|  |   RNG   |  |    |  SHA-512  |      +--------------+      |) s
5 88 M
(|  +---------+  |    |  mixing   |      | timestamp    |      |) s
5 77 M
(|  +---------+  +---\342\\226\266|     +     |-----\342\\226\266| localRandom  |      |) s
5 66 M
(|  |Photonic |  |    |  signing  |      | outputValue  |      |) s
5 55 M
(|  |  Noise  |--+    |           |      | signatureVal |      |) s
5 44 M
(|  +---------+       +-----------+      +--------------+      |) s
5 33 M
(|                                                              |) s
5 22 M
(|  Pulse interval: 60 seconds                                  |) s
5 11 M
(|  Hash chain: Each pulse includes hash of previous            |) s
_R
S
%%Page: (6) 6
%%BeginPageSetup
_S
24 24 translate
/pagenum 6 def
/fname (rfc-044-cryptographic-entropy.txt) def
/fdir (.) def
/ftail (rfc-044-cryptographic-entropy.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 781 M
(|  Signature: RSA-2048 \(Beacon 2.0\)                           |) s
5 770 M
(|                                                              |) s
5 759 M
(+-------------------------------------------------------------+) s
5 737 M
(Pulse Record Contents:) s
5 726 M
(- uri - Unique pulse identifier) s
5 715 M
(- version - Beacon protocol version) s
5 704 M
(- timeStamp - Unix timestamp) s
5 693 M
(- localRandomValue - 512 bits from quantum sources) s
5 682 M
(- outputValue - SHA-512 hash \(the public random value\)) s
5 671 M
(- statusCode - Health indicator) s
5 660 M
(- signatureValue - Digital signature) s
5 638 M
(Properties:) s
5 627 M
(- Unpredictable - Cannot be known before publication) s
5 616 M
(- Verifiable - Anyone can verify the signature chain) s
5 605 M
(- Non-manipulable - NIST cannot control output) s
5 594 M
(- Archived - Full history publicly available) s
5 572 M
(Use in Cyberspace:) s
5 561 M
(;; For ceremonies, audits, public verifiability) s
5 550 M
(\(define \(fetch-nist-beacon\)) s
5 539 M
(  \(let* \(\(response \(http-get "https://beacon.nist.gov/beacon/2.0/pulse/last"\)\)) s
5 528 M
(         \(pulse \(json-parse response\)\)) s
5 517 M
(         \(output \(assoc-ref pulse "outputValue"\)\)\)) s
5 506 M
(    \(hex->blob output\)\)\)) s
5 484 M
(Other Public Beacons) s
5 462 M
(| Beacon | Operator | Source | Interval |) s
5 451 M
(|--------|----------|--------|----------|) s
5 440 M
(| NIST Beacon | US NIST | Quantum + photonic | 60 seconds |) s
5 429 M
(| Chile UChile | University of Chile | Seismic + radio | 60 seconds |) s
5 418 M
(| Cloudflare drand | League of Entropy | Distributed threshold | 30 seconds |) s
5 407 M
(| IRISA | French research | Multiple physical | 60 seconds |) s
5 385 M
(League of Entropy \(drand\)) s
5 363 M
(Distributed randomness beacon - no single party controls the output:) s
5 341 M
(+-------------------------------------------------------------+) s
5 330 M
(|              DRAND DISTRIBUTED BEACON                        |) s
5 319 M
(+-------------------------------------------------------------+) s
5 308 M
(|                                                              |) s
5 297 M
(|   Cloudflare --+                                            |) s
5 286 M
(|                |                                             |) s
5 275 M
(|   EPFL --------+--- Threshold ---\342\\226\266 Public Random           |) s
5 264 M
(|                |    BLS Sig          \(t-of-n nodes          |) s
5 253 M
(|   Protocol ----+    \(t-of-n\)          must participate\)     |) s
5 242 M
(|   Labs         |                                             |) s
5 231 M
(|                |                                             |) s
5 220 M
(|   Kudelski ----+                                            |) s
5 209 M
(|                                                              |) s
5 198 M
(|   Endpoint: https://api.drand.sh/public/latest              |) s
5 187 M
(|   Chain: 8990e7a9aaed2ffed73dbd7092123d6f289930540d7651336225dc172e51b2ce |) s
5 176 M
(|                                                              |) s
5 165 M
(+-------------------------------------------------------------+) s
5 143 M
(Entropy Mixing) s
5 121 M
(Real systems mix multiple sources for defense in depth:) s
5 99 M
(;; Conceptual entropy mixer) s
5 88 M
(\(define \(mix-entropy-sources\)) s
5 77 M
(  \(let \(\(hw \(hardware-random-bytes 32\)\)      ;; RDRAND) s
5 66 M
(        \(os \(os-entropy-pool-bytes 32\)\)       ;; /dev/urandom) s
5 55 M
(        \(env \(environmental-entropy 32\)\)      ;; If available) s
5 44 M
(        \(beacon \(cached-nist-beacon\)\)\)        ;; Public verifiability) s
5 33 M
(    ;; Mix with HKDF or similar) s
5 22 M
(    \(hkdf-sha512) s
5 11 M
(      \(blob-append hw os env beacon\)) s
_R
S
%%Page: (7) 7
%%BeginPageSetup
_S
24 24 translate
/pagenum 7 def
/fname (rfc-044-cryptographic-entropy.txt) def
/fdir (.) def
/ftail (rfc-044-cryptographic-entropy.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 781 M
(      "cyberspace-entropy-v1") s
5 770 M
(      64\)\)\)) s
5 748 M
(Historical Entropy Failures) s
5 726 M
(Learning from disasters:) s
5 704 M
(| Incident | Year | Cause | Impact |) s
5 693 M
(|----------|------|-------|--------|) s
5 682 M
(| Netscape SSL | 1995 | PID + timestamp = predictable | All SSL broken |) s
5 671 M
(| Debian OpenSSL | 2006-2008 | Valgrind "fix" removed entropy | 32,767 possible keys |) s
5 660 M
(| Android SecureRandom | 2013 | PRNG state reuse | Bitcoin wallets drained |) s
5 649 M
(| DualECDRBG | 2013 | NSA backdoor in constants | Unknown surveillance |) s
5 638 M
(| Taiwan smart cards | 2013 | Shared PRNG state | Factored RSA keys |) s
5 616 M
(Lesson: Defense in depth. Mix multiple independent sources.) s
5 594 M
(Entropy Requirements by Operation) s
5 572 M
(| Operation | Entropy Needed | Notes |) s
5 561 M
(|-----------|---------------|-------|) s
5 550 M
(| Ed25519 keypair | 32 bytes | Full key security |) s
5 539 M
(| X25519 keypair | 32 bytes | Full key security |) s
5 528 M
(| XSalsa20 nonce | 24 bytes | Random OK \(large space\) |) s
5 517 M
(| AES-GCM nonce | 12 bytes | Counter preferred \(small space\) |) s
5 506 M
(| Argon2id salt | 16 bytes | Unique per derivation |) s
5 495 M
(| Session ID | 16-32 bytes | Unpredictable |) s
5 484 M
(| ECDSA k-value | 32 bytes | CRITICAL - must not repeat |) s
5 462 M
(Security Considerations) s
5 440 M
(Entropy Exhaustion) s
5 418 M
(libsodium's randombytes_buf\(\) never blocks on modern systems:) s
5 407 M
(- Uses ChaCha20 CSPRNG seeded from OS entropy) s
5 396 M
(- OS entropy pools are continuously replenished) s
5 385 M
(- Hardware RNG \(RDRAND/RDSEED\) available on modern CPUs) s
5 363 M
(VM/Container Considerations) s
5 341 M
(Virtual machines may have limited entropy at boot:) s
5 330 M
(- Use virtio-rng to pass host entropy to guests) s
5 319 M
(- Ensure haveged or rng-tools if entropy-limited) s
5 308 M
(- libsodium will block until sufficient entropy available) s
5 286 M
(Fork Safety) s
5 264 M
(libsodium handles fork correctly:) s
5 253 M
(- Automatic re-seeding after fork\(\)) s
5 242 M
(- No duplicate random sequences in child processes) s
5 220 M
(Deterministic Testing) s
5 198 M
(For reproducible tests ONLY \(never production\):) s
5 176 M
(\(define \(set-test-seed seed\)) s
5 165 M
(  "WARNING: Deterministic mode - testing only") s
5 154 M
(  \(\(foreign-lambda void "randombytes_stir"\)\)\)) s
5 132 M
(Production code MUST use true entropy.) s
5 110 M
(Implementation Notes) s
5 88 M
(Current Status) s
5 66 M
(| Component | Entropy Source | Status |) s
5 55 M
(|-----------|---------------|--------|) s
5 44 M
(| crypto-ffi.scm | randombytes_buf\(\) | Implemented |) s
5 33 M
(| vault.scm \(keystore\) | random-bytes | Implemented |) s
5 22 M
(| OCaml core | TBD | Open Issue |) s
_R
S
%%Page: (8) 8
%%BeginPageSetup
_S
24 24 translate
/pagenum 8 def
/fname (rfc-044-cryptographic-entropy.txt) def
/fdir (.) def
/ftail (rfc-044-cryptographic-entropy.txt) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
5 781 M
(Audit Trail) s
5 759 M
(All key generation events should be logged \(not the keys themselves\):) s
5 737 M
(\(seal-commit #f) s
5 726 M
(  `\(entropy-event) s
5 715 M
(    \(type "key-generation"\)) s
5 704 M
(    \(algorithm "ed25519"\)) s
5 693 M
(    \(timestamp ,\(current-seconds\)\)) s
5 682 M
(    \(entropy-source "libsodium"\)\)\)) s
5 660 M
(Hardware Entropy) s
5 638 M
(When available, hardware entropy sources enhance security:) s
5 616 M
(| Platform | Hardware RNG |) s
5 605 M
(|----------|-------------|) s
5 594 M
(| Intel/AMD | RDRAND, RDSEED instructions |) s
5 583 M
(| ARM | TRNG \(True Random Number Generator\) |) s
5 572 M
(| Apple Silicon | Secure Enclave entropy |) s
5 550 M
(libsodium automatically uses hardware entropy when available.) s
5 528 M
(Migration) s
5 506 M
(Phase 1: Audit \(Current\)) s
5 495 M
(- Identify all randomness usage in codebase) s
5 484 M
(- Replace non-libsodium sources) s
5 462 M
(Phase 2: Standardize) s
5 451 M
(- All Scheme uses random-bytes from crypto-ffi) s
5 440 M
(- Document OCaml approach) s
5 418 M
(Phase 3: Verify) s
5 407 M
(- Entropy quality testing) s
5 396 M
(- Audit logging for key generation) s
5 374 M
(References) s
5 352 M
(- libsodium documentation: https://doc.libsodium.org/) s
5 341 M
(- NIST SP 800-90A: Recommendations for Random Number Generation) s
5 330 M
(- RFC 4086: Randomness Requirements for Security) s
5 319 M
(- ChaCha20: https://cr.yp.to/chacha.html) s
5 297 M
(Appendix: Entropy Quality Testing) s
5 275 M
(For paranoid verification:) s
5 253 M
(Generate random data) s
5 242 M
(csi -e "\(import crypto-ffi\) \(display \(random-bytes 1000000\)\)" > random.bin) s
5 220 M
(Run NIST statistical tests) s
5 209 M
(ent random.bin) s
5 198 M
(dieharder -a -f random.bin) s
5 176 M
(Expected results:) s
5 165 M
(- Entropy: ~7.9999 bits per byte) s
5 154 M
(- Chi-square: p-value 0.01-0.99) s
5 143 M
(- All dieharder tests: PASSED) s
_R
S
%%Trailer
%%Pages: 8
%%DocumentNeededResources: font Courier-Bold Courier 
%%EOF
