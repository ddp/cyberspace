%!PS-Adobe-3.0
%%Creator: groff version 1.23.0
%%CreationDate: Mon Jan 12 10:26:44 2026
%%DocumentNeededResources: font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%+ font Courier
%%DocumentSuppliedResources: procset grops 1.23 0
%%Pages: 11
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.23 0
%!PS-Adobe-3.0 Resource-ProcSet
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
% The ASCII code of the space character.
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
% name size font SF -
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
% name a c d font MF -
/MF{
findfont
[5 2 roll
0 3 1 roll % b
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
% Enable manual feed.
% MANUAL -
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
% Guess the page length.
% This assumes that the imageable area is vertically centered on the page.
% PLG - length
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
% BP -
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
% centerx centery radius startangle endangle DA -
/DA{
newpath arcn stroke
}bind def
% x y SN - x' y'
% round a position to nearest (pixel + (.25,.25))
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
% endx endy startx starty DL -
% we round the endpoints of the line, so that parallel horizontal
% and vertical lines will appear even
/DL{
SN
moveto
SN
lineto stroke
}bind def
% centerx centery radius DC -
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
%  width height centerx centery DE -
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
% these are for splines
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
% fill the last path
% r g b Fr -
/Fr{
setrgbcolor fill
}bind def
% c m y k Fk -
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
% g Fg -
/Fg{
setgray fill
}bind def
% fill with the "current color"
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
% new_font_name encoding_vector old_font_name RE -
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
% hpos vpos EBEGIN -
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
% llx lly newwid wid newht ht newllx newlly PBEGIN -
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
% set the graphics state to default values
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
%
%  Any included setpagedevice should be ignored.
%  See: http://www.w-beer.de/doc/ps/.
%
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%EndProlog
%%BeginSetup
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Times-Bold
%%IncludeResource: font Times-Italic
%%IncludeResource: font Times-Roman
%%IncludeResource: font Courier
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/Euro/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Courier@0 ENC0/Courier RE/Times-Roman@0 ENC0/Times-Roman RE
/Times-Italic@0 ENC0/Times-Italic RE/Times-Bold@0 ENC0/Times-Bold RE
%%EndSetup
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 12/Times-Bold@0 SF(RFC-036: Quorum Pr)164.28 123 Q
(otocol with Homomor)-.216 E(phic V)-.12 E(oting)-1.2 E/F1 10
/Times-Italic@0 SF(Libr)260.85 159 Q(ary of Cyber)-.15 E(space)-.1 E/F2
10/Times-Roman@0 SF(2026)296 177 Q F1(ABSTRA)282.535 213 Q(CT)-.3 E/F3
10/Times-Bold@0 SF 2.5(1. Abstract)72 261 R F2 1.155(This RFC speci\214\
es the quorum protocol for the Library of Cyberspace: ho)72 276.6 R
3.655(wp)-.25 G 1.155(rincipals reach collecti)-3.655 F 1.455 -.15(ve d)
-.25 H(ecisions).15 E .946(through homomorphic encryption-based v)72
288.6 R .946(oting, enabling pri)-.2 F -.25(va)-.25 G .946
(te ballot tallying without re).25 F -.15(ve)-.25 G .947(aling indi).15
F .947(vidual v)-.25 F(otes.)-.2 E(Quorum inte)72 300.6 Q
(grates with threshold go)-.15 E -.15(ve)-.15 G
(rnance \(RFC-007\) and Byzantine consensus \(RFC-011\).).15 E F3 2.5
(2. Moti)72 324.6 R -.1(va)-.1 G(tion).1 E F2(Collecti)72 340.2 Q .3
-.15(ve d)-.25 H(ecisions require:).15 E 6.5<8350>72 355.8 S(ri)-6.5 E
-.25(va)-.25 G -.15(cy).25 G 6.5<8356>72 371.4 S(oters shouldn')-7.79 E
2.5(tk)-.18 G(no)-2.5 E 2.5(wh)-.25 G .5 -.25(ow o)-2.5 H(thers v).25 E
(oted)-.2 E 6.5<8356>72 387 S(eri\214ability)-7.61 E 6.5<8352>72 402.6 S
(esults must be pro)-6.5 E -.25(va)-.15 G(bly correct).25 E 6.5<8343>72
418.2 S(oercion resistance)-6.5 E 6.5<8343>72 433.8 S(an')-6.5 E 2.5(tp)
-.18 G(ro)-2.5 E .3 -.15(ve h)-.15 H .5 -.25(ow y).15 H(ou v).25 E
(oted to others)-.2 E 6.5<8341>72 449.4 S -.25(va)-7.24 G(ilability).25
E 6.5<8356>72 465 S(oting continues despite f)-7.79 E(ailures)-.1 E -.35
(Tr)72 484.2 S(aditional approaches f).35 E(ail:)-.1 E 6.5<834f>72 499.8
S(pen ballot)-6.5 E 6.5<834e>72 515.4 S 2.5(op)-6.5 G(ri)-2.5 E -.25(va)
-.25 G -.15(cy).25 G 2.5(,e)-.5 G(nables coercion)-2.5 E 6.5<8354>72 531
S(rusted tallier)-6.85 E 6.5<8353>72 546.6 S(ingle point of compromise)
-6.5 E 6.5<8353>72 562.2 S(ecure multi-party computation)-6.5 E 6.5
<8343>72 577.8 S(omple)-6.5 E(x, high communication o)-.15 E -.15(ve)
-.15 G(rhead).15 E(Homomorphic encryption pro)72 597 Q(vides:)-.15 E 6.5
<8356>72 612.6 S(ote on encrypted ballots)-7.79 E 6.5<8353>72 628.2 S
(um without decryption)-6.5 E 6.5<8344>72 643.8 S
(ecrypt only the \214nal tally)-6.5 E 6.5<834d>72 659.4 S
(athematical proof of correctness)-6.5 E F3 2.5(3. Cryptographic)72 687
R -.25(Fo)2.5 G(undation).25 E 0 Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-036 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(3.1. Homomor)72 84 R(phic Encryption Schemes)-.1 E .4 LW 466.815
94.5 145.185 94.5 DL 30.085(Scheme Operations)156.025 104 R -.2(Pe)
26.745 G(rf).2 E 41.115(ormance Use)-.25 F(Case)2.5 E -.1(Pa)150.185 116
S 28.44(illier Addition).1 F -.25(Fa)45.98 G 52(st V).25 F(ote tallying)
-1 E 15(BFV/BGV Add)150.185 128 R 2.5(+M)2.5 G 15(ultiply Medium)-2.5 F
(Complex pr)36.47 E(edicates)-.18 E 32.22(TFHE Arbitrary)150.185 140 R
(Slo)41.56 E 52.12(wG)-.1 G(eneral computation)-52.12 E 466.815 144.5
145.185 144.5 DL 466.815 94.5 466.815 144.5 DL 145.185 94.5 145.185
144.5 DL F0 -.15(Fo)72 158 S 2.5(rq).15 G(uorum v)-2.5 E(oting, P)-.2 E
(aillier suf)-.15 E(\214ces - we only need addition.)-.25 E F1 2.5
(3.2. P)72 182 R(aillier Pr)-.1 E(operties)-.18 E/F2 8/Courier@0 SF
(;; Additive homomorphism)108 200 Q
(\(= \(decrypt \(he-add \(encrypt a\) \(encrypt b\)\)\))108 212 Q
(\(+ a b\)\))122.4 224 Q(;; Scalar multiplication via repeated addition)
108 248 Q(\(= \(decrypt \(he-scalar-mult \(encrypt a\) k\)\))108 260 Q
(\(* a k\)\))122.4 272 Q
(;; Semantic security - ciphertexts indistinguishable)108 296 Q
(\(not \(distinguishable? \(encrypt 0\) \(encrypt 1\)\)\))108 308 Q F1
2.5(3.3. K)72 326 R(ey Generation)-.25 E F2
(\(define-record-type <quorum-keys>)108 344 Q
(\(make-quorum-keys public private threshold shares\))117.6 356 Q
(quorum-keys?)117.6 368 Q(\(public qk-public\))117.6 380 Q 4.8(;P)52.8 G
(ublic encryption key)-4.8 E(\(private qk-private\))117.6 392 Q 4.8(;P)
43.2 G(rivate decryption key \(or #f if distributed\))-4.8 E
(\(threshold qk-threshold\))117.6 404 Q 4.8(;M)24 G(-of-N threshold)-4.8
E(\(shares qk-shares\)\))117.6 416 Q 4.8(;D)48 G(istributed key shares)
-4.8 E(\(define \(generate-quorum-keys bit-length threshold trustees\))
108 440 Q("Generate threshold Paillier keys")117.6 452 Q
(\(let* \(\(keys \(paillier-keygen bit-length\)\))117.6 464 Q
(\(shares \(shamir-split \(paillier-private keys\))151.2 476 Q
(threshold)256.8 488 Q(\(length trustees\)\)\)\))256.8 500 Q
(\(make-quorum-keys)127.2 512 Q(\(paillier-public keys\))136.8 524 Q 4.8
(#f ;)136.8 536 R(No single party holds private key)4.8 E(threshold)
136.8 548 Q(\(map cons trustees shares\)\)\)\))136.8 560 Q F1 2.5
(4. Ballot)72 578 R(Structur)2.5 E(e)-.18 E 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-036 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(4.1. Ballot)72 84 R(De\214nition)2.5 E/F2 8/Courier@0 SF
(\(define-record-type <ballot>)108 102 Q
(\(make-ballot id question options threshold deadline\))117.6 114 Q
(ballot?)117.6 126 Q(\(id ballot-id\))117.6 138 Q 4.8(;C)81.6 G
(ontent hash)-4.8 E(\(question ballot-question\))117.6 150 Q 4.8(;H)24 G
(uman-readable question)-4.8 E(\(options ballot-options\))117.6 162 Q
4.8(;L)33.6 G(ist of choices)-4.8 E(\(threshold ballot-threshold\))117.6
174 Q 4.8(;V)14.4 G(otes needed to pass)-4.8 E
(\(deadline ballot-deadline\)\))117.6 186 Q 4.8(;V)19.2 G(oting closes)
-4.8 E(;; Example ballot)108 210 Q(\(make-ballot)108 222 Q
(id: "sha256:ballot...")117.6 234 Q
(question: "Accept RFC-042 into standard?")117.6 246 Q
(options: '\(accept reject abstain\))117.6 258 Q
(threshold: '\(majority members\))117.6 270 Q 4.8(;>)9.6 G
(50% of members)-4.8 E(deadline: 1767786000\))117.6 282 Q F1 2.5
(4.2. Encrypted)72 300 R -1(Vo)2.5 G(te)1 E F2
(\(define-record-type <encrypted-vote>)108 318 Q(\(make-encrypted-vote \
ballot-id voter ciphertext proof timestamp signature\))117.6 330 Q
(encrypted-vote?)117.6 342 Q(\(ballot-id vote-ballot-id\))117.6 354 Q
4.8(;W)24 G(hich ballot)-4.8 E(\(voter vote-voter\))117.6 366 Q 4.8(;V)
62.4 G(oter's public key \(or anonymous token\))-4.8 E
(\(ciphertext vote-ciphertext\))117.6 378 Q 4.8(;H)14.4 G
(E-encrypted choice)-4.8 E(\(proof vote-proof\))117.6 390 Q 4.8(;Z)62.4
G(ero-knowledge proof of validity)-4.8 E(\(timestamp vote-timestamp\))
117.6 402 Q(\(signature vote-signature\)\))117.6 414 Q F1 2.5(4.3. V)72
432 R(ote Encoding)-1 E F2(;; One-hot encoding for multiple choices)108
450 Q(;; accept=1, reject=0, abstain=0 > \(1, 0, 0\))108 462 Q
(\(define \(encode-vote choice options\))108 486 Q
("Encode choice as one-hot vector")117.6 498 Q(\(map \(lambda \(opt\))
117.6 510 Q(\(if \(eq? opt choice\) 1 0\)\))151.2 522 Q(options\)\))
141.6 534 Q(\(define \(encrypt-vote choice options public-key\))108 558
Q("Encrypt one-hot encoded vote")117.6 570 Q(\(map \(lambda \(v\))117.6
582 Q(\(paillier-encrypt public-key v\)\))151.2 594 Q
(\(encode-vote choice options\)\)\))141.6 606 Q(;; Vote for "accept")108
630 Q(\(encrypt-vote 'accept '\(accept reject abstain\) pub-key\))108
642 Q(;; => \(Enc\(1\), Enc\(0\), Enc\(0\)\))108 654 Q F1 2.5(5. V)72
672 R(oting Pr)-1 E(otocol)-.18 E 0 Cg EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-036 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(5.1. Phase)72 84 R(1: Ballot Cr)2.5 E(eation)-.18 E/F2 8/Courier@0
SF(\(define \(create-ballot question options threshold deadline trustee\
s\))108 102 Q("Create new ballot with threshold decryption")117.6 114 Q
(\(let* \(\(keys \(generate-quorum-keys 2048)117.6 126 Q
(\(ceiling \(/ \(length trustees\) 2\)\))285.6 138 Q(trustees\)\))285.6
150 Q(\(ballot \(make-ballot)151.2 162 Q(question: question)199.2 174 Q
(options: options)199.2 186 Q(threshold: threshold)199.2 198 Q
(deadline: deadline\)\)\))199.2 210 Q
(;; Distribute key shares to trustees)127.2 222 Q
(\(for-each \(lambda \(trustee share\))127.2 234 Q
(\(secure-send trustee)184.8 246 Q(`\(key-share)194.4 258 Q
(\(ballot-id ,\(ballot-id ballot\)\))204 270 Q(\(share ,share\)\)\)\))
204 282 Q(trustees)175.2 294 Q(\(qk-shares keys\)\))175.2 306 Q
(;; Publish ballot)127.2 318 Q(\(soup-put ballot type: 'ballot\))127.2
330 Q(\(audit-append action: 'ballot-created)127.2 342 Q
(ballot: \(ballot-id ballot\)\))194.4 354 Q(ballot\)\))127.2 366 Q 0 Cg
EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-036 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(5.2. Phase)72 84 R(2: V)2.5 E(ote Casting)-1 E/F2 8/Courier@0 SF
(\(define \(cast-vote ballot choice voter-key\))108 102 Q
("Cast encrypted vote with validity proof")117.6 114 Q
(\(let* \(\(pub-key \(ballot-public-key ballot\)\))117.6 126 Q(\(encryp\
ted \(encrypt-vote choice \(ballot-options ballot\) pub-key\)\))151.2
138 Q(\(proof \(generate-validity-proof encrypted choice pub-key\)\))
151.2 150 Q(\(vote \(make-encrypted-vote)151.2 162 Q
(ballot-id: \(ballot-id ballot\))189.6 174 Q
(voter: \(key->principal voter-key\))189.6 186 Q(ciphertext: encrypted)
189.6 198 Q(proof: proof)189.6 210 Q(timestamp: \(current-time\)\)\)\))
189.6 222 Q(;; Sign the vote)127.2 234 Q
(\(set-encrypted-vote-signature! vote)127.2 246 Q
(\(sign-vote voter-key vote\)\))136.8 258 Q(;; Submit)127.2 270 Q
(\(submit-vote vote\))127.2 282 Q(vote\)\))127.2 294 Q
(\(define \(submit-vote vote\))108 318 Q
("Submit vote to ballot coordinator")117.6 330 Q(;; Verify eligibility)
117.6 342 Q(\(unless \(eligible-voter? \(vote-voter vote\) \(vote-ballo\
t-id vote\)\))117.6 354 Q(\(error 'not-eligible\)\))127.2 366 Q
(;; Verify validity proof)117.6 378 Q
(\(unless \(verify-validity-proof vote\))117.6 390 Q
(\(error 'invalid-vote-proof\)\))127.2 402 Q
(;; Verify not already voted)117.6 414 Q
(\(when \(already-voted? \(vote-voter vote\) \(vote-ballot-id vote\)\))
117.6 426 Q(\(error 'already-voted\)\))127.2 438 Q(;; Record vote)117.6
450 Q(\(soup-put vote type: 'encrypted-vote\))117.6 462 Q
(\(audit-append action: 'vote-cast)117.6 474 Q
(ballot: \(vote-ballot-id vote\))184.8 486 Q
(voter: \(vote-voter vote\)\)\))184.8 498 Q 0 Cg EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-036 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(5.3. Phase)72 84 R(3: Homomor)2.5 E(phic T)-.1 E(allying)-.92 E/F2 8
/Courier@0 SF(\(define \(tally-votes ballot\))108 102 Q
("Homomorphically sum all votes")117.6 114 Q
(\(let* \(\(votes \(soup-query type: 'encrypted-vote)117.6 126 Q
(ballot-id: \(ballot-id ballot\)\)\))242.4 138 Q
(\(num-options \(length \(ballot-options ballot\)\)\))151.2 150 Q
(\(zero-tally \(make-list num-options \(paillier-encrypt-zero\)\)\)\))
151.2 162 Q(;; Sum encrypted votes)127.2 174 Q
(\(fold \(lambda \(vote tally\))127.2 186 Q(\(map paillier-add)165.6 198
Q(\(vote-ciphertext vote\))189.6 210 Q(tally\)\))189.6 222 Q(zero-tally)
156 234 Q(votes\)\)\))156 246 Q(;; After tallying 100 votes:)108 270 Q
(;; \(Enc\(47\), Enc\(41\), Enc\(12\)\))108 282 Q
(;; Still encrypted - no one knows the result yet)108 294 Q F1 2.5
(5.4. Phase)72 312 R(4: Thr)2.5 E(eshold Decryption)-.18 E F2
(\(define \(decrypt-tally ballot encrypted-tally\))108 330 Q
("Threshold decrypt the tally")117.6 342 Q
(\(let* \(\(trustees \(ballot-trustees ballot\)\))117.6 354 Q
(\(threshold \(ballot-key-threshold ballot\)\))151.2 366 Q
(\(shares '\(\)\)\))151.2 378 Q(;; Collect decryption shares)127.2 390 Q
(\(for-each \(lambda \(trustee\))127.2 402 Q
(\(let \(\(share \(request-decryption-share trustee)184.8 414 Q
(\(ballot-id ballot\))256.8 426 Q(encrypted-tally\)\)\))256.8 438 Q
(\(when share)194.4 450 Q(\(set! shares \(cons share shares\)\)\)\)\))
204 462 Q(trustees\))175.2 474 Q(;; Need threshold shares)127.2 486 Q
(\(unless \(>= \(length shares\) threshold\))127.2 498 Q
(\(error 'insufficient-decryption-shares\)\))136.8 510 Q
(;; Combine shares to decrypt)127.2 522 Q(\(let \(\(plaintext-tally)
127.2 534 Q(\(map \(lambda \(ct\))160.8 546 Q
(\(threshold-decrypt ct shares\)\))194.4 558 Q(encrypted-tally\)\)\))
184.8 570 Q(;; Publish result)136.8 582 Q
(\(publish-result ballot plaintext-tally\))136.8 594 Q
(plaintext-tally\)\)\))136.8 606 Q(\(define \(request-decryption-share \
trustee ballot-id encrypted-tally\))108 630 Q
("Request trustee's decryption share")117.6 642 Q
(\(let \(\(response \(tunnel trustee)117.6 654 Q
(`\(decryption-share-request)204 666 Q(\(ballot-id ,ballot-id\))213.6
678 Q(\(tally ,encrypted-tally\)\)\)\)\))213.6 690 Q
(\(and \(valid-share? response\))127.2 702 Q(response\)\)\))151.2 714 Q
0 Cg EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-036 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(5.5. Phase)72 84 R(5: Result Publication)2.5 E/F2 8/Courier@0 SF
(\(define \(publish-result ballot tally\))108 102 Q
("Publish verified result")117.6 114 Q
(\(let* \(\(options \(ballot-options ballot\)\))117.6 126 Q
(\(result \(map cons options tally\)\))151.2 138 Q
(\(winner \(determine-winner result \(ballot-threshold ballot\)\)\)\))
151.2 150 Q(\(soup-put)127.2 162 Q(`\(ballot-result)136.8 174 Q
(\(ballot-id ,\(ballot-id ballot\)\))146.4 186 Q(\(tally ,result\))146.4
198 Q(\(winner ,winner\))146.4 210 Q(\(timestamp ,\(current-time\)\))
146.4 222 Q(\(total-votes ,\(apply + tally\)\)\))146.4 234 Q
(type: 'ballot-result\))136.8 246 Q
(\(audit-append action: 'ballot-result)127.2 258 Q
(ballot: \(ballot-id ballot\))194.4 270 Q(result: result)194.4 282 Q
(winner: winner\)\)\))194.4 294 Q F1 2.5(6. Zer)72 312 R(o-Kno)-.18 E
(wledge Pr)-.1 E(oofs)-.18 E 2.5(6.1. V)72 336 R(ote V)-1 E(alidity Pr)
-.92 E(oof)-.18 E F0(Pro)72 351.6 Q .3 -.15(ve v)-.15 H(ote is v)-.05 E
(alid \(e)-.25 E(xactly one 1, rest 0s\) without re)-.15 E -.15(ve)-.25
G(aling which:).15 E F2
(\(define \(generate-validity-proof encrypted-vote choice public-key\))
108 369.6 Q("ZK proof that vote encodes valid choice")117.6 381.6 Q
(;; Disjunctive proof: prove one of N possibilities)117.6 393.6 Q
(;; Without revealing which)117.6 405.6 Q
(\(let \(\(n \(length encrypted-vote\)\)\))117.6 417.6 Q
(\(make-or-proof)127.2 429.6 Q(\(map \(lambda \(i\))136.8 441.6 Q
(\(if \(= i \(choice-index choice\)\))170.4 453.6 Q
(;; Real proof for actual choice)189.6 465.6 Q
(\(make-encryption-proof \(list-ref encrypted-vote i\) 1 public-key\))
189.6 477.6 Q(;; Simulated proof for other choices)189.6 489.6 Q(\(simu\
late-encryption-proof \(list-ref encrypted-vote i\) 1 public-key\)\)\))
189.6 501.6 Q(\(iota n\)\)\)\)\))160.8 513.6 Q
(\(define \(verify-validity-proof vote\))108 537.6 Q
("Verify vote validity without learning choice")117.6 549.6 Q
(\(let \(\(proof \(vote-proof vote\)\))117.6 561.6 Q
(\(ciphertext \(vote-ciphertext vote\)\))146.4 573.6 Q
(\(pub-key \(ballot-public-key \(vote-ballot-id vote\)\)\)\))146.4 585.6
Q(;; Verify OR proof)127.2 597.6 Q
(\(and \(verify-or-proof proof ciphertext pub-key\))127.2 609.6 Q
(;; Verify sum of encrypted values equals Enc\(1\))151.2 621.6 Q
(\(verify-sum-equals-one ciphertext pub-key\)\)\)\))151.2 633.6 Q F1 2.5
(6.2. Decryption)72 651.6 R(Shar)2.5 E 2.5(eP)-.18 G -.18(ro)-2.5 G(of)
.18 E 0 Cg EP
%%Page: 8 8
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-036 0)72 48 R(Pro)72 84 Q .3 -.15
(ve d)-.15 H(ecryption share is correct:).15 E/F1 8/Courier@0 SF
(\(define \(generate-share-proof share ciphertext trustee-key\))108 102
Q("ZK proof that decryption share is correct")117.6 114 Q
(\(make-dlog-proof)117.6 126 Q(\(share-value share\))127.2 138 Q
(trustee-key)127.2 150 Q(ciphertext\)\))127.2 162 Q
(\(define \(verify-share-proof share ciphertext trustee-pubkey\))108 186
Q("Verify decryption share correctness")117.6 198 Q(\(verify-dlog-proof)
117.6 210 Q(\(share-proof share\))127.2 222 Q(\(share-value share\))
127.2 234 Q(trustee-pubkey)127.2 246 Q(ciphertext\)\))127.2 258 Q/F2 10
/Times-Bold@0 SF 2.5(7. V)72 276 R(oter Pri)-1 E -.1(va)-.1 G(cy).1 E
2.5(7.1. Anonymous)72 300 R -1(Vo)2.5 G(ting T)1 E(ok)-.92 E(ens)-.1 E
F1(\(define \(issue-voting-token voter-key ballot-id issuer-key\))108
318 Q("Issue blind voting token")117.6 330 Q(;; Voter blinds their key)
117.6 342 Q(\(let* \(\(blinding-factor \(random-scalar\)\))117.6 354 Q
(\(blinded-key \(blind-key voter-key blinding-factor\)\)\))151.2 366 Q
(;; Issuer signs blinded key)127.2 378 Q
(\(let \(\(blind-signature \(sign issuer-key blinded-key\)\)\))127.2 390
Q(;; Voter unblinds signature)136.8 402 Q(\(let \(\(token \(unblind-sig\
nature blind-signature blinding-factor\)\)\))136.8 414 Q
(;; Token proves eligibility without linking to voter)146.4 426 Q
(\(make-voting-token)146.4 438 Q(ballot-id: ballot-id)156 450 Q
(token: token)156 462 Q(;; Cannot be linked to voter-key)156 474 Q
(\)\)\)\)\))156 486 Q(\(define \(vote-anonymously ballot choice token\))
108 510 Q("Cast vote using anonymous token")117.6 522 Q
(\(let \(\(vote \(cast-vote ballot choice token\)\)\))117.6 534 Q
(;; Vote linked to token, not voter identity)127.2 546 Q(vote\)\))127.2
558 Q F2 2.5(7.2. Receipt-Fr)72 576 R(eeness)-.18 E F0 -1.29(Vo)72 591.6
S(ters cannot pro)1.29 E .3 -.15(ve h)-.15 H .5 -.25(ow t).15 H(he).25 E
2.5(yv)-.15 G(oted \(pre)-2.7 E -.15(ve)-.25 G(nts v).15 E(ote b)-.2 E
(uying/coercion\):)-.2 E F1
(;; Re-encryption mixnet for receipt-freeness)108 609.6 Q
(\(define \(submit-through-mixnet vote mixnet-nodes\))108 621.6 Q
("Submit vote through re-encryption mixnet")117.6 633.6 Q
(\(fold \(lambda \(node encrypted-vote\))117.6 645.6 Q
(;; Each node re-encrypts)156 657.6 Q
(\(let \(\(re-encrypted \(paillier-rerandomize encrypted-vote\)\)\))156
669.6 Q(;; Shuffle with other votes)165.6 681.6 Q
(\(mixnet-shuffle node re-encrypted\)\)\))165.6 693.6 Q(vote)146.4 705.6
Q(mixnet-nodes\)\))146.4 717.6 Q 0 Cg EP
%%Page: 9 9
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-036 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(8. Quorum)72 84 R -.34(Ty)2.5 G(pes).34 E 2.5(8.1. Simple)72 108 R
(Majority)2.5 E/F2 8/Courier@0 SF
(\(define \(simple-majority tally total-eligible\))108 126 Q
("More than half of voters")117.6 138 Q
(\(let \(\(total-votes \(apply + tally\)\))117.6 150 Q
(\(winning-votes \(apply max tally\)\)\))146.4 162 Q
(\(> winning-votes \(/ total-votes 2\)\)\)\))127.2 174 Q F1 2.5
(8.2. Supermajority)72 192 R F2
(\(define \(supermajority tally fraction\))108 210 Q
("Require fraction \(e.g., 2/3\) agreement")117.6 222 Q
(\(let \(\(total-votes \(apply + tally\)\))117.6 234 Q
(\(winning-votes \(apply max tally\)\)\))146.4 246 Q
(\(>= winning-votes \(* fraction total-votes\)\)\)\))127.2 258 Q F1 2.5
(8.3. Thr)72 276 R(eshold of Eligible)-.18 E F2
(\(define \(threshold-of-eligible tally total-eligible threshold\))108
294 Q("Require threshold of all eligible voters")117.6 306 Q
(\(let \(\(winning-votes \(apply max tally\)\)\))117.6 318 Q
(\(>= winning-votes \(* threshold total-eligible\)\)\)\))127.2 330 Q F1
2.5(8.4. W)72 348 R(eighted V)-.65 E(oting)-1 E F2
(\(define \(weighted-vote voter-key weight choice ballot\))108 366 Q
("Cast vote with weight")117.6 378 Q(;; Encode weight in vote)117.6 390
Q(\(let \(\(encoded \(map \(lambda \(v\) \(* v weight\)\))117.6 402 Q
(\(encode-vote choice \(ballot-options ballot\)\)\)\)\))213.6 414 Q
(\(encrypt-vote-vector encoded \(ballot-public-key ballot\)\)\)\))127.2
426 Q F1 2.5(9. Integration)72 444 R(with Go)2.5 E -.1(ve)-.1 G -.15(rn)
.1 G(ance).15 E 2.5(9.1. RFC-007)72 468 R(Thr)2.5 E(eshold Go)-.18 E -.1
(ve)-.1 G -.15(rn).1 G(ance).15 E F2
(;; Quorum voting for threshold operations)108 486 Q
(\(define \(threshold-operation-vote operation trustees\))108 498 Q
("Vote on threshold operation")117.6 510 Q
(\(let \(\(ballot \(create-ballot)117.6 522 Q
(question: \(format "Approve ~a?" operation\))194.4 534 Q
(options: '\(approve reject\))194.4 546 Q
(threshold: '\(supermajority 2/3\))194.4 558 Q
(deadline: \(+ \(current-time\) 86400\))194.4 570 Q
(trustees: trustees\)\)\))194.4 582 Q(;; Wait for voting)127.2 594 Q
(\(await-ballot-result ballot\)\)\))127.2 606 Q 0 Cg EP
%%Page: 10 10
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-036 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(9.2. RFC-011)72 84 R(Byzantine Consensus)2.5 E/F2 8/Courier@0 SF
(;; Use quorum voting within Byzantine protocol)108 102 Q
(\(define \(byzantine-propose-vote proposal validators\))108 114 Q
("Propose via encrypted voting")117.6 126 Q
(\(let \(\(ballot \(create-ballot)117.6 138 Q(question: proposal)194.4
150 Q(options: '\(commit abort\))194.4 162 Q
(threshold: '\(byzantine-quorum \(length validators\)\))194.4 174 Q
(trustees: validators\)\)\))194.4 186 Q(ballot\)\))127.2 198 Q
(\(define \(byzantine-quorum n\))108 222 Q("2f+1 for n=3f+1 validators")
117.6 234 Q(\(+ \(* 2 \(floor \(/ \(- n 1\) 3\)\)\) 1\)\))117.6 246 Q F1
2.5(9.3. K)72 264 R(ey Cer)-.25 E(emony V)-.18 E(oting)-1 E F2
(;; Vote to approve key ceremony)108 282 Q
(\(define \(key-ceremony-approval ceremony guardians\))108 294 Q
("Guardians vote to approve ceremony")117.6 306 Q
(\(let \(\(ballot \(create-ballot)117.6 318 Q(question: \(format "Appro\
ve key ceremony ~a?" \(ceremony-id ceremony\)\))194.4 330 Q
(options: '\(approve reject\))194.4 342 Q(threshold: '\(unanimous\))
194.4 354 Q(deadline: \(+ \(current-time\) 3600\))194.4 366 Q
(trustees: guardians\)\)\))194.4 378 Q
(\(let \(\(result \(await-ballot-result ballot\)\)\))127.2 390 Q
(\(if \(eq? \(result-winner result\) 'approve\))136.8 402 Q
(\(proceed-ceremony ceremony\))156 414 Q
(\(abort-ceremony ceremony\)\)\)\)\))156 426 Q F1 2.5(10. Security)72
444 R(Considerations)2.5 E 2.5(10.1. Cryptographic)72 468 R(Assumptions)
2.5 E .4 LW 483.09 478.5 128.91 478.5 DL 73.58(Assumption Primiti)
180.295 488 R 27.395 -.1(ve C)-.1 H(onsequence if Br).1 E(ok)-.18 E(en)
-.1 E(Decisional Composite Residuosity)133.91 500 Q -.1(Pa)17.5 G 48.17
(illier V).1 F(ote pri)-1 E -.1(va)-.1 G(cy lost).1 E(Discr)133.91 512 Q
(ete Log)-.18 E(ZK pr)107.42 E 35.19(oofs V)-.18 F(alidity un)-.92 E -.1
(ve)-.4 G(ri\214able).1 E(Random Oracle)133.91 524 Q(Hash functions)
93.34 E(Pr)17.5 E(oof f)-.18 E(or)-.25 E(gery)-.1 E 483.09 528.5 128.91
528.5 DL 483.09 478.5 483.09 528.5 DL 128.91 478.5 128.91 528.5 DL 2.5
(10.2. Attack)72 542 R(Mitigations)2.5 E 434.38 552.5 177.62 552.5 DL
91.44(Attack Mitigation)208.705 562 R -1(Vo)182.62 574 S(te b)1 E 45.3
(uying Receipt-fr)-.2 F(eeness via r)-.18 E(e-encryption)-.18 E(Coer)
182.62 586 Q 57.35(cion Deniable)-.18 F -.1(vo)2.5 G(ting tok).1 E(ens)
-.1 E(Ballot stuf\214ng)182.62 598 Q(Eligibility pr)38.26 E
(oofs, audit trail)-.18 E -.92(Ta)182.62 610 S(lly manipulation).92 E
(Thr)17.5 E(eshold decryption, ZK pr)-.18 E(oofs)-.18 E(Denial of ser)
182.62 622 Q 25.61(vice Rate)-.1 F(limiting, deadlines)2.5 E 434.38
626.5 177.62 626.5 DL 434.38 552.5 434.38 626.5 DL 177.62 552.5 177.62
626.5 DL 2.5(10.3. A)72 640 R(udit T)-.5 E(rail)-.74 E F2
(;; All voting actions audited)108 658 Q
(\(audit-append action: 'ballot-created ...\))108 670 Q
(\(audit-append action: 'vote-cast ...\))108 682 Q 4.8(;V)28.8 G
(oter ID, not choice)-4.8 E
(\(audit-append action: 'tally-computed ...\))108 694 Q
(\(audit-append action: 'share-provided ...\))108 706 Q
(\(audit-append action: 'result-published ...\))108 718 Q 0 Cg EP
%%Page: 11 11
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-036 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(11. P)72 84 R(erf)-.2 E(ormance Considerations)-.25 E 2.5(11.1. P)72
108 R(aillier Costs)-.1 E .4 LW 395.44 118.5 216.56 118.5 DL 34.395
(Operation T)239.985 128 R(ime \(2048-bit\))-.18 E -.25(Ke)221.56 140 S
2.5(yg).25 G 30.72(eneration ~100ms)-2.5 F 60.74(Encrypt ~5ms)221.56 152
R(Homomor)221.56 164 Q(phic add)-.1 E(~0.1ms)17.5 E 61.31(Decrypt ~5ms)
221.56 176 R(Thr)221.56 188 Q(eshold decrypt)-.18 E(~10ms per shar)19.25
E(e)-.18 E 395.44 192.5 216.56 192.5 DL 395.44 118.5 395.44 192.5 DL
216.56 118.5 216.56 192.5 DL 2.5(11.2. Scalability)72 206 R/F2 8
/Courier@0 SF(;; For N voters, M options:)108 224 Q
(;; - Encryption: O\(N)108 236 Q(M\) operations)9.6 E
(;; - Tallying: O\(N)108 248 Q(M\) additions \(fast\))9.6 E
(;; - Decryption: O\(M * threshold\) operations)108 260 Q
(;; 10,000 voters, 3 options, 5 trustees:)108 284 Q
(;; ~50,000 encryptions \(parallel\))108 296 Q
(;; ~30,000 additions \(<1 second\))108 308 Q
(;; ~15 decryptions \(~150ms\))108 320 Q F1 2.5(12. Implementation)72
338 R(Notes)2.5 E 2.5(12.1. Dependencies)72 362 R F0 6.5<8370>72 377.6 S
(aillier)-6.5 E 6.5<8350>72 393.2 S(aillier cryptosystem - shamir)-6.65
E 6.5<8353>72 408.8 S(ecret sharing for threshold k)-6.5 E -.15(ey)-.1 G
2.5(s-z).15 G(kp)-2.5 E 6.5<835a>72 424.4 S(ero-kno)-6.5 E
(wledge proof primiti)-.25 E -.15(ve)-.25 G 2.5(s-s).15 G(r\214-27)-2.5
E 6.5<8352>72 440 S(andom number generation)-6.5 E F1 2.5
(12.2. Libraries)72 467.6 R F0 .214
(Recommended implementations: - OpenFHE \(C++\) - Full HE library - p)72
483.2 R .213(ython-paillier - Reference implementation -)-.1 F
(threshold-paillier - Distrib)72 495.2 Q(uted k)-.2 E .3 -.15(ey g)-.1 H
(eneration).15 E F1 2.5(13. Refer)72 519.2 R(ences)-.18 E F0 1.385(1. P)
72 534.8 R(aillier)-.15 E 3.885(,P)-.4 G 3.885(.\()-3.885 G 1.385
(1999\). Public-K)-3.885 F 1.685 -.15(ey C)-.25 H 1.385
(ryptosystems Based on Composite De).15 F 1.385
(gree Residuosity Classes 2. Benaloh, J.)-.15 F .831
(\(1994\). Dense Probabilistic Encryption 3. Cramer)72 546.8 R 3.331(,R)
-.4 G .831(., Gennaro, R., Schoenmak)-3.331 F .83
(ers, B. \(1997\). A Secure and Opti-)-.1 F .066(mally Ef)72 558.8 R
.067(\214cient Multi-Authority Election Scheme 4. RFC-007: Threshold Si\
gnature Go)-.25 F -.15(ve)-.15 G .067(rnance 5. RFC-011: Byzan-).15 F
(tine Consensus 6. RFC-022: K)72 570.8 Q .3 -.15(ey C)-.25 H(eremon).15
E 2.5(yP)-.15 G(rotocol)-2.5 E F1 2.5(14. Changelog)72 594.8 R F0 6.5
<8332>72 610.4 S(026-01-07)-6.5 E 6.5<8349>72 626 S(nitial draft)-6.5 E
0 Cg EP
%%Trailer
end
%%EOF
