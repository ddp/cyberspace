%!PS-Adobe-3.0
%%Creator: groff version 1.23.0
%%CreationDate: Sun Jan 11 22:47:40 2026
%%DocumentNeededResources: font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%+ font Courier
%%DocumentSuppliedResources: procset grops 1.23 0
%%Pages: 10
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.23 0
%!PS-Adobe-3.0 Resource-ProcSet
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
% The ASCII code of the space character.
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
% name size font SF -
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
% name a c d font MF -
/MF{
findfont
[5 2 roll
0 3 1 roll % b
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
% Enable manual feed.
% MANUAL -
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
% Guess the page length.
% This assumes that the imageable area is vertically centered on the page.
% PLG - length
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
% BP -
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
% centerx centery radius startangle endangle DA -
/DA{
newpath arcn stroke
}bind def
% x y SN - x' y'
% round a position to nearest (pixel + (.25,.25))
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
% endx endy startx starty DL -
% we round the endpoints of the line, so that parallel horizontal
% and vertical lines will appear even
/DL{
SN
moveto
SN
lineto stroke
}bind def
% centerx centery radius DC -
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
%  width height centerx centery DE -
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
% these are for splines
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
% fill the last path
% r g b Fr -
/Fr{
setrgbcolor fill
}bind def
% c m y k Fk -
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
% g Fg -
/Fg{
setgray fill
}bind def
% fill with the "current color"
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
% new_font_name encoding_vector old_font_name RE -
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
% hpos vpos EBEGIN -
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
% llx lly newwid wid newht ht newllx newlly PBEGIN -
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
% set the graphics state to default values
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
%
%  Any included setpagedevice should be ignored.
%  See: http://www.w-beer.de/doc/ps/.
%
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%EndProlog
%%BeginSetup
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Times-Bold
%%IncludeResource: font Times-Italic
%%IncludeResource: font Times-Roman
%%IncludeResource: font Courier
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/Euro/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Courier@0 ENC0/Courier RE/Times-Roman@0 ENC0/Times-Roman RE
/Times-Italic@0 ENC0/Times-Italic RE/Times-Bold@0 ENC0/Times-Bold RE
%%EndSetup
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 12/Times-Bold@0 SF(RFC-027: V)237.894 123 Q(ault Migration)-1.104 E
/F1 10/Times-Italic@0 SF(Libr)260.85 159 Q(ary of Cyber)-.15 E(space)-.1
E/F2 10/Times-Roman@0 SF(2026)296 177 Q F1(ABSTRA)282.535 213 Q(CT)-.3 E
/F3 10/Times-Bold@0 SF 2.5(1. Abstract)72 261 R F2 .373
(This RFC speci\214es v)72 276.6 R .372
(ault migration for the Library of Cyberspace: ho)-.25 F 2.872(wt)-.25 G
2.872(om)-2.872 G .672 -.15(ove v)-2.872 H .372
(aults between hosts, storage back-)-.1 F .561(ends, and administrati)72
288.6 R .861 -.15(ve d)-.25 H .561(omains while preserving content inte)
.15 F(grity)-.15 E 3.062(,c)-.65 G .562
(apability chains, and audit continuity. Migra-)-3.062 F
(tion is essential for long-term preserv)72 300.6 Q(ation.)-.25 E F3 2.5
(2. Moti)72 324.6 R -.1(va)-.1 G(tion).1 E F2 -1.11(Va)72 340.2 S
(ults must outli)1.11 E .3 -.15(ve t)-.25 H(heir infrastructure:).15 E
6.5<8348>72 355.8 S(ardw)-6.5 E(are f)-.1 E(ailure)-.1 E 6.5<8344>72
371.4 S(isks die, serv)-6.5 E(ers decommission)-.15 E 6.5<8350>72 387 S
(ro)-6.5 E(vider changes)-.15 E 6.5<8343>72 402.6 S(loud v)-6.5 E
(endors come and go)-.15 E 6.5<834a>72 418.2 S(urisdiction)-6.5 E 6.5
<834c>72 433.8 S -2.25 -.15(eg a)-6.5 H 2.5(lr).15 G
(equirements may force relocation)-2.5 E 6.5<8350>72 449.4 S(erformance)
-6.5 E 6.5<834d>72 465 S .3 -.15(ove c)-6.5 H(loser to users).15 E 6.5
<8343>72 480.6 S(ost)-6.5 E 6.5<8343>72 496.2 S
(heaper storage becomes a)-6.5 E -.25(va)-.2 G(ilable).25 E
(Migration must be:)72 515.4 Q 6.5<8343>72 531 S(omplete)-6.5 E 6.5
<8341>72 546.6 S(ll objects, metadata, capabilities)-6.5 E 6.5<8356>72
562.2 S(eri\214able)-7.61 E 6.5<8343>72 577.8 S
(ryptographic proof of inte)-6.5 E(grity)-.15 E 6.5<8352>72 593.4 S
(esumable)-6.5 E 6.5<8348>72 609 S(andle interruptions gracefully)-6.5 E
6.5<8341>72 624.6 S(uditable)-6.5 E 6.5<8346>72 640.2 S
(ull trail of what mo)-6.5 E -.15(ve)-.15 G 2.5(dw).15 G(here)-2.5 E F3
2.5(3. Migration)72 667.8 R -.34(Ty)2.5 G(pes).34 E 2.5(3.1. Full)72
691.8 R(Migration)2.5 E 0 Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-027 0)72 48 R(Mo)72 84 Q .3 -.15
(ve e)-.15 H(ntire v).15 E(ault to ne)-.25 E 2.5(wl)-.25 G(ocation:)-2.5
E/F1 8/Courier@0 SF
(\(define \(full-migration source-vault target-host\))108 102 Q
("Migrate entire vault to new host")117.6 114 Q
(\(let \(\(migration-id \(generate-migration-id\)\)\))117.6 126 Q
(\(audit-append action: `\(migration-start ,migration-id\))127.2 138 Q
(type: 'full)194.4 150 Q(source: source-vault)194.4 162 Q
(target: target-host\))194.4 174 Q(;; Phase 1: Snapshot)127.2 198 Q
(\(let \(\(snapshot \(vault-snapshot source-vault\)\)\))127.2 210 Q
(;; Phase 2: Transfer)136.8 222 Q
(\(transfer-snapshot snapshot target-host\))136.8 234 Q
(;; Phase 3: Verify)136.8 246 Q
(\(verify-transfer snapshot target-host\))136.8 258 Q
(;; Phase 4: Cutover)136.8 270 Q
(\(cutover source-vault target-host migration-id\)\)\)\))136.8 282 Q/F2
10/Times-Bold@0 SF 2.5(3.2. P)72 300 R(artial Migration)-.1 E F0(Mo)72
315.6 Q .3 -.15(ve s)-.15 H(ubset of objects:).15 E F1
(\(define \(partial-migration source-vault target-host predicate\))108
333.6 Q("Migrate objects matching predicate")117.6 345.6 Q
(\(let \(\(objects \(soup-query source-vault predicate\)\)\))117.6 357.6
Q(\(for-each \(lambda \(obj\))127.2 369.6 Q
(\(migrate-object obj target-host\)\))184.8 381.6 Q(objects\)\)\))175.2
393.6 Q F2 2.5(3.3. Li)72 411.6 R .2 -.1(ve M)-.1 H(igration).1 E F0
(Migrate while v)72 427.2 Q(ault remains acti)-.25 E -.15(ve)-.25 G(:)
.15 E F1(\(define \(live-migration source-vault target-host\))108 445.2
Q("Migrate without downtime")117.6 457.2 Q(;; Phase 1: Initial sync)
117.6 469.2 Q
(\(let \(\(checkpoint \(initial-sync source-vault target-host\)\)\))
117.6 481.2 Q(;; Phase 2: Catch up changes)127.2 493.2 Q
(\(let loop \(\(last-checkpoint checkpoint\)\))127.2 505.2 Q
(\(let \(\(changes \(changes-since source-vault last-checkpoint\)\)\))
136.8 517.2 Q(\(if \(< \(length changes\) catchup-threshold\))146.4
529.2 Q(;; Phase 3: Final cutover \(brief pause\))165.6 541.2 Q
(\(atomic-cutover source-vault target-host changes\))165.6 553.2 Q
(\(loop \(sync-changes changes target-host\)\)\)\)\)\)\))165.6 565.2 Q
F2 2.5(4. Object)72 583.2 R -.74(Tr)2.5 G(ansfer).74 E 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-027 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(4.1. Export)72 84 R -.25(Fo)2.5 G(rmat).25 E/F2 8/Courier@0 SF
(;; Sealed archive format \(RFC-018\))108 102 Q
(\(define \(export-object hash\))108 114 Q(`\(vault-object)117.6 126 Q
(\(hash ,hash\))127.2 138 Q(\(content ,\(cas-get hash\)\))127.2 150 Q
(\(soup-entry ,\(soup-get hash\)\))127.2 162 Q
(\(references ,\(object-references hash\)\))127.2 174 Q
(\(signatures ,\(object-signatures hash\)\)\)\))127.2 186 Q
(\(define \(export-batch hashes\))108 210 Q
(\(let \(\(objects \(map export-object hashes\)\)\))117.6 222 Q
(\(seal-archive objects)127.2 234 Q(compression: 'zstd)136.8 246 Q
(encryption: target-vault-key\)\)\))136.8 258 Q F1 2.5(4.2. T)72 276 R
(ransfer Pr)-.74 E(otocol)-.18 E F2
(\(define \(transfer-object obj source target\))108 294 Q
("Transfer single object with verification")117.6 306 Q
(\(let* \(\(hash \(object-hash obj\)\))117.6 318 Q
(\(data \(export-object hash\)\)\))151.2 330 Q(;; Send to target)127.2
342 Q(\(vault-send target data\))127.2 354 Q
(;; Get acknowledgment with hash)127.2 366 Q
(\(let \(\(ack \(vault-receive target\)\)\))127.2 378 Q
(\(unless \(equal? \(ack-hash ack\) hash\))136.8 390 Q
(\(error "Transfer verification failed" hash\)\))146.4 402 Q
(\(audit-append action: `\(object-transferred ,hash\))136.8 414 Q
(source: source)204 426 Q(target: target\)\)\)\))204 438 Q F1 2.5
(4.3. Str)72 456 R(eaming T)-.18 E(ransfer)-.74 E F2
(\(define \(stream-transfer source target\))108 474 Q
("Stream objects for efficient bulk transfer")117.6 486 Q
(\(let \(\(stream \(open-transfer-stream source target\)\)\))117.6 498 Q
(\(for-each \(lambda \(hash\))127.2 510 Q
(\(let \(\(obj \(export-object hash\)\)\))184.8 522 Q
(\(stream-write stream obj\))194.4 534 Q
(\(when \(stream-buffer-full? stream\))194.4 546 Q
(\(stream-flush stream\)\)\)\))204 558 Q(\(vault-all-hashes source\)\))
175.2 570 Q(\(stream-close stream\)\)\))127.2 582 Q F1 2.5(5. Metadata)
72 600 R(Migration)2.5 E 0 Cg EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-027 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(5.1. Soup)72 84 R(Entries)2.5 E/F2 8/Courier@0 SF
(\(define \(migrate-soup-entry hash source target\))108 102 Q
("Migrate soup metadata for object")117.6 114 Q
(\(let \(\(entry \(soup-get source hash\)\)\))117.6 126 Q(\(when entry)
127.2 138 Q(\(soup-put target hash entry\))136.8 150 Q(;; Verify)136.8
162 Q(\(unless \(equal? \(soup-get target hash\) entry\))136.8 174 Q
(\(error "Soup entry migration failed" hash\)\)\)\)\))146.4 186 Q F1 2.5
(5.2. Index)72 204 R(Migration)2.5 E F2
(\(define \(migrate-indexes source target\))108 222 Q
("Rebuild indexes on target")117.6 234 Q
(;; Option 1: Export and import index data)117.6 246 Q
(\(let \(\(index-data \(export-indexes source\)\)\))117.6 258 Q
(\(import-indexes target index-data\)\))127.2 270 Q
(;; Option 2: Rebuild from soup \(slower but guaranteed correct\))117.6
294 Q(\(rebuild-indexes target\)\))117.6 306 Q F1 2.5(5.3. A)72 324 R
(udit T)-.5 E(rail)-.74 E F2(\(define \(migrate-audit source target\))
108 342 Q("Migrate audit trail \(critical for provenance\)")117.6 354 Q
(\(let \(\(audit-entries \(audit-export source\)\)\))117.6 366 Q
(;; Audit entries are append-only, transfer in order)127.2 378 Q
(\(for-each \(lambda \(entry\))127.2 390 Q
(\(audit-import target entry\)\))184.8 402 Q(audit-entries\))175.2 414 Q
(;; Add migration event to both)127.2 426 Q(\(let \(\(migration-entry)
127.2 438 Q(`\(migration-audit)160.8 450 Q(\(source ,source\))170.4 462
Q(\(target ,target\))170.4 474 Q(\(entries ,\(length audit-entries\)\))
170.4 486 Q(\(timestamp ,\(current-time\)\)\)\)\))170.4 498 Q
(\(audit-append source migration-entry\))136.8 510 Q
(\(audit-append target migration-entry\)\)\)\))136.8 522 Q F1 2.5
(6. Capability)72 540 R(Migration)2.5 E 2.5(6.1. Certi\214cate)72 564 R
-.74(Tr)2.5 G(ansfer).74 E F2
(\(define \(migrate-capabilities source target\))108 582 Q
("Migrate SPKI certificates")117.6 594 Q
(\(let \(\(certs \(soup-query source type: 'certificate\)\)\))117.6 606
Q(\(for-each \(lambda \(cert\))127.2 618 Q
(;; Certificates are content-addressed, transfer directly)184.8 630 Q
(\(let \(\(hash \(cert-hash cert\)\)\))184.8 642 Q
(\(migrate-object hash source target\)\)\))194.4 654 Q(certs\)\)\))175.2
666 Q 0 Cg EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-027 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(6.2. K)72 84 R(ey Migration)-.25 E/F2 8/Courier@0 SF
(;; Private keys require special handling)108 102 Q
(\(define \(migrate-vault-keys source target ceremony-witnesses\))108
114 Q("Migrate vault keys via key ceremony")117.6 126 Q
(;; Never transfer private keys directly!)117.6 138 Q
(;; Use threshold re-sharing or key ceremony)117.6 150 Q
(\(let* \(\(old-shares \(gather-key-shares source\)\))117.6 162 Q
(\(new-key \(generate-new-key target\)\))151.2 174 Q
(\(transition-cert \(create-key-transition-cert)151.2 186 Q
(old-key: \(vault-public-key source\))237.6 198 Q(new-key: new-key)237.6
210 Q(witnesses: ceremony-witnesses\)\)\))237.6 222 Q
(;; Sign transition with old key)127.2 234 Q
(\(sign-transition old-shares transition-cert\))127.2 246 Q
(;; Record in both vaults)127.2 258 Q
(\(audit-append source action: \(key-transition ,transition-cert\)\))
127.2 270 Q(\(audit-append target action: \(key-transition ,transition-\
cert\)\)\)\))127.2 282 Q F1 2.5(6.3. Delegation)72 300 R
(Chain Continuity)2.5 E F2(\(define \(verify-delegation-chains target\))
108 318 Q("Verify all delegation chains remain valid after migration")
117.6 330 Q
(\(let \(\(certs \(soup-query target type: 'certificate\)\)\))117.6 342
Q(\(for-each \(lambda \(cert\))127.2 354 Q
(\(let \(\(chain \(build-chain cert\)\)\))184.8 366 Q
(\(unless \(valid-chain? chain\))194.4 378 Q
(\(warn "Broken delegation chain" cert\)\)\)\))204 390 Q(certs\)\)\))
175.2 402 Q F1 2.5(7. V)72 420 R(eri\214cation)-1 E 0 Cg EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-027 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(7.1. Content)72 84 R -1(Ve)2.5 G(ri\214cation)1 E/F2 8/Courier@0 SF
(\(define \(verify-migration source target\))108 102 Q
("Verify all content transferred correctly")117.6 114 Q
(\(let \(\(source-hashes \(vault-all-hashes source\)\))117.6 126 Q
(\(target-hashes \(vault-all-hashes target\)\)\))146.4 138 Q
(;; Check completeness)127.2 162 Q
(\(let \(\(missing \(set-difference source-hashes target-hashes\)\)\))
127.2 174 Q(\(unless \(null? missing\))136.8 186 Q
(\(error "Missing objects after migration" missing\)\)\))146.4 198 Q
(;; Check integrity \(sample verification for large vaults\))127.2 222 Q
(\(let \(\(sample \(random-sample source-hashes 1000\)\)\))127.2 234 Q
(\(for-each \(lambda \(hash\))136.8 246 Q
(\(unless \(equal? \(cas-get source hash\))194.4 258 Q
(\(cas-get target hash\)\))271.2 270 Q
(\(error "Content mismatch" hash\)\)\))204 282 Q(sample\)\))184.8 294 Q
(;; Check soup metadata)127.2 318 Q(\(for-each \(lambda \(hash\))127.2
330 Q(\(unless \(equal? \(soup-get source hash\))184.8 342 Q
(\(soup-get target hash\)\))261.6 354 Q
(\(error "Soup mismatch" hash\)\)\))194.4 366 Q
(\(random-sample source-hashes 1000\)\)\)\))175.2 378 Q F1 2.5
(7.2. Merkle)72 396 R -1(Ve)2.5 G(ri\214cation)1 E F2
(\(define \(merkle-verify-migration source target\))108 414 Q
("Verify migration via Merkle root comparison")117.6 426 Q
(\(let \(\(source-root \(vault-merkle-root source\)\))117.6 438 Q
(\(target-root \(vault-merkle-root target\)\)\))146.4 450 Q
(\(unless \(equal? source-root target-root\))127.2 462 Q
(;; Find divergence)136.8 474 Q
(\(let \(\(divergence \(find-merkle-divergence source target\)\)\))136.8
486 Q(\(error "Merkle verification failed" divergence\)\)\)\)\))146.4
498 Q F1 2.5(7.3. A)72 516 R(udit V)-.5 E(eri\214cation)-1 E F2
(\(define \(verify-audit-continuity source target\))108 534 Q
("Verify audit trail continuity")117.6 546 Q
(\(let \(\(source-audit \(audit-export source\)\))117.6 558 Q
(\(target-audit \(audit-export target\)\)\))146.4 570 Q
(;; Target should have all source entries plus migration events)127.2
582 Q(\(unless \(subsequence? source-audit target-audit\))127.2 594 Q
(\(error "Audit trail discontinuity"\)\)\)\))136.8 606 Q F1 2.5(8. Cuto)
72 624 R -.1(ve)-.1 G(r).1 E 0 Cg EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-027 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(8.1. Atomic)72 84 R(Cuto)2.5 E -.1(ve)-.1 G(r).1 E/F2 8/Courier@0 SF
(\(define \(atomic-cutover source target migration-id\))108 102 Q
("Atomically switch from source to target")117.6 114 Q
(;; Phase 1: Quiesce source)117.6 126 Q(\(vault-readonly! source\))117.6
138 Q(;; Phase 2: Final sync)117.6 162 Q(\(let \(\(final-changes \(chan\
ges-since source \(last-sync-point\)\)\)\))117.6 174 Q
(\(sync-changes final-changes target\)\))127.2 186 Q(;; Phase 3: Verify)
117.6 210 Q(\(verify-migration source target\))117.6 222 Q
(;; Phase 4: Update DNS/routing)117.6 246 Q
(\(update-vault-routing source target\))117.6 258 Q
(;; Phase 5: Activate target)117.6 282 Q(\(vault-activate! target\))
117.6 294 Q(;; Phase 6: Record completion)117.6 318 Q(\(audit-append ta\
rget action: `\(migration-complete ,migration-id\)\)\))117.6 330 Q F1
2.5(8.2. Rollback)72 348 R F2
(\(define \(migration-rollback migration-id\))108 366 Q
("Rollback failed migration")117.6 378 Q
(\(let \(\(migration \(get-migration migration-id\)\)\))117.6 390 Q
(\(case \(migration-phase migration\))127.2 402 Q(\(\(transfer\))136.8
414 Q(;; Just abandon target)141.6 426 Q
(\(vault-delete! \(migration-target migration\)\)\))141.6 438 Q
(\(\(cutover\))136.8 450 Q(;; Restore routing to source)141.6 462 Q
(\(update-vault-routing \(migration-target migration\))141.6 474 Q
(\(migration-source migration\)\))247.2 486 Q
(\(vault-readonly! \(migration-target migration\)\))141.6 498 Q
(\(vault-activate! \(migration-source migration\)\)\))141.6 510 Q
(\(\(complete\))136.8 522 Q
(\(error "Cannot rollback completed migration"\)\)\)\)\))141.6 534 Q F1
2.5(9. Incr)72 552 R(emental Migration)-.18 E 0 Cg EP
%%Page: 8 8
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-027 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(9.1. Checkpoint)72 84 R(System)2.5 E/F2 8/Courier@0 SF
(\(define \(migration-checkpoint migration-id progress\))108 102 Q
("Save migration progress for resumption")117.6 114 Q
(\(let \(\(checkpoint)117.6 126 Q(`\(checkpoint)151.2 138 Q
(\(migration-id ,migration-id\))160.8 150 Q
(\(timestamp ,\(current-time\)\))160.8 162 Q
(\(transferred ,\(progress-transferred progress\)\))160.8 174 Q
(\(remaining ,\(progress-remaining progress\)\))160.8 186 Q
(\(last-hash ,\(progress-last-hash progress\)\)\)\)\))160.8 198 Q
(\(cas-put \(serialize checkpoint\)\)\)\))127.2 210 Q
(\(define \(resume-migration migration-id\))108 234 Q
("Resume interrupted migration")117.6 246 Q
(\(let \(\(checkpoint \(latest-checkpoint migration-id\)\)\))117.6 258 Q
(\(if checkpoint)127.2 270 Q(\(continue-from-checkpoint checkpoint\))
146.4 282 Q(\(error "No checkpoint found" migration-id\)\)\)\))146.4 294
Q F1 2.5(9.2. Change)72 312 R -.74(Tr)2.5 G(acking).74 E F2
(;; Track changes during migration)108 330 Q
(\(define \(changes-since vault timestamp\))108 342 Q
("Get all changes since timestamp")117.6 354 Q(\(soup-query vault)117.6
366 Q(modified: \(> timestamp\))175.2 378 Q
(order-by: '\(\(modified asc\)\)\)\))175.2 390 Q
(\(define \(sync-changes changes target\))108 414 Q
("Apply changes to target")117.6 426 Q(\(for-each \(lambda \(change\))
117.6 438 Q(\(case \(change-type change\))175.2 450 Q
(\(\(create modify\))184.8 462 Q
(\(migrate-object \(change-hash change\) target\)\))189.6 474 Q
(\(\(delete\))184.8 486 Q
(\(cas-delete target \(change-hash change\)\)\)\)\))189.6 498 Q
(changes\)\))165.6 510 Q F1 2.5(10. Storage)72 528 R(Back)2.5 E
(end Migration)-.1 E 0 Cg EP
%%Page: 9 9
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-027 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(10.1. Back)72 84 R(end Abstraction)-.1 E/F2 8/Courier@0 SF
(;; Migrate between storage backends)108 102 Q
(\(define \(backend-migration vault old-backend new-backend\))108 114 Q
("Migrate vault to different storage backend")117.6 126 Q
(\(for-each \(lambda \(hash\))117.6 138 Q
(\(let \(\(data \(backend-get old-backend hash\)\)\))175.2 150 Q
(\(backend-put new-backend hash data\))184.8 162 Q
(\(verify-backend-transfer hash old-backend new-backend\)\)\))184.8 174
Q(\(backend-all-hashes old-backend\)\)\))165.6 186 Q
(;; Example: S3 to local filesystem)108 210 Q
(\(define \(s3-to-local vault bucket path\))108 222 Q
(\(backend-migration vault)117.6 234 Q(\(make-s3-backend bucket\))208.8
246 Q(\(make-fs-backend path\)\)\))208.8 258 Q F1 2.5(10.2. F)72 276 R
(ormat Con)-.25 E -.1(ve)-.4 G(rsion).1 E F2
(;; Migrate between storage formats)108 294 Q
(\(define \(format-migration vault old-format new-format\))108 306 Q
("Convert storage format during migration")117.6 318 Q
(\(for-each \(lambda \(hash\))117.6 330 Q
(\(let* \(\(old-data \(read-format old-format hash\)\))175.2 342 Q
(\(new-data \(convert-format old-data new-format\)\)\))208.8 354 Q
(\(write-format new-format hash new-data\)\)\))184.8 366 Q
(\(vault-all-hashes vault\)\)\))165.6 378 Q F1 2.5(11. F)72 396 R
(ederation Migration)-.25 E 2.5(11.1. V)72 420 R(ault F)-.92 E
(ederation Changes)-.25 E F2
(\(define \(federation-migrate vault old-federation new-federation\))108
438 Q("Migrate vault between federations")117.6 450 Q
(;; Leave old federation)117.6 462 Q
(\(federation-leave old-federation vault\))117.6 474 Q
(;; Update vault metadata)117.6 498 Q
(\(vault-set-federation! vault new-federation\))117.6 510 Q
(;; Join new federation)117.6 534 Q
(\(federation-join new-federation vault\))117.6 546 Q
(;; Announce to peers)117.6 570 Q
(\(federation-announce new-federation vault\)\))117.6 582 Q F1 2.5
(11.2. Cr)72 600 R(oss-F)-.18 E(ederation T)-.25 E(ransfer)-.74 E F2
(\(define \(cross-federation-transfer hash source-fed target-fed\))108
618 Q("Transfer object between federations")117.6 630 Q
(\(let* \(\(source-vault \(federation-locate source-fed hash\)\))117.6
642 Q(\(target-vault \(federation-select target-fed\)\))151.2 654 Q
(\(obj \(vault-get source-vault hash\)\)\))151.2 666 Q
(\(vault-put target-vault obj\))127.2 678 Q
(\(federation-announce target-fed hash target-vault\)\)\))127.2 690 Q 0
Cg EP
%%Page: 10 10
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-027 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(12. Security)72 84 R(Considerations)2.5 E 2.5(12.1. Migration)72 108
R -.5(Au)2.5 G(thorization).5 E/F2 8/Courier@0 SF
(;; Migration requires appropriate capability)108 126 Q(\(spki-cert)108
138 Q(\(issuer vault-admin\))117.6 150 Q(\(subject migration-operator\))
117.6 162 Q(\(capability)117.6 174 Q(\(action migrate\))127.2 186 Q
(\(object vault-id\)\))127.2 198 Q
(\(validity \(not-after "2026-02-01"\)\)\))117.6 210 Q
(\(define \(authorized-migration? operator source target\))108 234 Q
(\(and \(has-capability? operator 'migrate source\))117.6 246 Q
(\(has-capability? operator 'write target\)\)\))141.6 258 Q F1 2.5
(12.2. Encryption)72 276 R(in T)2.5 E(ransit)-.74 E F2
(\(define \(secure-transfer source target\))108 294 Q
("Transfer with encryption")117.6 306 Q
(\(let \(\(session-key \(establish-session-key source target\)\)\))117.6
318 Q(\(for-each \(lambda \(hash\))127.2 330 Q
(\(let* \(\(data \(cas-get source hash\)\))184.8 342 Q
(\(encrypted \(encrypt session-key data\)\)\))218.4 354 Q
(\(send-encrypted target encrypted\)\)\))194.4 366 Q
(\(vault-all-hashes source\)\)\)\))175.2 378 Q F1 2.5(12.3. Migration)72
396 R -.5(Au)2.5 G(dit).5 E F2(;; All migrations are fully audited)108
414 Q(\(define \(audited-migration source target\))108 426 Q
(\(let \(\(migration-id \(generate-migration-id\)\)\))117.6 438 Q
(\(audit-append action: 'migration-authorized)127.2 450 Q
(migration-id: migration-id)194.4 462 Q(operator: \(current-principal\))
194.4 474 Q(source: source)194.4 486 Q(target: target\))194.4 498 Q
(;; ... perform migration ...)127.2 510 Q
(\(audit-append action: 'migration-complete)127.2 522 Q
(migration-id: migration-id)194.4 534 Q(objects: \(count-migrated\))
194.4 546 Q(verification: \(verification-result\)\)\)\))194.4 558 Q F1
2.5(13. Refer)72 576 R(ences)-.18 E F0 4.282(1. [Li)72 591.6 R 4.582
-.15(ve M)-.25 H 4.282(igration of V).15 F 4.282
(irtual Machines]\(https://dl.acm.or)-.6 F 4.282
(g/doi/10.1145/1095810.1095816\) - Clark et al. 2.)-.18 F 7.862
([RFC-018: Sealed Archi)72 603.6 R 8.162 -.15(ve Fo)-.25 H
(rmat]\(rfc-018-sealed-archi).15 E -.15(ve)-.25 G 7.863
(.html\) 3. [RFC-022: K).15 F 8.163 -.15(ey C)-.25 H(eremon).15 E 10.363
(yP)-.15 G(roto-)-10.363 E(col]\(rfc-022-k)72 615.6 Q -.15(ey)-.1 G
(-ceremon).15 E(y.html\) 4. [RFC-024: Netw)-.15 E
(ork Protocol]\(rfc-024-netw)-.1 E(ork-protocol.html\))-.1 E F1 2.5
(14. Changelog)72 639.6 R F0 6.5<8332>72 655.2 S(026-01-07)-6.5 E 6.5
<8349>72 670.8 S(nitial draft)-6.5 E 0 Cg EP
%%Trailer
end
%%EOF
