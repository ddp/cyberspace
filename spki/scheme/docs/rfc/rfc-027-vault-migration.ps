%!PS-Adobe-3.0
%%Creator: groff version 1.23.0
%%CreationDate: Fri Jan  9 11:29:12 2026
%%DocumentNeededResources: font Times-Roman
%%DocumentSuppliedResources: procset grops 1.23 0
%%Pages: 8
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.23 0
%!PS-Adobe-3.0 Resource-ProcSet
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
% The ASCII code of the space character.
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
% name size font SF -
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
% name a c d font MF -
/MF{
findfont
[5 2 roll
0 3 1 roll % b
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
% Enable manual feed.
% MANUAL -
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
% Guess the page length.
% This assumes that the imageable area is vertically centered on the page.
% PLG - length
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
% BP -
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
% centerx centery radius startangle endangle DA -
/DA{
newpath arcn stroke
}bind def
% x y SN - x' y'
% round a position to nearest (pixel + (.25,.25))
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
% endx endy startx starty DL -
% we round the endpoints of the line, so that parallel horizontal
% and vertical lines will appear even
/DL{
SN
moveto
SN
lineto stroke
}bind def
% centerx centery radius DC -
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
%  width height centerx centery DE -
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
% these are for splines
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
% fill the last path
% r g b Fr -
/Fr{
setrgbcolor fill
}bind def
% c m y k Fk -
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
% g Fg -
/Fg{
setgray fill
}bind def
% fill with the "current color"
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
% new_font_name encoding_vector old_font_name RE -
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
% hpos vpos EBEGIN -
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
% llx lly newwid wid newht ht newllx newlly PBEGIN -
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
% set the graphics state to default values
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
%
%  Any included setpagedevice should be ignored.
%  See: http://www.w-beer.de/doc/ps/.
%
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%EndProlog
%%BeginSetup
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Times-Roman
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/Euro/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Times-Roman@0 ENC0/Times-Roman RE
%%EndSetup
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(RFC-027: V)72 12 Q(ault Migration)-1.11 E 1.95(\
**Status:** Draft **Date:** January 2026 **Author:** Derrell Piper <ddp\
@eludom.net> **Implementation:**)72 36 R(Proposed)72 48 Q(---)72 72 Q
(Abstract)72 96 Q .372(This RFC speci\214es v)72 120 R .372
(ault migration for the Library of Cyberspace: ho)-.25 F 2.872(wt)-.25 G
2.873(om)-2.872 G .673 -.15(ove v)-2.873 H .373
(aults between hosts, storage back-)-.1 F .612(ends, and administrati)72
132 R .912 -.15(ve d)-.25 H .612(omains while preserving content inte)
.15 F(grity)-.15 E 3.111(,c)-.65 G .611
(apability chains, and audit continuity)-3.111 F 3.111(.M)-.65 G(igra-)
-3.111 E(tion is essential for long-term preserv)72 144 Q(ation.)-.25 E
(---)72 168 Q(Moti)72 192 Q -.25(va)-.25 G(tion).25 E -1.11(Va)72 216 S
(ults must outli)1.11 E .3 -.15(ve t)-.25 H(heir infrastructure:).15 E
3.177(-*)72 240 S(*Hardw)-3.177 E .677(are f)-.1 F .677
(ailure** - Disks die, serv)-.1 F .678(ers decommission - **Pro)-.15 F
.678(vider changes** - Cloud v)-.15 F .678(endors come and go -)-.15 F
.468(**Jurisdiction** - Le)72 252 R -.05(ga)-.15 G 2.968(lr).05 G .468
(equirements may force relocation - **Performance** - Mo)-2.968 F .767
-.15(ve c)-.15 H .467(loser to users - **Cost** -).15 F
(Cheaper storage becomes a)72 264 Q -.25(va)-.2 G(ilable).25 E
(Migration must be:)72 288 Q 2.88(-*)72 312 S .38
(*Complete** - All objects, metadata, capabilities - **V)-2.88 F .381
(eri\214able** - Cryptographic proof of inte)-1.11 F .381
(grity - **Resum-)-.15 F(able** - Handle interruptions gracefully - **A\
uditable** - Full trail of what mo)72 324 Q -.15(ve)-.15 G 2.5(dw).15 G
(here)-2.5 E(---)72 348 Q(Migration T)72 372 Q(ypes)-.8 E
(Full Migration)72 396 Q(Mo)72 420 Q .3 -.15(ve e)-.15 H(ntire v).15 E
(ault to ne)-.25 E 2.5(wl)-.25 G(ocation:)-2.5 E -.74(```)72 444 S
(scheme \(de\214ne \(full-migration source-v).74 E(ault tar)-.25 E
(get-host\))-.18 E("Migrate entire v)77 456 Q(ault to ne)-.25 E 2.5(wh)
-.25 G(ost")-2.5 E(\(let \(\(migration-id \(generate-migration-id\)\)\))
77 468 Q(\(audit-append action: `\(migration-start ,migration-id\))82
480 Q(type: 'full)117 492 Q(source: source-v)117 504 Q(ault)-.25 E(tar)
117 516 Q(get: tar)-.18 E(get-host\))-.18 E(;; Phase 1: Snapshot)82 540
Q(\(let \(\(snapshot \(v)82 552 Q(ault-snapshot source-v)-.25 E
(ault\)\)\))-.25 E(;; Phase 2: T)87 564 Q(ransfer)-.35 E(\(transfer)87
576 Q(-snapshot snapshot tar)-.2 E(get-host\))-.18 E(;; Phase 3: V)87
588 Q(erify)-1.11 E(\(v)87 600 Q(erify-transfer snapshot tar)-.15 E
(get-host\))-.18 E(;; Phase 4: Cuto)87 612 Q -.15(ve)-.15 G(r).15 E
(\(cuto)87 624 Q -.15(ve)-.15 G 2.5(rs).15 G(ource-v)-2.5 E(ault tar)
-.25 E(get-host migration-id\)\)\)\) `)-.18 E -.74(``)-.74 G -.15(Pa)72
648 S(rtial Migration).15 E(Mo)72 672 Q .3 -.15(ve s)-.15 H
(ubset of objects:).15 E -.74(```)72 696 S
(scheme \(de\214ne \(partial-migration source-v).74 E(ault tar)-.25 E
(get-host predicate\))-.18 E("Migrate objects matching predicate")77 708
Q(\(let \(\(objects \(soup-query source-v)77 720 Q(ault predicate\)\)\))
-.25 E(\(for)82 732 Q(-each \(lambda \(obj\))-.2 E
(\(migrate-object obj tar)112 744 Q(get-host\)\))-.18 E(objects\)\)\) `)
107 756 Q -.74(``)-.74 G(Li)72 780 Q .3 -.15(ve M)-.25 H(igration).15 E
0 Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(Migrate while v)72 12 Q(ault remains acti)-.25 E
-.15(ve)-.25 G(:).15 E -.74(```)72 36 S(scheme \(de\214ne \(li).74 E
-.15(ve)-.25 G(-migration source-v).15 E(ault tar)-.25 E(get-host\))-.18
E("Migrate without do)77 48 Q(wntime")-.25 E(;; Phase 1: Initial sync)77
60 Q(\(let \(\(checkpoint \(initial-sync source-v)77 72 Q(ault tar)-.25
E(get-host\)\)\))-.18 E(;; Phase 2: Catch up changes)82 84 Q
(\(let loop \(\(last-checkpoint checkpoint\)\))82 96 Q
(\(let \(\(changes \(changes-since source-v)87 108 Q
(ault last-checkpoint\)\)\))-.25 E
(\(if \(< \(length changes\) *catchup-threshold*\))92 120 Q
(;; Phase 3: Final cuto)102 132 Q -.15(ve)-.15 G 2.5(r\().15 G
(brief pause\))-2.5 E(\(atomic-cuto)102 144 Q -.15(ve)-.15 G 2.5(rs).15
G(ource-v)-2.5 E(ault tar)-.25 E(get-host changes\))-.18 E
(\(loop \(sync-changes changes tar)102 156 Q(get-host\)\)\)\)\)\)\) `)
-.18 E -.74(``)-.74 G(---)72 180 Q(Object T)72 204 Q(ransfer)-.35 E
(Export F)72 228 Q(ormat)-.15 E -.74(```)72 252 S
(scheme ;; Sealed archi).74 E .3 -.15(ve f)-.25 H
(ormat \(RFC-018\) \(de\214ne \(e).15 E(xport-object hash\))-.15 E(`\(v)
77 264 Q(ault-object)-.25 E(\(hash ,hash\))82 276 Q
(\(content ,\(cas-get hash\)\))82 288 Q
(\(soup-entry ,\(soup-get hash\)\))82 300 Q
(\(references ,\(object-references hash\)\))82 312 Q
(\(signatures ,\(object-signatures hash\)\)\)\))82 324 Q(\(de\214ne \(e)
72 348 Q(xport-batch hashes\))-.15 E(\(let \(\(objects \(map e)77 360 Q
(xport-object hashes\)\)\))-.15 E(\(seal-archi)82 372 Q .3 -.15(ve o)
-.25 H(bjects).15 E(compression: 'zstd)87 384 Q(encryption: tar)87 396 Q
(get-v)-.18 E(ault-k)-.25 E -.15(ey)-.1 G(\)\)\) `).15 E -.74(``)-.74 G
-.35(Tr)72 420 S(ansfer Protocol).35 E -.74(```)72 444 S
(scheme \(de\214ne \(transfer).74 E(-object obj source tar)-.2 E(get\))
-.18 E("T)77 456 Q(ransfer single object with v)-.35 E(eri\214cation")
-.15 E(\(let* \(\(hash \(object-hash obj\)\))77 468 Q(\(data \(e)94.5
480 Q(xport-object hash\)\)\))-.15 E(;; Send to tar)82 492 Q(get)-.18 E
(\(v)82 504 Q(ault-send tar)-.25 E(get data\))-.18 E(;; Get ackno)82 516
Q(wledgment with hash)-.25 E(\(let \(\(ack \(v)82 528 Q(ault-recei)-.25
E .3 -.15(ve t)-.25 H(ar).15 E(get\)\)\))-.18 E
(\(unless \(equal? \(ack-hash ack\) hash\))87 540 Q(\(error "T)92 552 Q
(ransfer v)-.35 E(eri\214cation f)-.15 E(ailed" hash\)\))-.1 E
(\(audit-append action: `\(object-transferred ,hash\))87 564 Q
(source: source)122 576 Q(tar)122 588 Q(get: tar)-.18 E(get\)\)\)\) `)
-.18 E -.74(``)-.74 G(Streaming T)72 612 Q(ransfer)-.35 E -.74(```)72
636 S(scheme \(de\214ne \(stream-transfer source tar).74 E(get\))-.18 E
("Stream objects for ef)77 648 Q(\214cient b)-.25 E(ulk transfer")-.2 E
(\(let \(\(stream \(open-transfer)77 660 Q(-stream source tar)-.2 E
(get\)\)\))-.18 E(\(for)82 672 Q(-each \(lambda \(hash\))-.2 E
(\(let \(\(obj \(e)112 684 Q(xport-object hash\)\)\))-.15 E
(\(stream-write stream obj\))117 696 Q(\(when \(stream-b)117 708 Q(uf)
-.2 E(fer)-.25 E(-full? stream\))-.2 E(\(stream-\215ush stream\)\)\)\))
122 720 Q(\(v)107 732 Q(ault-all-hashes source\)\))-.25 E
(\(stream-close stream\)\)\) `)82 744 Q -.74(``)-.74 G(---)72 768 Q
(Metadata Migration)72 792 Q 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(Soup Entries)72 24 Q -.74(```)72 48 S
(scheme \(de\214ne \(migrate-soup-entry hash source tar).74 E(get\))-.18
E("Migrate soup metadata for object")77 60 Q
(\(let \(\(entry \(soup-get source hash\)\)\))77 72 Q(\(when entry)82 84
Q(\(soup-put tar)87 96 Q(get hash entry\))-.18 E(;; V)87 108 Q(erify)
-1.11 E(\(unless \(equal? \(soup-get tar)87 120 Q(get hash\) entry\))
-.18 E(\(error "Soup entry migration f)92 132 Q(ailed" hash\)\)\)\)\) `)
-.1 E -.74(``)-.74 G(Inde)72 156 Q 2.5(xM)-.15 G(igration)-2.5 E -.74
(```)72 180 S(scheme \(de\214ne \(migrate-inde).74 E -.15(xe)-.15 G 2.5
(ss).15 G(ource tar)-2.5 E(get\))-.18 E("Reb)77 192 Q(uild inde)-.2 E
-.15(xe)-.15 G 2.5(so).15 G 2.5(nt)-2.5 G(ar)-2.5 E(get")-.18 E
(;; Option 1: Export and import inde)77 204 Q 2.5(xd)-.15 G(ata)-2.5 E
(\(let \(\(inde)77 216 Q(x-data \(e)-.15 E(xport-inde)-.15 E -.15(xe)
-.15 G 2.5(ss).15 G(ource\)\)\))-2.5 E(\(import-inde)82 228 Q -.15(xe)
-.15 G 2.5(st).15 G(ar)-2.5 E(get inde)-.18 E(x-data\)\))-.15 E
(;; Option 2: Reb)77 252 Q(uild from soup \(slo)-.2 E(wer b)-.25 E
(ut guaranteed correct\))-.2 E(\(reb)77 264 Q(uild-inde)-.2 E -.15(xe)
-.15 G 2.5(st).15 G(ar)-2.5 E(get\)\) `)-.18 E -.74(``)-.74 G(Audit T)72
288 Q(rail)-.35 E -.74(```)72 312 S
(scheme \(de\214ne \(migrate-audit source tar).74 E(get\))-.18 E
("Migrate audit trail \(critical for pro)77 324 Q -.15(ve)-.15 G
(nance\)").15 E(\(let \(\(audit-entries \(audit-e)77 336 Q
(xport source\)\)\))-.15 E(;; Audit entries are append-only)82 348 Q 2.5
(,t)-.65 G(ransfer in order)-2.5 E(\(for)82 360 Q
(-each \(lambda \(entry\))-.2 E(\(audit-import tar)112 372 Q
(get entry\)\))-.18 E(audit-entries\))107 384 Q(;; Add migration e)82
396 Q -.15(ve)-.25 G(nt to both).15 E(\(let \(\(migration-entry)82 408 Q
(`\(migration-audit)99.5 420 Q(\(source ,source\))104.5 432 Q(\(tar)
104.5 444 Q(get ,tar)-.18 E(get\))-.18 E
(\(entries ,\(length audit-entries\)\))104.5 456 Q
(\(timestamp ,\(current-time\)\)\)\)\))104.5 468 Q
(\(audit-append source migration-entry\))87 480 Q(\(audit-append tar)87
492 Q(get migration-entry\)\)\)\) `)-.18 E -.74(``)-.74 G(---)72 516 Q
(Capability Migration)72 540 Q(Certi\214cate T)72 564 Q(ransfer)-.35 E
-.74(```)72 588 S(scheme \(de\214ne \(migrate-capabilities source tar)
.74 E(get\))-.18 E("Migrate SPKI certi\214cates")77 600 Q
(\(let \(\(certs \(soup-query source type: 'certi\214cate\)\)\))77 612 Q
(\(for)82 624 Q(-each \(lambda \(cert\))-.2 E
(;; Certi\214cates are content-addressed, transfer directly)112 636 Q
(\(let \(\(hash \(cert-hash cert\)\)\))112 648 Q
(\(migrate-object hash source tar)117 660 Q(get\)\)\))-.18 E
(certs\)\)\) `)107 672 Q -.74(``)-.74 G -2.15 -.25(Ke y)72 696 T
(Migration)2.75 E -.74(```)72 720 S(scheme ;; Pri).74 E -.25(va)-.25 G
(te k).25 E -.15(ey)-.1 G 2.5(sr).15 G
(equire special handling \(de\214ne \(migrate-v)-2.5 E(ault-k)-.25 E
-.15(ey)-.1 G 2.5(ss).15 G(ource tar)-2.5 E(get ceremon)-.18 E
(y-witnesses\))-.15 E("Migrate v)77 732 Q(ault k)-.25 E -.15(ey)-.1 G
2.5(sv).15 G(ia k)-2.5 E .3 -.15(ey c)-.1 H(eremon).15 E(y")-.15 E
(;; Ne)77 744 Q -.15(ve)-.25 G 2.5(rt).15 G(ransfer pri)-2.5 E -.25(va)
-.25 G(te k).25 E -.15(ey)-.1 G 2.5(sd).15 G(irectly!)-2.5 E
(;; Use threshold re-sharing or k)77 756 Q .3 -.15(ey c)-.1 H(eremon).15
E(y)-.15 E(\(let* \(\(old-shares \(g)77 768 Q(ather)-.05 E(-k)-.2 E -.15
(ey)-.1 G(-shares source\)\)).15 E(\(ne)94.5 780 Q(w-k)-.25 E .3 -.15
(ey \()-.1 H(generate-ne).15 E(w-k)-.25 E .3 -.15(ey t)-.1 H(ar).15 E
(get\)\))-.18 E(\(transition-cert \(create-k)94.5 792 Q -.15(ey)-.1 G
(-transition-cert).15 E 0 Cg EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(old-k)139.5 12 Q -.15(ey)-.1 G 2.5(:\().15 G
-.25(va)-2.5 G(ult-public-k).25 E .3 -.15(ey s)-.1 H(ource\)).15 E(ne)
139.5 24 Q(w-k)-.25 E -.15(ey)-.1 G 2.5(:n).15 G -.25(ew)-2.5 G(-k).25 E
-.15(ey)-.1 G(witnesses: ceremon)139.5 36 Q(y-witnesses\)\)\))-.15 E
(;; Sign transition with old k)82 48 Q -.15(ey)-.1 G
(\(sign-transition old-shares transition-cert\))82 60 Q
(;; Record in both v)82 72 Q(aults)-.25 E
(\(audit-append source action: `\(k)82 84 Q -.15(ey)-.1 G
(-transition ,transition-cert\)\)).15 E(\(audit-append tar)82 96 Q
(get action: `\(k)-.18 E -.15(ey)-.1 G
(-transition ,transition-cert\)\)\)\) `).15 E -.74(``)-.74 G(Dele)72 120
Q -.05(ga)-.15 G(tion Chain Continuity).05 E -.74(```)72 144 S
(scheme \(de\214ne \(v).74 E(erify-dele)-.15 E -.05(ga)-.15 G
(tion-chains tar).05 E(get\))-.18 E("V)77 156 Q(erify all dele)-1.11 E
-.05(ga)-.15 G(tion chains remain v).05 E(alid after migration")-.25 E
(\(let \(\(certs \(soup-query tar)77 168 Q
(get type: 'certi\214cate\)\)\))-.18 E(\(for)82 180 Q
(-each \(lambda \(cert\))-.2 E(\(let \(\(chain \(b)112 192 Q
(uild-chain cert\)\)\))-.2 E(\(unless \(v)117 204 Q(alid-chain? chain\))
-.25 E(\(w)122 216 Q(arn "Brok)-.1 E(en dele)-.1 E -.05(ga)-.15 G
(tion chain" cert\)\)\)\)).05 E(certs\)\)\) `)107 228 Q -.74(``)-.74 G
(---)72 252 Q -1.11(Ve)72 276 S(ri\214cation)1.11 E(Content V)72 300 Q
(eri\214cation)-1.11 E -.74(```)72 324 S(scheme \(de\214ne \(v).74 E
(erify-migration source tar)-.15 E(get\))-.18 E("V)77 336 Q
(erify all content transferred correctly")-1.11 E
(\(let \(\(source-hashes \(v)77 348 Q(ault-all-hashes source\)\))-.25 E
(\(tar)92 360 Q(get-hashes \(v)-.18 E(ault-all-hashes tar)-.25 E
(get\)\)\))-.18 E(;; Check completeness)82 384 Q
(\(let \(\(missing \(set-dif)82 396 Q(ference source-hashes tar)-.25 E
(get-hashes\)\)\))-.18 E(\(unless \(null? missing\))87 408 Q
(\(error "Missing objects after migration" missing\)\)\))92 420 Q
(;; Check inte)82 444 Q(grity \(sample v)-.15 E(eri\214cation for lar)
-.15 E(ge v)-.18 E(aults\))-.25 E
(\(let \(\(sample \(random-sample source-hashes 1000\)\)\))82 456 Q
(\(for)87 468 Q(-each \(lambda \(hash\))-.2 E
(\(unless \(equal? \(cas-get source hash\))117 480 Q(\(cas-get tar)157
492 Q(get hash\)\))-.18 E(\(error "Content mismatch" hash\)\)\))122 504
Q(sample\)\))112 516 Q(;; Check soup metadata)82 540 Q(\(for)82 552 Q
(-each \(lambda \(hash\))-.2 E
(\(unless \(equal? \(soup-get source hash\))112 564 Q(\(soup-get tar)152
576 Q(get hash\)\))-.18 E(\(error "Soup mismatch" hash\)\)\))117 588 Q
(\(random-sample source-hashes 1000\)\)\)\) `)107 600 Q -.74(``)-.74 G
(Merkle V)72 624 Q(eri\214cation)-1.11 E -.74(```)72 648 S
(scheme \(de\214ne \(merkle-v).74 E(erify-migration source tar)-.15 E
(get\))-.18 E("V)77 660 Q(erify migration via Merkle root comparison")
-1.11 E(\(let \(\(source-root \(v)77 672 Q(ault-merkle-root source\)\))
-.25 E(\(tar)92 684 Q(get-root \(v)-.18 E(ault-merkle-root tar)-.25 E
(get\)\)\))-.18 E(\(unless \(equal? source-root tar)82 696 Q(get-root\))
-.18 E(;; Find di)87 708 Q -.15(ve)-.25 G -.18(rg).15 G(ence).18 E
(\(let \(\(di)87 720 Q -.15(ve)-.25 G -.18(rg).15 G
(ence \(\214nd-merkle-di).18 E -.15(ve)-.25 G -.18(rg).15 G
(ence source tar).18 E(get\)\)\))-.18 E(\(error "Merkle v)92 732 Q
(eri\214cation f)-.15 E(ailed" di)-.1 E -.15(ve)-.25 G -.18(rg).15 G
(ence\)\)\)\)\) `).18 E -.74(``)-.74 G(Audit V)72 756 Q(eri\214cation)
-1.11 E -.74(```)72 780 S(scheme \(de\214ne \(v).74 E
(erify-audit-continuity source tar)-.15 E(get\))-.18 E("V)77 792 Q
(erify audit trail continuity")-1.11 E 0 Cg EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(let \(\(source-audit \(audit-e)77 12 Q
(xport source\)\))-.15 E(\(tar)92 24 Q(get-audit \(audit-e)-.18 E
(xport tar)-.15 E(get\)\)\))-.18 E(;; T)82 36 Q(ar)-.8 E(get should ha)
-.18 E .3 -.15(ve a)-.2 H(ll source entries plus migration e).15 E -.15
(ve)-.25 G(nts).15 E(\(unless \(subsequence? source-audit tar)82 48 Q
(get-audit\))-.18 E(\(error "Audit trail discontinuity"\)\)\)\) `)87 60
Q -.74(``)-.74 G(---)72 84 Q(Cuto)72 108 Q -.15(ve)-.15 G(r).15 E
(Atomic Cuto)72 132 Q -.15(ve)-.15 G(r).15 E -.74(```)72 156 S
(scheme \(de\214ne \(atomic-cuto).74 E -.15(ve)-.15 G 2.5(rs).15 G
(ource tar)-2.5 E(get migration-id\))-.18 E
("Atomically switch from source to tar)77 168 Q(get")-.18 E
(;; Phase 1: Quiesce source)77 180 Q(\(v)77 192 Q
(ault-readonly! source\))-.25 E(;; Phase 2: Final sync)77 216 Q(\(let \
\(\(\214nal-changes \(changes-since source \(last-sync-point\)\)\)\))77
228 Q(\(sync-changes \214nal-changes tar)82 240 Q(get\)\))-.18 E
(;; Phase 3: V)77 264 Q(erify)-1.11 E(\(v)77 276 Q
(erify-migration source tar)-.15 E(get\))-.18 E
(;; Phase 4: Update DNS/routing)77 300 Q(\(update-v)77 312 Q
(ault-routing source tar)-.25 E(get\))-.18 E(;; Phase 5: Acti)77 336 Q
-.25(va)-.25 G(te tar).25 E(get)-.18 E(\(v)77 348 Q(ault-acti)-.25 E
-.25(va)-.25 G(te! tar).25 E(get\))-.18 E(;; Phase 6: Record completion)
77 372 Q(\(audit-append tar)77 384 Q
(get action: `\(migration-complete ,migration-id\)\)\) `)-.18 E -.74(``)
-.74 G(Rollback)72 408 Q -.74(```)72 432 S
(scheme \(de\214ne \(migration-rollback migration-id\)).74 E
("Rollback f)77 444 Q(ailed migration")-.1 E
(\(let \(\(migration \(get-migration migration-id\)\)\))77 456 Q
(\(case \(migration-phase migration\))82 468 Q(\(\(transfer\))87 480 Q
(;; Just abandon tar)89.5 492 Q(get)-.18 E(\(v)89.5 504 Q
(ault-delete! \(migration-tar)-.25 E(get migration\)\)\))-.18 E
(\(\(cuto)87 516 Q -.15(ve)-.15 G(r\)).15 E
(;; Restore routing to source)89.5 528 Q(\(update-v)89.5 540 Q
(ault-routing \(migration-tar)-.25 E(get migration\))-.18 E
(\(migration-source migration\)\))144.5 552 Q(\(v)89.5 564 Q
(ault-readonly! \(migration-tar)-.25 E(get migration\)\))-.18 E(\(v)89.5
576 Q(ault-acti)-.25 E -.25(va)-.25 G
(te! \(migration-source migration\)\)\)).25 E(\(\(complete\))87 588 Q
(\(error "Cannot rollback completed migration"\)\)\)\)\) `)89.5 600 Q
-.74(``)-.74 G(---)72 624 Q(Incremental Migration)72 648 Q
(Checkpoint System)72 672 Q -.74(```)72 696 S
(scheme \(de\214ne \(migration-checkpoint migration-id progress\)).74 E
("Sa)77 708 Q .3 -.15(ve m)-.2 H(igration progress for resumption").15 E
(\(let \(\(checkpoint)77 720 Q(`\(checkpoint)94.5 732 Q
(\(migration-id ,migration-id\))99.5 744 Q
(\(timestamp ,\(current-time\)\))99.5 756 Q
(\(transferred ,\(progress-transferred progress\)\))99.5 768 Q
(\(remaining ,\(progress-remaining progress\)\))99.5 780 Q
(\(last-hash ,\(progress-last-hash progress\)\)\)\)\))99.5 792 Q 0 Cg EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(cas-put \(serialize checkpoint\)\)\)\))82 12 Q
(\(de\214ne \(resume-migration migration-id\))72 36 Q
("Resume interrupted migration")77 48 Q
(\(let \(\(checkpoint \(latest-checkpoint migration-id\)\)\))77 60 Q
(\(if checkpoint)82 72 Q(\(continue-from-checkpoint checkpoint\))92 84 Q
(\(error "No checkpoint found" migration-id\)\)\)\) `)92 96 Q -.74(``)
-.74 G(Change T)72 120 Q(racking)-.35 E -.74(```)72 144 S(scheme ;; T)
.74 E(rack changes during migration \(de\214ne \(changes-since v)-.35 E
(ault timestamp\))-.25 E("Get all changes since timestamp")77 156 Q
(\(soup-query v)77 168 Q(ault)-.25 E(modi\214ed: \(> timestamp\))107 180
Q(order)107 192 Q(-by: '\(\(modi\214ed asc\)\)\)\))-.2 E
(\(de\214ne \(sync-changes changes tar)72 216 Q(get\))-.18 E
("Apply changes to tar)77 228 Q(get")-.18 E(\(for)77 240 Q
(-each \(lambda \(change\))-.2 E(\(case \(change-type change\))107 252 Q
(\(\(create modify\))112 264 Q
(\(migrate-object \(change-hash change\) tar)114.5 276 Q(get\)\))-.18 E
(\(\(delete\))112 288 Q(\(cas-delete tar)114.5 300 Q
(get \(change-hash change\)\)\)\)\))-.18 E(changes\)\) `)102 312 Q -.74
(``)-.74 G(---)72 336 Q(Storage Back)72 360 Q(end Migration)-.1 E(Back)
72 384 Q(end Abstraction)-.1 E -.74(```)72 408 S
(scheme ;; Migrate between storage back).74 E(ends \(de\214ne \(back)-.1
E(end-migration v)-.1 E(ault old-back)-.25 E(end ne)-.1 E(w-back)-.25 E
(end\))-.1 E("Migrate v)77 420 Q(ault to dif)-.25 E(ferent storage back)
-.25 E(end")-.1 E(\(for)77 432 Q(-each \(lambda \(hash\))-.2 E
(\(let \(\(data \(back)107 444 Q(end-get old-back)-.1 E(end hash\)\)\))
-.1 E(\(back)112 456 Q(end-put ne)-.1 E(w-back)-.25 E(end hash data\))
-.1 E(\(v)112 468 Q(erify-back)-.15 E(end-transfer hash old-back)-.1 E
(end ne)-.1 E(w-back)-.25 E(end\)\)\))-.1 E(\(back)102 480 Q
(end-all-hashes old-back)-.1 E(end\)\)\))-.1 E
(;; Example: S3 to local \214lesystem \(de\214ne \(s3-to-local v)72 504
Q(ault b)-.25 E(uck)-.2 E(et path\))-.1 E(\(back)77 516 Q
(end-migration v)-.1 E(ault)-.25 E(\(mak)124.5 528 Q(e-s3-back)-.1 E
(end b)-.1 E(uck)-.2 E(et\))-.1 E(\(mak)124.5 540 Q(e-fs-back)-.1 E
(end path\)\)\) `)-.1 E -.74(``)-.74 G -.15(Fo)72 564 S(rmat Con).15 E
-.15(ve)-.4 G(rsion).15 E -.74(```)72 588 S(scheme ;; Migrate between s\
torage formats \(de\214ne \(format-migration v).74 E(ault old-format ne)
-.25 E(w-format\))-.25 E("Con)77 600 Q -.15(ve)-.4 G
(rt storage format during migration").15 E(\(for)77 612 Q
(-each \(lambda \(hash\))-.2 E
(\(let* \(\(old-data \(read-format old-format hash\)\))107 624 Q(\(ne)
124.5 636 Q(w-data \(con)-.25 E -.15(ve)-.4 G(rt-format old-data ne).15
E(w-format\)\)\))-.25 E(\(write-format ne)112 648 Q(w-format hash ne)
-.25 E(w-data\)\)\))-.25 E(\(v)102 660 Q(ault-all-hashes v)-.25 E
(ault\)\)\) `)-.25 E -.74(``)-.74 G(---)72 684 Q(Federation Migration)72
708 Q -1.11(Va)72 732 S(ult Federation Changes)1.11 E -.74(```)72 756 S
(scheme \(de\214ne \(federation-migrate v).74 E(ault old-federation ne)
-.25 E(w-federation\))-.25 E("Migrate v)77 768 Q
(ault between federations")-.25 E(;; Lea)77 780 Q .3 -.15(ve o)-.2 H
(ld federation).15 E(\(federation-lea)77 792 Q .3 -.15(ve o)-.2 H
(ld-federation v).15 E(ault\))-.25 E 0 Cg EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(;; Update v)77 24 Q(ault metadata)-.25 E(\(v)77
36 Q(ault-set-federation! v)-.25 E(ault ne)-.25 E(w-federation\))-.25 E
(;; Join ne)77 60 Q 2.5(wf)-.25 G(ederation)-2.5 E(\(federation-join ne)
77 72 Q(w-federation v)-.25 E(ault\))-.25 E(;; Announce to peers)77 96 Q
(\(federation-announce ne)77 108 Q(w-federation v)-.25 E(ault\)\) `)-.25
E -.74(``)-.74 G(Cross-Federation T)72 132 Q(ransfer)-.35 E -.74(```)72
156 S(scheme \(de\214ne \(cross-federation-transfer hash source-fed tar)
.74 E(get-fed\))-.18 E("T)77 168 Q(ransfer object between federations")
-.35 E(\(let* \(\(source-v)77 180 Q
(ault \(federation-locate source-fed hash\)\))-.25 E(\(tar)94.5 192 Q
(get-v)-.18 E(ault \(federation-select tar)-.25 E(get-fed\)\))-.18 E
(\(obj \(v)94.5 204 Q(ault-get source-v)-.25 E(ault hash\)\)\))-.25 E
(\(v)82 216 Q(ault-put tar)-.25 E(get-v)-.18 E(ault obj\))-.25 E
(\(federation-announce tar)82 228 Q(get-fed hash tar)-.18 E(get-v)-.18 E
(ault\)\)\) `)-.25 E -.74(``)-.74 G(---)72 252 Q
(Security Considerations)72 276 Q(Migration Authorization)72 300 Q -.74
(```)72 324 S
(scheme ;; Migration requires appropriate capability \(spki-cert).74 E
(\(issuer v)77 336 Q(ault-admin\))-.25 E(\(subject migration-operator\))
77 348 Q(\(capability)77 360 Q(\(action migrate\))82 372 Q(\(object v)82
384 Q(ault-id\)\))-.25 E(\(v)77 396 Q
(alidity \(not-after "2026-02-01"\)\)\))-.25 E
(\(de\214ne \(authorized-migration? operator source tar)72 420 Q(get\))
-.18 E(\(and \(has-capability? operator 'migrate source\))77 432 Q
(\(has-capability? operator 'write tar)89.5 444 Q(get\)\)\) `)-.18 E
-.74(``)-.74 G(Encryption in T)72 468 Q(ransit)-.35 E -.74(```)72 492 S
(scheme \(de\214ne \(secure-transfer source tar).74 E(get\))-.18 E("T)77
504 Q(ransfer with encryption")-.35 E(\(let \(\(session-k)77 516 Q .3
-.15(ey \()-.1 H(establish-session-k).15 E .3 -.15(ey s)-.1 H(ource tar)
.15 E(get\)\)\))-.18 E(\(for)82 528 Q(-each \(lambda \(hash\))-.2 E
(\(let* \(\(data \(cas-get source hash\)\))112 540 Q
(\(encrypted \(encrypt session-k)129.5 552 Q .3 -.15(ey d)-.1 H
(ata\)\)\)).15 E(\(send-encrypted tar)117 564 Q(get encrypted\)\)\))-.18
E(\(v)107 576 Q(ault-all-hashes source\)\)\)\) `)-.25 E -.74(``)-.74 G
(Migration Audit)72 600 Q -.74(```)72 624 S(scheme ;; All migrations ar\
e fully audited \(de\214ne \(audited-migration source tar).74 E(get\))
-.18 E(\(let \(\(migration-id \(generate-migration-id\)\)\))77 636 Q
(\(audit-append action: 'migration-authorized)82 648 Q
(migration-id: migration-id)117 660 Q(operator: \(current-principal\))
117 672 Q(source: source)117 684 Q(tar)117 696 Q(get: tar)-.18 E(get\))
-.18 E(;; ... perform migration ...)82 708 Q
(\(audit-append action: 'migration-complete)82 720 Q
(migration-id: migration-id)117 732 Q(objects: \(count-migrated\))117
744 Q -.15(ve)117 756 S(ri\214cation: \(v).15 E
(eri\214cation-result\)\)\)\) `)-.15 E -.74(``)-.74 G(---)72 780 Q 0 Cg
EP
%%Page: 8 8
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(References)72 12 Q 4.032(1. [Li)72 36 R 4.332
-.15(ve M)-.25 H 4.032(igration of V).15 F 4.032
(irtual Machines]\(https://dl.acm.or)-.6 F 4.032
(g/doi/10.1145/1095810.1095816\) - Clark et al.)-.18 F(2.)9.032 E .328
([RFC-018: Sealed Archi)72 48 R .629 -.15(ve Fo)-.25 H
(rmat]\(rfc-018-sealed-archi).15 E -.15(ve)-.25 G .329
(.md\) 3. [RFC-022: K).15 F .629 -.15(ey C)-.25 H(eremon).15 E 2.829(yP)
-.15 G(rotocol]\(rfc-022-k)-2.829 E -.15(ey)-.1 G(-).15 E(ceremon)72 60
Q -.65(y.)-.15 G(md\) 4. [RFC-024: Netw).65 E
(ork Protocol]\(rfc-024-netw)-.1 E(ork-protocol.md\))-.1 E(---)72 84 Q
(Changelog)72 108 Q 2.5(-*)72 132 S(*2026-01-07** - Initial draft)-2.5 E
(---)72 156 Q .124(**Implementation Status:** Draft **Dependencies:** v)
72 180 R .124(ault, cas, soup, federation **Inte)-.25 F .124
(gration:** V)-.15 F .124(ault operations,)-1.11 F
(federation, disaster reco)72 192 Q -.15(ve)-.15 G(ry).15 E 0 Cg EP
%%Trailer
end
%%EOF
