%!PS-Adobe-3.0
%%Creator: groff version 1.23.0
%%CreationDate: Thu Jan  8 15:17:54 2026
%%DocumentNeededResources: font Times-Roman
%%DocumentSuppliedResources: procset grops 1.23 0
%%Pages: 8
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.23 0
%!PS-Adobe-3.0 Resource-ProcSet
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
% The ASCII code of the space character.
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
% name size font SF -
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
% name a c d font MF -
/MF{
findfont
[5 2 roll
0 3 1 roll % b
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
% Enable manual feed.
% MANUAL -
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
% Guess the page length.
% This assumes that the imageable area is vertically centered on the page.
% PLG - length
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
% BP -
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
% centerx centery radius startangle endangle DA -
/DA{
newpath arcn stroke
}bind def
% x y SN - x' y'
% round a position to nearest (pixel + (.25,.25))
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
% endx endy startx starty DL -
% we round the endpoints of the line, so that parallel horizontal
% and vertical lines will appear even
/DL{
SN
moveto
SN
lineto stroke
}bind def
% centerx centery radius DC -
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
%  width height centerx centery DE -
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
% these are for splines
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
% fill the last path
% r g b Fr -
/Fr{
setrgbcolor fill
}bind def
% c m y k Fk -
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
% g Fg -
/Fg{
setgray fill
}bind def
% fill with the "current color"
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
% new_font_name encoding_vector old_font_name RE -
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
% hpos vpos EBEGIN -
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
% llx lly newwid wid newht ht newllx newlly PBEGIN -
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
% set the graphics state to default values
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
%
%  Any included setpagedevice should be ignored.
%  See: http://www.w-beer.de/doc/ps/.
%
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%EndProlog
%%BeginSetup
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Times-Roman
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/Euro/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Times-Roman@0 ENC0/Times-Roman RE
%%EndSetup
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(RFC-027: V)72 12 Q(ault Migration)-1.11 E(Statu\
s: Draft Date: January 2026 Author: Derrell Piper ddp@eludom.net Implem\
entation: Proposed)72 36 Q(--------------------------------------------\
----------------------------------)72 60 Q(Abstract)72 84 Q .373
(This RFC speci\214es v)72 108 R .372
(ault migration for the Library of Cyberspace: ho)-.25 F 2.872(wt)-.25 G
2.872(om)-2.872 G .672 -.15(ove v)-2.872 H .372
(aults between hosts, storage back-)-.1 F .419(ends, and administrati)72
120 R .719 -.15(ve d)-.25 H .419(omains while preserving content inte)
.15 F(grity)-.15 E 2.919(,c)-.65 G .419
(apability chains, and audit continuity)-2.919 F 5.42(.M)-.65 G(igra-)
-5.42 E(tion is essential for long-term preserv)72 132 Q(ation.)-.25 E(\
-----------------------------------------------------------------------\
-------)72 156 Q(Moti)72 180 Q -.25(va)-.25 G(tion).25 E -1.11(Va)72 204
S(ults must outli)1.11 E .3 -.15(ve t)-.25 H(heir infrastructure:).15 E
2.631(-H)72 228 S(ardw)-2.631 E .131(are f)-.1 F .131
(ailure - Disks die, serv)-.1 F .131(ers decommission - Pro)-.15 F .13
(vider changes - Cloud v)-.15 F .13(endors come and go - Jurisdiction)
-.15 F 3.164(-L)72 240 S -2.25 -.15(eg a)-3.164 H 3.164(lr).15 G .664
(equirements may force relocation - Performance - Mo)-3.164 F .964 -.15
(ve c)-.15 H .665(loser to users - Cost - Cheaper storage becomes).15 F
-.2(av)72 252 S(ailable)-.05 E(Migration must be:)72 276 Q 2.805(-C)72
300 S .304(omplete - All objects, metadata, capabilities - V)-2.805 F
.304(eri\214able - Cryptographic proof of inte)-1.11 F .304
(grity - Resumable - Handle)-.15 F
(interruptions gracefully - Auditable - Full trail of what mo)72 312 Q
-.15(ve)-.15 G 2.5(dw).15 G(here)-2.5 E(-------------------------------\
-----------------------------------------------)72 336 Q(Migration T)72
360 Q(ypes)-.8 E(Full Migration)72 384 Q(Mo)72 408 Q .3 -.15(ve e)-.15 H
(ntire v).15 E(ault to ne)-.25 E 2.5(wl)-.25 G(ocation:)-2.5 E
(\(de\214ne \(full-migration source-v)82 432 Q(ault tar)-.25 E
(get-host\))-.18 E("Migrate entire v)87 444 Q(ault to ne)-.25 E 2.5(wh)
-.25 G(ost")-2.5 E(\(let \(\(migration-id \(generate-migration-id\)\)\))
87 456 Q(\(audit-append action: `\(migration-start ,migration-id\))92
468 Q(type: 'full)127 480 Q(source: source-v)127 492 Q(ault)-.25 E(tar)
127 504 Q(get: tar)-.18 E(get-host\))-.18 E(;; Phase 1: Snapshot)92 528
Q(\(let \(\(snapshot \(v)92 540 Q(ault-snapshot source-v)-.25 E
(ault\)\)\))-.25 E(;; Phase 2: T)97 552 Q(ransfer)-.35 E(\(transfer)97
564 Q(-snapshot snapshot tar)-.2 E(get-host\))-.18 E(;; Phase 3: V)97
576 Q(erify)-1.11 E(\(v)97 588 Q(erify-transfer snapshot tar)-.15 E
(get-host\))-.18 E(;; Phase 4: Cuto)97 600 Q -.15(ve)-.15 G(r).15 E
(\(cuto)97 612 Q -.15(ve)-.15 G 2.5(rs).15 G(ource-v)-2.5 E(ault tar)
-.25 E(get-host migration-id\)\)\)\))-.18 E -.15(Pa)72 636 S
(rtial Migration).15 E(Mo)72 660 Q .3 -.15(ve s)-.15 H
(ubset of objects:).15 E(\(de\214ne \(partial-migration source-v)82 684
Q(ault tar)-.25 E(get-host predicate\))-.18 E
("Migrate objects matching predicate")87 696 Q
(\(let \(\(objects \(soup-query source-v)87 708 Q(ault predicate\)\)\))
-.25 E(\(for)92 720 Q(-each \(lambda \(obj\))-.2 E
(\(migrate-object obj tar)122 732 Q(get-host\)\))-.18 E(objects\)\)\))
117 744 Q(Li)72 768 Q .3 -.15(ve M)-.25 H(igration).15 E
(Migrate while v)72 792 Q(ault remains acti)-.25 E -.15(ve)-.25 G(:).15
E 0 Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(de\214ne \(li)82 24 Q -.15(ve)-.25 G
(-migration source-v).15 E(ault tar)-.25 E(get-host\))-.18 E
("Migrate without do)87 36 Q(wntime")-.25 E(;; Phase 1: Initial sync)87
48 Q(\(let \(\(checkpoint \(initial-sync source-v)87 60 Q(ault tar)-.25
E(get-host\)\)\))-.18 E(;; Phase 2: Catch up changes)92 72 Q
(\(let loop \(\(last-checkpoint checkpoint\)\))92 84 Q
(\(let \(\(changes \(changes-since source-v)97 96 Q
(ault last-checkpoint\)\)\))-.25 E
(\(if \(< \(length changes\) *catchup-threshold*\))102 108 Q
(;; Phase 3: Final cuto)112 120 Q -.15(ve)-.15 G 2.5(r\().15 G
(brief pause\))-2.5 E(\(atomic-cuto)112 132 Q -.15(ve)-.15 G 2.5(rs).15
G(ource-v)-2.5 E(ault tar)-.25 E(get-host changes\))-.18 E
(\(loop \(sync-changes changes tar)112 144 Q(get-host\)\)\)\)\)\)\))-.18
E(---------------------------------------------------------------------\
---------)72 168 Q(Object T)72 192 Q(ransfer)-.35 E(Export F)72 216 Q
(ormat)-.15 E(;; Sealed archi)82 240 Q .3 -.15(ve f)-.25 H
(ormat \(RFC-018\)).15 E(\(de\214ne \(e)82 252 Q(xport-object hash\))
-.15 E(`\(v)87 264 Q(ault-object)-.25 E(\(hash ,hash\))92 276 Q
(\(content ,\(cas-get hash\)\))92 288 Q
(\(soup-entry ,\(soup-get hash\)\))92 300 Q
(\(references ,\(object-references hash\)\))92 312 Q
(\(signatures ,\(object-signatures hash\)\)\)\))92 324 Q(\(de\214ne \(e)
82 348 Q(xport-batch hashes\))-.15 E(\(let \(\(objects \(map e)87 360 Q
(xport-object hashes\)\)\))-.15 E(\(seal-archi)92 372 Q .3 -.15(ve o)
-.25 H(bjects).15 E(compression: 'zstd)97 384 Q(encryption: tar)97 396 Q
(get-v)-.18 E(ault-k)-.25 E -.15(ey)-.1 G(\)\)\)).15 E -.35(Tr)72 420 S
(ansfer Protocol).35 E(\(de\214ne \(transfer)82 444 Q
(-object obj source tar)-.2 E(get\))-.18 E("T)87 456 Q
(ransfer single object with v)-.35 E(eri\214cation")-.15 E
(\(let* \(\(hash \(object-hash obj\)\))87 468 Q(\(data \(e)104.5 480 Q
(xport-object hash\)\)\))-.15 E(;; Send to tar)92 492 Q(get)-.18 E(\(v)
92 504 Q(ault-send tar)-.25 E(get data\))-.18 E(;; Get ackno)92 516 Q
(wledgment with hash)-.25 E(\(let \(\(ack \(v)92 528 Q(ault-recei)-.25 E
.3 -.15(ve t)-.25 H(ar).15 E(get\)\)\))-.18 E
(\(unless \(equal? \(ack-hash ack\) hash\))97 540 Q(\(error "T)102 552 Q
(ransfer v)-.35 E(eri\214cation f)-.15 E(ailed" hash\)\))-.1 E
(\(audit-append action: `\(object-transferred ,hash\))97 564 Q
(source: source)132 576 Q(tar)132 588 Q(get: tar)-.18 E(get\)\)\)\))-.18
E(Streaming T)72 612 Q(ransfer)-.35 E
(\(de\214ne \(stream-transfer source tar)82 636 Q(get\))-.18 E
("Stream objects for ef)87 648 Q(\214cient b)-.25 E(ulk transfer")-.2 E
(\(let \(\(stream \(open-transfer)87 660 Q(-stream source tar)-.2 E
(get\)\)\))-.18 E(\(for)92 672 Q(-each \(lambda \(hash\))-.2 E
(\(let \(\(obj \(e)122 684 Q(xport-object hash\)\)\))-.15 E
(\(stream-write stream obj\))127 696 Q(\(when \(stream-b)127 708 Q(uf)
-.2 E(fer)-.25 E(-full? stream\))-.2 E(\(stream-\215ush stream\)\)\)\))
132 720 Q(\(v)117 732 Q(ault-all-hashes source\)\))-.25 E
(\(stream-close stream\)\)\))92 744 Q(---------------------------------\
---------------------------------------------)72 768 Q
(Metadata Migration)72 792 Q 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(Soup Entries)72 24 Q
(\(de\214ne \(migrate-soup-entry hash source tar)82 48 Q(get\))-.18 E
("Migrate soup metadata for object")87 60 Q
(\(let \(\(entry \(soup-get source hash\)\)\))87 72 Q(\(when entry)92 84
Q(\(soup-put tar)97 96 Q(get hash entry\))-.18 E(;; V)97 108 Q(erify)
-1.11 E(\(unless \(equal? \(soup-get tar)97 120 Q(get hash\) entry\))
-.18 E(\(error "Soup entry migration f)102 132 Q(ailed" hash\)\)\)\)\))
-.1 E(Inde)72 156 Q 2.5(xM)-.15 G(igration)-2.5 E
(\(de\214ne \(migrate-inde)82 180 Q -.15(xe)-.15 G 2.5(ss).15 G
(ource tar)-2.5 E(get\))-.18 E("Reb)87 192 Q(uild inde)-.2 E -.15(xe)
-.15 G 2.5(so).15 G 2.5(nt)-2.5 G(ar)-2.5 E(get")-.18 E
(;; Option 1: Export and import inde)87 204 Q 2.5(xd)-.15 G(ata)-2.5 E
(\(let \(\(inde)87 216 Q(x-data \(e)-.15 E(xport-inde)-.15 E -.15(xe)
-.15 G 2.5(ss).15 G(ource\)\)\))-2.5 E(\(import-inde)92 228 Q -.15(xe)
-.15 G 2.5(st).15 G(ar)-2.5 E(get inde)-.18 E(x-data\)\))-.15 E
(;; Option 2: Reb)87 252 Q(uild from soup \(slo)-.2 E(wer b)-.25 E
(ut guaranteed correct\))-.2 E(\(reb)87 264 Q(uild-inde)-.2 E -.15(xe)
-.15 G 2.5(st).15 G(ar)-2.5 E(get\)\))-.18 E(Audit T)72 288 Q(rail)-.35
E(\(de\214ne \(migrate-audit source tar)82 312 Q(get\))-.18 E
("Migrate audit trail \(critical for pro)87 324 Q -.15(ve)-.15 G
(nance\)").15 E(\(let \(\(audit-entries \(audit-e)87 336 Q
(xport source\)\)\))-.15 E(;; Audit entries are append-only)92 348 Q 2.5
(,t)-.65 G(ransfer in order)-2.5 E(\(for)92 360 Q
(-each \(lambda \(entry\))-.2 E(\(audit-import tar)122 372 Q
(get entry\)\))-.18 E(audit-entries\))117 384 Q(;; Add migration e)92
396 Q -.15(ve)-.25 G(nt to both).15 E(\(let \(\(migration-entry)92 408 Q
(`\(migration-audit)109.5 420 Q(\(source ,source\))114.5 432 Q(\(tar)
114.5 444 Q(get ,tar)-.18 E(get\))-.18 E
(\(entries ,\(length audit-entries\)\))114.5 456 Q
(\(timestamp ,\(current-time\)\)\)\)\))114.5 468 Q
(\(audit-append source migration-entry\))97 480 Q(\(audit-append tar)97
492 Q(get migration-entry\)\)\)\))-.18 E(------------------------------\
------------------------------------------------)72 516 Q
(Capability Migration)72 540 Q(Certi\214cate T)72 564 Q(ransfer)-.35 E
(\(de\214ne \(migrate-capabilities source tar)82 588 Q(get\))-.18 E
("Migrate SPKI certi\214cates")87 600 Q
(\(let \(\(certs \(soup-query source type: 'certi\214cate\)\)\))87 612 Q
(\(for)92 624 Q(-each \(lambda \(cert\))-.2 E
(;; Certi\214cates are content-addressed, transfer directly)122 636 Q
(\(let \(\(hash \(cert-hash cert\)\)\))122 648 Q
(\(migrate-object hash source tar)127 660 Q(get\)\)\))-.18 E
(certs\)\)\))117 672 Q -2.15 -.25(Ke y)72 696 T(Migration)2.75 E(;; Pri)
82 720 Q -.25(va)-.25 G(te k).25 E -.15(ey)-.1 G 2.5(sr).15 G
(equire special handling)-2.5 E(\(de\214ne \(migrate-v)82 732 Q(ault-k)
-.25 E -.15(ey)-.1 G 2.5(ss).15 G(ource tar)-2.5 E(get ceremon)-.18 E
(y-witnesses\))-.15 E("Migrate v)87 744 Q(ault k)-.25 E -.15(ey)-.1 G
2.5(sv).15 G(ia k)-2.5 E .3 -.15(ey c)-.1 H(eremon).15 E(y")-.15 E
(;; Ne)87 756 Q -.15(ve)-.25 G 2.5(rt).15 G(ransfer pri)-2.5 E -.25(va)
-.25 G(te k).25 E -.15(ey)-.1 G 2.5(sd).15 G(irectly!)-2.5 E
(;; Use threshold re-sharing or k)87 768 Q .3 -.15(ey c)-.1 H(eremon).15
E(y)-.15 E(\(let* \(\(old-shares \(g)87 780 Q(ather)-.05 E(-k)-.2 E -.15
(ey)-.1 G(-shares source\)\)).15 E(\(ne)104.5 792 Q(w-k)-.25 E .3 -.15
(ey \()-.1 H(generate-ne).15 E(w-k)-.25 E .3 -.15(ey t)-.1 H(ar).15 E
(get\)\))-.18 E 0 Cg EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(transition-cert \(create-k)104.5 12 Q -.15(ey)
-.1 G(-transition-cert).15 E(old-k)149.5 24 Q -.15(ey)-.1 G 2.5(:\().15
G -.25(va)-2.5 G(ult-public-k).25 E .3 -.15(ey s)-.1 H(ource\)).15 E(ne)
149.5 36 Q(w-k)-.25 E -.15(ey)-.1 G 2.5(:n).15 G -.25(ew)-2.5 G(-k).25 E
-.15(ey)-.1 G(witnesses: ceremon)149.5 48 Q(y-witnesses\)\)\))-.15 E
(;; Sign transition with old k)92 60 Q -.15(ey)-.1 G
(\(sign-transition old-shares transition-cert\))92 72 Q
(;; Record in both v)92 84 Q(aults)-.25 E
(\(audit-append source action: `\(k)92 96 Q -.15(ey)-.1 G
(-transition ,transition-cert\)\)).15 E(\(audit-append tar)92 108 Q
(get action: `\(k)-.18 E -.15(ey)-.1 G
(-transition ,transition-cert\)\)\)\)).15 E(Dele)72 132 Q -.05(ga)-.15 G
(tion Chain Continuity).05 E(\(de\214ne \(v)82 156 Q(erify-dele)-.15 E
-.05(ga)-.15 G(tion-chains tar).05 E(get\))-.18 E("V)87 168 Q
(erify all dele)-1.11 E -.05(ga)-.15 G(tion chains remain v).05 E
(alid after migration")-.25 E(\(let \(\(certs \(soup-query tar)87 180 Q
(get type: 'certi\214cate\)\)\))-.18 E(\(for)92 192 Q
(-each \(lambda \(cert\))-.2 E(\(let \(\(chain \(b)122 204 Q
(uild-chain cert\)\)\))-.2 E(\(unless \(v)127 216 Q(alid-chain? chain\))
-.25 E(\(w)132 228 Q(arn "Brok)-.1 E(en dele)-.1 E -.05(ga)-.15 G
(tion chain" cert\)\)\)\)).05 E(certs\)\)\))117 240 Q(-----------------\
-------------------------------------------------------------)72 264 Q
-1.11(Ve)72 288 S(ri\214cation)1.11 E(Content V)72 312 Q(eri\214cation)
-1.11 E(\(de\214ne \(v)82 336 Q(erify-migration source tar)-.15 E(get\))
-.18 E("V)87 348 Q(erify all content transferred correctly")-1.11 E
(\(let \(\(source-hashes \(v)87 360 Q(ault-all-hashes source\)\))-.25 E
(\(tar)102 372 Q(get-hashes \(v)-.18 E(ault-all-hashes tar)-.25 E
(get\)\)\))-.18 E(;; Check completeness)92 396 Q
(\(let \(\(missing \(set-dif)92 408 Q(ference source-hashes tar)-.25 E
(get-hashes\)\)\))-.18 E(\(unless \(null? missing\))97 420 Q
(\(error "Missing objects after migration" missing\)\)\))102 432 Q
(;; Check inte)92 456 Q(grity \(sample v)-.15 E(eri\214cation for lar)
-.15 E(ge v)-.18 E(aults\))-.25 E
(\(let \(\(sample \(random-sample source-hashes 1000\)\)\))92 468 Q
(\(for)97 480 Q(-each \(lambda \(hash\))-.2 E
(\(unless \(equal? \(cas-get source hash\))127 492 Q(\(cas-get tar)167
504 Q(get hash\)\))-.18 E(\(error "Content mismatch" hash\)\)\))132 516
Q(sample\)\))122 528 Q(;; Check soup metadata)92 552 Q(\(for)92 564 Q
(-each \(lambda \(hash\))-.2 E
(\(unless \(equal? \(soup-get source hash\))122 576 Q(\(soup-get tar)162
588 Q(get hash\)\))-.18 E(\(error "Soup mismatch" hash\)\)\))127 600 Q
(\(random-sample source-hashes 1000\)\)\)\))117 612 Q(Merkle V)72 636 Q
(eri\214cation)-1.11 E(\(de\214ne \(merkle-v)82 660 Q
(erify-migration source tar)-.15 E(get\))-.18 E("V)87 672 Q
(erify migration via Merkle root comparison")-1.11 E
(\(let \(\(source-root \(v)87 684 Q(ault-merkle-root source\)\))-.25 E
(\(tar)102 696 Q(get-root \(v)-.18 E(ault-merkle-root tar)-.25 E
(get\)\)\))-.18 E(\(unless \(equal? source-root tar)92 708 Q(get-root\))
-.18 E(;; Find di)97 720 Q -.15(ve)-.25 G -.18(rg).15 G(ence).18 E
(\(let \(\(di)97 732 Q -.15(ve)-.25 G -.18(rg).15 G
(ence \(\214nd-merkle-di).18 E -.15(ve)-.25 G -.18(rg).15 G
(ence source tar).18 E(get\)\)\))-.18 E(\(error "Merkle v)102 744 Q
(eri\214cation f)-.15 E(ailed" di)-.1 E -.15(ve)-.25 G -.18(rg).15 G
(ence\)\)\)\)\)).18 E(Audit V)72 768 Q(eri\214cation)-1.11 E
(\(de\214ne \(v)82 792 Q(erify-audit-continuity source tar)-.15 E(get\))
-.18 E 0 Cg EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF("V)87 12 Q(erify audit trail continuity")-1.11 E
(\(let \(\(source-audit \(audit-e)87 24 Q(xport source\)\))-.15 E(\(tar)
102 36 Q(get-audit \(audit-e)-.18 E(xport tar)-.15 E(get\)\)\))-.18 E
(;; T)92 48 Q(ar)-.8 E(get should ha)-.18 E .3 -.15(ve a)-.2 H
(ll source entries plus migration e).15 E -.15(ve)-.25 G(nts).15 E
(\(unless \(subsequence? source-audit tar)92 60 Q(get-audit\))-.18 E
(\(error "Audit trail discontinuity"\)\)\)\))97 72 Q(------------------\
------------------------------------------------------------)72 96 Q
(Cuto)72 120 Q -.15(ve)-.15 G(r).15 E(Atomic Cuto)72 144 Q -.15(ve)-.15
G(r).15 E(\(de\214ne \(atomic-cuto)82 168 Q -.15(ve)-.15 G 2.5(rs).15 G
(ource tar)-2.5 E(get migration-id\))-.18 E
("Atomically switch from source to tar)87 180 Q(get")-.18 E
(;; Phase 1: Quiesce source)87 192 Q(\(v)87 204 Q
(ault-readonly! source\))-.25 E(;; Phase 2: Final sync)87 228 Q(\(let \
\(\(\214nal-changes \(changes-since source \(last-sync-point\)\)\)\))87
240 Q(\(sync-changes \214nal-changes tar)92 252 Q(get\)\))-.18 E
(;; Phase 3: V)87 276 Q(erify)-1.11 E(\(v)87 288 Q
(erify-migration source tar)-.15 E(get\))-.18 E
(;; Phase 4: Update DNS/routing)87 312 Q(\(update-v)87 324 Q
(ault-routing source tar)-.25 E(get\))-.18 E(;; Phase 5: Acti)87 348 Q
-.25(va)-.25 G(te tar).25 E(get)-.18 E(\(v)87 360 Q(ault-acti)-.25 E
-.25(va)-.25 G(te! tar).25 E(get\))-.18 E(;; Phase 6: Record completion)
87 384 Q(\(audit-append tar)87 396 Q
(get action: `\(migration-complete ,migration-id\)\)\))-.18 E(Rollback)
72 420 Q(\(de\214ne \(migration-rollback migration-id\))82 444 Q
("Rollback f)87 456 Q(ailed migration")-.1 E
(\(let \(\(migration \(get-migration migration-id\)\)\))87 468 Q
(\(case \(migration-phase migration\))92 480 Q(\(\(transfer\))97 492 Q
(;; Just abandon tar)99.5 504 Q(get)-.18 E(\(v)99.5 516 Q
(ault-delete! \(migration-tar)-.25 E(get migration\)\)\))-.18 E
(\(\(cuto)97 528 Q -.15(ve)-.15 G(r\)).15 E
(;; Restore routing to source)99.5 540 Q(\(update-v)99.5 552 Q
(ault-routing \(migration-tar)-.25 E(get migration\))-.18 E
(\(migration-source migration\)\))154.5 564 Q(\(v)99.5 576 Q
(ault-readonly! \(migration-tar)-.25 E(get migration\)\))-.18 E(\(v)99.5
588 Q(ault-acti)-.25 E -.25(va)-.25 G
(te! \(migration-source migration\)\)\)).25 E(\(\(complete\))97 600 Q
(\(error "Cannot rollback completed migration"\)\)\)\)\))99.5 612 Q(---\
-----------------------------------------------------------------------\
----)72 636 Q(Incremental Migration)72 660 Q(Checkpoint System)72 684 Q
(\(de\214ne \(migration-checkpoint migration-id progress\))82 708 Q("Sa)
87 720 Q .3 -.15(ve m)-.2 H(igration progress for resumption").15 E
(\(let \(\(checkpoint)87 732 Q(`\(checkpoint)104.5 744 Q
(\(migration-id ,migration-id\))109.5 756 Q
(\(timestamp ,\(current-time\)\))109.5 768 Q
(\(transferred ,\(progress-transferred progress\)\))109.5 780 Q
(\(remaining ,\(progress-remaining progress\)\))109.5 792 Q 0 Cg EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF
(\(last-hash ,\(progress-last-hash progress\)\)\)\)\))109.5 12 Q
(\(cas-put \(serialize checkpoint\)\)\)\))92 24 Q
(\(de\214ne \(resume-migration migration-id\))82 48 Q
("Resume interrupted migration")87 60 Q
(\(let \(\(checkpoint \(latest-checkpoint migration-id\)\)\))87 72 Q
(\(if checkpoint)92 84 Q(\(continue-from-checkpoint checkpoint\))102 96
Q(\(error "No checkpoint found" migration-id\)\)\)\))102 108 Q(Change T)
72 132 Q(racking)-.35 E(;; T)82 156 Q(rack changes during migration)-.35
E(\(de\214ne \(changes-since v)82 168 Q(ault timestamp\))-.25 E
("Get all changes since timestamp")87 180 Q(\(soup-query v)87 192 Q
(ault)-.25 E(modi\214ed: \(> timestamp\))117 204 Q(order)117 216 Q
(-by: '\(\(modi\214ed asc\)\)\)\))-.2 E
(\(de\214ne \(sync-changes changes tar)82 240 Q(get\))-.18 E
("Apply changes to tar)87 252 Q(get")-.18 E(\(for)87 264 Q
(-each \(lambda \(change\))-.2 E(\(case \(change-type change\))117 276 Q
(\(\(create modify\))122 288 Q
(\(migrate-object \(change-hash change\) tar)124.5 300 Q(get\)\))-.18 E
(\(\(delete\))122 312 Q(\(cas-delete tar)124.5 324 Q
(get \(change-hash change\)\)\)\)\))-.18 E(changes\)\))112 336 Q(------\
-----------------------------------------------------------------------\
-)72 360 Q(Storage Back)72 384 Q(end Migration)-.1 E(Back)72 408 Q
(end Abstraction)-.1 E(;; Migrate between storage back)82 432 Q(ends)-.1
E(\(de\214ne \(back)82 444 Q(end-migration v)-.1 E(ault old-back)-.25 E
(end ne)-.1 E(w-back)-.25 E(end\))-.1 E("Migrate v)87 456 Q(ault to dif)
-.25 E(ferent storage back)-.25 E(end")-.1 E(\(for)87 468 Q
(-each \(lambda \(hash\))-.2 E(\(let \(\(data \(back)117 480 Q
(end-get old-back)-.1 E(end hash\)\)\))-.1 E(\(back)122 492 Q
(end-put ne)-.1 E(w-back)-.25 E(end hash data\))-.1 E(\(v)122 504 Q
(erify-back)-.15 E(end-transfer hash old-back)-.1 E(end ne)-.1 E(w-back)
-.25 E(end\)\)\))-.1 E(\(back)112 516 Q(end-all-hashes old-back)-.1 E
(end\)\)\))-.1 E(;; Example: S3 to local \214lesystem)82 540 Q
(\(de\214ne \(s3-to-local v)82 552 Q(ault b)-.25 E(uck)-.2 E(et path\))
-.1 E(\(back)87 564 Q(end-migration v)-.1 E(ault)-.25 E(\(mak)134.5 576
Q(e-s3-back)-.1 E(end b)-.1 E(uck)-.2 E(et\))-.1 E(\(mak)134.5 588 Q
(e-fs-back)-.1 E(end path\)\)\))-.1 E -.15(Fo)72 612 S(rmat Con).15 E
-.15(ve)-.4 G(rsion).15 E(;; Migrate between storage formats)82 636 Q
(\(de\214ne \(format-migration v)82 648 Q(ault old-format ne)-.25 E
(w-format\))-.25 E("Con)87 660 Q -.15(ve)-.4 G
(rt storage format during migration").15 E(\(for)87 672 Q
(-each \(lambda \(hash\))-.2 E
(\(let* \(\(old-data \(read-format old-format hash\)\))117 684 Q(\(ne)
134.5 696 Q(w-data \(con)-.25 E -.15(ve)-.4 G(rt-format old-data ne).15
E(w-format\)\)\))-.25 E(\(write-format ne)122 708 Q(w-format hash ne)
-.25 E(w-data\)\)\))-.25 E(\(v)112 720 Q(ault-all-hashes v)-.25 E
(ault\)\)\))-.25 E(----------------------------------------------------\
--------------------------)72 744 Q(Federation Migration)72 768 Q -1.11
(Va)72 792 S(ult Federation Changes)1.11 E 0 Cg EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(de\214ne \(federation-migrate v)82 24 Q
(ault old-federation ne)-.25 E(w-federation\))-.25 E("Migrate v)87 36 Q
(ault between federations")-.25 E(;; Lea)87 48 Q .3 -.15(ve o)-.2 H
(ld federation).15 E(\(federation-lea)87 60 Q .3 -.15(ve o)-.2 H
(ld-federation v).15 E(ault\))-.25 E(;; Update v)87 84 Q(ault metadata)
-.25 E(\(v)87 96 Q(ault-set-federation! v)-.25 E(ault ne)-.25 E
(w-federation\))-.25 E(;; Join ne)87 120 Q 2.5(wf)-.25 G(ederation)-2.5
E(\(federation-join ne)87 132 Q(w-federation v)-.25 E(ault\))-.25 E
(;; Announce to peers)87 156 Q(\(federation-announce ne)87 168 Q
(w-federation v)-.25 E(ault\)\))-.25 E(Cross-Federation T)72 192 Q
(ransfer)-.35 E
(\(de\214ne \(cross-federation-transfer hash source-fed tar)82 216 Q
(get-fed\))-.18 E("T)87 228 Q(ransfer object between federations")-.35 E
(\(let* \(\(source-v)87 240 Q
(ault \(federation-locate source-fed hash\)\))-.25 E(\(tar)104.5 252 Q
(get-v)-.18 E(ault \(federation-select tar)-.25 E(get-fed\)\))-.18 E
(\(obj \(v)104.5 264 Q(ault-get source-v)-.25 E(ault hash\)\)\))-.25 E
(\(v)92 276 Q(ault-put tar)-.25 E(get-v)-.18 E(ault obj\))-.25 E
(\(federation-announce tar)92 288 Q(get-fed hash tar)-.18 E(get-v)-.18 E
(ault\)\)\))-.25 E(----------------------------------------------------\
--------------------------)72 312 Q(Security Considerations)72 336 Q
(Migration Authorization)72 360 Q
(;; Migration requires appropriate capability)82 384 Q(\(spki-cert)82
396 Q(\(issuer v)87 408 Q(ault-admin\))-.25 E
(\(subject migration-operator\))87 420 Q(\(capability)87 432 Q
(\(action migrate\))92 444 Q(\(object v)92 456 Q(ault-id\)\))-.25 E(\(v)
87 468 Q(alidity \(not-after "2026-02-01"\)\)\))-.25 E
(\(de\214ne \(authorized-migration? operator source tar)82 492 Q(get\))
-.18 E(\(and \(has-capability? operator 'migrate source\))87 504 Q
(\(has-capability? operator 'write tar)99.5 516 Q(get\)\)\))-.18 E
(Encryption in T)72 540 Q(ransit)-.35 E
(\(de\214ne \(secure-transfer source tar)82 564 Q(get\))-.18 E("T)87 576
Q(ransfer with encryption")-.35 E(\(let \(\(session-k)87 588 Q .3 -.15
(ey \()-.1 H(establish-session-k).15 E .3 -.15(ey s)-.1 H(ource tar).15
E(get\)\)\))-.18 E(\(for)92 600 Q(-each \(lambda \(hash\))-.2 E
(\(let* \(\(data \(cas-get source hash\)\))122 612 Q
(\(encrypted \(encrypt session-k)139.5 624 Q .3 -.15(ey d)-.1 H
(ata\)\)\)).15 E(\(send-encrypted tar)127 636 Q(get encrypted\)\)\))-.18
E(\(v)117 648 Q(ault-all-hashes source\)\)\)\))-.25 E(Migration Audit)72
672 Q(;; All migrations are fully audited)82 696 Q
(\(de\214ne \(audited-migration source tar)82 708 Q(get\))-.18 E
(\(let \(\(migration-id \(generate-migration-id\)\)\))87 720 Q
(\(audit-append action: 'migration-authorized)92 732 Q
(migration-id: migration-id)127 744 Q(operator: \(current-principal\))
127 756 Q(source: source)127 768 Q(tar)127 780 Q(get: tar)-.18 E(get\))
-.18 E(;; ... perform migration ...)92 792 Q 0 Cg EP
%%Page: 8 8
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(audit-append action: 'migration-complete)92 12
Q(migration-id: migration-id)127 24 Q(objects: \(count-migrated\))127 36
Q -.15(ve)127 48 S(ri\214cation: \(v).15 E(eri\214cation-result\)\)\)\))
-.15 E(----------------------------------------------------------------\
--------------)72 72 Q(References)72 96 Q 3.024(1. Li)72 120 R .824 -.15
(ve M)-.25 H .524(igration of V).15 F .524
(irtual Machines - Clark et al.)-.6 F 3.025(2. RFC-018:)5.524 F .525
(Sealed Archi)3.025 F .825 -.15(ve Fo)-.25 H .525(rmat 3.).15 F .525
(RFC-022: K)5.525 F .825 -.15(ey C)-.25 H(ere-).15 E(mon)72 132 Q 2.5
(yP)-.15 G(rotocol 4.)-2.5 E(RFC-024: Netw)5 E(ork Protocol)-.1 E(-----\
-----------------------------------------------------------------------\
--)72 156 Q(Changelog)72 180 Q 2.5(-2)72 204 S
(026-01-07 - Initial draft)-2.5 E(-------------------------------------\
-----------------------------------------)72 228 Q 1.428
(Implementation Status: Draft Dependencies: v)72 252 R 1.427
(ault, cas, soup, federation Inte)-.25 F 1.427(gration: V)-.15 F 1.427
(ault operations, federation,)-1.11 F(disaster reco)72 264 Q -.15(ve)
-.15 G(ry).15 E 0 Cg EP
%%Trailer
end
%%EOF
