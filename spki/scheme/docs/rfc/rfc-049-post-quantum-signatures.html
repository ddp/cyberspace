<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>rfc-049-post-quantum-signatures</title>
  <style>
    /* Default styles provided by pandoc.
    ** See https://pandoc.org/MANUAL.html#variables-for-html for config info.
    */
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="rfc.css" />
</head>
<body>
<h1 id="rfc-049-post-quantum-signatures">RFC-049: Post-Quantum
Signatures</h1>
<p><strong>Status:</strong> Draft <strong>Date:</strong> January 2026
<strong>Author:</strong> Derrell Piper <a href="mailto:ddp@eludom.net"
class="email">ddp@eludom.net</a> <strong>Requires:</strong> RFC-004
(SPKI Authorization), RFC-040 (Security Architecture), RFC-041
(Keystore), RFC-042 (Merkle Trees)</p>
<hr />
<h2 id="abstract">Abstract</h2>
<p>Ed25519 won’t survive. Shor’s algorithm breaks elliptic curve
cryptography in polynomial time. When quantum computers arrive, every
capability ever signed, every realm identity ever created, becomes
forgeable. This RFC specifies the transition from Ed25519 to
post-quantum signature schemes: SPHINCS+ and CRYSTALS-Dilithium.</p>
<hr />
<h2 id="the-threat">The Threat</h2>
<p>Ed25519 security relies on the hardness of the elliptic curve
discrete logarithm problem. Shor’s algorithm solves this in polynomial
time on a quantum computer.</p>
<table>
<thead>
<tr>
<th>Algorithm</th>
<th>Classical Security</th>
<th>Quantum Security</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ed25519</td>
<td>128 bits</td>
<td><strong>0 bits</strong> (broken)</td>
</tr>
<tr>
<td>RSA-2048</td>
<td>112 bits</td>
<td><strong>0 bits</strong> (broken)</td>
</tr>
<tr>
<td>SPHINCS+-256</td>
<td>256 bits</td>
<td>128 bits</td>
</tr>
<tr>
<td>Dilithium3</td>
<td>192 bits</td>
<td>128 bits</td>
</tr>
</tbody>
</table>
<p>When Q-Day arrives: - Every Ed25519 signature becomes forgeable -
Every SPKI certificate can be counterfeited - Every realm identity can
be stolen - Every sealed release can be replaced</p>
<p>The capability chain breaks. The sealed closure unseals. Cyberspace
falls.</p>
<p>We must migrate before Q-Day.</p>
<hr />
<h2 id="the-candidates">The Candidates</h2>
<p>NIST Post-Quantum Cryptography standardization selected:</p>
<h3 id="sphincs-hash-based">SPHINCS+ (Hash-Based)</h3>
<pre><code>Type:           Stateless hash-based signatures
Security basis: Hash function security (SHAKE256)
Key size:       32 bytes (private), 32 bytes (public)
Signature size: 7,856 - 49,856 bytes (parameter dependent)
Speed:          Slow signing, fast verification
Maturity:       Conservative, well-understood</code></pre>
<p><strong>Why SPHINCS+:</strong> - Security reduces to hash function
security - No number-theoretic assumptions - Stateless (no state
management headaches) - Uses SHAKE256 (same as our Merkle trees)</p>
<p><strong>Tradeoff:</strong> Large signatures. A SPHINCS+-256s
signature is ~8 KB.</p>
<h3 id="crystals-dilithium-lattice-based">CRYSTALS-Dilithium
(Lattice-Based)</h3>
<pre><code>Type:           Lattice-based (Module-LWE)
Security basis: Learning With Errors hardness
Key size:       1,312 bytes (private), 1,952 bytes (public)
Signature size: 2,420 - 4,595 bytes (parameter dependent)
Speed:          Fast signing, fast verification
Maturity:       Newer, but extensively analyzed</code></pre>
<p><strong>Why Dilithium:</strong> - Smaller signatures than SPHINCS+ -
Faster operations - NIST primary recommendation</p>
<p><strong>Tradeoff:</strong> Relies on lattice assumptions (less
conservative than hash-based).</p>
<hr />
<h2 id="cyberspace-strategy-both">Cyberspace Strategy: Both</h2>
<p>We support both. Different use cases, different tradeoffs:</p>
<table>
<colgroup>
<col style="width: 35%" />
<col style="width: 46%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr>
<th>Use Case</th>
<th>Recommended</th>
<th>Why</th>
</tr>
</thead>
<tbody>
<tr>
<td>Realm identity (keystore)</td>
<td>SPHINCS+</td>
<td>Maximum conservatism for long-lived keys</td>
</tr>
<tr>
<td>Capability certificates</td>
<td>Dilithium</td>
<td>Smaller signatures, many certs</td>
</tr>
<tr>
<td>Sealed releases</td>
<td>SPHINCS+</td>
<td>Archival, must survive</td>
</tr>
<tr>
<td>Agent delegation</td>
<td>Dilithium</td>
<td>Short-lived, performance matters</td>
</tr>
<tr>
<td>Audit entries</td>
<td>Dilithium</td>
<td>High volume</td>
</tr>
</tbody>
</table>
<p>The keystore can hold multiple key types:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(keystore</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  (realm-keys</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    (ed25519 #<span class="op">${</span>legacy-key...<span class="op">}</span>)           <span class="co">; Legacy (sunset)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    (sphincs+ #<span class="op">${</span>pq-primary...<span class="op">}</span>)          <span class="co">; Post-quantum primary</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    (dilithium #<span class="op">${</span>pq-operational...<span class="op">}</span>))    <span class="co">; Post-quantum operational</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  (active-signing &#39;sphincs+)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  (accept-verification &#39;(sphincs+ dilithium ed25519)))</span></code></pre></div>
<hr />
<h2 id="certificate-format">Certificate Format</h2>
<h3 id="current-ed25519">Current (Ed25519)</h3>
<div class="sourceCode" id="cb4"><pre
class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(spki-cert</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  (issuer <span class="st">&quot;ed25519:alice...&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  (subject <span class="st">&quot;ed25519:bob...&quot;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  (tag (<span class="kw">read</span> <span class="st">&quot;sha512:doc...&quot;</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  (signature #<span class="op">${</span><span class="dv">64</span>-byte-ed25519-sig<span class="op">}</span>))</span></code></pre></div>
<h3 id="post-quantum-sphincs">Post-Quantum (SPHINCS+)</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(spki-cert</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  (issuer <span class="st">&quot;sphincs+:alice...&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  (subject <span class="st">&quot;sphincs+:bob...&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  (tag (<span class="kw">read</span> <span class="st">&quot;shake256:doc...&quot;</span>))           <span class="co">; Merkle root</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  (signature-algorithm <span class="st">&quot;sphincs+-shake-256s&quot;</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  (signature #<span class="op">${</span><span class="dv">7856</span>-byte-sphincs-sig<span class="op">}</span>))</span></code></pre></div>
<h3 id="post-quantum-dilithium">Post-Quantum (Dilithium)</h3>
<div class="sourceCode" id="cb6"><pre
class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(spki-cert</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  (issuer <span class="st">&quot;dilithium:alice...&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  (subject <span class="st">&quot;dilithium:bob...&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  (tag (<span class="kw">read</span> <span class="st">&quot;shake256:doc...&quot;</span>))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  (signature-algorithm <span class="st">&quot;dilithium3&quot;</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  (signature #<span class="op">${</span><span class="dv">3293</span>-byte-dilithium-sig<span class="op">}</span>))</span></code></pre></div>
<h3 id="hybrid-transition">Hybrid (Transition)</h3>
<p>During transition, sign with both:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(spki-cert</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  (issuer <span class="st">&quot;hybrid:alice...&quot;</span>)               <span class="co">; Hybrid identity</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  (subject <span class="st">&quot;hybrid:bob...&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  (tag (<span class="kw">read</span> <span class="st">&quot;shake256:doc...&quot;</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  (signatures</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    (ed25519 #<span class="op">${</span><span class="dv">64</span>-byte-sig<span class="op">}</span>)              <span class="co">; Legacy</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    (sphincs+ #<span class="op">${</span><span class="dv">7856</span>-byte-sig<span class="op">}</span>)))         <span class="co">; Post-quantum</span></span></code></pre></div>
<p>Both signatures must verify. If Ed25519 is later broken, SPHINCS+
still holds.</p>
<hr />
<h2 id="key-generation">Key Generation</h2>
<h3 id="sphincs-shake-256s">SPHINCS+-SHAKE-256s</h3>
<div class="sourceCode" id="cb8"><pre
class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(<span class="fu">sphincs+-keygen</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Generate SPHINCS+ keypair using SHAKE256&quot;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">let*</span> ((seed (random-bytes <span class="dv">96</span>))          <span class="co">; 3 × 32-byte seeds</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         (sk-seed (subbytevector seed <span class="dv">0</span> <span class="dv">32</span>))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>         (sk-prf (subbytevector seed <span class="dv">32</span> <span class="dv">64</span>))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>         (pk-seed (subbytevector seed <span class="dv">64</span> <span class="dv">96</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>         (keypair (sphincs+-generate sk-seed sk-prf pk-seed)))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    keypair))</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">;; Keystore storage (encrypted)</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>(realm-private-key</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  (version <span class="dv">1</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  (algorithm <span class="st">&quot;sphincs+-shake-256s&quot;</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  (parameters</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    (n <span class="dv">32</span>)                                 <span class="co">; Security parameter</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    (h <span class="dv">64</span>)                                 <span class="co">; Tree height</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    (d <span class="dv">8</span>)                                  <span class="co">; Hypertree layers</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    (k <span class="dv">22</span>)                                 <span class="co">; FORS trees</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    (w <span class="dv">16</span>))                                <span class="co">; Winternitz parameter</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  (protection <span class="st">&quot;passphrase&quot;</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  (kdf <span class="st">&quot;argon2id&quot;</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  (ciphertext #<span class="op">${</span>encrypted-sk<span class="op">}</span>))</span></code></pre></div>
<h3 id="dilithium3">Dilithium3</h3>
<div class="sourceCode" id="cb9"><pre
class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(<span class="fu">dilithium-keygen</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Generate Dilithium3 keypair&quot;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">let*</span> ((seed (random-bytes <span class="dv">32</span>))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>         (keypair (dilithium3-generate seed)))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    keypair))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>(realm-private-key</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  (version <span class="dv">1</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  (algorithm <span class="st">&quot;dilithium3&quot;</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  (parameters</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    (k <span class="dv">6</span>)                                  <span class="co">; Module dimension</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    (l <span class="dv">5</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    (eta <span class="dv">4</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    (beta <span class="dv">175</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    (omega <span class="dv">55</span>))</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  (protection <span class="st">&quot;passphrase&quot;</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  (kdf <span class="st">&quot;argon2id&quot;</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  (ciphertext #<span class="op">${</span>encrypted-sk<span class="op">}</span>))</span></code></pre></div>
<hr />
<h2 id="signing-operations">Signing Operations</h2>
<h3 id="sphincs-signing">SPHINCS+ Signing</h3>
<div class="sourceCode" id="cb10"><pre
class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(<span class="fu">sphincs+-sign </span>message private-key)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Sign message with SPHINCS+&quot;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">let*</span> ((opt-rand (random-bytes <span class="dv">32</span>))      <span class="co">; Optional randomness</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>         (signature (sphincs+-sign-internal message private-key opt-rand)))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    signature))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">;; Signature is large: 7,856 bytes for SPHINCS+-SHAKE-256s</span></span></code></pre></div>
<h3 id="dilithium-signing">Dilithium Signing</h3>
<div class="sourceCode" id="cb11"><pre
class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(<span class="fu">dilithium-sign </span>message private-key)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Sign message with Dilithium3&quot;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">let*</span> ((signature (dilithium3-sign-internal message private-key)))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    signature))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">;; Signature is moderate: 3,293 bytes for Dilithium3</span></span></code></pre></div>
<h3 id="hybrid-signing">Hybrid Signing</h3>
<div class="sourceCode" id="cb12"><pre
class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(<span class="fu">hybrid-sign </span>message ed25519-sk sphincs+-sk)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Sign with both algorithms for transition security&quot;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">let</span> ((ed25519-sig (ed25519-sign message ed25519-sk))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        (sphincs+-sig (sphincs+-sign message sphincs+-sk)))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    `(hybrid-signature</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>      (ed25519 ,ed25519-sig)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>      (sphincs+ ,sphincs+-sig))))</span></code></pre></div>
<hr />
<h2 id="verification">Verification</h2>
<h3 id="multi-algorithm-verification">Multi-Algorithm Verification</h3>
<div class="sourceCode" id="cb13"><pre
class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(<span class="fu">verify-signature </span>message signature public-key)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Verify signature, handling multiple algorithms&quot;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">let</span> ((algorithm (signature-algorithm signature)))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">case</span> algorithm</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>      ((ed25519) (ed25519-verify message (sig-bytes signature) public-key))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>      ((sphincs+) (sphincs+-verify message (sig-bytes signature) public-key))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>      ((dilithium) (dilithium-verify message (sig-bytes signature) public-key))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>      ((hybrid) (verify-hybrid message signature public-key))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>      (<span class="kw">else</span> (<span class="kw">error</span> <span class="st">&quot;Unknown signature algorithm&quot;</span> algorithm)))))</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(<span class="fu">verify-hybrid </span>message signature public-keys)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Both signatures must verify&quot;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">and</span> (ed25519-verify message (hybrid-ed25519 signature) (keys-ed25519 public-keys))</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>       (sphincs+-verify message (hybrid-sphincs+ signature) (keys-sphincs+ public-keys))))</span></code></pre></div>
<hr />
<h2 id="realm-identity">Realm Identity</h2>
<p>A realm’s principal expands to include algorithm:</p>
<pre><code>Current:   ed25519:7f3a2b4c5d6e...
Future:    sphincs+:8a9b0c1d2e3f...
           dilithium:4e5f6a7b8c9d...
           hybrid:7f3a2b4c|8a9b0c1d...</code></pre>
<p>The principal is still coordinates in cyberspace - a place you can
teleport to. The algorithm prefix tells you what cryptography guards the
gate.</p>
<hr />
<h2 id="capability-chain-implications">Capability Chain
Implications</h2>
<p>Capability chains must handle mixed algorithms:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">;; Alice (Ed25519) delegates to Bob (Dilithium) who delegates to Carol (SPHINCS+)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>(cert-chain</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  (cert-1</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    (issuer <span class="st">&quot;ed25519:alice...&quot;</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    (subject <span class="st">&quot;dilithium:bob...&quot;</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    (signature #<span class="op">${</span>ed25519-sig<span class="op">}</span>))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  (cert-2</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    (issuer <span class="st">&quot;dilithium:bob...&quot;</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    (subject <span class="st">&quot;sphincs+:carol...&quot;</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    (signature #<span class="op">${</span>dilithium-sig<span class="op">}</span>)))</span></code></pre></div>
<p>Each link verified with its own algorithm. The chain is as strong as
its weakest link - but even one post-quantum link prevents total
collapse after Q-Day.</p>
<hr />
<h2 id="migration-timeline">Migration Timeline</h2>
<h3 id="phase-1-preparation-now">Phase 1: Preparation (Now)</h3>
<ul>
<li>Implement SPHINCS+ and Dilithium in crypto-ffi</li>
<li>Add multi-algorithm support to keystore</li>
<li>Test hybrid signatures</li>
</ul>
<h3 id="phase-2-hybrid-default-now-1-year">Phase 2: Hybrid Default (Now
+ 1 year)</h3>
<ul>
<li>New realms generate hybrid keys (Ed25519 + SPHINCS+)</li>
<li>All signatures include both</li>
<li>Legacy realms can upgrade</li>
</ul>
<h3 id="phase-3-post-quantum-primary-q-day---3-years">Phase 3:
Post-Quantum Primary (Q-Day - 3 years)</h3>
<ul>
<li>SPHINCS+/Dilithium become primary</li>
<li>Ed25519 becomes secondary</li>
<li>Capability chains require at least one PQ signature</li>
</ul>
<h3 id="phase-4-legacy-sunset-q-day">Phase 4: Legacy Sunset (Q-Day)</h3>
<ul>
<li>Ed25519 signatures no longer trusted</li>
<li>Hybrid signatures verified by PQ component only</li>
<li>Legacy-only realms frozen (read-only)</li>
</ul>
<h3 id="phase-5-pure-post-quantum-q-day-2-years">Phase 5: Pure
Post-Quantum (Q-Day + 2 years)</h3>
<ul>
<li>Ed25519 removed from new certificates</li>
<li>Historical certificates retain for audit</li>
<li>Cyberspace survives</li>
</ul>
<hr />
<h2 id="storage-implications">Storage Implications</h2>
<p>Post-quantum signatures are larger:</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Ed25519</th>
<th>Dilithium3</th>
<th>SPHINCS+-256s</th>
</tr>
</thead>
<tbody>
<tr>
<td>Public key</td>
<td>32 B</td>
<td>1,952 B</td>
<td>32 B</td>
</tr>
<tr>
<td>Private key</td>
<td>64 B</td>
<td>4,000 B</td>
<td>128 B</td>
</tr>
<tr>
<td>Signature</td>
<td>64 B</td>
<td>3,293 B</td>
<td>7,856 B</td>
</tr>
<tr>
<td>Cert overhead</td>
<td>~200 B</td>
<td>~3,500 B</td>
<td>~8,100 B</td>
</tr>
</tbody>
</table>
<p>A realm with 10,000 capabilities: - Ed25519: ~2 MB - Dilithium: ~35
MB - SPHINCS+: ~81 MB</p>
<p>Storage is cheap. Quantum resistance is not.</p>
<hr />
<h2 id="performance">Performance</h2>
<table>
<thead>
<tr>
<th>Operation</th>
<th>Ed25519</th>
<th>Dilithium3</th>
<th>SPHINCS+-256s</th>
</tr>
</thead>
<tbody>
<tr>
<td>Keygen</td>
<td>0.03 ms</td>
<td>0.15 ms</td>
<td>2 ms</td>
</tr>
<tr>
<td>Sign</td>
<td>0.05 ms</td>
<td>0.5 ms</td>
<td>50 ms</td>
</tr>
<tr>
<td>Verify</td>
<td>0.1 ms</td>
<td>0.3 ms</td>
<td>1 ms</td>
</tr>
</tbody>
</table>
<p>SPHINCS+ signing is slow (50ms). Acceptable for: - Realm identity
(rare) - Sealed releases (rare) - Capability grants (occasional)</p>
<p>Use Dilithium for: - Agent delegation (frequent) - Audit entries
(constant) - Bulk operations</p>
<hr />
<h2 id="library-support">Library Support</h2>
<h3 id="required-libraries">Required Libraries</h3>
<table>
<thead>
<tr>
<th>Library</th>
<th>SPHINCS+</th>
<th>Dilithium</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>liboqs</td>
<td>Yes</td>
<td>Yes</td>
<td>Open Quantum Safe project</td>
</tr>
<tr>
<td>libsodium</td>
<td>No</td>
<td>No</td>
<td>Not yet</td>
</tr>
<tr>
<td>OpenSSL 3.x</td>
<td>Provider</td>
<td>Provider</td>
<td>Via oqsprovider</td>
</tr>
<tr>
<td>BoringSSL</td>
<td>No</td>
<td>Partial</td>
<td>Google internal</td>
</tr>
</tbody>
</table>
<p><strong>Recommended:</strong> liboqs (Open Quantum Safe) - Reference
implementations - Actively maintained - C library, easy FFI</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">;; crypto-ffi.scm addition</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> sphincs+-sign </span>(foreign-lambda* <span class="op">...</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> sphincs+-verify </span>(foreign-lambda* <span class="op">...</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> dilithium-sign </span>(foreign-lambda* <span class="op">...</span>))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> dilithium-verify </span>(foreign-lambda* <span class="op">...</span>))</span></code></pre></div>
<hr />
<h2 id="security-considerations">Security Considerations</h2>
<h3 id="algorithm-agility">Algorithm Agility</h3>
<p>Cyberspace must survive algorithm obsolescence:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> *supported-algorithms*</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  &#39;((signatures <span class="op">.</span> (ed25519 sphincs+ dilithium))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    (hashes <span class="op">.</span> (sha512 shake256 blake3))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    (encryption <span class="op">.</span> (xchacha20-poly1305 aes-256-gcm))))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(<span class="fu">algorithm-status </span>alg)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">case</span> alg</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    ((ed25519) &#39;deprecated)    <span class="co">; Quantum-vulnerable</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    ((sphincs+) &#39;recommended)  <span class="co">; Post-quantum, conservative</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    ((dilithium) &#39;recommended) <span class="co">; Post-quantum, performant</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    ((sha512) &#39;legacy)         <span class="co">; Quantum-reduced</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    ((shake256) &#39;recommended)  <span class="co">; Post-quantum</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>))</span></code></pre></div>
<h3 id="side-channels">Side Channels</h3>
<p>Post-quantum implementations must be constant-time: - SPHINCS+: Hash
operations are naturally constant-time - Dilithium: Requires careful NTT
implementation</p>
<p>Use only audited implementations (liboqs reference, or formally
verified).</p>
<h3 id="hybrid-security">Hybrid Security</h3>
<p>During transition, hybrid signatures provide defense in depth: - If
Ed25519 is broken → SPHINCS+ holds - If SPHINCS+ has unknown flaw →
Ed25519 holds (pre-Q-Day)</p>
<p>Both must be broken to forge. Belt and suspenders.</p>
<hr />
<h2 id="invariants">Invariants</h2>
<pre><code>S1. Post-quantum signatures are unforgeable (given hash security)
    forge(sphincs+-sig) requires break(shake256)

S2. Hybrid requires both valid
    valid(hybrid-sig) ↔ valid(ed25519-sig) ∧ valid(pq-sig)

S3. Algorithm indicated in signature
    verify(sig) uses algorithm(sig), not ambient config

S4. Key algorithm matches signature algorithm
    sign(sphincs+-key, msg) produces sphincs+-signature

S5. Migration preserves capability validity
    valid-pre-migration(cert) → valid-post-migration(cert) [during transition]</code></pre>
<hr />
<h2 id="the-quantum-winter">The Quantum Winter</h2>
<p>Q-Day is coming. We don’t know when - estimates range from 2030 to
2040. But the harvest-now-decrypt-later threat is real today. Every
Ed25519 signature captured now can be forged after Q-Day.</p>
<p>Cyberspace is built to last. The Library of Alexandria must not burn
twice.</p>
<p>When the quantum winter comes: - Merkle trees (RFC-042) protect
object identity - SPHINCS+/Dilithium protect signatures - The sealed
closure remains sealed - The wilderness of mirrors endures</p>
<p>Prepare now. Migrate early. Survive.</p>
<hr />
<h2 id="references">References</h2>
<ol type="1">
<li>NIST Post-Quantum Cryptography Standardization</li>
<li>SPHINCS+ specification - https://sphincs.org/</li>
<li>CRYSTALS-Dilithium specification -
https://pq-crystals.org/dilithium/</li>
<li>Open Quantum Safe project - https://openquantumsafe.org/</li>
<li>Shor, P., “Algorithms for Quantum Computation”, 1994</li>
<li>RFC-041 - Keystore and Attestation</li>
<li>RFC-042 - Quantum-Resistant Merkle Trees</li>
</ol>
<hr />
<h2 id="changelog">Changelog</h2>
<ul>
<li>2026-01-08 - Initial draft</li>
</ul>
</body>
</html>
