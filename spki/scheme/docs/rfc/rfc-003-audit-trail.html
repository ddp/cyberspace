<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <title>RFC-003: Cryptographic Audit Trail</title>
  <link rel="stylesheet" href="rfc.css">
</head>
<body>
<span class="theme-toggle" onclick="toggleTheme()" title="Toggle light/dark">[theme]</span>
<h1>RFC-003: Cryptographic Audit Trail</h1>
<dl class="metadata">
</dl>
<hr>
<section>
<h2>Abstract</h2>
<p>This RFC specifies the cryptographic audit trail system for the Library of Cyberspace, providing tamper-evident, hash-chained logging with SPKI principal attribution and Ed25519 signatures.</p>
</section>
<section>
<h2>Motivation</h2>
<p>Distributed systems require accountability. Who did what, when, and under whose authority?</p>
<h3>Heritage: VMS Cluster-Wide Audit</h3>
<p>This audit trail descends from VMS SECURITY.AUDIT$JOURNAL and the cluster-wide security infrastructure of VMS 6.0 (1993). That system introduced:</p>
<ul>
<li>SECURITYPOLICY bit 7 propagation</li>
<li>Intrusion detection state replicated cluster-wide</li>
<li>Cluster-wide intrusion detection</li>
<li>Breakin attempts detected across all nodes as one</li>
<li>TLV-encoded object store</li>
<li>The [000000]SECURITY.SYS file in ODS5 stored SECURITYCLASS records</li>
</ul>
<p>The design principle then, as now: cluster nodes behave identically. N nodes, one security domain. Every significant action audited, every audit record signed.</p>
<p>Cyberspace audit trails apply the same principle at IPv6 scale.</p>
<h3>The Problem</h3>
<p>Traditional logging fails on all counts: - Tamperable: Text files can be edited - Anonymous: No cryptographic identity - Disconnected: No provable ordering - Unverifiable: No mathematical proof of integrity</p>
<p>Cyberspace audit trails provide: 1. Content-addressed entries - Tamper-evident by hash 2. Hash-chained structure - Append-only ordering 3. SPKI attribution - Cryptographic actor identity 4. Ed25519 seals - Mathematical proof of authenticity 5. Dual context - Human-readable motivation + machine-parseable environment</p>
</section>
<section>
<h2>Specification</h2>
<h3>Entry Structure</h3>
<pre class="language-scheme">
(audit-entry
  (id "sha512:b14471cd57ea557f...")
  (timestamp "2026-01-05 23:38:20Z")
  (sequence 1)
  (parent-id "sha512:previous...")
  (actor
    (principal #${public-key-blob})
    (authorization-chain))
  (action
    (verb seal-publish)
    (object "1.0.0")
    (parameters "/path/to/remote"))
  (context
    (motivation "Published to filesystem")
    (language "en"))
  (environment
    (platform "darwin")
    (timestamp 1767685100))
  (seal
    (algorithm "ed25519-sha512")
    (content-hash "...")
    (signature "...")))
</pre>
<h3>Core Fields</h3>
<table>
<tr><th>Field </th><th>Type </th><th>Description </th></tr>
<tr><td>id </td><td>string </td><td>Content-addressed hash (SHA-512, first 32 hex chars) </td></tr>
<tr><td>timestamp </td><td>string </td><td>ISO 8601 UTC (YYYY-MM-DD HH:MM:SSZ) </td></tr>
<tr><td>sequence </td><td>integer </td><td>Monotonic counter within audit trail </td></tr>
<tr><td>parent-id </td><td>string/nil </td><td>ID of previous entry (hash chain) </td></tr>
<tr><td>actor </td><td>record </td><td>SPKI principal who performed action </td></tr>
<tr><td>action </td><td>record </td><td>What was done (verb, object, parameters) </td></tr>
<tr><td>context </td><td>record </td><td>Human-readable motivation </td></tr>
<tr><td>environment </td><td>alist </td><td>Machine environment snapshot </td></tr>
<tr><td>seal </td><td>record </td><td>Cryptographic signature </td></tr>
</table>
<h3>Actor Record</h3>
<pre class="language-scheme">
(define-record-type &lt;audit-actor&gt;
  (make-audit-actor principal authorization-chain)
  audit-actor?
  (principal actor-principal)              ; Public key blob
  (authorization-chain actor-authorization-chain))  ; SPKI cert chain
</pre>
<p>The actor is identified by: - Principal: Ed25519 public key (32 bytes) - Authorization chain: Optional SPKI certificate chain proving delegation</p>
<h3>Action Record</h3>
<pre class="language-scheme">
(define-record-type &lt;audit-action&gt;
  (make-audit-action verb object parameters)
  audit-action?
  (verb action-verb)        ; Symbol: seal-commit, seal-publish, etc.
  (object action-object)    ; Primary target
  (parameters action-parameters))  ; Additional arguments
</pre>
<p>Standard verbs: - seal-commit - Version control commit - seal-publish - Release publication - seal-subscribe - Subscription to remote - seal-synchronize - Bidirectional sync - seal-release - Version tagging</p>
<h3>Context Record</h3>
<pre class="language-scheme">
(define-record-type &lt;audit-context&gt;
  (make-audit-context motivation relates-to language)
  audit-context?
  (motivation context-motivation)    ; Human explanation
  (relates-to context-relates-to)    ; Related entries
  (language context-language))       ; ISO 639-1 code
</pre>
<p>Context provides: - Motivation: Why the action was taken (human-readable) - Relates-to: Cross-references to related audit entries - Language: For internationalization</p>
<h3>Seal Record</h3>
<pre class="language-scheme">
(define-record-type &lt;audit-seal&gt;
  (make-audit-seal algorithm content-hash signature)
  audit-seal?
  (algorithm seal-algorithm)        ; "ed25519-sha512"
  (content-hash seal-content-hash)  ; SHA-512 of unsealed entry
  (signature seal-signature))       ; Ed25519 signature
</pre>
</section>
<section>
<h2>Operations</h2>
<h3>audit-init</h3>
<p>Initialize audit trail for a vault.</p>
<pre class="language-scheme">
(audit-init signing-key: key audit-dir: ".vault/audit")
</pre>
<h3>audit-append</h3>
<p>Create and sign a new audit entry.</p>
<pre class="language-scheme">
(audit-append
  actor: public-key-blob
  action: '(seal-commit "hash123")
  motivation: "Added new feature"
  signing-key: private-key-blob)
</pre>
<p>Process: 1. Increment sequence counter 2. Get parent entry ID (hash chain link) 3. Build unsealed entry structure 4. Compute SHA-512 hash of canonical S-expression 5. Sign hash with Ed25519 6. Create seal record 7. Save entry to disk</p>
<h3>audit-verify</h3>
<p>Verify cryptographic seal on an entry.</p>
<pre class="language-scheme">
(audit-verify entry public-key: key)
</pre>
<p>Verification steps: 1. Reconstruct unsealed entry 2. Compute SHA-512 hash 3. Compare with stored content-hash 4. Verify Ed25519 signature</p>
<h3>audit-chain</h3>
<p>Verify entire audit chain.</p>
<pre class="language-scheme">
(audit-chain verify-key: public-key)
</pre>
<p>Verifies: - Each entry's signature is valid - Parent-id references form valid chain - Sequence numbers are monotonic</p>
<h3>audit-read</h3>
<p>Read specific audit entry.</p>
<pre class="language-scheme">
(audit-read sequence: 42)
(audit-read id: "sha512:...")
</pre>
</section>
<section>
<h2>Storage Format</h2>
<p>Entries stored as individual S-expression files:</p>
<pre>
.vault/audit/
  1.sexp
  2.sexp
  3.sexp
  ...
</pre>
<p>File naming by sequence number enables efficient: - Sequential reads - Range queries - Latest entry lookup</p>
</section>
<section>
<h2>Security Considerations</h2>
<h3>Threat Model</h3>
<p>Trusted: - Local filesystem (during operation) - Ed25519 implementation (libsodium) - Private keys</p>
<p>Untrusted: - Storage medium (after creation) - Network transport - Other actors</p>
<h3>Attack Mitigations</h3>
<table>
<tr><th>Attack </th><th>Mitigation </th></tr>
<tr><td>Entry modification </td><td>SHA-512 hash detects tampering </td></tr>
<tr><td>Entry deletion </td><td>Chain breaks are detectable </td></tr>
<tr><td>Entry insertion </td><td>Hash chain prevents backdating </td></tr>
<tr><td>Actor impersonation </td><td>Ed25519 signatures verify identity </td></tr>
<tr><td>Replay attacks </td><td>Sequence numbers detect duplicates </td></tr>
</table>
<h3>Non-Repudiation</h3>
<p>Once an entry is signed and published: - Actor cannot deny performing the action - Timestamp cannot be backdated - Content cannot be altered - Signature mathematically proves authorship</p>
</section>
<section>
<h2>Integration Points</h2>
<h3>Vault Operations</h3>
<p>All vault operations record audit entries:</p>
<div class="diagram-container">
<svg class="diagram" viewBox="0 0 614.4 57.6" width="614.4" height="57.6" xmlns="http://www.w3.org/2000/svg">
<style>
  line { stroke: currentColor; stroke-width: 1.5; stroke-linecap: round; }
  text { font-family: 'Hack', 'SF Mono', monospace; font-size: 14px; fill: currentColor; }
</style>

<text x="4.8" y="9.6" text-anchor="middle" dominant-baseline="central">(</text>
<text x="14.4" y="9.6" text-anchor="middle" dominant-baseline="central">s</text>
<text x="24.0" y="9.6" text-anchor="middle" dominant-baseline="central">e</text>
<text x="33.6" y="9.6" text-anchor="middle" dominant-baseline="central">a</text>
<text x="43.2" y="9.6" text-anchor="middle" dominant-baseline="central">l</text>
<text x="52.8" y="9.6" text-anchor="middle" dominant-baseline="central">-</text>
<text x="62.4" y="9.6" text-anchor="middle" dominant-baseline="central">c</text>
<text x="72.0" y="9.6" text-anchor="middle" dominant-baseline="central">o</text>
<text x="81.6" y="9.6" text-anchor="middle" dominant-baseline="central">m</text>
<text x="91.2" y="9.6" text-anchor="middle" dominant-baseline="central">m</text>
<text x="100.8" y="9.6" text-anchor="middle" dominant-baseline="central">i</text>
<text x="110.4" y="9.6" text-anchor="middle" dominant-baseline="central">t</text>
<text x="129.6" y="9.6" text-anchor="middle" dominant-baseline="central">"</text>
<text x="139.2" y="9.6" text-anchor="middle" dominant-baseline="central">m</text>
<text x="148.8" y="9.6" text-anchor="middle" dominant-baseline="central">e</text>
<text x="158.4" y="9.6" text-anchor="middle" dominant-baseline="central">s</text>
<text x="168.0" y="9.6" text-anchor="middle" dominant-baseline="central">s</text>
<text x="177.6" y="9.6" text-anchor="middle" dominant-baseline="central">a</text>
<text x="187.2" y="9.6" text-anchor="middle" dominant-baseline="central">g</text>
<text x="196.8" y="9.6" text-anchor="middle" dominant-baseline="central">e</text>
<text x="206.4" y="9.6" text-anchor="middle" dominant-baseline="central">"</text>
<text x="216.0" y="9.6" text-anchor="middle" dominant-baseline="central">)</text>
<text x="273.6" y="9.6" text-anchor="middle" dominant-baseline="central">→</text>
<text x="292.8" y="9.6" text-anchor="middle" dominant-baseline="central">(</text>
<text x="302.4" y="9.6" text-anchor="middle" dominant-baseline="central">a</text>
<text x="312.0" y="9.6" text-anchor="middle" dominant-baseline="central">c</text>
<text x="321.6" y="9.6" text-anchor="middle" dominant-baseline="central">t</text>
<text x="331.2" y="9.6" text-anchor="middle" dominant-baseline="central">i</text>
<text x="340.8" y="9.6" text-anchor="middle" dominant-baseline="central">o</text>
<text x="350.4" y="9.6" text-anchor="middle" dominant-baseline="central">n</text>
<text x="369.6" y="9.6" text-anchor="middle" dominant-baseline="central">(</text>
<text x="379.2" y="9.6" text-anchor="middle" dominant-baseline="central">v</text>
<text x="388.8" y="9.6" text-anchor="middle" dominant-baseline="central">e</text>
<text x="398.4" y="9.6" text-anchor="middle" dominant-baseline="central">r</text>
<text x="408.0" y="9.6" text-anchor="middle" dominant-baseline="central">b</text>
<text x="427.2" y="9.6" text-anchor="middle" dominant-baseline="central">s</text>
<text x="436.8" y="9.6" text-anchor="middle" dominant-baseline="central">e</text>
<text x="446.4" y="9.6" text-anchor="middle" dominant-baseline="central">a</text>
<text x="456.0" y="9.6" text-anchor="middle" dominant-baseline="central">l</text>
<text x="465.6" y="9.6" text-anchor="middle" dominant-baseline="central">-</text>
<text x="475.2" y="9.6" text-anchor="middle" dominant-baseline="central">c</text>
<text x="484.8" y="9.6" text-anchor="middle" dominant-baseline="central">o</text>
<text x="494.4" y="9.6" text-anchor="middle" dominant-baseline="central">m</text>
<text x="504.0" y="9.6" text-anchor="middle" dominant-baseline="central">m</text>
<text x="513.6" y="9.6" text-anchor="middle" dominant-baseline="central">i</text>
<text x="523.2" y="9.6" text-anchor="middle" dominant-baseline="central">t</text>
<text x="532.8" y="9.6" text-anchor="middle" dominant-baseline="central">)</text>
<text x="552.0" y="9.6" text-anchor="middle" dominant-baseline="central">.</text>
<text x="561.6" y="9.6" text-anchor="middle" dominant-baseline="central">.</text>
<text x="571.2" y="9.6" text-anchor="middle" dominant-baseline="central">.</text>
<text x="580.8" y="9.6" text-anchor="middle" dominant-baseline="central">)</text>
<text x="4.8" y="28.8" text-anchor="middle" dominant-baseline="central">(</text>
<text x="14.4" y="28.8" text-anchor="middle" dominant-baseline="central">s</text>
<text x="24.0" y="28.8" text-anchor="middle" dominant-baseline="central">e</text>
<text x="33.6" y="28.8" text-anchor="middle" dominant-baseline="central">a</text>
<text x="43.2" y="28.8" text-anchor="middle" dominant-baseline="central">l</text>
<text x="52.8" y="28.8" text-anchor="middle" dominant-baseline="central">-</text>
<text x="62.4" y="28.8" text-anchor="middle" dominant-baseline="central">p</text>
<text x="72.0" y="28.8" text-anchor="middle" dominant-baseline="central">u</text>
<text x="81.6" y="28.8" text-anchor="middle" dominant-baseline="central">b</text>
<text x="91.2" y="28.8" text-anchor="middle" dominant-baseline="central">l</text>
<text x="100.8" y="28.8" text-anchor="middle" dominant-baseline="central">i</text>
<text x="110.4" y="28.8" text-anchor="middle" dominant-baseline="central">s</text>
<text x="120.0" y="28.8" text-anchor="middle" dominant-baseline="central">h</text>
<text x="139.2" y="28.8" text-anchor="middle" dominant-baseline="central">"</text>
<text x="148.8" y="28.8" text-anchor="middle" dominant-baseline="central">1</text>
<text x="158.4" y="28.8" text-anchor="middle" dominant-baseline="central">.</text>
<text x="168.0" y="28.8" text-anchor="middle" dominant-baseline="central">0</text>
<text x="177.6" y="28.8" text-anchor="middle" dominant-baseline="central">.</text>
<text x="187.2" y="28.8" text-anchor="middle" dominant-baseline="central">0</text>
<text x="196.8" y="28.8" text-anchor="middle" dominant-baseline="central">"</text>
<text x="216.0" y="28.8" text-anchor="middle" dominant-baseline="central">.</text>
<text x="225.6" y="28.8" text-anchor="middle" dominant-baseline="central">.</text>
<text x="235.2" y="28.8" text-anchor="middle" dominant-baseline="central">.</text>
<text x="244.8" y="28.8" text-anchor="middle" dominant-baseline="central">)</text>
<text x="273.6" y="28.8" text-anchor="middle" dominant-baseline="central">→</text>
<text x="292.8" y="28.8" text-anchor="middle" dominant-baseline="central">(</text>
<text x="302.4" y="28.8" text-anchor="middle" dominant-baseline="central">a</text>
<text x="312.0" y="28.8" text-anchor="middle" dominant-baseline="central">c</text>
<text x="321.6" y="28.8" text-anchor="middle" dominant-baseline="central">t</text>
<text x="331.2" y="28.8" text-anchor="middle" dominant-baseline="central">i</text>
<text x="340.8" y="28.8" text-anchor="middle" dominant-baseline="central">o</text>
<text x="350.4" y="28.8" text-anchor="middle" dominant-baseline="central">n</text>
<text x="369.6" y="28.8" text-anchor="middle" dominant-baseline="central">(</text>
<text x="379.2" y="28.8" text-anchor="middle" dominant-baseline="central">v</text>
<text x="388.8" y="28.8" text-anchor="middle" dominant-baseline="central">e</text>
<text x="398.4" y="28.8" text-anchor="middle" dominant-baseline="central">r</text>
<text x="408.0" y="28.8" text-anchor="middle" dominant-baseline="central">b</text>
<text x="427.2" y="28.8" text-anchor="middle" dominant-baseline="central">s</text>
<text x="436.8" y="28.8" text-anchor="middle" dominant-baseline="central">e</text>
<text x="446.4" y="28.8" text-anchor="middle" dominant-baseline="central">a</text>
<text x="456.0" y="28.8" text-anchor="middle" dominant-baseline="central">l</text>
<text x="465.6" y="28.8" text-anchor="middle" dominant-baseline="central">-</text>
<text x="475.2" y="28.8" text-anchor="middle" dominant-baseline="central">p</text>
<text x="484.8" y="28.8" text-anchor="middle" dominant-baseline="central">u</text>
<text x="494.4" y="28.8" text-anchor="middle" dominant-baseline="central">b</text>
<text x="504.0" y="28.8" text-anchor="middle" dominant-baseline="central">l</text>
<text x="513.6" y="28.8" text-anchor="middle" dominant-baseline="central">i</text>
<text x="523.2" y="28.8" text-anchor="middle" dominant-baseline="central">s</text>
<text x="532.8" y="28.8" text-anchor="middle" dominant-baseline="central">h</text>
<text x="542.4" y="28.8" text-anchor="middle" dominant-baseline="central">)</text>
<text x="561.6" y="28.8" text-anchor="middle" dominant-baseline="central">.</text>
<text x="571.2" y="28.8" text-anchor="middle" dominant-baseline="central">.</text>
<text x="580.8" y="28.8" text-anchor="middle" dominant-baseline="central">.</text>
<text x="590.4" y="28.8" text-anchor="middle" dominant-baseline="central">)</text>
<text x="4.8" y="48.0" text-anchor="middle" dominant-baseline="central">(</text>
<text x="14.4" y="48.0" text-anchor="middle" dominant-baseline="central">s</text>
<text x="24.0" y="48.0" text-anchor="middle" dominant-baseline="central">e</text>
<text x="33.6" y="48.0" text-anchor="middle" dominant-baseline="central">a</text>
<text x="43.2" y="48.0" text-anchor="middle" dominant-baseline="central">l</text>
<text x="52.8" y="48.0" text-anchor="middle" dominant-baseline="central">-</text>
<text x="62.4" y="48.0" text-anchor="middle" dominant-baseline="central">s</text>
<text x="72.0" y="48.0" text-anchor="middle" dominant-baseline="central">u</text>
<text x="81.6" y="48.0" text-anchor="middle" dominant-baseline="central">b</text>
<text x="91.2" y="48.0" text-anchor="middle" dominant-baseline="central">s</text>
<text x="100.8" y="48.0" text-anchor="middle" dominant-baseline="central">c</text>
<text x="110.4" y="48.0" text-anchor="middle" dominant-baseline="central">r</text>
<text x="120.0" y="48.0" text-anchor="middle" dominant-baseline="central">i</text>
<text x="129.6" y="48.0" text-anchor="middle" dominant-baseline="central">b</text>
<text x="139.2" y="48.0" text-anchor="middle" dominant-baseline="central">e</text>
<text x="158.4" y="48.0" text-anchor="middle" dominant-baseline="central">r</text>
<text x="168.0" y="48.0" text-anchor="middle" dominant-baseline="central">e</text>
<text x="177.6" y="48.0" text-anchor="middle" dominant-baseline="central">m</text>
<text x="187.2" y="48.0" text-anchor="middle" dominant-baseline="central">o</text>
<text x="196.8" y="48.0" text-anchor="middle" dominant-baseline="central">t</text>
<text x="206.4" y="48.0" text-anchor="middle" dominant-baseline="central">e</text>
<text x="225.6" y="48.0" text-anchor="middle" dominant-baseline="central">.</text>
<text x="235.2" y="48.0" text-anchor="middle" dominant-baseline="central">.</text>
<text x="244.8" y="48.0" text-anchor="middle" dominant-baseline="central">.</text>
<text x="254.4" y="48.0" text-anchor="middle" dominant-baseline="central">)</text>
<text x="273.6" y="48.0" text-anchor="middle" dominant-baseline="central">→</text>
<text x="292.8" y="48.0" text-anchor="middle" dominant-baseline="central">(</text>
<text x="302.4" y="48.0" text-anchor="middle" dominant-baseline="central">a</text>
<text x="312.0" y="48.0" text-anchor="middle" dominant-baseline="central">c</text>
<text x="321.6" y="48.0" text-anchor="middle" dominant-baseline="central">t</text>
<text x="331.2" y="48.0" text-anchor="middle" dominant-baseline="central">i</text>
<text x="340.8" y="48.0" text-anchor="middle" dominant-baseline="central">o</text>
<text x="350.4" y="48.0" text-anchor="middle" dominant-baseline="central">n</text>
<text x="369.6" y="48.0" text-anchor="middle" dominant-baseline="central">(</text>
<text x="379.2" y="48.0" text-anchor="middle" dominant-baseline="central">v</text>
<text x="388.8" y="48.0" text-anchor="middle" dominant-baseline="central">e</text>
<text x="398.4" y="48.0" text-anchor="middle" dominant-baseline="central">r</text>
<text x="408.0" y="48.0" text-anchor="middle" dominant-baseline="central">b</text>
<text x="427.2" y="48.0" text-anchor="middle" dominant-baseline="central">s</text>
<text x="436.8" y="48.0" text-anchor="middle" dominant-baseline="central">e</text>
<text x="446.4" y="48.0" text-anchor="middle" dominant-baseline="central">a</text>
<text x="456.0" y="48.0" text-anchor="middle" dominant-baseline="central">l</text>
<text x="465.6" y="48.0" text-anchor="middle" dominant-baseline="central">-</text>
<text x="475.2" y="48.0" text-anchor="middle" dominant-baseline="central">s</text>
<text x="484.8" y="48.0" text-anchor="middle" dominant-baseline="central">u</text>
<text x="494.4" y="48.0" text-anchor="middle" dominant-baseline="central">b</text>
<text x="504.0" y="48.0" text-anchor="middle" dominant-baseline="central">s</text>
<text x="513.6" y="48.0" text-anchor="middle" dominant-baseline="central">c</text>
<text x="523.2" y="48.0" text-anchor="middle" dominant-baseline="central">r</text>
<text x="532.8" y="48.0" text-anchor="middle" dominant-baseline="central">i</text>
<text x="542.4" y="48.0" text-anchor="middle" dominant-baseline="central">b</text>
<text x="552.0" y="48.0" text-anchor="middle" dominant-baseline="central">e</text>
<text x="561.6" y="48.0" text-anchor="middle" dominant-baseline="central">)</text>
<text x="580.8" y="48.0" text-anchor="middle" dominant-baseline="central">.</text>
<text x="590.4" y="48.0" text-anchor="middle" dominant-baseline="central">.</text>
<text x="600.0" y="48.0" text-anchor="middle" dominant-baseline="central">.</text>
<text x="609.6" y="48.0" text-anchor="middle" dominant-baseline="central">)</text>
</svg>
</div>
<h3>SPKI Authorization</h3>
<p>Audit entries can include authorization chains:</p>
<pre class="language-scheme">
(actor
  (principal #${bob-public-key})
  (authorization-chain
    (signed-cert ...)   ; Alice delegated to Bob
    (signed-cert ...))) ; Root delegated to Alice
</pre>
<p>This proves not just who acted, but under whose authority.</p>
</section>
<section>
<h2>Export Formats</h2>
<h3>S-expression Export</h3>
<pre class="language-scheme">
(audit-export-sexp output: "audit-export.sexp")
</pre>
<p>Produces:</p>
<pre class="language-scheme">
(audit-trail
  (audit-entry ...)
  (audit-entry ...)
  ...)
</pre>
<h3>Human-readable Export</h3>
<pre class="language-scheme">
(audit-export-human output: "audit-export.txt")
</pre>
<p>Produces:</p>
<pre>
AUDIT TRAIL - Library of Cyberspace
===================================

Entry #1
  ID: sha512:b14471cd57ea557f...
  Time: 2026-01-05 23:38:20Z
  Action: seal-publish
  Why: Published release to filesystem

Entry #2
  ...
</pre>
</section>
<section>
<h2>Implementation Notes</h2>
<h3>Dependencies</h3>
<ul>
<li>crypto-ffi</li>
<li>Ed25519 signatures, SHA-512 hashing - srfi-1</li>
<li>List utilities - srfi-4 - u8vectors for binary data - srfi-13</li>
<li>String utilities</li>
</ul>
<h3>Performance Considerations</h3>
<ul>
<li>Content-addressed IDs enable O(1) lookup by hash</li>
<li>Sequential file naming enables efficient range queries</li>
<li>Lazy verification: verify on read, not on load</li>
</ul>
</section>
<section>
<h2>References</h2>
<p>1. Haber, S., &amp; Stornetta, W. S. (1991). How to time-stamp a digital document. 2. Merkle, R. C. (1987). A digital signature based on a conventional encryption function. 3. Bernstein, D. J. (2006). Curve25519: new Diffie-Hellman speed records. 4. SPKI/SDSI - RFC 2693, RFC 2692</p>
</section>
<section>
<h2>Changelog</h2>
<ul>
<li>2026-01-06</li>
<li>Initial specification</li>
</ul>
</section>
<script>
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
}
(function() {
  // Query param override (for REPL: ?theme=dark or ?theme=light)
  const params = new URLSearchParams(window.location.search);
  const param = params.get('theme');
  if (param === 'dark' || param === 'light') {
    document.documentElement.setAttribute('data-theme', param);
    localStorage.setItem('theme', param);
    return;
  }
  // localStorage preference
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.setAttribute('data-theme', saved);
  } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', 'light');
  }
})();
</script>
</body>
</html>
