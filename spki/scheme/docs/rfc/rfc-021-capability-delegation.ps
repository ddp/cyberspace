%!PS-Adobe-3.0
%%Creator: groff version 1.23.0
%%CreationDate: Mon Jan 12 10:26:42 2026
%%DocumentNeededResources: font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%+ font Courier
%%DocumentSuppliedResources: procset grops 1.23 0
%%Pages: 12
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.23 0
%!PS-Adobe-3.0 Resource-ProcSet
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
% The ASCII code of the space character.
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
% name size font SF -
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
% name a c d font MF -
/MF{
findfont
[5 2 roll
0 3 1 roll % b
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
% Enable manual feed.
% MANUAL -
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
% Guess the page length.
% This assumes that the imageable area is vertically centered on the page.
% PLG - length
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
% BP -
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
% centerx centery radius startangle endangle DA -
/DA{
newpath arcn stroke
}bind def
% x y SN - x' y'
% round a position to nearest (pixel + (.25,.25))
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
% endx endy startx starty DL -
% we round the endpoints of the line, so that parallel horizontal
% and vertical lines will appear even
/DL{
SN
moveto
SN
lineto stroke
}bind def
% centerx centery radius DC -
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
%  width height centerx centery DE -
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
% these are for splines
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
% fill the last path
% r g b Fr -
/Fr{
setrgbcolor fill
}bind def
% c m y k Fk -
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
% g Fg -
/Fg{
setgray fill
}bind def
% fill with the "current color"
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
% new_font_name encoding_vector old_font_name RE -
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
% hpos vpos EBEGIN -
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
% llx lly newwid wid newht ht newllx newlly PBEGIN -
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
% set the graphics state to default values
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
%
%  Any included setpagedevice should be ignored.
%  See: http://www.w-beer.de/doc/ps/.
%
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%EndProlog
%%BeginSetup
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Times-Bold
%%IncludeResource: font Times-Italic
%%IncludeResource: font Times-Roman
%%IncludeResource: font Courier
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/Euro/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Courier@0 ENC0/Courier RE/Times-Roman@0 ENC0/Times-Roman RE
/Times-Italic@0 ENC0/Times-Italic RE/Times-Bold@0 ENC0/Times-Bold RE
%%EndSetup
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 12/Times-Bold@0 SF(RFC-021: Capability Delegation P)200.328 123 Q
(atter)-.12 E(ns)-.18 E/F1 10/Times-Italic@0 SF(Libr)260.85 159 Q
(ary of Cyber)-.15 E(space)-.1 E/F2 10/Times-Roman@0 SF(2026)296 177 Q
F1(ABSTRA)282.535 213 Q(CT)-.3 E/F3 10/Times-Bold@0 SF 2.5(1. Abstract)
72 261 R F2 .18(This RFC speci\214es capability dele)72 276.6 R -.05(ga)
-.15 G .179(tion patterns for the Library of Cyberspace: ho).05 F 2.679
(wp)-.25 G .179(rincipals grant, attenuate, and)-2.679 F(re)72 288.6 Q
-.2(vo)-.25 G .326 -.1(ke c).2 H .127(apabilities using SPKI certi\214c\
ates, content-addressed objects, and the soup metadata layer. Capabilit\
ies \215o).1 F(w)-.25 E(through dele)72 300.6 Q -.05(ga)-.15 G
(tion chains with monotonically decreasing authority.).05 E F3 2.5
(2. Moti)72 324.6 R -.1(va)-.1 G(tion).1 E F2(Authorization in distrib)
72 340.2 Q(uted systems is hard:)-.2 E 2.682(-A)72 355.8 S .182
(CLs don')-3.082 F 2.682(ts)-.18 G .182(cale - Central lists become bot\
tlenecks - Identity is fragile - Names change, k)-2.682 F -.15(ey)-.1 G
2.682(sr).15 G .182(otate - Ambient au-)-2.682 F
(thority is dangerous - "Run as root" is not a security model - Re)72
367.8 Q -.2(vo)-.25 G
(cation is an afterthought - Usually bolted on badly).2 E
(SPKI \(Simple Public K)72 383.4 Q .3 -.15(ey I)-.25 H
(nfrastructure\) solv).15 E(ed this decades ago:)-.15 E 6.5<8343>72 399
S(apabilities, not identities)-6.5 E 6.5<8357>72 414.6 S
(hat you can do, not who you are)-6.5 E 6.5<834c>72 430.2 S(ocal names)
-6.5 E 6.5<834e>72 445.8 S 2.5(og)-6.5 G(lobal namespace required)-2.5 E
6.5<8344>72 461.4 S(ele)-6.5 E -.05(ga)-.15 G(tion chains).05 E 6.5
<8341>72 477 S(uthority \215o)-6.5 E(ws from source to dele)-.25 E -.05
(ga)-.15 G(te).05 E 6.5<8354>72 492.6 S(hreshold signatures)-6.5 E 6.5
<834d>72 508.2 S(-of-N for critical operations)-6.5 E 1.325
(The Library inte)72 527.4 R 1.325(grates SPKI with content-addressed s\
torage, creating capabilities that are themselv)-.15 F 1.325
(es content-ad-)-.15 F(dressed and introspectable.)72 539.4 Q F3 2.5
(3. Capability)72 563.4 R(Model)2.5 E 2.5(3.1. Principals)72 587.4 R 0
Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-021 0)72 48 R 2.5(Ap)72 84 S
(rincipal is an)-2.5 E(ything that can hold authority:)-.15 E/F1 8
/Courier@0 SF(;; Key principal - most common)108 102 Q(\(make-principal)
108 114 Q(\(type key\))117.6 126 Q(\(algorithm ed25519\))117.6 138 Q
(\(public-key #${...32 bytes...}\)\))117.6 150 Q
(;; Hash principal - content-addressed object)108 174 Q
(\(make-principal)108 186 Q(\(type hash\))117.6 198 Q
(\(algorithm sha256\))117.6 210 Q(\(digest #${...32 bytes...}\)\))117.6
222 Q(;; Threshold principal - M-of-N group)108 246 Q(\(make-principal)
108 258 Q(\(type threshold\))117.6 270 Q(\(threshold 3\))117.6 282 Q
(\(members \(key1 key2 key3 key4 key5\)\)\))117.6 294 Q
(;; Name principal - local binding)108 318 Q(\(make-principal)108 330 Q
(\(type name\))117.6 342 Q(\(issuer parent-key\))117.6 354 Q
(\(name "alice"\)\))117.6 366 Q/F2 10/Times-Bold@0 SF 2.5
(3.2. Capabilities)72 384 R F0 2.5(Ac)72 399.6 S
(apability is a transferable right to perform an action:)-2.5 E F1
(\(capability)108 417.6 Q(\(action read\))117.6 429.6 Q
(\(object \(hash sha256 "content-hash..."\)\)\))117.6 441.6 Q
(\(capability)108 465.6 Q(\(action write\))117.6 477.6 Q
(\(object \(tree sha256 "subtree-root..."\)\)\))117.6 489.6 Q
(\(capability)108 513.6 Q(\(action sign\))117.6 525.6 Q
(\(object \(tag "releases/*"\)\)\))117.6 537.6 Q(\(capability)108 561.6
Q(\(action delegate\))117.6 573.6 Q(\(object \(capability ...\)\)\))
117.6 585.6 Q 4.8(;M)9.6 G(eta-capability)-4.8 E F2 2.5
(3.3. Certi\214cates)72 603.6 R 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-021 0)72 48 R
(SPKI certi\214cates bind capabilities to principals:)72 84 Q/F1 8
/Courier@0 SF(\(spki-cert)108 102 Q(\(issuer vault-master-key\))117.6
114 Q(\(subject alice-key\))117.6 126 Q(\(capability)117.6 138 Q
(\(action read\))127.2 150 Q
(\(object \(tree sha256 "docs-root..."\)\)\))127.2 162 Q(\(validity)
117.6 174 Q(\(not-before "2026-01-01"\))127.2 186 Q
(\(not-after "2027-01-01"\)\))127.2 198 Q(\(delegation #t\)\))117.6 210
Q 4.8(;A)9.6 G(lice can re-delegate)-4.8 E/F2 10/Times-Bold@0 SF 2.5
(4. Delegation)72 228 R(Chains)2.5 E 2.5(4.1. Chain)72 252 R(Structur)
2.5 E(e)-.18 E F0(Authority \215o)72 267.6 Q
(ws through certi\214cate chains:)-.25 E F1(Master Key)108 285.6 Q(|)
127.2 297.6 Q 4.8(v\()127.2 309.6 S(cert: full access to vault\))-4.8 E
(Admin Key)108 321.6 Q(|)127.2 333.6 Q 4.8(v\()127.2 345.6 S
(cert: read/write to docs/, can delegate\))-4.8 E(Developer Key)108
357.6 Q(|)127.2 369.6 Q 4.8(v\()127.2 381.6 S
(cert: read-only to docs/public/, cannot delegate\))-4.8 E
(Contractor Key)108 393.6 Q F2 2.5(4.2. Chain)72 411.6 R -.92(Va)2.5 G
(lidation).92 E F1(\(define \(validate-chain chain target-capability\))
108 429.6 Q("Validate delegation chain grants capability")117.6 441.6 Q
(\(let loop \(\(certs chain\))117.6 453.6 Q
(\(current-authority 'unlimited\)\))170.4 465.6 Q(\(if \(null? certs\))
127.2 477.6 Q
(\(capability-subset? target-capability current-authority\))146.4 489.6
Q(\(let \(\(cert \(car certs\)\)\))146.4 501.6 Q
(\(and \(verify-signature cert\))156 513.6 Q(\(valid-time? cert\))180
525.6 Q(\(not-revoked? cert\))180 537.6 Q
(\(capability-subset? \(cert-capability cert\) current-authority\))180
549.6 Q(\(if \(cert-delegation? cert\))180 561.6 Q
(\(loop \(cdr certs\) \(cert-capability cert\)\))199.2 573.6 Q
(\(and \(null? \(cdr certs\)\))199.2 585.6 Q
(\(capability-subset? target-capability)223.2 597.6 Q
(\(cert-capability cert\)\)\)\)\)\)\)\)\))314.4 609.6 Q F2 2.5
(4.3. Monotonic)72 627.6 R(Attenuation)2.5 E 0 Cg EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-021 0)72 48 R(Dele)72 84 Q -.05(ga)
-.15 G(ted capabilities can only decrease:).05 E/F1 8/Courier@0 SF
(;; Alice has read/write to entire vault)108 102 Q(\(spki-cert)108 114 Q
(\(issuer master\))117.6 126 Q(\(subject alice\))117.6 138 Q
(\(capability \(action \(read write\)\) \(object vault-root\)\))117.6
150 Q(\(delegation #t\)\))117.6 162 Q
(;; Alice delegates read-only to Bob \(valid - attenuation\))108 186 Q
(\(spki-cert)108 198 Q(\(issuer alice\))117.6 210 Q(\(subject bob\))
117.6 222 Q(\(capability \(action read\) \(object vault-root\)\))117.6
234 Q(\(delegation #t\)\))117.6 246 Q
(;; Bob tries to delegate write to Carol \(INVALID - amplification\))108
270 Q(\(spki-cert)108 282 Q(\(issuer bob\))117.6 294 Q
(\(subject carol\))117.6 306 Q
(\(capability \(action write\) \(object vault-root\)\))117.6 318 Q 4.8
(;R)9.6 G(EJECTED)-4.8 E(\(delegation #f\)\))117.6 330 Q
(;; Bob delegates read to subtree only \(valid - further attenuation\))
108 354 Q(\(spki-cert)108 366 Q(\(issuer bob\))117.6 378 Q
(\(subject carol\))117.6 390 Q
(\(capability \(action read\) \(object docs-subtree\)\))117.6 402 Q
(\(delegation #f\)\))117.6 414 Q/F2 10/Times-Bold@0 SF 2.5
(5. Delegation)72 432 R -.1(Pa)2.5 G(tter).1 E(ns)-.15 E 2.5(5.1. P)72
456 R(atter)-.1 E 2.5(n1)-.15 G 2.5(:D)-2.5 G(ir)-2.5 E(ect Delegation)
-.18 E F0(Simplest form - one hop:)72 471.6 Q F1
(\(define \(delegate-direct issuer-key subject-key capability)108 489.6
Q(#!key validity can-delegate\))228 501.6 Q(\(sign-cert issuer-key)117.6
513.6 Q(`\(spki-cert)127.2 525.6 Q
(\(issuer ,\(key->principal issuer-key\)\))136.8 537.6 Q
(\(subject ,\(key->principal subject-key\)\))136.8 549.6 Q
(\(capability ,capability\))136.8 561.6 Q(\(validity ,validity\))136.8
573.6 Q(\(delegation ,can-delegate\)\)\)\))136.8 585.6 Q F2 2.5(5.2. P)
72 603.6 R(atter)-.1 E 2.5(n2)-.15 G 2.5(:R)-2.5 G(ole-Based Delegation)
-2.5 E 0 Cg EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-021 0)72 48 R(Dele)72 84 Q -.05(ga)
-.15 G(te to roles, bind k).05 E -.15(ey)-.1 G 2.5(st).15 G 2.5(or)-2.5
G(oles:)-2.5 E/F1 8/Courier@0 SF(;; Define role)108 102 Q(\(spki-cert)
108 114 Q(\(issuer vault-admin\))117.6 126 Q
(\(subject \(name vault-admin "reviewer"\)\))117.6 138 Q
(\(capability \(action read\) \(object \(tag "pending/*"\)\)\))117.6 150
Q(\(delegation #f\)\))117.6 162 Q(;; Bind key to role)108 186 Q
(\(spki-cert)108 198 Q(\(issuer vault-admin\))117.6 210 Q
(\(subject alice-key\))117.6 222 Q
(\(capability \(name vault-admin "reviewer"\)\))117.6 234 Q
(\(validity \(not-after "2026-06-01"\)\)\))117.6 246 Q
(;; Alice now has reviewer capability via role binding)108 270 Q/F2 10
/Times-Bold@0 SF 2.5(5.3. P)72 288 R(atter)-.1 E 2.5(n3)-.15 G 2.5(:T)
-2.5 G(hr)-2.5 E(eshold Delegation)-.18 E F0(Require multiple parties:)
72 303.6 Q F1(;; Critical operation requires 3-of-5)108 321.6 Q
(\(spki-cert)108 333.6 Q(\(issuer root-key\))117.6 345.6 Q
(\(subject \(threshold 3 \(key1 key2 key3 key4 key5\)\)\))117.6 357.6 Q
(\(capability \(action delete\) \(object vault-root\)\))117.6 369.6 Q
(\(delegation #f\)\))117.6 381.6 Q
(;; Exercise requires gathering signatures)108 405.6 Q
(\(define \(threshold-exercise capability signers\))108 417.6 Q(\(let \
\(\(signatures \(map \(lambda \(key\) \(sign key capability\)\) signers\
\)\)\))117.6 429.6 Q(\(if \(>= \(length signatures\) 3\))127.2 441.6 Q
(\(execute-capability capability signatures\))146.4 453.6 Q
(\(error "Insufficient signatures"\)\)\)\))146.4 465.6 Q F2 2.5(5.4. P)
72 483.6 R(atter)-.1 E 2.5(n4)-.15 G 2.5(:T)-2.5 G
(ime-Bounded Delegation)-2.68 E F0 -.7(Te)72 499.2 S(mporary access:).7
E F1(;; Conference access - 3 days only)108 517.2 Q(\(spki-cert)108
529.2 Q(\(issuer organizer-key\))117.6 541.2 Q(\(subject attendee-key\))
117.6 553.2 Q
(\(capability \(action read\) \(object conference-materials\)\))117.6
565.2 Q(\(validity)117.6 577.2 Q(\(not-before "2026-03-15T09:00:00Z"\))
127.2 589.2 Q(\(not-after "2026-03-17T18:00:00Z"\)\))127.2 601.2 Q
(\(delegation #f\)\))117.6 613.2 Q F2 2.5(5.5. P)72 631.2 R(atter)-.1 E
2.5(n5)-.15 G 2.5(:C)-2.5 G(onditional Delegation)-2.5 E 0 Cg EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-021 0)72 48 R
(Capability with restrictions:)72 84 Q/F1 8/Courier@0 SF
(;; Can read, but only from specific IP range)108 102 Q(\(spki-cert)108
114 Q(\(issuer admin-key\))117.6 126 Q(\(subject service-key\))117.6 138
Q(\(capability \(action read\) \(object api-data\)\))117.6 150 Q
(\(condition)117.6 162 Q(\(source-ip "10.0.0.0/8"\)\))127.2 174 Q
(\(delegation #f\)\))117.6 186 Q
(;; Can write, but only objects under 1MB)108 210 Q(\(spki-cert)108 222
Q(\(issuer admin-key\))117.6 234 Q(\(subject uploader-key\))117.6 246 Q
(\(capability \(action write\) \(object uploads\)\))117.6 258 Q
(\(condition)117.6 270 Q(\(max-size 1048576\)\))127.2 282 Q
(\(delegation #f\)\))117.6 294 Q/F2 10/Times-Bold@0 SF 2.5(5.6. P)72 312
R(atter)-.1 E 2.5(n6)-.15 G 2.5(:P)-2.5 G -.18(ro)-2.5 G(xy Delegation)
.18 E F0(Dele)72 327.6 Q -.05(ga)-.15 G(te through intermediary:).05 E
F1(;; Alice delegates to proxy service)108 345.6 Q(\(spki-cert)108 357.6
Q(\(issuer alice-key\))117.6 369.6 Q(\(subject proxy-key\))117.6 381.6 Q
(\(capability \(action read\) \(object alice-files\)\))117.6 393.6 Q
(\(delegation #t\))117.6 405.6 Q
(\(condition \(proxy-for alice-key\)\)\))117.6 417.6 Q
(;; Proxy can act on Alice's behalf)108 441.6 Q
(;; but chain shows Alice as original authority)108 453.6 Q F2 2.5
(6. Content-Addr)72 471.6 R(essed Capabilities)-.18 E 2.5(6.1. Hash)72
495.6 R(as Capability)2.5 E F0(Kno)72 511.2 Q
(wledge of a content hash is itself a capability \(RFC-020\):)-.25 E F1
(;; Possessing this hash grants read access)108 529.2 Q
(\(define secret-doc-hash "sha256:7f83b1657ff1fc..."\))108 541.2 Q
(;; The hash is unguessable \(256 bits of entropy\))108 565.2 Q
(;; Sharing the hash = sharing the capability)108 577.2 Q
(\(define \(share-capability recipient hash\))108 589.2 Q
(\(encrypted-send recipient hash\)\))117.6 601.2 Q F2 2.5
(6.2. Capability)72 619.2 R(Certi\214cates f)2.5 E(or Hashes)-.25 E 0 Cg
EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-021 0)72 48 R -.15(Fo)72 84 S
(rmalize hash-based access:).15 E/F1 8/Courier@0 SF(\(spki-cert)108 102
Q(\(issuer vault-key\))117.6 114 Q(\(subject reader-key\))117.6 126 Q
(\(capability)117.6 138 Q(\(action read\))127.2 150 Q
(\(object \(hash sha256 "specific-doc..."\)\)\))127.2 162 Q
(\(validity \(not-after "2027-01-01"\)\)\))117.6 174 Q/F2 10
/Times-Bold@0 SF 2.5(6.3. T)72 192 R -.18(re)-.74 G 2.5(eC).18 G
(apabilities)-2.5 E F0(Grant access to Merkle subtree:)72 207.6 Q F1
(\(spki-cert)108 225.6 Q(\(issuer vault-key\))117.6 237.6 Q
(\(subject team-key\))117.6 249.6 Q(\(capability)117.6 261.6 Q
(\(action read\))127.2 273.6 Q
(\(object \(tree sha256 "project-root..."\)\))127.2 285.6 Q
(\(propagate #t\)\))127.2 297.6 Q 4.8(;I)9.6 G
(ncludes all referenced objects)-4.8 E(\(delegation #t\)\))117.6 309.6 Q
F2 2.5(6.4. Sealed)72 327.6 R(Capabilities)2.5 E F0
(Encrypt capability for speci\214c recipient:)72 343.2 Q F1
(\(define \(seal-capability cap recipient-pubkey\))108 361.2 Q
("Encrypt capability so only recipient can use it")117.6 373.2 Q
(\(let \(\(serialized \(serialize cap\)\))117.6 385.2 Q
(\(encrypted \(age-encrypt serialized recipient-pubkey\)\)\))151.2 397.2
Q(\(cas-put encrypted\)\)\))127.2 409.2 Q
(\(define \(unseal-capability sealed-hash identity\))108 433.2 Q
("Decrypt and exercise capability")117.6 445.2 Q
(\(let \(\(encrypted \(cas-get sealed-hash\)\))117.6 457.2 Q
(\(decrypted \(age-decrypt encrypted identity\)\))151.2 469.2 Q
(\(cap \(deserialize decrypted\)\)\))151.2 481.2 Q(cap\)\))127.2 493.2 Q
F2 2.5(7. Re)72 511.2 R -.1(vo)-.15 G(cation).1 E 2.5(7.1. Re)72 535.2 R
-.1(vo)-.15 G(cation Lists).1 E F1(\(spki-crl)108 553.2 Q
(\(issuer vault-admin\))117.6 565.2 Q(\(revoked)117.6 577.2 Q
(\(\(cert-hash "sha256:revoked1..."\))127.2 589.2 Q
(\(reason key-compromise\))132 601.2 Q(\(revoked-at 1767700000\)\))132
613.2 Q(\(\(cert-hash "sha256:revoked2..."\))127.2 625.2 Q
(\(reason superseded\))132 637.2 Q(\(revoked-at 1767700100\)\)\)\))132
649.2 Q 0 Cg EP
%%Page: 8 8
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-021 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(7.2. Online)72 84 R(Re)2.5 E -.1(vo)-.15 G(cation Check).1 E/F2 8
/Courier@0 SF(\(define \(check-revocation cert\))108 102 Q
("Check if certificate is revoked")117.6 114 Q
(\(let* \(\(cert-hash \(sha256 \(serialize cert\)\)\))117.6 126 Q
(\(issuer \(cert-issuer cert\)\))151.2 138 Q
(\(crl \(fetch-crl issuer\)\)\))151.2 150 Q
(\(not \(member cert-hash \(crl-revoked-hashes crl\)\)\)\)\))127.2 162 Q
F1 2.5(7.3. T)72 180 R(ombstone Re)-.92 E -.1(vo)-.15 G(cation).1 E F0
(Using CAS tombstones \(RFC-020\):)72 195.6 Q F2
(\(define \(revoke-capability-tombstone cert-hash reason\))108 213.6 Q
("Revoke by tombstoning the certificate")117.6 225.6 Q
(\(cas-tombstone cert-hash)117.6 237.6 Q(reason: reason)127.2 249.6 Q
(actor: \(current-principal\)\)\))127.2 261.6 Q F1 2.5(7.4. Short-Li)72
279.6 R -.1(ve)-.1 G 2.5(dC).1 G(erti\214cates)-2.5 E F0 -1.22 -.74
(Av o)72 295.2 T(id re).74 E -.2(vo)-.25 G(cation by using short v).2 E
(alidity:)-.25 E F2(;; 1-hour certificate, no revocation needed)108
313.2 Q(\(spki-cert)108 325.2 Q(\(issuer service-key\))117.6 337.2 Q
(\(subject session-key\))117.6 349.2 Q
(\(capability \(action api-access\)\))117.6 361.2 Q(\(validity)117.6
373.2 Q(\(not-before ,\(current-time\)\))127.2 385.2 Q
(\(not-after ,\(+ \(current-time\) 3600\)\)\))127.2 397.2 Q
(\(delegation #f\)\))117.6 409.2 Q F1 2.5(8. Soup)72 427.2 R
(Integration)2.5 E 2.5(8.1. Certi\214cates)72 451.2 R(in the Soup)2.5 E
F0(All certi\214cates are soup objects:)72 466.8 Q F2(\(soup-object)108
484.8 Q(\(name "cert/alice-read-docs"\))117.6 496.8 Q
(\(type certificate\))117.6 508.8 Q(\(size "412B"\))117.6 520.8 Q
(\(crypto \(ed25519 sha256 "cert-hash..."\)\))117.6 532.8 Q
(\(issuer "vault-admin"\))117.6 544.8 Q(\(subject "alice"\))117.6 556.8
Q(\(capability "read docs/*"\))117.6 568.8 Q(\(expires "2027-01-01"\)\))
117.6 580.8 Q 0 Cg EP
%%Page: 9 9
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-021 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(8.2. Querying)72 84 R(Capabilities)2.5 E/F2 8/Courier@0 SF
(;; Find all certificates for a subject)108 102 Q
(\(soup-query type: 'certificate subject: alice-key\))108 114 Q
(;; Find all certificates granting write access)108 138 Q
(\(soup-query type: 'certificate capability: 'write\))108 150 Q
(;; Find expiring certificates)108 174 Q
(\(soup-query type: 'certificate)108 186 Q
(expires-before: \(+ \(current-time\) \(* 7 24 3600\)\)\))165.6 198 Q
(;; Find certificates from specific issuer)108 222 Q
(\(soup-query type: 'certificate issuer: vault-admin\))108 234 Q F1 2.5
(8.3. Capability)72 252 R(Intr)2.5 E(ospection)-.18 E F2
(;; What can Alice do?)108 270 Q
(\(define \(principal-capabilities principal\))108 282 Q(\(let \(\(cert\
s \(soup-query type: 'certificate subject: principal\)\)\))117.6 294 Q
(\(map cert-capability certs\)\)\))127.2 306 Q
(;; Who can read this object?)108 330 Q
(\(define \(object-readers hash\))108 342 Q
(\(let \(\(certs \(soup-query type: 'certificate)117.6 354 Q
(capability: `\(read ,hash\)\)\)\))237.6 366 Q
(\(map cert-subject certs\)\)\))127.2 378 Q
(;; Visualize delegation graph)108 402 Q
(\(define \(delegation-graph root-principal\))108 414 Q(\(let \(\(certs\
 \(soup-query type: 'certificate issuer: root-principal\)\)\))117.6 426
Q(\(map \(lambda \(cert\))127.2 438 Q(\(cons \(cert-subject cert\))160.8
450 Q(\(delegation-graph \(cert-subject cert\)\)\)\))189.6 462 Q
(certs\)\)\))151.2 474 Q F1 2.5(9. A)72 492 R(uthorization Decisions)-.5
E 2.5(9.1. Simple)72 516 R(Check)2.5 E F2
(\(define \(authorized? principal action object\))108 534 Q
("Check if principal can perform action on object")117.6 546 Q(\(let \(\
\(chains \(find-authorization-chains principal action object\)\)\))117.6
558 Q(\(any valid-chain? chains\)\)\))127.2 570 Q 0 Cg EP
%%Page: 10 10
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-021 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(9.2. Chain)72 84 R(Disco)2.5 E -.1(ve)-.1 G(ry).1 E/F2 8/Courier@0
SF(\(define \(find-authorization-chains principal action object\))108
102 Q("Find all certificate chains granting capability")117.6 114 Q
(\(let \(\(target-cap \(capability action object\)\)\))117.6 126 Q
(\(let search \(\(current principal\) \(chain '\(\)\)\))127.2 138 Q
(\(let \(\(certs \(soup-query type: 'certificate subject: current\)\)\))
136.8 150 Q(\(append-map)146.4 162 Q(\(lambda \(cert\))156 174 Q
(\(if \(capability-grants? \(cert-capability cert\) target-cap\))165.6
186 Q(\(list \(reverse \(cons cert chain\)\)\))184.8 198 Q
(\(if \(cert-delegation? cert\))184.8 210 Q
(\(search \(cert-issuer cert\) \(cons cert chain\)\))204 222 Q
('\(\)\)\)\))204 234 Q(certs\)\)\)\)\))156 246 Q F1 2.5(9.3. Cached)72
264 R -.5(Au)2.5 G(thorization).5 E F2
(\(define auth-cache \(make-lru-cache 10000\)\))108 282 Q
(\(define \(authorized?/cached principal action object\))108 306 Q
(\(let \(\(key \(list principal action object\)\)\))117.6 318 Q
(\(or \(lru-get auth-cache key\))127.2 330 Q
(\(let \(\(result \(authorized? principal action object\)\)\))146.4 342
Q(\(lru-put! auth-cache key result\))156 354 Q(result\)\)\)\))156 366 Q
F1 2.5(10. Delegation)72 384 R(Cer)2.5 E(emonies)-.18 E 2.5(10.1. K)72
408 R(ey Cer)-.25 E(emony)-.18 E F0 -.15(Fo)72 423.6 S 2.5(rc).15 G
(ritical dele)-2.5 E -.05(ga)-.15 G(tions:).05 E F2
(\(define \(key-ceremony capability threshold witnesses\))108 441.6 Q
("Conduct witnessed delegation ceremony")117.6 453.6 Q
(\(let* \(\(ceremony-id \(generate-ceremony-id\)\))117.6 465.6 Q
(\(ceremony-record)151.2 477.6 Q(\(ceremony)156 489.6 Q
(\(id ,ceremony-id\))165.6 501.6 Q(\(capability ,capability\))165.6
513.6 Q(\(threshold ,threshold\))165.6 525.6 Q(\(witnesses ,witnesses\))
165.6 537.6 Q(\(started-at ,\(current-time\)\)\)\)\))165.6 549.6 Q
(;; Record ceremony start)127.2 573.6 Q
(\(audit-append action: \(ceremony-start ,ceremony-id\)\))127.2 585.6 Q
(;; Gather witness signatures)127.2 609.6 Q(\(let \(\(signatures \(gath\
er-witness-signatures ceremony-record witnesses\)\)\))127.2 621.6 Q
(\(if \(>= \(length signatures\) threshold\))136.8 633.6 Q
(\(let \(\(cert \(finalize-ceremony ceremony-record signatures\)\)\))156
645.6 Q(\(audit-append action: \(ceremony-complete ,ceremony-id\)\))
165.6 657.6 Q(cert\))165.6 669.6 Q(\(begin)156 681.6 Q
(\(audit-append action: \(ceremony-failed ,ceremony-id\)\))165.6 693.6 Q
(\(error "Insufficient witnesses"\)\)\)\)\)\))165.6 705.6 Q 0 Cg EP
%%Page: 11 11
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-021 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(10.2. Emer)72 84 R(gency Re)-.1 E -.1(vo)-.15 G(cation).1 E/F2 8
/Courier@0 SF(\(define \(emergency-revoke cert-hash reason\))108 102 Q
("Emergency revocation with audit trail")117.6 114 Q
(\(let \(\(revocation)117.6 126 Q(\(emergency-revocation)151.2 138 Q
(\(cert ,cert-hash\))160.8 150 Q(\(reason ,reason\))160.8 162 Q
(\(revoked-by ,\(current-principal\)\))160.8 174 Q
(\(revoked-at ,\(current-time\)\)\)\)\))160.8 186 Q
(;; Immediate tombstone)127.2 210 Q
(\(cas-tombstone cert-hash reason: reason\))127.2 222 Q(;; Add to CRL)
127.2 246 Q(\(crl-append cert-hash reason\))127.2 258 Q
(;; Audit with high priority)127.2 282 Q(\(audit-append)127.2 294 Q
(action: \(emergency-revoke ,cert-hash\))136.8 306 Q(motivation: reason)
136.8 318 Q(priority: 'critical\))136.8 330 Q
(;; Notify affected parties)127.2 354 Q
(\(notify-revocation cert-hash\)\)\))127.2 366 Q F1 2.5(11. Security)72
384 R(Considerations)2.5 E 2.5(11.1. Capability)72 408 R(Leakage)2.5 E
F2(;; Capabilities can leak through:)108 426 Q
(;; 1. Logging - don't log capability tokens)108 438 Q
(;; 2. URLs - don't put capabilities in query strings)108 450 Q
(;; 3. Errors - don't include capabilities in error messages)108 462 Q
(\(define \(safe-log message capability\))108 486 Q
(\(log \(string-append message " [capability:REDACTED]"\)\)\))117.6 498
Q F1 2.5(11.2. Confused)72 516 R(Deputy)2.5 E F2
(;; Always verify capability matches intended action)108 534 Q
(\(define \(execute-action action object capability\))108 546 Q
(\(unless \(capability-grants? capability action object\))117.6 558 Q
(\(error "Capability does not grant this action"\)\))127.2 570 Q
(\(perform-action action object\)\))117.6 582 Q F1 2.5(11.3. T)72 600 R
(ime-of-Check vs T)-.18 E(ime-of-Use)-.18 E F2
(;; Validate immediately before use, not before)108 618 Q
(\(define \(safe-execute capability action\))108 630 Q
(\(let \(\(validated \(validate-capability capability\)\)\))117.6 642 Q
(;; No window between check and use)127.2 654 Q(\(atomically)127.2 666 Q
(\(unless validated)136.8 678 Q(\(error "Invalid capability"\)\))146.4
690 Q(\(perform-action action\)\)\)\))136.8 702 Q 0 Cg EP
%%Page: 12 12
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 423.27(RFC-021 0)72 48 R/F1 10/Times-Bold@0 SF
2.5(11.4. Delegation)72 84 R(Depth Limits)2.5 E/F2 8/Courier@0 SF
(;; Prevent infinite delegation chains)108 102 Q
(\(define max-delegation-depth 10\))108 114 Q
(\(define \(validate-chain-depth chain\))108 138 Q
(\(when \(> \(length chain\) max-delegation-depth\))117.6 150 Q
(\(error "Delegation chain too deep"\)\)\))127.2 162 Q F1 2.5
(12. Implementation)72 180 R(Notes)2.5 E 2.5(12.1. Certi\214cate)72 204
R(Storage)2.5 E F2(;; Certificates stored in CAS)108 222 Q
(\(define \(store-cert cert\))108 234 Q
(\(let \(\(signed \(sign-cert cert\)\)\))117.6 246 Q
(\(cas-put \(serialize signed\)\)\)\))127.2 258 Q
(;; Indexed by issuer and subject for fast lookup)108 282 Q
(\(define cert-by-issuer \(make-hash-table\)\))108 294 Q
(\(define cert-by-subject \(make-hash-table\)\))108 306 Q F1 2.5
(12.2. P)72 324 R(erf)-.2 E(ormance)-.25 E F0 6.5<8343>72 339.6 S
(erti\214cate v)-6.5 E(alidation is e)-.25 E(xpensi)-.15 E .3 -.15
(ve - c)-.25 H(ache results).15 E 6.5<8343>72 355.2 S(hain disco)-6.5 E
-.15(ve)-.15 G(ry can be slo).15 E 2.5(w-i)-.25 G(nde)-2.5 E 2.5(xb)-.15
G 2.5(yi)-2.5 G(ssuer/subject)-2.5 E 6.5<8352>72 370.8 S -2.2 -.25(ev o)
-6.5 H(cation checks add latenc).25 E 2.5(y-u)-.15 G(se short-li)-2.5 E
-.15(ve)-.25 G 2.5(dc).15 G(erts when possible)-2.5 E F1 2.5(13. Refer)
72 398.4 R(ences)-.18 E F0 .459(1. SPKI/SDSI 2.0 - RFC 2693 \(preserv)72
414 R .458(ed\) 2. A Logic of Authentication - Burro)-.15 F .458
(ws, Abadi, Needham \(preserv)-.25 F .458(ed\) 3.)-.15 F .048
(Capability Myths Demolished - Miller)72 426 R 2.548(,Y)-.4 G .048
(ee, Shapiro \(preserv)-3.548 F .049
(ed\) 4. RFC-004: SPKI Authorization 5. RFC-020: Con-)-.15 F
(tent-Addressed Storage 6. RFC-007: Threshold Signature Go)72 438 Q -.15
(ve)-.15 G(rnance).15 E F1 2.5(14. Changelog)72 462 R F0 6.5<8332>72
477.6 S(026-01-07)-6.5 E 6.5<8349>72 493.2 S(nitial draft)-6.5 E 0 Cg EP
%%Trailer
end
%%EOF
