%!PS-Adobe-3.0
%%Creator: groff version 1.23.0
%%CreationDate: Thu Jan  8 15:17:54 2026
%%DocumentNeededResources: font Times-Roman
%%DocumentSuppliedResources: procset grops 1.23 0
%%Pages: 10
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.23 0
%!PS-Adobe-3.0 Resource-ProcSet
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
% The ASCII code of the space character.
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
% name size font SF -
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
% name a c d font MF -
/MF{
findfont
[5 2 roll
0 3 1 roll % b
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
% Enable manual feed.
% MANUAL -
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
% Guess the page length.
% This assumes that the imageable area is vertically centered on the page.
% PLG - length
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
% BP -
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
% centerx centery radius startangle endangle DA -
/DA{
newpath arcn stroke
}bind def
% x y SN - x' y'
% round a position to nearest (pixel + (.25,.25))
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
% endx endy startx starty DL -
% we round the endpoints of the line, so that parallel horizontal
% and vertical lines will appear even
/DL{
SN
moveto
SN
lineto stroke
}bind def
% centerx centery radius DC -
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
%  width height centerx centery DE -
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
% these are for splines
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
% fill the last path
% r g b Fr -
/Fr{
setrgbcolor fill
}bind def
% c m y k Fk -
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
% g Fg -
/Fg{
setgray fill
}bind def
% fill with the "current color"
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
% new_font_name encoding_vector old_font_name RE -
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
% hpos vpos EBEGIN -
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
% llx lly newwid wid newht ht newllx newlly PBEGIN -
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
% set the graphics state to default values
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
%
%  Any included setpagedevice should be ignored.
%  See: http://www.w-beer.de/doc/ps/.
%
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%EndProlog
%%BeginSetup
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Times-Roman
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/Euro/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Times-Roman@0 ENC0/Times-Roman RE
%%EndSetup
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(RFC-021: Capability Dele)72 12 Q -.05(ga)-.15 G
(tion P).05 E(atterns)-.15 E(Status: Draft Date: January 2026 Author: D\
errell Piper ddp@eludom.net Implementation: Proposed)72 36 Q(----------\
--------------------------------------------------------------------)72
60 Q(Abstract)72 84 Q .18(This RFC speci\214es capability dele)72 108 R
-.05(ga)-.15 G .179(tion patterns for the Library of Cyberspace: ho).05
F 2.679(wp)-.25 G .179(rincipals grant, attenuate, and)-2.679 F(re)72
120 Q -.2(vo)-.25 G 1.844 -.1(ke c).2 H 1.644(apabilities using SPKI ce\
rti\214cates, content-addressed objects, and the soup metadata layer).1
F 6.645(.C)-.55 G(apabilities)-6.645 E<8d6f>72 132 Q 2.5(wt)-.25 G
(hrough dele)-2.5 E -.05(ga)-.15 G
(tion chains with monotonically decreasing authority).05 E(.)-.65 E(---\
-----------------------------------------------------------------------\
----)72 156 Q(Moti)72 180 Q -.25(va)-.25 G(tion).25 E
(Authorization in distrib)72 204 Q(uted systems is hard:)-.2 E 2.618(-A)
72 228 S .118(CLs don\342t scale - Central lists become bottlenecks - I\
dentity is fragile - Names change, k)-3.018 F -.15(ey)-.1 G 2.617(sr).15
G .117(otate - Ambient au-)-2.617 F(thority is dangerous - \342Run as r\
oot\342 is not a security model - Re)72 240 Q -.2(vo)-.25 G
(cation is an afterthought - Usually bolted on badly).2 E
(SPKI \(Simple Public K)72 264 Q .3 -.15(ey I)-.25 H
(nfrastructure\) solv).15 E(ed this decades ago:)-.15 E 3.268(-C)72 288
S .769(apabilities, not identities - What you can do, not who you are -\
 Local names - No global namespace required -)-3.268 F(Dele)72 300 Q
-.05(ga)-.15 G(tion chains - Authority \215o).05 E
(ws from source to dele)-.25 E -.05(ga)-.15 G
(te - Threshold signatures - M-of-N for critical operations).05 E 1.325
(The Library inte)72 324 R 1.325(grates SPKI with content-addressed sto\
rage, creating capabilities that are themselv)-.15 F 1.325
(es content-ad-)-.15 F(dressed and introspectable.)72 336 Q(-----------\
-------------------------------------------------------------------)72
360 Q(Capability Model)72 384 Q(Principals)72 408 Q 2.5(Ap)72 432 S
(rincipal is an)-2.5 E(ything that can hold authority:)-.15 E(;; K)82
456 Q .3 -.15(ey p)-.25 H(rincipal - most common).15 E(\(mak)82 468 Q
(e-principal)-.1 E(\(type k)87 480 Q -.15(ey)-.1 G(\)).15 E
(\(algorithm ed25519\))87 492 Q(\(public-k)87 504 Q .3 -.15(ey #)-.1 H
(${...32 bytes...}\)\)).15 E
(;; Hash principal - content-addressed object)82 528 Q(\(mak)82 540 Q
(e-principal)-.1 E(\(type hash\))87 552 Q(\(algorithm sha256\))87 564 Q
(\(digest #${...32 bytes...}\)\))87 576 Q
(;; Threshold principal - M-of-N group)82 600 Q(\(mak)82 612 Q
(e-principal)-.1 E(\(type threshold\))87 624 Q(\(threshold 3\))87 636 Q
(\(members \(k)87 648 Q -.15(ey)-.1 G 2.5(1k).15 G -.15(ey)-2.6 G 2.5
(2k).15 G -.15(ey)-2.6 G 2.5(3k).15 G -.15(ey)-2.6 G 2.5(4k).15 G -.15
(ey)-2.6 G(5\)\)\)).15 E(;; Name principal - local binding)82 672 Q
(\(mak)82 684 Q(e-principal)-.1 E(\(type name\))87 696 Q
(\(issuer parent-k)87 708 Q -.15(ey)-.1 G(\)).15 E(\(name "alice"\)\))87
720 Q(Capabilities)72 744 Q 2.5(Ac)72 768 S
(apability is a transferable right to perform an action:)-2.5 E
(\(capability)82 792 Q 0 Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(action read\))87 12 Q
(\(object \(hash sha256 "content-hash..."\)\)\))87 24 Q(\(capability)82
48 Q(\(action write\))87 60 Q
(\(object \(tree sha256 "subtree-root..."\)\)\))87 72 Q(\(capability)82
96 Q(\(action sign\))87 108 Q(\(object \(tag "releases/*"\)\)\))87 120 Q
(\(capability)82 144 Q(\(action dele)87 156 Q -.05(ga)-.15 G(te\)).05 E
(\(object \(capability ...\)\)\))87 168 Q 2.5(;M)5 G(eta-capability)-2.5
E(Certi\214cates)72 192 Q
(SPKI certi\214cates bind capabilities to principals:)72 216 Q
(\(spki-cert)82 240 Q(\(issuer v)87 252 Q(ault-master)-.25 E(-k)-.2 E
-.15(ey)-.1 G(\)).15 E(\(subject alice-k)87 264 Q -.15(ey)-.1 G(\)).15 E
(\(capability)87 276 Q(\(action read\))92 288 Q
(\(object \(tree sha256 "docs-root..."\)\)\))92 300 Q(\(v)87 312 Q
(alidity)-.25 E(\(not-before "2026-01-01"\))92 324 Q
(\(not-after "2027-01-01"\)\))92 336 Q(\(dele)87 348 Q -.05(ga)-.15 G
(tion #t\)\)).05 E 2.5(;A)5 G(lice can re-dele)-2.5 E -.05(ga)-.15 G(te)
.05 E(-----------------------------------------------------------------\
-------------)72 372 Q(Dele)72 396 Q -.05(ga)-.15 G(tion Chains).05 E
(Chain Structure)72 420 Q(Authority \215o)72 444 Q
(ws through certi\214cate chains:)-.25 E(Master K)82 468 Q -.15(ey)-.25
G<e2>92 480 Q(\342\274 \(cert: full access to v)92 492 Q(ault\))-.25 E
(Admin K)82 504 Q -.15(ey)-.25 G<e2>92 516 Q
(\342\274 \(cert: read/write to docs/, can dele)92 528 Q -.05(ga)-.15 G
(te\)).05 E(De)82 540 Q -.15(ve)-.25 G(loper K).15 E -.15(ey)-.25 G<e2>
92 552 Q(\342\274 \(cert: read-only to docs/public/, cannot dele)92 564
Q -.05(ga)-.15 G(te\)).05 E(Contractor K)82 576 Q -.15(ey)-.25 G
(Chain V)72 600 Q(alidation)-1.11 E(\(de\214ne \(v)82 624 Q
(alidate-chain chain tar)-.25 E(get-capability\))-.18 E("V)87 636 Q
(alidate dele)-1.11 E -.05(ga)-.15 G(tion chain grants capability").05 E
(\(let loop \(\(certs chain\))87 648 Q
(\(current-authority 'unlimited\)\))114.5 660 Q(\(if \(null? certs\))92
672 Q(\(capability-subset? tar)102 684 Q
(get-capability current-authority\))-.18 E
(\(let \(\(cert \(car certs\)\)\))102 696 Q(\(and \(v)107 708 Q
(erify-signature cert\))-.15 E(\(v)119.5 720 Q(alid-time? cert\))-.25 E
(\(not-re)119.5 732 Q -.2(vo)-.25 G -.1(ke).2 G(d? cert\)).1 E
(\(capability-subset? \(cert-capability cert\) current-authority\))119.5
744 Q(\(if \(cert-dele)119.5 756 Q -.05(ga)-.15 G(tion? cert\)).05 E
(\(loop \(cdr certs\) \(cert-capability cert\)\))129.5 768 Q
(\(and \(null? \(cdr certs\)\))129.5 780 Q(\(capability-subset? tar)142
792 Q(get-capability)-.18 E 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(cert-capability cert\)\)\)\)\)\)\)\)\))189.5
12 Q(Monotonic Attenuation)72 36 Q(Dele)72 60 Q -.05(ga)-.15 G
(ted capabilities can only decrease:).05 E
(;; Alice has read/write to entire v)82 84 Q(ault)-.25 E(\(spki-cert)82
96 Q(\(issuer master\))87 108 Q(\(subject alice\))87 120 Q
(\(capability \(action \(read write\)\) \(object v)87 132 Q
(ault-root\)\))-.25 E(\(dele)87 144 Q -.05(ga)-.15 G(tion #t\)\)).05 E
(;; Alice dele)82 168 Q -.05(ga)-.15 G(tes read-only to Bob \(v).05 E
(alid - attenuation\))-.25 E(\(spki-cert)82 180 Q(\(issuer alice\))87
192 Q(\(subject bob\))87 204 Q(\(capability \(action read\) \(object v)
87 216 Q(ault-root\)\))-.25 E(\(dele)87 228 Q -.05(ga)-.15 G
(tion #t\)\)).05 E(;; Bob tries to dele)82 252 Q -.05(ga)-.15 G
(te write to Carol \(INV).05 E(ALID - ampli\214cation\))-1.35 E
(\(spki-cert)82 264 Q(\(issuer bob\))87 276 Q(\(subject carol\))87 288 Q
(\(capability \(action write\) \(object v)87 300 Q 2.5(ault-root\)\) ;)
-.25 F(REJECTED)2.5 E(\(dele)87 312 Q -.05(ga)-.15 G(tion #f\)\)).05 E
(;; Bob dele)82 336 Q -.05(ga)-.15 G(tes read to subtree only \(v).05 E
(alid - further attenuation\))-.25 E(\(spki-cert)82 348 Q
(\(issuer bob\))87 360 Q(\(subject carol\))87 372 Q
(\(capability \(action read\) \(object docs-subtree\)\))87 384 Q(\(dele)
87 396 Q -.05(ga)-.15 G(tion #f\)\)).05 E(-----------------------------\
-------------------------------------------------)72 420 Q(Dele)72 444 Q
-.05(ga)-.15 G(tion P).05 E(atterns)-.15 E -.15(Pa)72 468 S
(ttern 1: Direct Dele).15 E -.05(ga)-.15 G(tion).05 E
(Simplest form - one hop:)72 492 Q(\(de\214ne \(dele)82 516 Q -.05(ga)
-.15 G(te-direct issuer).05 E(-k)-.2 E .3 -.15(ey s)-.1 H(ubject-k).15 E
.3 -.15(ey c)-.1 H(apability).15 E(#!k)144.5 528 Q .3 -.15(ey v)-.1 H
(alidity can-dele)-.1 E -.05(ga)-.15 G(te\)).05 E(\(sign-cert issuer)87
540 Q(-k)-.2 E -.15(ey)-.1 G(`\(spki-cert)92 552 Q(\(issuer ,\(k)97 564
Q -.15(ey)-.1 G(->principal issuer).15 E(-k)-.2 E -.15(ey)-.1 G(\)\)).15
E(\(subject ,\(k)97 576 Q -.15(ey)-.1 G(->principal subject-k).15 E -.15
(ey)-.1 G(\)\)).15 E(\(capability ,capability\))97 588 Q(\(v)97 600 Q
(alidity ,v)-.25 E(alidity\))-.25 E(\(dele)97 612 Q -.05(ga)-.15 G
(tion ,can-dele).05 E -.05(ga)-.15 G(te\)\)\)\)).05 E -.15(Pa)72 636 S
(ttern 2: Role-Based Dele).15 E -.05(ga)-.15 G(tion).05 E(Dele)72 660 Q
-.05(ga)-.15 G(te to roles, bind k).05 E -.15(ey)-.1 G 2.5(st).15 G 2.5
(or)-2.5 G(oles:)-2.5 E(;; De\214ne role)82 684 Q(\(spki-cert)82 696 Q
(\(issuer v)87 708 Q(ault-admin\))-.25 E(\(subject \(name v)87 720 Q
(ault-admin "re)-.25 E(vie)-.25 E(wer"\)\))-.25 E
(\(capability \(action read\) \(object \(tag "pending/*"\)\)\))87 732 Q
(\(dele)87 744 Q -.05(ga)-.15 G(tion #f\)\)).05 E(;; Bind k)82 768 Q .3
-.15(ey t)-.1 H 2.5(or).15 G(ole)-2.5 E(\(spki-cert)82 780 Q(\(issuer v)
87 792 Q(ault-admin\))-.25 E 0 Cg EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(subject alice-k)87 12 Q -.15(ey)-.1 G(\)).15 E
(\(capability \(name v)87 24 Q(ault-admin "re)-.25 E(vie)-.25 E
(wer"\)\))-.25 E(\(v)87 36 Q(alidity \(not-after "2026-06-01"\)\)\))-.25
E(;; Alice no)82 60 Q 2.5(wh)-.25 G(as re)-2.5 E(vie)-.25 E
(wer capability via role binding)-.25 E -.15(Pa)72 84 S
(ttern 3: Threshold Dele).15 E -.05(ga)-.15 G(tion).05 E
(Require multiple parties:)72 108 Q
(;; Critical operation requires 3-of-5)82 132 Q(\(spki-cert)82 144 Q
(\(issuer root-k)87 156 Q -.15(ey)-.1 G(\)).15 E
(\(subject \(threshold 3 \(k)87 168 Q -.15(ey)-.1 G 2.5(1k).15 G -.15
(ey)-2.6 G 2.5(2k).15 G -.15(ey)-2.6 G 2.5(3k).15 G -.15(ey)-2.6 G 2.5
(4k).15 G -.15(ey)-2.6 G(5\)\)\)).15 E
(\(capability \(action delete\) \(object v)87 180 Q(ault-root\)\))-.25 E
(\(dele)87 192 Q -.05(ga)-.15 G(tion #f\)\)).05 E(;; Ex)82 216 Q
(ercise requires g)-.15 E(athering signatures)-.05 E
(\(de\214ne \(threshold-e)82 228 Q -.15(xe)-.15 G
(rcise capability signers\)).15 E
(\(let \(\(signatures \(map \(lambda \(k)87 240 Q -.15(ey)-.1 G 2.5
(\)\().15 G(sign k)-2.5 E .3 -.15(ey c)-.1 H
(apability\)\) signers\)\)\)).15 E(\(if \(>= \(length signatures\) 3\))
92 252 Q(\(e)102 264 Q -.15(xe)-.15 G
(cute-capability capability signatures\)).15 E(\(error "Insuf)102 276 Q
(\214cient signatures"\)\)\)\))-.25 E -.15(Pa)72 300 S(ttern 4: T).15 E
(ime-Bounded Dele)-.35 E -.05(ga)-.15 G(tion).05 E -.7(Te)72 324 S
(mporary access:).7 E(;; Conference access - 3 days only)82 348 Q
(\(spki-cert)82 360 Q(\(issuer or)87 372 Q -.05(ga)-.18 G(nizer).05 E
(-k)-.2 E -.15(ey)-.1 G(\)).15 E(\(subject attendee-k)87 384 Q -.15(ey)
-.1 G(\)).15 E
(\(capability \(action read\) \(object conference-materials\)\))87 396 Q
(\(v)87 408 Q(alidity)-.25 E(\(not-before "2026-03-15T09:00:00Z"\))92
420 Q(\(not-after "2026-03-17T18:00:00Z"\)\))92 432 Q(\(dele)87 444 Q
-.05(ga)-.15 G(tion #f\)\)).05 E -.15(Pa)72 468 S
(ttern 5: Conditional Dele).15 E -.05(ga)-.15 G(tion).05 E
(Capability with restrictions:)72 492 Q(;; Can read, b)82 516 Q
(ut only from speci\214c IP range)-.2 E(\(spki-cert)82 528 Q
(\(issuer admin-k)87 540 Q -.15(ey)-.1 G(\)).15 E(\(subject service-k)87
552 Q -.15(ey)-.1 G(\)).15 E
(\(capability \(action read\) \(object api-data\)\))87 564 Q
(\(condition)87 576 Q(\(source-ip "10.0.0.0/8"\)\))92 588 Q(\(dele)87
600 Q -.05(ga)-.15 G(tion #f\)\)).05 E(;; Can write, b)82 624 Q
(ut only objects under 1MB)-.2 E(\(spki-cert)82 636 Q(\(issuer admin-k)
87 648 Q -.15(ey)-.1 G(\)).15 E(\(subject uploader)87 660 Q(-k)-.2 E
-.15(ey)-.1 G(\)).15 E
(\(capability \(action write\) \(object uploads\)\))87 672 Q
(\(condition)87 684 Q(\(max-size 1048576\)\))92 696 Q(\(dele)87 708 Q
-.05(ga)-.15 G(tion #f\)\)).05 E -.15(Pa)72 732 S(ttern 6: Proxy Dele)
.15 E -.05(ga)-.15 G(tion).05 E(Dele)72 756 Q -.05(ga)-.15 G
(te through intermediary:).05 E(;; Alice dele)82 780 Q -.05(ga)-.15 G
(tes to proxy service).05 E(\(spki-cert)82 792 Q 0 Cg EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(issuer alice-k)87 12 Q -.15(ey)-.1 G(\)).15 E
(\(subject proxy-k)87 24 Q -.15(ey)-.1 G(\)).15 E
(\(capability \(action read\) \(object alice-\214les\)\))87 36 Q(\(dele)
87 48 Q -.05(ga)-.15 G(tion #t\)).05 E(\(condition \(proxy-for alice-k)
87 60 Q -.15(ey)-.1 G(\)\)\)).15 E(;; Proxy can act on Alice')82 84 Q
2.5(sb)-.55 G(ehalf)-2.5 E(;; b)82 96 Q(ut chain sho)-.2 E
(ws Alice as original authority)-.25 E(--------------------------------\
----------------------------------------------)72 120 Q
(Content-Addressed Capabilities)72 144 Q(Hash as Capability)72 168 Q
(Kno)72 192 Q
(wledge of a content hash is itself a capability \(RFC-020\):)-.25 E
(;; Possessing this hash grants read access)82 216 Q
(\(de\214ne secret-doc-hash "sha256:7f83b1657f)82 228 Q(f1fc..."\))-.25
E(;; The hash is unguessable \(256 bits of entrop)82 252 Q(y\))-.1 E
(;; Sharing the hash = sharing the capability)82 264 Q
(\(de\214ne \(share-capability recipient hash\))82 276 Q
(\(encrypted-send recipient hash\)\))87 288 Q
(Capability Certi\214cates for Hashes)72 312 Q -.15(Fo)72 336 S
(rmalize hash-based access:).15 E(\(spki-cert)82 360 Q(\(issuer v)87 372
Q(ault-k)-.25 E -.15(ey)-.1 G(\)).15 E(\(subject reader)87 384 Q(-k)-.2
E -.15(ey)-.1 G(\)).15 E(\(capability)87 396 Q(\(action read\))92 408 Q
(\(object \(hash sha256 "speci\214c-doc..."\)\)\))92 420 Q(\(v)87 432 Q
(alidity \(not-after "2027-01-01"\)\)\))-.25 E -.35(Tr)72 456 S
(ee Capabilities).35 E(Grant access to Merkle subtree:)72 480 Q
(\(spki-cert)82 504 Q(\(issuer v)87 516 Q(ault-k)-.25 E -.15(ey)-.1 G
(\)).15 E(\(subject team-k)87 528 Q -.15(ey)-.1 G(\)).15 E(\(capability)
87 540 Q(\(action read\))92 552 Q
(\(object \(tree sha256 "project-root..."\)\))92 564 Q(\(propag)92 576 Q
(ate #t\)\))-.05 E 2.5(;I)5 G(ncludes all referenced objects)-2.5 E
(\(dele)87 588 Q -.05(ga)-.15 G(tion #t\)\)).05 E(Sealed Capabilities)72
612 Q(Encrypt capability for speci\214c recipient:)72 636 Q
(\(de\214ne \(seal-capability cap recipient-pubk)82 660 Q -.15(ey)-.1 G
(\)).15 E("Encrypt capability so only recipient can use it")87 672 Q
(\(let* \(\(serialized \(serialize cap\)\))87 684 Q
(\(encrypted \(age-encrypt serialized recipient-pubk)104.5 696 Q -.15
(ey)-.1 G(\)\)\)).15 E(\(cas-put encrypted\)\)\))92 708 Q
(\(de\214ne \(unseal-capability sealed-hash identity\))82 732 Q
("Decrypt and e)87 744 Q -.15(xe)-.15 G(rcise capability").15 E
(\(let* \(\(encrypted \(cas-get sealed-hash\)\))87 756 Q
(\(decrypted \(age-decrypt encrypted identity\)\))104.5 768 Q
(\(cap \(deserialize decrypted\)\)\))104.5 780 Q(cap\)\))92 792 Q 0 Cg
EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-----------------------------------------------\
-------------------------------)72 24 Q(Re)72 48 Q -.2(vo)-.25 G(cation)
.2 E(Re)72 72 Q -.2(vo)-.25 G(cation Lists).2 E(\(spki-crl)82 96 Q
(\(issuer v)87 108 Q(ault-admin\))-.25 E(\(re)87 120 Q -.2(vo)-.25 G -.1
(ke).2 G(d).1 E(\(\(cert-hash "sha256:re)92 132 Q -.2(vo)-.25 G -.1(ke)
.2 G(d1..."\)).1 E(\(reason k)94.5 144 Q -.15(ey)-.1 G(-compromise\)).15
E(\(re)94.5 156 Q -.2(vo)-.25 G -.1(ke).2 G(d-at 1767700000\)\)).1 E
(\(\(cert-hash "sha256:re)92 168 Q -.2(vo)-.25 G -.1(ke).2 G(d2..."\)).1
E(\(reason superseded\))94.5 180 Q(\(re)94.5 192 Q -.2(vo)-.25 G -.1(ke)
.2 G(d-at 1767700100\)\)\)\)).1 E(Online Re)72 216 Q -.2(vo)-.25 G
(cation Check).2 E(\(de\214ne \(check-re)82 240 Q -.2(vo)-.25 G
(cation cert\)).2 E("Check if certi\214cate is re)87 252 Q -.2(vo)-.25 G
-.1(ke).2 G(d").1 E
(\(let* \(\(cert-hash \(sha256 \(serialize cert\)\)\))87 264 Q
(\(issuer \(cert-issuer cert\)\))104.5 276 Q
(\(crl \(fetch-crl issuer\)\)\))104.5 288 Q
(\(not \(member cert-hash \(crl-re)92 300 Q -.2(vo)-.25 G -.1(ke).2 G
(d-hashes crl\)\)\)\)\)).1 E -.8(To)72 324 S(mbstone Re).8 E -.2(vo)-.25
G(cation).2 E(Using CAS tombstones \(RFC-020\):)72 348 Q
(\(de\214ne \(re)82 372 Q -.2(vo)-.25 G -.1(ke).2 G
(-capability-tombstone cert-hash reason\)).1 E("Re)87 384 Q -.2(vo)-.25
G .2 -.1(ke b).2 H 2.5(yt).1 G(ombstoning the certi\214cate")-2.5 E
(\(cas-tombstone cert-hash)87 396 Q(reason: reason)92 408 Q
(actor: \(current-principal\)\)\))92 420 Q(Short-Li)72 444 Q -.15(ve)
-.25 G 2.5(dC).15 G(erti\214cates)-2.5 E -1.22 -.74(Av o)72 468 T(id re)
.74 E -.2(vo)-.25 G(cation by using short v).2 E(alidity:)-.25 E
(;; 1-hour certi\214cate, no re)82 492 Q -.2(vo)-.25 G(cation needed).2
E(\(spki-cert)82 504 Q(\(issuer service-k)87 516 Q -.15(ey)-.1 G(\)).15
E(\(subject session-k)87 528 Q -.15(ey)-.1 G(\)).15 E
(\(capability \(action api-access\)\))87 540 Q(\(v)87 552 Q(alidity)-.25
E(\(not-before ,\(current-time\)\))92 564 Q
(\(not-after ,\(+ \(current-time\) 3600\)\)\))92 576 Q(\(dele)87 588 Q
-.05(ga)-.15 G(tion #f\)\)).05 E(--------------------------------------\
----------------------------------------)72 612 Q(Soup Inte)72 636 Q
(gration)-.15 E(Certi\214cates in the Soup)72 660 Q
(All certi\214cates are soup objects:)72 684 Q(\(soup-object)82 708 Q
(\(name "cert/alice-read-docs"\))87 720 Q(\(type certi\214cate\))87 732
Q(\(size "412B"\))87 744 Q(\(crypto \(ed25519 sha256 "cert-hash..."\)\))
87 756 Q(\(issuer "v)87 768 Q(ault-admin"\))-.25 E(\(subject "alice"\))
87 780 Q(\(capability "read docs/*"\))87 792 Q 0 Cg EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(e)87 12 Q(xpires "2027-01-01"\)\))-.15 E
(Querying Capabilities)72 36 Q(;; Find all certi\214cates for a subject)
82 60 Q(\(soup-query type: 'certi\214cate subject: alice-k)82 72 Q -.15
(ey)-.1 G(\)).15 E(;; Find all certi\214cates granting write access)82
96 Q(\(soup-query type: 'certi\214cate capability: 'write\))82 108 Q
(;; Find e)82 132 Q(xpiring certi\214cates)-.15 E
(\(soup-query type: 'certi\214cate)82 144 Q -.15(ex)112 156 S
(pires-before: \(+ \(current-time\) \(* 7 24 3600\)\)\)).15 E
(;; Find certi\214cates from speci\214c issuer)82 180 Q
(\(soup-query type: 'certi\214cate issuer: v)82 192 Q(ault-admin\))-.25
E(Capability Introspection)72 216 Q(;; What can Alice do?)82 240 Q
(\(de\214ne \(principal-capabilities principal\))82 252 Q(\(let \(\(cer\
ts \(soup-query type: 'certi\214cate subject: principal\)\)\))87 264 Q
(\(map cert-capability certs\)\)\))92 276 Q
(;; Who can read this object?)82 300 Q
(\(de\214ne \(object-readers hash\))82 312 Q
(\(let \(\(certs \(soup-query type: 'certi\214cate)87 324 Q
(capability: `\(read ,hash\)\)\)\))149.5 336 Q
(\(map cert-subject certs\)\)\))92 348 Q(;; V)82 372 Q(isualize dele)-.6
E -.05(ga)-.15 G(tion graph).05 E(\(de\214ne \(dele)82 384 Q -.05(ga)
-.15 G(tion-graph root-principal\)).05 E(\(let \(\(certs \(soup-query t\
ype: 'certi\214cate issuer: root-principal\)\)\))87 396 Q
(\(map \(lambda \(cert\))92 408 Q(\(cons \(cert-subject cert\))109.5 420
Q(\(dele)124.5 432 Q -.05(ga)-.15 G
(tion-graph \(cert-subject cert\)\)\)\)).05 E(certs\)\)\))104.5 444 Q(-\
-----------------------------------------------------------------------\
------)72 468 Q(Authorization Decisions)72 492 Q(Simple Check)72 516 Q
(\(de\214ne \(authorized? principal action object\))82 540 Q
("Check if principal can perform action on object")87 552 Q(\(let \(\(c\
hains \(\214nd-authorization-chains principal action object\)\)\))87 564
Q(\(an)92 576 Q 2.5(yv)-.15 G(alid-chain? chains\)\)\))-2.75 E
(Chain Disco)72 600 Q -.15(ve)-.15 G(ry).15 E
(\(de\214ne \(\214nd-authorization-chains principal action object\))82
624 Q("Find all certi\214cate chains granting capability")87 636 Q
(\(let \(\(tar)87 648 Q(get-cap \(capability action object\)\)\))-.18 E
(\(let search \(\(current principal\) \(chain '\(\)\)\))92 660 Q(\(let \
\(\(certs \(soup-query type: 'certi\214cate subject: current\)\)\))97
672 Q(\(append-map)102 684 Q(\(lambda \(cert\))107 696 Q
(\(if \(capability-grants? \(cert-capability cert\) tar)112 708 Q
(get-cap\))-.18 E(\(list \(re)122 720 Q -.15(ve)-.25 G
(rse \(cons cert chain\)\)\)).15 E(\(if \(cert-dele)122 732 Q -.05(ga)
-.15 G(tion? cert\)).05 E
(\(search \(cert-issuer cert\) \(cons cert chain\)\))132 744 Q
('\(\)\)\)\))132 756 Q(certs\)\)\)\)\))107 768 Q(Cached Authorization)72
792 Q 0 Cg EP
%%Page: 8 8
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(de\214ne auth-cache \(mak)82 24 Q
(e-lru-cache 10000\)\))-.1 E
(\(de\214ne \(authorized?/cached principal action object\))82 48 Q
(\(let \(\(k)87 60 Q .3 -.15(ey \()-.1 H
(list principal action object\)\)\)).15 E(\(or \(lru-get auth-cache k)92
72 Q -.15(ey)-.1 G(\)).15 E
(\(let \(\(result \(authorized? principal action object\)\)\))102 84 Q
(\(lru-put! auth-cache k)107 96 Q .3 -.15(ey r)-.1 H(esult\)).15 E
(result\)\)\)\))107 108 Q(---------------------------------------------\
---------------------------------)72 132 Q(Dele)72 156 Q -.05(ga)-.15 G
(tion Ceremonies).05 E -2.15 -.25(Ke y)72 180 T(Ceremon)2.75 E(y)-.15 E
-.15(Fo)72 204 S 2.5(rc).15 G(ritical dele)-2.5 E -.05(ga)-.15 G(tions:)
.05 E(\(de\214ne \(k)82 228 Q -.15(ey)-.1 G(-ceremon).15 E 2.5(yc)-.15 G
(apability threshold witnesses\))-2.5 E("Conduct witnessed dele)87 240 Q
-.05(ga)-.15 G(tion ceremon).05 E(y")-.15 E(\(let* \(\(ceremon)87 252 Q
(y-id \(generate-ceremon)-.15 E(y-id\)\))-.15 E(\(ceremon)104.5 264 Q
(y-record)-.15 E(`\(ceremon)107 276 Q(y)-.15 E(\(id ,ceremon)112 288 Q
(y-id\))-.15 E(\(capability ,capability\))112 300 Q
(\(threshold ,threshold\))112 312 Q(\(witnesses ,witnesses\))112 324 Q
(\(started-at ,\(current-time\)\)\)\)\))112 336 Q(;; Record ceremon)92
360 Q 2.5(ys)-.15 G(tart)-2.5 E(\(audit-append action: `\(ceremon)92 372
Q(y-start ,ceremon)-.15 E(y-id\)\))-.15 E(;; Gather witness signatures)
92 396 Q(\(let \(\(signatures \(g)92 408 Q(ather)-.05 E
(-witness-signatures ceremon)-.2 E(y-record witnesses\)\)\))-.15 E
(\(if \(>= \(length signatures\) threshold\))97 420 Q
(\(let \(\(cert \(\214nalize-ceremon)107 432 Q 2.5(yc)-.15 G(eremon)-2.5
E(y-record signatures\)\)\))-.15 E(\(audit-append action: `\(ceremon)112
444 Q(y-complete ,ceremon)-.15 E(y-id\)\))-.15 E(cert\))112 456 Q(\(be)
107 468 Q(gin)-.15 E(\(audit-append action: `\(ceremon)112 480 Q(y-f)
-.15 E(ailed ,ceremon)-.1 E(y-id\)\))-.15 E(\(error "Insuf)112 492 Q
(\214cient witnesses"\)\)\)\)\)\))-.25 E(Emer)72 516 Q(genc)-.18 E 2.5
(yR)-.15 G -2.2 -.25(ev o)-2.5 H(cation).25 E(\(de\214ne \(emer)82 540 Q
(genc)-.18 E(y-re)-.15 E -.2(vo)-.25 G .2 -.1(ke c).2 H
(ert-hash reason\)).1 E("Emer)87 552 Q(genc)-.18 E 2.5(yr)-.15 G -2.2
-.25(ev o)-2.5 H(cation with audit trail").25 E(\(let \(\(re)87 564 Q
-.2(vo)-.25 G(cation).2 E(`\(emer)104.5 576 Q(genc)-.18 E(y-re)-.15 E
-.2(vo)-.25 G(cation).2 E(\(cert ,cert-hash\))109.5 588 Q
(\(reason ,reason\))109.5 600 Q(\(re)109.5 612 Q -.2(vo)-.25 G -.1(ke).2
G(d-by ,\(current-principal\)\)).1 E(\(re)109.5 624 Q -.2(vo)-.25 G -.1
(ke).2 G(d-at ,\(current-time\)\)\)\)\)).1 E(;; Immediate tombstone)92
648 Q(\(cas-tombstone cert-hash reason: reason\))92 660 Q(;; Add to CRL)
92 684 Q(\(crl-append cert-hash reason\))92 696 Q
(;; Audit with high priority)92 720 Q(\(audit-append)92 732 Q
(action: `\(emer)97 744 Q(genc)-.18 E(y-re)-.15 E -.2(vo)-.25 G .2 -.1
(ke ,).2 H(cert-hash\)).1 E(moti)97 756 Q -.25(va)-.25 G(tion: reason)
.25 E(priority: 'critical\))97 768 Q(;; Notify af)92 792 Q
(fected parties)-.25 E 0 Cg EP
%%Page: 9 9
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(\(notify-re)92 12 Q -.2(vo)-.25 G
(cation cert-hash\)\)\)).2 E(------------------------------------------\
------------------------------------)72 36 Q(Security Considerations)72
60 Q(Capability Leakage)72 84 Q(;; Capabilities can leak through:)82 108
Q(;; 1. Logging - don')82 120 Q 2.5(tl)-.18 G(og capability tok)-2.5 E
(ens)-.1 E(;; 2. URLs - don')82 132 Q 2.5(tp)-.18 G
(ut capabilities in query strings)-2.5 E(;; 3. Errors - don')82 144 Q
2.5(ti)-.18 G(nclude capabilities in error messages)-2.5 E
(\(de\214ne \(safe-log message capability\))82 168 Q
(\(log \(string-append message " [capability:RED)87 180 Q -.4(AC)-.4 G
(TED]"\)\)\)).4 E(Confused Deputy)72 204 Q(;; Al)82 228 Q -.1(wa)-.1 G
(ys v).1 E(erify capability matches intended action)-.15 E
(\(de\214ne \(e)82 240 Q -.15(xe)-.15 G
(cute-action action object capability\)).15 E
(\(unless \(capability-grants? capability action object\))87 252 Q
(\(error "Capability does not grant this action"\)\))92 264 Q
(\(perform-action action object\)\))87 276 Q -.35(Ti)72 300 S
(me-of-Check vs T).35 E(ime-of-Use)-.35 E(;; V)82 324 Q
(alidate immediately before use, not before)-1.11 E(\(de\214ne \(safe-e)
82 336 Q -.15(xe)-.15 G(cute capability action\)).15 E(\(let \(\(v)87
348 Q(alidated \(v)-.25 E(alidate-capability capability\)\)\))-.25 E
(;; No windo)92 360 Q 2.5(wb)-.25 G(etween check and use)-2.5 E
(\(atomically)92 372 Q(\(unless v)97 384 Q(alidated)-.25 E(\(error "In)
102 396 Q -.25(va)-.4 G(lid capability"\)\)).25 E
(\(perform-action action\)\)\)\))97 408 Q(Dele)72 432 Q -.05(ga)-.15 G
(tion Depth Limits).05 E(;; Pre)82 456 Q -.15(ve)-.25 G
(nt in\214nite dele).15 E -.05(ga)-.15 G(tion chains).05 E
(\(de\214ne max-dele)82 468 Q -.05(ga)-.15 G(tion-depth 10\)).05 E
(\(de\214ne \(v)82 492 Q(alidate-chain-depth chain\))-.25 E
(\(when \(> \(length chain\) max-dele)87 504 Q -.05(ga)-.15 G
(tion-depth\)).05 E(\(error "Dele)92 516 Q -.05(ga)-.15 G
(tion chain too deep"\)\)\)).05 E(-------------------------------------\
-----------------------------------------)72 540 Q(Implementation Notes)
72 564 Q(Certi\214cate Storage)72 588 Q(;; Certi\214cates stored in CAS)
82 612 Q(\(de\214ne \(store-cert cert\))82 624 Q
(\(let \(\(signed \(sign-cert cert\)\)\))87 636 Q
(\(cas-put \(serialize signed\)\)\)\))92 648 Q(;; Inde)82 672 Q -.15(xe)
-.15 G 2.5(db).15 G 2.5(yi)-2.5 G(ssuer and subject for f)-2.5 E
(ast lookup)-.1 E(\(de\214ne cert-by-issuer \(mak)82 684 Q
(e-hash-table\)\))-.1 E(\(de\214ne cert-by-subject \(mak)82 696 Q
(e-hash-table\)\))-.1 E(Performance)72 720 Q 2.692(-C)72 744 S .192
(erti\214cate v)-2.692 F .192(alidation is e)-.25 F(xpensi)-.15 E .492
-.15(ve - c)-.25 H .192(ache results - Chain disco).15 F -.15(ve)-.15 G
.192(ry can be slo).15 F 2.692(w-i)-.25 G(nde)-2.692 E 2.692(xb)-.15 G
2.692(yi)-2.692 G .193(ssuer/subject - Re)-2.692 F -.2(vo)-.25 G(ca-).2
E(tion checks add latenc)72 756 Q 2.5(y-u)-.15 G(se short-li)-2.5 E -.15
(ve)-.25 G 2.5(dc).15 G(erts when possible)-2.5 E(---------------------\
---------------------------------------------------------)72 780 Q 0 Cg
EP
%%Page: 10 10
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(References)72 12 Q 2.665(1. SPKI/SDSI)72 36 R
.164(2.0 - RFC 2693 \(preserv)2.665 F .164(ed\) 2.)-.15 F 2.664(AL)5.164
G .164(ogic of Authentication - Burro)-2.664 F .164
(ws, Abadi, Needham \(preserv)-.25 F .164(ed\) 3.)-.15 F 1.398
(Capability Myths Demolished - Miller)72 48 R 3.898(,Y)-.4 G 1.398
(ee, Shapiro \(preserv)-4.898 F 1.399(ed\) 4.)-.15 F 1.399
(RFC-004: SPKI Authorization 5.)6.399 F(RFC-020:)6.399 E
(Content-Addressed Storage 6.)72 60 Q(RFC-007: Threshold Signature Go)5
E -.15(ve)-.15 G(rnance).15 E(-----------------------------------------\
-------------------------------------)72 84 Q(Changelog)72 108 Q 2.5(-2)
72 132 S(026-01-07 - Initial draft)-2.5 E(-----------------------------\
-------------------------------------------------)72 156 Q
(Implementation Status: Draft Dependencies: spki, v)72 180 Q
(ault, cas Inte)-.25 E(gration: V)-.15 E
(ault authorization, soup queries, audit trail)-1.11 E 0 Cg EP
%%Trailer
end
%%EOF
