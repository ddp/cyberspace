<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>RFC-054: Terminal Interface Conventions</title>
  <link rel="stylesheet" href="rfc.css">
</head>
<body>
<h1>RFC-054: Terminal Interface Conventions</h1>
<dl class="metadata">
</dl>
<hr>
<section>
<h2>Abstract</h2>
<p>The terminal is for operators. This RFC specifies visual conventions for the Cyberspace REPL: box drawing, tree displays, prompts, color usage, and output formatting. Consistency aids muscle memory.</p>
</section>
<section>
<h2>1. The Operator Interface</h2>
<p>The Cyberspace REPL is for hackers, admins, and operators—people who think in terms of data structures. This interface is deliberately different from the "normie" GUI interface (RFC-053).</p>
<pre>
                    CYBERSPACE
                        │
           ┌────────────┴────────────┐
           │                         │
      ┌────▼────┐              ┌─────▼─────┐
      │ Terminal │              │  Friendly  │
      │  (cs)    │  ← this RFC │    Door    │
      └─────────┘              └───────────┘
</pre>
</section>
<section>
<h2>2. Box Drawing</h2>
<h3>2.1 Unicode Box Characters</h3>
<p>All boxes MUST use Unicode box-drawing characters. Single-line (standard):</p>
<pre>
┌  U+250C  Top-left corner
┐  U+2510  Top-right corner
└  U+2514  Bottom-left corner
┘  U+2518  Bottom-right corner
│  U+2502  Vertical line
─  U+2500  Horizontal line
├  U+251C  Left tee (tree branch)
┤  U+2524  Right tee
┬  U+252C  Top tee
┴  U+2534  Bottom tee
┼  U+253C  Cross
</pre>
<p>Double-line boxes for emphasis:</p>
<pre>
╔  U+2554  Top-left corner
╗  U+2557  Top-right corner
╚  U+255A  Bottom-left corner
╝  U+255D  Bottom-right corner
║  U+2551  Vertical line
═  U+2550  Horizontal line
</pre>
<p>Rounded corners for certificates and sealed objects:</p>
<pre>
╭  U+256D  Top-left corner
╮  U+256E  Top-right corner
╰  U+2570  Bottom-left corner
╯  U+256F  Bottom-right corner
</pre>
<h3>2.2 Box Construction Pattern</h3>
<p>Use closures to encapsulate box state:</p>
<pre class="language-scheme">
(define (make-box title w)
  "Create a box drawing closure with given title and width"
  (let ((title-padded (string-append " " title " "))
         (title-len (string-length title-padded))
         (left-pad (quotient (- w title-len) 2))
         (right-pad (- w title-len left-pad))
         (header (string-append "┌" (make-string left-pad #\─)
                               title-padded
                               (make-string right-pad #\─) "┐\n"))
         (footer (string-append "└" (make-string w #\─) "┘\n")))
    (lambda (cmd . args)
      (case cmd
        ((header) header)
        ((footer) footer)
        ((line) (let ((content (if (null? args) "" (car args)))
                       (pad (- w (string-length content) 2)))
                  (string-append "│ " content
                                (make-string (max 0 pad) #\space)
                                " │\n")))))))
</pre>
<h3>2.3 Standard Box Widths</h3>
<table>
<tr><th>Context </th><th>Width </th><th>Usage </th></tr>
<tr><td>Compact </td><td>40 </td><td>Small status displays </td></tr>
<tr><td>Standard </td><td>50 </td><td>Most dialogs </td></tr>
<tr><td>Wide </td><td>65 </td><td>Detailed information </td></tr>
</table>
</section>
<section>
<h2>3. Tree Display</h2>
<h3>3.1 Tree Characters</h3>
<pre>
├─  U+251C + U+2500  Branch with more siblings
└─  U+2514 + U+2500  Final branch (no more siblings)
│   U+2502           Vertical continuation
▶   U+25B6           Collapsed/expandable indicator
▼   U+25BC           Expanded indicator
</pre>
<h3>3.2 Tree Example</h3>
<pre>
hostname · up 3d 12:45:03
├─ 10 cores, 64GB, Apple M4
├─ 192.168.1.100 / 2001:db8::1...
└─ vault: .vault/ (keys) (audit)
</pre>
<h3>3.3 Multi-level Trees</h3>
<pre>
vault (49 objects)
├─ archives (3)
│  └─ cyberspace-v0.59.tar.gz
├─ keys (2)
│  ├─ starlight · Ed25519
│  └─ macmini · Ed25519
└─ releases (5)
   └─ v0.59 (signed)
</pre>
</section>
<section>
<h2>4. Prompt</h2>
<h3>4.1 Default Prompt</h3>
<p>The default prompt is a simple colon with trailing space:</p>
<pre>
:
</pre>
<p>This echoes the Newton's soup browser prompt.</p>
<h3>4.2 Prompt Variants</h3>
<table>
<tr><th>Context </th><th>Prompt </th><th>Usage </th></tr>
<tr><td>Normal </td><td>:  </td><td>Default </td></tr>
<tr><td>Continuation </td><td>&gt;  </td><td>Multi-line input </td></tr>
<tr><td>Debug </td><td>[n]:  </td><td>In debugger at frame n </td></tr>
</table>
</section>
<section>
<h2>5. Color and Emphasis</h2>
<h3>5.1 VT100 Codes</h3>
<p>Use ANSI/VT100 escape sequences sparingly:</p>
<pre class="language-scheme">
(define vt100-bold    "\x1b[1m")
(define vt100-dim     "\x1b[2m")
(define vt100-normal  "\x1b[0m")
(define vt100-red     "\x1b[31m")
(define vt100-green   "\x1b[32m")
(define vt100-yellow  "\x1b[33m")
(define vt100-blue    "\x1b[34m")
</pre>
<h3>5.2 When to Use Color</h3>
<ul>
<li>Green: Success, completion (✓)</li>
<li>Red: Error, failure (✗)</li>
<li>Yellow: Warning, attention needed</li>
<li>Blue: Informational highlights</li>
<li>Dim: Secondary information</li>
<li>Bold: Headers, important values</li>
</ul>
<h3>5.3 Principle</h3>
<p>Color is enhancement, not information. All output MUST be readable without color (plain terminal, logging, piped output).</p>
</section>
<section>
<h2>6. Status Symbols</h2>
<h3>6.1 Checkmarks and Crosses</h3>
<pre>
✓ U+2713  Success
✗ U+2717  Failure
• U+2022  Bullet point
→ U+2192  Arrow, implies
</pre>
<h3>6.2 Inline Separators</h3>
<p>For separating items in compact displays (session stats, status lines):</p>
<pre>
·  U+00B7  Middle dot separator (preferred)
|  U+007C  Pipe (more intrusive, use sparingly)
↓  U+2193  Down arrow (bytes/data in)
↑  U+2191  Up arrow (bytes/data out)
</pre>
<p>Example session summary:</p>
<pre>
Session: 4m 24s · 2 syncs · 3 seals · ↓1.2K ↑856B · 1247 VUPS
</pre>
<h3>6.3 Sparklines</h3>
<p>For activity visualization over time:</p>
<pre>
▁▂▃▄▅▆▇█  U+2581 through U+2588
</pre>
<p>Eight levels map to normalized data:</p>
<pre class="language-scheme">
(define sparkline-chars '#("▁" "▂" "▃" "▄" "▅" "▆" "▇" "█"))
</pre>
</section>
<section>
<h2>7. Output Conventions</h2>
<h3>7.1 Blank Lines</h3>
<ul>
<li>One blank line before major output blocks</li>
<li>One blank line after banner/header boxes</li>
<li>No trailing blank lines in functions returning (void)</li>
</ul>
<h3>7.2 Indentation</h3>
<ul>
<li>2 spaces for nested information - 4 spaces for code examples in help text</li>
<li>Tree branches provide visual indentation</li>
</ul>
<h3>7.3 Truncation</h3>
<p>Long values should be truncated with ellipsis:</p>
<pre class="language-scheme">
(define (short-id id)
  "Truncate id for display (max 16 chars)"
  (if (&gt; (string-length id) 16)
      (string-append (substring id 0 16) "...")
      id))
</pre>
</section>
<section>
<h2>8. Result Display</h2>
<h3>8.1 History Variables</h3>
<pre class="language-scheme">
   ; last result
1  ; second-to-last
_2  ; third-to-last
($n); result by number
</pre>
<h3>8.2 Void</h3>
<p>Functions that print output typically return (void) to suppress duplicate display.</p>
</section>
<section>
<h2>9. Messages</h2>
<h3>9.1 Welcome Banner</h3>
<pre>
Cyberspace Scheme v0.59 (2026-01-11)
  Starlight · Darwin-arm64 · 10 cores, 64GB, Apple M4
  boot: 2026-01-11 22:30:45Z (14:30:45 PST)
  IPv4: 192.168.1.100
  IPv6: 2001:db8::1
</pre>
<h3>9.2 Goodbye Message</h3>
<pre>
Returning to objective reality, Cyberspace frozen at 2026-01-11 22:35:22Z (14:35:22 PST).
  Session: 4m 37s · 2 syncs · 47 objects · 2 keys
</pre>
<h3>9.3 Timestamp Convention</h3>
<p>All timestamps in Cyberspace use ISO 8601 UTC format with Z suffix, followed by local time reference for operators:</p>
<pre>
YYYY-MM-DD HH:MM:SSZ (HH:MM:SS TZ)
</pre>
<p>UTC is canonical for storage, audit trails, and cross-node operations. The local time reference aids operators without affecting data integrity.</p>
<h3>9.4 Error Messages</h3>
<p>Errors should be clear and actionable:</p>
<pre>
No signing key configured. Generate with (ed25519-keypair)
</pre>
<p>Not:</p>
<pre>
Error: nil key
</pre>
</section>
<section>
<h2>10. Single-Character Shortcuts</h2>
<table>
<tr><th>Symbol </th><th>Function </th><th>Description </th></tr>
<tr><td>\</td><td>.\</td><td> </td><td>status </td><td>Compact status display </td></tr>
<tr><td>\</td><td>?\</td><td> </td><td>help </td><td>Show help </td></tr>
</table>
<p>These use pipe-delimited symbols to avoid conflict with Scheme.</p>
</section>
<section>
<h2>11. Terminal Window</h2>
<h3>11.1 Title</h3>
<p>Set terminal title on startup:</p>
<pre class="language-scheme">
(define (set-terminal-title title)
  (display (string-append "\x1b]0;" title "\x07")))
</pre>
<p>Format: &lt;Hostname&gt; Workstation</p>
<h3>11.2 Clear Screen</h3>
<pre class="language-scheme">
(define (clear)
  (display "\x1b[2J\x1b[H")
  (void))
</pre>
</section>
<section>
<h2>12. Implementation Notes</h2>
<h3>12.1 UTF-8 and string-ref</h3>
<p>Do NOT use string-ref on strings containing multi-byte UTF-8 characters. Use vectors of strings instead:</p>
<pre class="language-scheme">
;; WRONG - fails on multi-byte chars
(string-ref "▁▂▃" idx)

;; RIGHT - vector of strings
(vector-ref '#("▁" "▂" "▃") idx)
</pre>
<h3>12.2 Width Calculations</h3>
<p>String length for box padding must account for display width, not byte length. ASCII characters are safe. For emoji or CJK, additional handling is needed.</p>
</section>
<section>
<h2>13. Linting Checklist</h2>
<p>When auditing terminal output:</p>
<p>1. [ ] Boxes use Unicode box-drawing characters 2. [ ] Trees use ├─ and └─ consistently 3. [ ] Prompt is :  (colon-space) 4. [ ] Colors are optional, not required for meaning 5. [ ] Error messages are actionable 6. [ ] Functions returning output use (void) 7. [ ] Long values are truncated with ... 8. [ ] Blank lines follow the convention 9. [ ] No ASCII art boxes (+---, |, etc.) 10. [ ] No tabs in output (spaces only)</p>
</section>
<section>
<h2>14. References</h2>
<p>1. RFC-053 — The Normie Interface (GUI counterpart) 2. RFC-002 — Architecture ("English on top, Scheme underneath") 3. Unicode Standard — Box Drawing (U+2500–U+257F) 4. ECMA-48 — Control Functions for Coded Character Sets (VT100)</p>
</section>
<section>
<h2>Changelog</h2>
<p>- 2026-01-11 — Initial specification</p>
</section>
</body>
</html>
